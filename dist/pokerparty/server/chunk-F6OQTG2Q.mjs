import './polyfills.server.mjs';
import{$ as sC,$a as hC,A as iC,Aa as at,B as Oo,Ba as As,C as Ml,Ca as gn,D as nC,Da as Fo,E as No,Ea as pi,F as rC,Fa as au,G as Ei,Ga as Ve,H as hn,Ha as yn,I as Yp,Ia as ai,J as si,Ja as Ue,K as wr,Ka as aC,L as Xp,M as nu,N as ue,O as J,P as W,Q as N,Qa as tg,R as Nt,S as mi,Sa as Tr,T as ee,Ta as lt,U as Le,V as Sr,Va as lC,W as Zp,Wa as cC,X as Gi,Xa as lu,Y as Ol,Ya as dC,Z as fn,Za as cu,_ as Jp,_a as uC,a as zi,aa as Po,ab as fC,b as mt,ba as Be,bb as mC,c as te,ca as ru,cb as pC,d as eu,da as su,db as gC,e as WE,ea as ou,eb as ig,f as Wp,fa as Se,fb as yC,g as KE,ga as V,gb as vC,h as _r,ha as Er,hb as _C,i as Is,ia as ot,j as ji,ja as se,k as Ot,ka as mn,kb as bC,l as QE,la as Cr,m as pe,ma as Ci,n as YE,na as Pt,o as XE,oa as Ze,p as tu,pa as eg,q as Kp,qa as pt,qb as ng,r as ZE,ra as Wt,s as br,sa as ye,t as un,ta as ve,u as Qp,ua as Qn,v as JE,va as Nl,w as eC,wa as oC,x as Ds,xa as oi,y as iu,ya as pn,z as tC,za as $i}from"./chunk-SVC3CLQA.mjs";import{a as wC,b as SC,c as rg,d as EC,e as du,f as CC,g as uu,h as TC,i as xC,j as qe,k as Rs,l as vn,m as hu,n as Pl,o as sg,p as IC,q as DC,r as Fl,s as fu,t as Kt,u as _P,v as li}from"./chunk-V3ZKNJHS.mjs";import{a as yt,b as dn,c as ge,e as S,g as $p,h as Hp,i as p}from"./chunk-LK223424.mjs";var he=S(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0});Ii.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=Ii.DEFAULT_MAX_SEND_MESSAGE_LENGTH=Ii.Propagate=Ii.LogVerbosity=Ii.Status=void 0;var Mx=function(i){return i[i.OK=0]="OK",i[i.CANCELLED=1]="CANCELLED",i[i.UNKNOWN=2]="UNKNOWN",i[i.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",i[i.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",i[i.NOT_FOUND=5]="NOT_FOUND",i[i.ALREADY_EXISTS=6]="ALREADY_EXISTS",i[i.PERMISSION_DENIED=7]="PERMISSION_DENIED",i[i.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",i[i.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",i[i.ABORTED=10]="ABORTED",i[i.OUT_OF_RANGE=11]="OUT_OF_RANGE",i[i.UNIMPLEMENTED=12]="UNIMPLEMENTED",i[i.INTERNAL=13]="INTERNAL",i[i.UNAVAILABLE=14]="UNAVAILABLE",i[i.DATA_LOSS=15]="DATA_LOSS",i[i.UNAUTHENTICATED=16]="UNAUTHENTICATED",i}(Mx||(Ii.Status=Mx={})),Ox=function(i){return i[i.DEBUG=0]="DEBUG",i[i.INFO=1]="INFO",i[i.ERROR=2]="ERROR",i[i.NONE=3]="NONE",i}(Ox||(Ii.LogVerbosity=Ox={})),Nx=function(i){return i[i.DEADLINE=1]="DEADLINE",i[i.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",i[i.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",i[i.CANCELLATION=8]="CANCELLATION",i[i.DEFAULTS=65535]="DEFAULTS",i}(Nx||(Ii.Propagate=Nx={}));Ii.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;Ii.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var my=S((bX,i2)=>{i2.exports={name:"@grpc/grpc-js",version:"1.9.13",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var Ke=S(Xt=>{"use strict";var py,gy,yy,vy;Object.defineProperty(Xt,"__esModule",{value:!0});Xt.isTracerEnabled=Xt.trace=Xt.log=Xt.setLoggerVerbosity=Xt.setLogger=Xt.getLogger=void 0;var Dr=he(),n2=ge("process"),r2=my().version,s2={error:(i,...e)=>{console.error("E "+i,...e)},info:(i,...e)=>{console.error("I "+i,...e)},debug:(i,...e)=>{console.error("D "+i,...e)}},zs=s2,Wo=Dr.LogVerbosity.ERROR,o2=(gy=(py=process.env.GRPC_NODE_VERBOSITY)!==null&&py!==void 0?py:process.env.GRPC_VERBOSITY)!==null&&gy!==void 0?gy:"";switch(o2.toUpperCase()){case"DEBUG":Wo=Dr.LogVerbosity.DEBUG;break;case"INFO":Wo=Dr.LogVerbosity.INFO;break;case"ERROR":Wo=Dr.LogVerbosity.ERROR;break;case"NONE":Wo=Dr.LogVerbosity.NONE;break;default:}var a2=()=>zs;Xt.getLogger=a2;var l2=i=>{zs=i};Xt.setLogger=l2;var c2=i=>{Wo=i};Xt.setLoggerVerbosity=c2;var d2=(i,...e)=>{let t;if(i>=Wo){switch(i){case Dr.LogVerbosity.DEBUG:t=zs.debug;break;case Dr.LogVerbosity.INFO:t=zs.info;break;case Dr.LogVerbosity.ERROR:t=zs.error;break}t||(t=zs.error),t&&t.bind(zs)(...e)}};Xt.log=d2;var u2=(vy=(yy=process.env.GRPC_NODE_TRACE)!==null&&yy!==void 0?yy:process.env.GRPC_TRACE)!==null&&vy!==void 0?vy:"",_y=new Set,Px=new Set;for(let i of u2.split(","))i.startsWith("-")?Px.add(i.substring(1)):_y.add(i);var h2=_y.has("all");function f2(i,e,t){Fx(e)&&(0,Xt.log)(i,new Date().toISOString()+" | v"+r2+" "+n2.pid+" | "+e+" | "+t)}Xt.trace=f2;function Fx(i){return!Px.has(i)&&(h2||_y.has(i))}Xt.isTracerEnabled=Fx});var Ju=S(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.getErrorCode=Ko.getErrorMessage=void 0;function m2(i){return i instanceof Error?i.message:String(i)}Ko.getErrorMessage=m2;function p2(i){return typeof i=="object"&&i!==null&&"code"in i&&typeof i.code=="number"?i.code:null}Ko.getErrorCode=p2});var Zt=S(th=>{"use strict";Object.defineProperty(th,"__esModule",{value:!0});th.Metadata=void 0;var g2=Ke(),y2=he(),v2=Ju(),_2=/^[0-9a-z_.-]+$/,b2=/^[ -~]*$/;function w2(i){return _2.test(i)}function S2(i){return b2.test(i)}function Bx(i){return i.endsWith("-bin")}function E2(i){return!i.startsWith("grpc-")}function eh(i){return i.toLowerCase()}function Lx(i,e){if(!w2(i))throw new Error('Metadata key "'+i+'" contains illegal characters');if(e!=null)if(Bx(i)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!S2(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var by=class i{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){e=eh(e),Lx(e,t),this.internalRepr.set(e,[t])}add(e,t){e=eh(e),Lx(e,t);let n=this.internalRepr.get(e);n===void 0?this.internalRepr.set(e,[t]):n.push(t)}remove(e){e=eh(e),this.internalRepr.delete(e)}get(e){return e=eh(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,n]of this.internalRepr)if(n.length>0){let r=n[0];e[t]=Buffer.isBuffer(r)?Buffer.from(r):r}return e}clone(){let e=new i(this.options),t=e.internalRepr;for(let[n,r]of this.internalRepr){let s=r.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);t.set(n,s)}return e}merge(e){for(let[t,n]of e.internalRepr){let r=(this.internalRepr.get(t)||[]).concat(n);this.internalRepr.set(t,r)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,n]of this.internalRepr)e[t]=n.map(C2);return e}toJSON(){let e={};for(let[t,n]of this.internalRepr)e[t]=n;return e}static fromHttp2Headers(e){let t=new i;for(let n of Object.keys(e)){if(n.charAt(0)===":")continue;let r=e[n];try{Bx(n)?Array.isArray(r)?r.forEach(s=>{t.add(n,Buffer.from(s,"base64"))}):r!==void 0&&(E2(n)?r.split(",").forEach(s=>{t.add(n,Buffer.from(s.trim(),"base64"))}):t.add(n,Buffer.from(r,"base64"))):Array.isArray(r)?r.forEach(s=>{t.add(n,s)}):r!==void 0&&t.add(n,r)}catch(s){let o=`Failed to add metadata entry ${n}: ${r}. ${(0,v2.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,g2.log)(y2.LogVerbosity.ERROR,o)}}return t}};th.Metadata=by;var C2=i=>Buffer.isBuffer(i)?i.toString("base64"):i});var Ty=S(ih=>{"use strict";Object.defineProperty(ih,"__esModule",{value:!0});ih.CallCredentials=void 0;var Cy=Zt();function T2(i){return"getRequestHeaders"in i&&typeof i.getRequestHeaders=="function"}var Qo=class i{static createFromMetadataGenerator(e){return new Sy(e)}static createFromGoogleCredential(e){return i.createFromMetadataGenerator((t,n)=>{let r;T2(e)?r=e.getRequestHeaders(t.service_url):r=new Promise((s,o)=>{e.getRequestMetadata(t.service_url,(a,l)=>{if(a){o(a);return}if(!l){o(new Error("Headers not set by metadata plugin"));return}s(l)})}),r.then(s=>{let o=new Cy.Metadata;for(let a of Object.keys(s))o.add(a,s[a]);n(null,o)},s=>{n(s)})})}static createEmpty(){return new Ey}};ih.CallCredentials=Qo;var wy=class i extends Qo{constructor(e){super(),this.creds=e}generateMetadata(e){return p(this,null,function*(){let t=new Cy.Metadata,n=yield Promise.all(this.creds.map(r=>r.generateMetadata(e)));for(let r of n)t.merge(r);return t})}compose(e){return new i(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof i?this.creds.every((t,n)=>t._equals(e.creds[n])):!1}},Sy=class i extends Qo{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,n)=>{this.metadataGenerator(e,(r,s)=>{s!==void 0?t(s):n(r)})})}compose(e){return new wy([this,e])}_equals(e){return this===e?!0:e instanceof i?this.metadataGenerator===e.metadataGenerator:!1}},Ey=class i extends Qo{generateMetadata(e){return Promise.resolve(new Cy.Metadata)}compose(e){return e}_equals(e){return e instanceof i}}});var Iy=S(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.getDefaultRootsData=Yo.CIPHER_SUITES=void 0;var x2=ge("fs");Yo.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var Vx=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,xy=null;function I2(){return Vx?(xy===null&&(xy=x2.readFileSync(Vx)),xy):null}Yo.getDefaultRootsData=I2});var sh=S(rh=>{"use strict";Object.defineProperty(rh,"__esModule",{value:!0});rh.ChannelCredentials=void 0;var D2=ge("tls"),A2=Ty(),Ux=Iy();function Dy(i,e){if(i&&!(i instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var Xo=class{constructor(e){this.callCredentials=e||A2.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,n,r){var s;if(Dy(e,"Root certificate"),Dy(t,"Private key"),Dy(n,"Certificate chain"),t&&!n)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&n)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,D2.createSecureContext)({ca:(s=e??(0,Ux.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:t??void 0,cert:n??void 0,ciphers:Ux.CIPHER_SUITES});return new nh(o,r??{})}static createFromSecureContext(e,t){return new nh(e,t??{})}static createInsecure(){return new Ay}};rh.ChannelCredentials=Xo;var Ay=class i extends Xo{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof i}},nh=class i extends Xo{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},t?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){let t=this.callCredentials.compose(e);return new Ry(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof i?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},Ry=class i extends Xo{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new i(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof i?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var Rr=S(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.validateLoadBalancingConfig=Vt.getFirstUsableConfig=Vt.isLoadBalancerNameRegistered=Vt.createLoadBalancer=Vt.registerDefaultLoadBalancerType=Vt.registerLoadBalancerType=Vt.createChildChannelControlHelper=void 0;function R2(i,e){var t,n,r,s,o,a,l,c,d,u;return{createSubchannel:(n=(t=e.createSubchannel)===null||t===void 0?void 0:t.bind(e))!==null&&n!==void 0?n:i.createSubchannel.bind(i),updateState:(s=(r=e.updateState)===null||r===void 0?void 0:r.bind(e))!==null&&s!==void 0?s:i.updateState.bind(i),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:i.requestReresolution.bind(i),addChannelzChild:(c=(l=e.addChannelzChild)===null||l===void 0?void 0:l.bind(e))!==null&&c!==void 0?c:i.addChannelzChild.bind(i),removeChannelzChild:(u=(d=e.removeChannelzChild)===null||d===void 0?void 0:d.bind(e))!==null&&u!==void 0?u:i.removeChannelzChild.bind(i)}}Vt.createChildChannelControlHelper=R2;var Ar={},ky=null;function k2(i,e,t){Ar[i]={LoadBalancer:e,LoadBalancingConfig:t}}Vt.registerLoadBalancerType=k2;function M2(i){ky=i}Vt.registerDefaultLoadBalancerType=M2;function O2(i,e){let t=i.getLoadBalancerName();return t in Ar?new Ar[t].LoadBalancer(e):null}Vt.createLoadBalancer=O2;function N2(i){return i in Ar}Vt.isLoadBalancerNameRegistered=N2;function P2(i,e=!1){for(let t of i)if(t.getLoadBalancerName()in Ar)return t;return e&&ky?new Ar[ky].LoadBalancingConfig:null}Vt.getFirstUsableConfig=P2;function F2(i){if(!(i!==null&&typeof i=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(i);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let t=e[0];if(t in Ar)return Ar[t].LoadBalancingConfig.createFromJson(i[t]);throw new Error(`Unrecognized load balancing config name ${t}`)}Vt.validateLoadBalancingConfig=F2});var My=S(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.extractAndSelectServiceConfig=kr.validateServiceConfig=kr.validateRetryThrottling=void 0;var L2=ge("os"),oh=he(),B2=Rr(),ah=/^\d+(\.\d{1,9})?s$/,V2="node";function U2(i){if("service"in i&&i.service!==""){if(typeof i.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof i.service}`);if("method"in i&&i.method!==""){if(typeof i.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof i.service}`);return{service:i.service,method:i.method}}else return{service:i.service}}else{if("method"in i&&i.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function q2(i){if(!("maxAttempts"in i)||!Number.isInteger(i.maxAttempts)||i.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in i)||typeof i.initialBackoff!="string"||!ah.test(i.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in i)||typeof i.maxBackoff!="string"||!ah.test(i.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in i)||typeof i.backoffMultiplier!="number"||i.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in i&&Array.isArray(i.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(i.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of i.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(oh.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(oh.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:i.maxAttempts,initialBackoff:i.initialBackoff,maxBackoff:i.maxBackoff,backoffMultiplier:i.backoffMultiplier,retryableStatusCodes:i.retryableStatusCodes}}function z2(i){if(!("maxAttempts"in i)||!Number.isInteger(i.maxAttempts)||i.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in i&&(typeof i.hedgingDelay!="string"||!ah.test(i.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in i&&Array.isArray(i.nonFatalStatusCodes))for(let t of i.nonFatalStatusCodes)if(typeof t=="number"){if(!Object.values(oh.Status).includes(t))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof t=="string"){if(!Object.values(oh.Status).includes(t.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:i.maxAttempts};return i.hedgingDelay&&(e.hedgingDelay=i.hedgingDelay),i.nonFatalStatusCodes&&(e.nonFatalStatusCodes=i.nonFatalStatusCodes),e}function j2(i){var e;let t={name:[]};if(!("name"in i)||!Array.isArray(i.name))throw new Error("Invalid method config: invalid name array");for(let n of i.name)t.name.push(U2(n));if("waitForReady"in i){if(typeof i.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");t.waitForReady=i.waitForReady}if("timeout"in i)if(typeof i.timeout=="object"){if(!("seconds"in i.timeout)||typeof i.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in i.timeout)||typeof i.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");t.timeout=i.timeout}else if(typeof i.timeout=="string"&&ah.test(i.timeout)){let n=i.timeout.substring(0,i.timeout.length-1).split(".");t.timeout={seconds:n[0]|0,nanos:((e=n[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in i){if(typeof i.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxRequestBytes=i.maxRequestBytes}if("maxResponseBytes"in i){if(typeof i.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxResponseBytes=i.maxResponseBytes}if("retryPolicy"in i){if("hedgingPolicy"in i)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");t.retryPolicy=q2(i.retryPolicy)}else"hedgingPolicy"in i&&(t.hedgingPolicy=z2(i.hedgingPolicy));return t}function qx(i){if(!("maxTokens"in i)||typeof i.maxTokens!="number"||i.maxTokens<=0||i.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in i)||typeof i.tokenRatio!="number"||i.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+i.maxTokens.toFixed(3),tokenRatio:+i.tokenRatio.toFixed(3)}}kr.validateRetryThrottling=qx;function zx(i){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in i)if(typeof i.loadBalancingPolicy=="string")e.loadBalancingPolicy=i.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in i)if(Array.isArray(i.loadBalancingConfig))for(let n of i.loadBalancingConfig)e.loadBalancingConfig.push((0,B2.validateLoadBalancingConfig)(n));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in i&&Array.isArray(i.methodConfig))for(let n of i.methodConfig)e.methodConfig.push(j2(n));"retryThrottling"in i&&(e.retryThrottling=qx(i.retryThrottling));let t=[];for(let n of e.methodConfig)for(let r of n.name){for(let s of t)if(r.service===s.service&&r.method===s.method)throw new Error(`Invalid service config: duplicate name ${r.service}/${r.method}`);t.push(r)}return e}kr.validateServiceConfig=zx;function G2(i){if(!("serviceConfig"in i))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:zx(i.serviceConfig)};if("clientLanguage"in i)if(Array.isArray(i.clientLanguage)){e.clientLanguage=[];for(let n of i.clientLanguage)if(typeof n=="string")e.clientLanguage.push(n);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in i)if(Array.isArray(i.clientHostname)){e.clientHostname=[];for(let n of i.clientHostname)if(typeof n=="string")e.clientHostname.push(n);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in i)if(typeof i.percentage=="number"&&0<=i.percentage&&i.percentage<=100)e.percentage=i.percentage;else throw new Error("Invalid service config choice: invalid percentage");let t=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let n in i)if(!t.includes(n))throw new Error(`Invalid service config choice: unexpected field ${n}`);return e}function $2(i,e){if(!Array.isArray(i))throw new Error("Invalid service config list");for(let t of i){let n=G2(t);if(!(typeof n.percentage=="number"&&e>n.percentage)){if(Array.isArray(n.clientHostname)){let r=!1;for(let s of n.clientHostname)s===L2.hostname()&&(r=!0);if(!r)continue}if(Array.isArray(n.clientLanguage)){let r=!1;for(let s of n.clientLanguage)s===V2&&(r=!0);if(!r)continue}return n.serviceConfig}}throw new Error("No matching service config found")}function H2(i,e){for(let t of i)if(t.length>0&&t[0].startsWith("grpc_config=")){let n=t.join("").substring(12),r=JSON.parse(n);return $2(r,e)}return null}kr.extractAndSelectServiceConfig=H2});var Di=S(lh=>{"use strict";Object.defineProperty(lh,"__esModule",{value:!0});lh.ConnectivityState=void 0;var jx=function(i){return i[i.IDLE=0]="IDLE",i[i.CONNECTING=1]="CONNECTING",i[i.READY=2]="READY",i[i.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",i[i.SHUTDOWN=4]="SHUTDOWN",i}(jx||(lh.ConnectivityState=jx={}))});var yi=S(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.uriToString=Mr.splitHostPort=Mr.parseUri=void 0;var W2=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function K2(i){let e=W2.exec(i);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}Mr.parseUri=K2;var Gx=/^\d+$/;function Q2(i){if(i.startsWith("[")){let e=i.indexOf("]");if(e===-1)return null;let t=i.substring(1,e);if(t.indexOf(":")===-1)return null;if(i.length>e+1)if(i[e+1]===":"){let n=i.substring(e+2);return Gx.test(n)?{host:t,port:+n}:null}else return null;else return{host:t}}else{let e=i.split(":");return e.length===2?Gx.test(e[1])?{host:e[0],port:+e[1]}:null:{host:i}}}Mr.splitHostPort=Q2;function Y2(i){let e="";return i.scheme!==void 0&&(e+=i.scheme+":"),i.authority!==void 0&&(e+="//"+i.authority+"/"),e+=i.path,e}Mr.uriToString=Y2});var En=S(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.mapUriDefaultScheme=Ai.getDefaultAuthority=Ai.createResolver=Ai.registerDefaultScheme=Ai.registerResolver=void 0;var Ny=yi(),Zo={},Oy=null;function X2(i,e){Zo[i]=e}Ai.registerResolver=X2;function Z2(i){Oy=i}Ai.registerDefaultScheme=Z2;function J2(i,e,t){if(i.scheme!==void 0&&i.scheme in Zo)return new Zo[i.scheme](i,e,t);throw new Error(`No resolver could be created for target ${(0,Ny.uriToString)(i)}`)}Ai.createResolver=J2;function eB(i){if(i.scheme!==void 0&&i.scheme in Zo)return Zo[i.scheme].getDefaultAuthority(i);throw new Error(`Invalid target ${(0,Ny.uriToString)(i)}`)}Ai.getDefaultAuthority=eB;function tB(i){return i.scheme===void 0||!(i.scheme in Zo)?Oy!==null?{scheme:Oy,authority:void 0,path:(0,Ny.uriToString)(i)}:null:i}Ai.mapUriDefaultScheme=tB});var Nr=S(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.QueuePicker=Or.UnavailablePicker=Or.PickResultType=void 0;var iB=Zt(),nB=he(),ch=function(i){return i[i.COMPLETE=0]="COMPLETE",i[i.QUEUE=1]="QUEUE",i[i.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",i[i.DROP=3]="DROP",i}(ch||(Or.PickResultType=ch={})),Py=class{constructor(e){this.status=Object.assign({code:nB.Status.UNAVAILABLE,details:"No connection established",metadata:new iB.Metadata},e)}pick(e){return{pickResultType:ch.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};Or.UnavailablePicker=Py;var Fy=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:ch.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};Or.QueuePicker=Fy});var hc=S(dh=>{"use strict";Object.defineProperty(dh,"__esModule",{value:!0});dh.BackoffTimeout=void 0;var rB=1e3,sB=1.6,oB=12e4,aB=.2;function lB(i,e){return Math.random()*(e-i)+i}var Ly=class{constructor(e,t){this.callback=e,this.initialDelay=rB,this.multiplier=sB,this.maxDelay=oB,this.jitter=aB,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,n;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(n=(t=this.timerId).unref)===null||n===void 0||n.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+lB(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,(t=(e=this.timerId).ref)===null||t===void 0||t.call(e)}unref(){var e,t;this.hasRef=!1,(t=(e=this.timerId).unref)===null||t===void 0||t.call(e)}getEndTime(){return this.endTime}};dh.BackoffTimeout=Ly});var hh=S(uh=>{"use strict";Object.defineProperty(uh,"__esModule",{value:!0});uh.ChildLoadBalancerHandler=void 0;var cB=Rr(),dB=Di(),uB="child_load_balancer_helper",By=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,n){return this.parent.channelControlHelper.createSubchannel(t,n)}updateState(t,n){var r;if(this.calledByPendingChild()){if(t===dB.ConnectivityState.CONNECTING)return;(r=this.parent.currentChild)===null||r===void 0||r.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,n)}requestReresolution(){var t;let n=(t=this.parent.pendingChild)!==null&&t!==void 0?t:this.parent.currentChild;this.child===n&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,n){let r;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let s=new this.ChildPolicyHelper(this),o=(0,cB.createLoadBalancer)(t,s);s.setChild(o),this.currentChild===null?(this.currentChild=o,r=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,r=this.pendingChild)}else this.pendingChild===null?r=this.currentChild:r=this.pendingChild;this.latestConfig=t,r.updateAddressList(e,t,n)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return uB}};uh.ChildLoadBalancerHandler=By});var Hx=S(fh=>{"use strict";Object.defineProperty(fh,"__esModule",{value:!0});fh.ResolvingLoadBalancer=void 0;var hB=Rr(),fB=My(),ci=Di(),mB=En(),Jo=Nr(),pB=hc(),Vy=he(),gB=Zt(),yB=Ke(),vB=he(),_B=yi(),bB=hh(),wB="resolving_load_balancer";function $x(i){yB.trace(vB.LogVerbosity.DEBUG,wB,i)}var SB=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function EB(i,e,t,n){for(let r of t.name)switch(n){case"EMPTY":if(!r.service&&!r.method)return!0;break;case"SERVICE":if(r.service===i&&!r.method)return!0;break;case"SERVICE_AND_METHOD":if(r.service===i&&r.method===e)return!0}return!1}function CB(i,e,t,n){for(let r of t)if(EB(i,e,r,n))return r;return null}function TB(i){return function(t,n){var r,s;let o=t.split("/").filter(c=>c.length>0),a=(r=o[0])!==null&&r!==void 0?r:"",l=(s=o[1])!==null&&s!==void 0?s:"";if(i&&i.methodConfig)for(let c of SB){let d=CB(a,l,i.methodConfig,c);if(d)return{methodConfig:d,pickInformation:{},status:Vy.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:Vy.Status.OK,dynamicFilterFactories:[]}}}var Uy=class{constructor(e,t,n,r,s){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=r,this.onFailedResolution=s,this.latestChildState=ci.ConnectivityState.IDLE,this.latestChildPicker=new Jo.QueuePicker(this),this.currentState=ci.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,n["grpc.service_config"]?this.defaultServiceConfig=(0,fB.validateServiceConfig)(JSON.parse(n["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(ci.ConnectivityState.IDLE,new Jo.QueuePicker(this)),this.childLoadBalancer=new bB.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?($x("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,l)=>{this.latestChildState=a,this.latestChildPicker=l,this.updateState(a,l)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,mB.createResolver)(e,{onSuccessfulResolution:(a,l,c,d,u)=>{var h;this.backoffTimeout.stop(),this.backoffTimeout.reset();let m=null;l===null?c===null?(this.previousServiceConfig=null,m=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(c):m=this.previousServiceConfig:(m=l,this.previousServiceConfig=l);let g=(h=m?.loadBalancingConfig)!==null&&h!==void 0?h:[],_=(0,hB.getFirstUsableConfig)(g,!0);if(_===null){this.handleResolutionFailure({code:Vy.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new gB.Metadata});return}this.childLoadBalancer.updateAddressList(a,_,u);let y=m??this.defaultServiceConfig;this.onSuccessfulResolution(y,d??TB(y))},onError:a=>{this.handleResolutionFailure(a)}},n);let o={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new pB.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===ci.ConnectivityState.IDLE&&this.updateState(ci.ConnectivityState.CONNECTING,new Jo.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){$x((0,_B.uriToString)(this.target)+" "+ci.ConnectivityState[this.currentState]+" -> "+ci.ConnectivityState[e]),e===ci.ConnectivityState.IDLE&&(t=new Jo.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===ci.ConnectivityState.IDLE&&(this.updateState(ci.ConnectivityState.TRANSIENT_FAILURE,new Jo.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===ci.ConnectivityState.IDLE||this.currentState===ci.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=ci.ConnectivityState.IDLE,this.latestChildPicker=new Jo.QueuePicker(this),this.currentState=ci.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};fh.ResolvingLoadBalancer=Uy});var Wx=S(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.channelOptionsEqual=ea.recognizedOptions=void 0;ea.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function xB(i,e){let t=Object.keys(i).sort(),n=Object.keys(e).sort();if(t.length!==n.length)return!1;for(let r=0;r<t.length;r+=1)if(t[r]!==n[r]||i[t[r]]!==e[n[r]])return!1;return!0}ea.channelOptionsEqual=xB});var Tn=S(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});Cn.stringToSubchannelAddress=Cn.subchannelAddressToString=Cn.subchannelAddressEqual=Cn.isTcpSubchannelAddress=void 0;var IB=ge("net");function fc(i){return"port"in i}Cn.isTcpSubchannelAddress=fc;function DB(i,e){return!i&&!e?!0:!i||!e?!1:fc(i)?fc(e)&&i.host===e.host&&i.port===e.port:!fc(e)&&i.path===e.path}Cn.subchannelAddressEqual=DB;function AB(i){return fc(i)?i.host+":"+i.port:i.path}Cn.subchannelAddressToString=AB;var RB=443;function kB(i,e){return(0,IB.isIP)(i)?{host:i,port:e??RB}:{path:i}}Cn.stringToSubchannelAddress=kB});var mh=S(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.addAdminServicesToServer=ta.registerAdminService=void 0;var Kx=[];function MB(i,e){Kx.push({getServiceDefinition:i,getHandlers:e})}ta.registerAdminService=MB;function OB(i){for(let{getServiceDefinition:e,getHandlers:t}of Kx)i.addService(e(),t())}ta.addAdminServicesToServer=OB});var Qx=S(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.ClientDuplexStreamImpl=Ri.ClientWritableStreamImpl=Ri.ClientReadableStreamImpl=Ri.ClientUnaryCallImpl=Ri.callErrorFromStatus=void 0;var NB=ge("events"),$y=ge("stream"),mc=he();function PB(i,e){let t=`${i.code} ${mc.Status[i.code]}: ${i.details}`,r=`${new Error(t).stack}
for call at
${e}`;return Object.assign(new Error(t),i,{stack:r})}Ri.callErrorFromStatus=PB;var qy=class extends NB.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(mc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}};Ri.ClientUnaryCallImpl=qy;var zy=class extends $y.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(mc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}};Ri.ClientReadableStreamImpl=zy;var jy=class extends $y.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(mc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,n){var r;let s={callback:n},o=Number(t);Number.isNaN(o)||(s.flags=o),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};Ri.ClientWritableStreamImpl=jy;var Gy=class extends $y.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(mc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}_write(e,t,n){var r;let s={callback:n},o=Number(t);Number.isNaN(o)||(s.flags=o),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};Ri.ClientDuplexStreamImpl=Gy});var Yx=S(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.InterceptingListenerImpl=ia.isInterceptingListener=void 0;function FB(i){return i.onReceiveMetadata!==void 0&&i.onReceiveMetadata.length===1}ia.isInterceptingListener=FB;var Hy=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,t=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(t),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,t=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=t,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(t),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,t=>{this.processingMetadata||this.processingMessage?this.pendingStatus=t:this.nextListener.onReceiveStatus(t)})}};ia.InterceptingListenerImpl=Hy});var Jy=S(ki=>{"use strict";Object.defineProperty(ki,"__esModule",{value:!0});ki.getInterceptingCall=ki.InterceptingCall=ki.RequesterBuilder=ki.ListenerBuilder=ki.InterceptorConfigurationError=void 0;var LB=Zt(),Xx=Yx(),Zx=he(),Jx=Ju(),gc=class i extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,i)}};ki.InterceptorConfigurationError=gc;var Ky=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};ki.ListenerBuilder=Ky;var Qy=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};ki.RequesterBuilder=Qy;var Wy={onReceiveMetadata:(i,e)=>{e(i)},onReceiveMessage:(i,e)=>{e(i)},onReceiveStatus:(i,e)=>{e(i)}},pc={start:(i,e,t)=>{t(i,e)},sendMessage:(i,e)=>{e(i)},halfClose:i=>{i()},cancel:i=>{i()}},Yy=class{constructor(e,t){var n,r,s,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:(n=t.start)!==null&&n!==void 0?n:pc.start,sendMessage:(r=t.sendMessage)!==null&&r!==void 0?r:pc.sendMessage,halfClose:(s=t.halfClose)!==null&&s!==void 0?s:pc.halfClose,cancel:(o=t.cancel)!==null&&o!==void 0?o:pc.cancel}:this.requester=pc}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var n,r,s,o,a,l;let c={onReceiveMetadata:(r=(n=t?.onReceiveMetadata)===null||n===void 0?void 0:n.bind(t))!==null&&r!==void 0?r:d=>{},onReceiveMessage:(o=(s=t?.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&o!==void 0?o:d=>{},onReceiveStatus:(l=(a=t?.onReceiveStatus)===null||a===void 0?void 0:a.bind(t))!==null&&l!==void 0?l:d=>{}};this.processingMetadata=!0,this.requester.start(e,c,(d,u)=>{var h,m,g;this.processingMetadata=!1;let _;if((0,Xx.isInterceptingListener)(u))_=u;else{let y={onReceiveMetadata:(h=u.onReceiveMetadata)!==null&&h!==void 0?h:Wy.onReceiveMetadata,onReceiveMessage:(m=u.onReceiveMessage)!==null&&m!==void 0?m:Wy.onReceiveMessage,onReceiveStatus:(g=u.onReceiveStatus)!==null&&g!==void 0?g:Wy.onReceiveStatus};_=new Xx.InterceptingListenerImpl(y,c)}this.nextCall.start(d,_),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,n=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,n),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};ki.InterceptingCall=Yy;function BB(i,e,t){var n,r;let s=(n=t.deadline)!==null&&n!==void 0?n:1/0,o=t.host,a=(r=t.parent)!==null&&r!==void 0?r:null,l=t.propagate_flags,c=t.credentials,d=i.createCall(e,s,o,a,l);return c&&d.setCredentials(c),d}var ph=class{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let n;try{n=this.methodDefinition.requestSerialize(t)}catch(r){this.call.cancelWithStatus(Zx.Status.INTERNAL,`Request message serialization failure: ${(0,Jx.getErrorMessage)(r)}`);return}this.call.sendMessageWithContext(e,n)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let n=null;this.call.start(e,{onReceiveMetadata:r=>{var s;(s=t?.onReceiveMetadata)===null||s===void 0||s.call(t,r)},onReceiveMessage:r=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(r)}catch(a){n={code:Zx.Status.INTERNAL,details:`Response message parsing error: ${(0,Jx.getErrorMessage)(a)}`,metadata:new LB.Metadata},this.call.cancelWithStatus(n.code,n.details);return}(s=t?.onReceiveMessage)===null||s===void 0||s.call(t,o)},onReceiveStatus:r=>{var s,o;n?(s=t?.onReceiveStatus)===null||s===void 0||s.call(t,n):(o=t?.onReceiveStatus)===null||o===void 0||o.call(t,r)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},Xy=class extends ph{constructor(e,t){super(e,t)}start(e,t){var n,r;let s=!1,o={onReceiveMetadata:(r=(n=t?.onReceiveMetadata)===null||n===void 0?void 0:n.bind(t))!==null&&r!==void 0?r:a=>{},onReceiveMessage:a=>{var l;s=!0,(l=t?.onReceiveMessage)===null||l===void 0||l.call(t,a)},onReceiveStatus:a=>{var l,c;s||(l=t?.onReceiveMessage)===null||l===void 0||l.call(t,null),(c=t?.onReceiveStatus)===null||c===void 0||c.call(t,a)}};super.start(e,o),this.call.startRead()}},Zy=class extends ph{};function VB(i,e,t){let n=BB(i,t.path,e);return t.responseStream?new Zy(n,t):new Xy(n,t)}function UB(i,e,t,n){if(i.clientInterceptors.length>0&&i.clientInterceptorProviders.length>0)throw new gc("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(i.callInterceptors.length>0&&i.callInterceptorProviders.length>0)throw new gc("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let r=[];i.callInterceptors.length>0||i.callInterceptorProviders.length>0?r=[].concat(i.callInterceptors,i.callInterceptorProviders.map(a=>a(e))).filter(a=>a):r=[].concat(i.clientInterceptors,i.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let s=Object.assign({},t,{method_definition:e});return r.reduceRight((a,l)=>c=>l(c,a),a=>VB(n,a,e))(s)}ki.getInterceptingCall=UB});var iv=S(yh=>{"use strict";Object.defineProperty(yh,"__esModule",{value:!0});yh.Client=void 0;var xn=Qx(),qB=nv(),zB=Di(),Pr=he(),na=Zt(),gh=Jy(),Ki=Symbol(),ra=Symbol(),sa=Symbol(),tr=Symbol();function ev(i){return typeof i=="function"}function oa(i){return i.stack.split(`
`).slice(1).join(`
`)}var tv=class{constructor(e,t,n={}){var r,s;if(n=Object.assign({},n),this[ra]=(r=n.interceptors)!==null&&r!==void 0?r:[],delete n.interceptors,this[sa]=(s=n.interceptor_providers)!==null&&s!==void 0?s:[],delete n.interceptor_providers,this[ra].length>0&&this[sa].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[tr]=n.callInvocationTransformer,delete n.callInvocationTransformer,n.channelOverride)this[Ki]=n.channelOverride;else if(n.channelFactoryOverride){let o=n.channelFactoryOverride;delete n.channelFactoryOverride,this[Ki]=o(e,t,n)}else this[Ki]=new qB.ChannelImplementation(e,t,n)}close(){this[Ki].close()}getChannel(){return this[Ki]}waitForReady(e,t){let n=r=>{if(r){t(new Error("Failed to connect before the deadline"));return}let s;try{s=this[Ki].getConnectivityState(!0)}catch{t(new Error("The channel has been closed"));return}if(s===zB.ConnectivityState.READY)t();else try{this[Ki].watchConnectivityState(s,e,n)}catch{t(new Error("The channel has been closed"))}};setImmediate(n)}checkOptionalUnaryResponseArguments(e,t,n){if(ev(e))return{metadata:new na.Metadata,options:{},callback:e};if(ev(t))return e instanceof na.Metadata?{metadata:e,options:{},callback:t}:{metadata:new na.Metadata,options:e,callback:t};if(!(e instanceof na.Metadata&&t instanceof Object&&ev(n)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:n}}makeUnaryRequest(e,t,n,r,s,o,a){var l,c;let d=this.checkOptionalUnaryResponseArguments(s,o,a),u={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:n},h={argument:r,metadata:d.metadata,call:new xn.ClientUnaryCallImpl,channel:this[Ki],methodDefinition:u,callOptions:d.options,callback:d.callback};this[tr]&&(h=this[tr](h));let m=h.call,g={clientInterceptors:this[ra],clientInterceptorProviders:this[sa],callInterceptors:(l=h.callOptions.interceptors)!==null&&l!==void 0?l:[],callInterceptorProviders:(c=h.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},_=(0,gh.getInterceptingCall)(g,h.methodDefinition,h.callOptions,h.channel);m.call=_;let y=null,A=!1,w=new Error;return _.start(h.metadata,{onReceiveMetadata:R=>{m.emit("metadata",R)},onReceiveMessage(R){y!==null&&_.cancelWithStatus(Pr.Status.INTERNAL,"Too many responses received"),y=R},onReceiveStatus(R){if(!A){if(A=!0,R.code===Pr.Status.OK)if(y===null){let k=oa(w);h.callback((0,xn.callErrorFromStatus)({code:Pr.Status.INTERNAL,details:"No message received",metadata:R.metadata},k))}else h.callback(null,y);else{let k=oa(w);h.callback((0,xn.callErrorFromStatus)(R,k))}w=null,m.emit("status",R)}}}),_.sendMessage(r),_.halfClose(),m}makeClientStreamRequest(e,t,n,r,s,o){var a,l;let c=this.checkOptionalUnaryResponseArguments(r,s,o),d={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:n},u={metadata:c.metadata,call:new xn.ClientWritableStreamImpl(t),channel:this[Ki],methodDefinition:d,callOptions:c.options,callback:c.callback};this[tr]&&(u=this[tr](u));let h=u.call,m={clientInterceptors:this[ra],clientInterceptorProviders:this[sa],callInterceptors:(a=u.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=u.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},g=(0,gh.getInterceptingCall)(m,u.methodDefinition,u.callOptions,u.channel);h.call=g;let _=null,y=!1,A=new Error;return g.start(u.metadata,{onReceiveMetadata:w=>{h.emit("metadata",w)},onReceiveMessage(w){_!==null&&g.cancelWithStatus(Pr.Status.INTERNAL,"Too many responses received"),_=w},onReceiveStatus(w){if(!y){if(y=!0,w.code===Pr.Status.OK)if(_===null){let R=oa(A);u.callback((0,xn.callErrorFromStatus)({code:Pr.Status.INTERNAL,details:"No message received",metadata:w.metadata},R))}else u.callback(null,_);else{let R=oa(A);u.callback((0,xn.callErrorFromStatus)(w,R))}A=null,h.emit("status",w)}}}),h}checkMetadataAndOptions(e,t){let n,r;return e instanceof na.Metadata?(n=e,t?r=t:r={}):(e?r=e:r={},n=new na.Metadata),{metadata:n,options:r}}makeServerStreamRequest(e,t,n,r,s,o){var a,l;let c=this.checkMetadataAndOptions(s,o),d={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:n},u={argument:r,metadata:c.metadata,call:new xn.ClientReadableStreamImpl(n),channel:this[Ki],methodDefinition:d,callOptions:c.options};this[tr]&&(u=this[tr](u));let h=u.call,m={clientInterceptors:this[ra],clientInterceptorProviders:this[sa],callInterceptors:(a=u.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=u.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},g=(0,gh.getInterceptingCall)(m,u.methodDefinition,u.callOptions,u.channel);h.call=g;let _=!1,y=new Error;return g.start(u.metadata,{onReceiveMetadata(A){h.emit("metadata",A)},onReceiveMessage(A){h.push(A)},onReceiveStatus(A){if(!_){if(_=!0,h.push(null),A.code!==Pr.Status.OK){let w=oa(y);h.emit("error",(0,xn.callErrorFromStatus)(A,w))}y=null,h.emit("status",A)}}}),g.sendMessage(r),g.halfClose(),h}makeBidiStreamRequest(e,t,n,r,s){var o,a;let l=this.checkMetadataAndOptions(r,s),c={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:n},d={metadata:l.metadata,call:new xn.ClientDuplexStreamImpl(t,n),channel:this[Ki],methodDefinition:c,callOptions:l.options};this[tr]&&(d=this[tr](d));let u=d.call,h={clientInterceptors:this[ra],clientInterceptorProviders:this[sa],callInterceptors:(o=d.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=d.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},m=(0,gh.getInterceptingCall)(h,d.methodDefinition,d.callOptions,d.channel);u.call=m;let g=!1,_=new Error;return m.start(d.metadata,{onReceiveMetadata(y){u.emit("metadata",y)},onReceiveMessage(y){u.push(y)},onReceiveStatus(y){if(!g){if(g=!0,u.push(null),y.code!==Pr.Status.OK){let A=oa(_);u.emit("error",(0,xn.callErrorFromStatus)(y,A))}_=null,u.emit("status",y)}}}),u}};yh.Client=tv});var sv=S(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});aa.loadPackageDefinition=aa.makeClientConstructor=void 0;var yc=iv(),jB={unary:yc.Client.prototype.makeUnaryRequest,server_stream:yc.Client.prototype.makeServerStreamRequest,client_stream:yc.Client.prototype.makeClientStreamRequest,bidi:yc.Client.prototype.makeBidiStreamRequest};function rv(i){return["__proto__","prototype","constructor"].includes(i)}function eI(i,e,t){t||(t={});class n extends yc.Client{}return Object.keys(i).forEach(r=>{if(rv(r))return;let s=i[r],o;if(typeof r=="string"&&r.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?o="bidi":o="client_stream":s.responseStream?o="server_stream":o="unary";let a=s.requestSerialize,l=s.responseDeserialize,c=GB(jB[o],s.path,a,l);n.prototype[r]=c,Object.assign(n.prototype[r],s),s.originalName&&!rv(s.originalName)&&(n.prototype[s.originalName]=n.prototype[r])}),n.service=i,n.serviceName=e,n}aa.makeClientConstructor=eI;function GB(i,e,t,n){return function(...r){return i.call(this,e,t,n,...r)}}function $B(i){return"format"in i}function HB(i){let e={};for(let t in i)if(Object.prototype.hasOwnProperty.call(i,t)){let n=i[t],r=t.split(".");if(r.some(a=>rv(a)))continue;let s=r[r.length-1],o=e;for(let a of r.slice(0,-1))o[a]||(o[a]={}),o=o[a];$B(n)?o[s]=n:o[s]=eI(n,s,{})}return e}aa.loadPackageDefinition=HB});var TI=S((HX,CI)=>{"use strict";var WB=1/0,KB="[object Symbol]",QB=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,YB=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_h="\\ud800-\\udfff",lI="\\u0300-\\u036f\\ufe20-\\ufe23",cI="\\u20d0-\\u20f0",dI="\\u2700-\\u27bf",uI="a-z\\xdf-\\xf6\\xf8-\\xff",XB="\\xac\\xb1\\xd7\\xf7",ZB="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",JB="\\u2000-\\u206f",eV=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",hI="A-Z\\xc0-\\xd6\\xd8-\\xde",fI="\\ufe0e\\ufe0f",mI=XB+ZB+JB+eV,av="['\u2019]",tV="["+_h+"]",tI="["+mI+"]",vh="["+lI+cI+"]",pI="\\d+",iV="["+dI+"]",gI="["+uI+"]",yI="[^"+_h+mI+pI+dI+uI+hI+"]",ov="\\ud83c[\\udffb-\\udfff]",nV="(?:"+vh+"|"+ov+")",vI="[^"+_h+"]",lv="(?:\\ud83c[\\udde6-\\uddff]){2}",cv="[\\ud800-\\udbff][\\udc00-\\udfff]",la="["+hI+"]",_I="\\u200d",iI="(?:"+gI+"|"+yI+")",rV="(?:"+la+"|"+yI+")",nI="(?:"+av+"(?:d|ll|m|re|s|t|ve))?",rI="(?:"+av+"(?:D|LL|M|RE|S|T|VE))?",bI=nV+"?",wI="["+fI+"]?",sV="(?:"+_I+"(?:"+[vI,lv,cv].join("|")+")"+wI+bI+")*",SI=wI+bI+sV,oV="(?:"+[iV,lv,cv].join("|")+")"+SI,aV="(?:"+[vI+vh+"?",vh,lv,cv,tV].join("|")+")",lV=RegExp(av,"g"),cV=RegExp(vh,"g"),dV=RegExp(ov+"(?="+ov+")|"+aV+SI,"g"),uV=RegExp([la+"?"+gI+"+"+nI+"(?="+[tI,la,"$"].join("|")+")",rV+"+"+rI+"(?="+[tI,la+iI,"$"].join("|")+")",la+"?"+iI+"+"+nI,la+"+"+rI,pI,oV].join("|"),"g"),hV=RegExp("["+_I+_h+lI+cI+fI+"]"),fV=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mV={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},pV=typeof global=="object"&&global&&global.Object===Object&&global,gV=typeof self=="object"&&self&&self.Object===Object&&self,yV=pV||gV||Function("return this")();function vV(i,e,t,n){var r=-1,s=i?i.length:0;for(n&&s&&(t=i[++r]);++r<s;)t=e(t,i[r],r,i);return t}function _V(i){return i.split("")}function bV(i){return i.match(QB)||[]}function wV(i){return function(e){return i?.[e]}}var SV=wV(mV);function EI(i){return hV.test(i)}function EV(i){return fV.test(i)}function CV(i){return EI(i)?TV(i):_V(i)}function TV(i){return i.match(dV)||[]}function xV(i){return i.match(uV)||[]}var IV=Object.prototype,DV=IV.toString,sI=yV.Symbol,oI=sI?sI.prototype:void 0,aI=oI?oI.toString:void 0;function AV(i,e,t){var n=-1,r=i.length;e<0&&(e=-e>r?0:r+e),t=t>r?r:t,t<0&&(t+=r),r=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(r);++n<r;)s[n]=i[n+e];return s}function RV(i){if(typeof i=="string")return i;if(PV(i))return aI?aI.call(i):"";var e=i+"";return e=="0"&&1/i==-WB?"-0":e}function kV(i,e,t){var n=i.length;return t=t===void 0?n:t,!e&&t>=n?i:AV(i,e,t)}function MV(i){return function(e){e=bh(e);var t=EI(e)?CV(e):void 0,n=t?t[0]:e.charAt(0),r=t?kV(t,1).join(""):e.slice(1);return n[i]()+r}}function OV(i){return function(e){return vV(UV(BV(e).replace(lV,"")),i,"")}}function NV(i){return!!i&&typeof i=="object"}function PV(i){return typeof i=="symbol"||NV(i)&&DV.call(i)==KB}function bh(i){return i==null?"":RV(i)}var FV=OV(function(i,e,t){return e=e.toLowerCase(),i+(t?LV(e):e)});function LV(i){return VV(bh(i).toLowerCase())}function BV(i){return i=bh(i),i&&i.replace(YB,SV).replace(cV,"")}var VV=MV("toUpperCase");function UV(i,e,t){return i=bh(i),e=t?void 0:e,e===void 0?EV(i)?xV(i):bV(i):i.match(e)||[]}CI.exports=FV});var dv=S((WX,xI)=>{"use strict";xI.exports=qV;function qV(i,e){for(var t=new Array(arguments.length-1),n=0,r=2,s=!0;r<arguments.length;)t[n++]=arguments[r++];return new Promise(function(a,l){t[n]=function(d){if(s)if(s=!1,d)l(d);else{for(var u=new Array(arguments.length-1),h=0;h<u.length;)u[h++]=arguments[h];a.apply(null,u)}};try{i.apply(e||null,t)}catch(c){s&&(s=!1,l(c))}})}});var RI=S(AI=>{"use strict";var wh=AI;wh.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&e.charAt(t)==="=";)++n;return Math.ceil(e.length*3)/4-n};var ca=new Array(64),DI=new Array(123);for(Qi=0;Qi<64;)DI[ca[Qi]=Qi<26?Qi+65:Qi<52?Qi+71:Qi<62?Qi-4:Qi-59|43]=Qi++;var Qi;wh.encode=function(e,t,n){for(var r=null,s=[],o=0,a=0,l;t<n;){var c=e[t++];switch(a){case 0:s[o++]=ca[c>>2],l=(c&3)<<4,a=1;break;case 1:s[o++]=ca[l|c>>4],l=(c&15)<<2,a=2;break;case 2:s[o++]=ca[l|c>>6],s[o++]=ca[c&63],a=0;break}o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=ca[l],s[o++]=61,a===1&&(s[o++]=61)),r?(o&&r.push(String.fromCharCode.apply(String,s.slice(0,o))),r.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var II="invalid encoding";wh.decode=function(e,t,n){for(var r=n,s=0,o,a=0;a<e.length;){var l=e.charCodeAt(a++);if(l===61&&s>1)break;if((l=DI[l])===void 0)throw Error(II);switch(s){case 0:o=l,s=1;break;case 1:t[n++]=o<<2|(l&48)>>4,o=l,s=2;break;case 2:t[n++]=(o&15)<<4|(l&60)>>2,o=l,s=3;break;case 3:t[n++]=(o&3)<<6|l,s=0;break}}if(s===1)throw Error(II);return n-r};wh.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var MI=S((QX,kI)=>{"use strict";kI.exports=Sh;function Sh(){this._listeners={}}Sh.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this};Sh.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this};Sh.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}});var VI=S((YX,BI)=>{"use strict";BI.exports=OI(OI);function OI(i){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),n=t[3]===128;function r(l,c,d){e[0]=l,c[d]=t[0],c[d+1]=t[1],c[d+2]=t[2],c[d+3]=t[3]}function s(l,c,d){e[0]=l,c[d]=t[3],c[d+1]=t[2],c[d+2]=t[1],c[d+3]=t[0]}i.writeFloatLE=n?r:s,i.writeFloatBE=n?s:r;function o(l,c){return t[0]=l[c],t[1]=l[c+1],t[2]=l[c+2],t[3]=l[c+3],e[0]}function a(l,c){return t[3]=l[c],t[2]=l[c+1],t[1]=l[c+2],t[0]=l[c+3],e[0]}i.readFloatLE=n?o:a,i.readFloatBE=n?a:o}():function(){function e(n,r,s,o){var a=r<0?1:0;if(a&&(r=-r),r===0)n(1/r>0?0:2147483648,s,o);else if(isNaN(r))n(2143289344,s,o);else if(r>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(r<11754943508222875e-54)n((a<<31|Math.round(r/1401298464324817e-60))>>>0,s,o);else{var l=Math.floor(Math.log(r)/Math.LN2),c=Math.round(r*Math.pow(2,-l)*8388608)&8388607;n((a<<31|l+127<<23|c)>>>0,s,o)}}i.writeFloatLE=e.bind(null,NI),i.writeFloatBE=e.bind(null,PI);function t(n,r,s){var o=n(r,s),a=(o>>31)*2+1,l=o>>>23&255,c=o&8388607;return l===255?c?NaN:a*(1/0):l===0?a*1401298464324817e-60*c:a*Math.pow(2,l-150)*(c+8388608)}i.readFloatLE=t.bind(null,FI),i.readFloatBE=t.bind(null,LI)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),n=t[7]===128;function r(l,c,d){e[0]=l,c[d]=t[0],c[d+1]=t[1],c[d+2]=t[2],c[d+3]=t[3],c[d+4]=t[4],c[d+5]=t[5],c[d+6]=t[6],c[d+7]=t[7]}function s(l,c,d){e[0]=l,c[d]=t[7],c[d+1]=t[6],c[d+2]=t[5],c[d+3]=t[4],c[d+4]=t[3],c[d+5]=t[2],c[d+6]=t[1],c[d+7]=t[0]}i.writeDoubleLE=n?r:s,i.writeDoubleBE=n?s:r;function o(l,c){return t[0]=l[c],t[1]=l[c+1],t[2]=l[c+2],t[3]=l[c+3],t[4]=l[c+4],t[5]=l[c+5],t[6]=l[c+6],t[7]=l[c+7],e[0]}function a(l,c){return t[7]=l[c],t[6]=l[c+1],t[5]=l[c+2],t[4]=l[c+3],t[3]=l[c+4],t[2]=l[c+5],t[1]=l[c+6],t[0]=l[c+7],e[0]}i.readDoubleLE=n?o:a,i.readDoubleBE=n?a:o}():function(){function e(n,r,s,o,a,l){var c=o<0?1:0;if(c&&(o=-o),o===0)n(0,a,l+r),n(1/o>0?0:2147483648,a,l+s);else if(isNaN(o))n(0,a,l+r),n(2146959360,a,l+s);else if(o>17976931348623157e292)n(0,a,l+r),n((c<<31|2146435072)>>>0,a,l+s);else{var d;if(o<22250738585072014e-324)d=o/5e-324,n(d>>>0,a,l+r),n((c<<31|d/4294967296)>>>0,a,l+s);else{var u=Math.floor(Math.log(o)/Math.LN2);u===1024&&(u=1023),d=o*Math.pow(2,-u),n(d*4503599627370496>>>0,a,l+r),n((c<<31|u+1023<<20|d*1048576&1048575)>>>0,a,l+s)}}}i.writeDoubleLE=e.bind(null,NI,0,4),i.writeDoubleBE=e.bind(null,PI,4,0);function t(n,r,s,o,a){var l=n(o,a+r),c=n(o,a+s),d=(c>>31)*2+1,u=c>>>20&2047,h=4294967296*(c&1048575)+l;return u===2047?h?NaN:d*(1/0):u===0?d*5e-324*h:d*Math.pow(2,u-1075)*(h+4503599627370496)}i.readDoubleLE=t.bind(null,FI,0,4),i.readDoubleBE=t.bind(null,LI,4,0)}(),i}function NI(i,e,t){e[t]=i&255,e[t+1]=i>>>8&255,e[t+2]=i>>>16&255,e[t+3]=i>>>24}function PI(i,e,t){e[t]=i>>>24,e[t+1]=i>>>16&255,e[t+2]=i>>>8&255,e[t+3]=i&255}function FI(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16|i[e+3]<<24)>>>0}function LI(i,e){return(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}});var uv=S((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(i){}return null}});var qI=S(UI=>{"use strict";var hv=UI;hv.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)n=e.charCodeAt(r),n<128?t+=1:n<2048?t+=2:(n&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320?(++r,t+=4):t+=3;return t};hv.read=function(e,t,n){var r=n-t;if(r<1)return"";for(var s=null,o=[],a=0,l;t<n;)l=e[t++],l<128?o[a++]=l:l>191&&l<224?o[a++]=(l&31)<<6|e[t++]&63:l>239&&l<365?(l=((l&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(l>>10),o[a++]=56320+(l&1023)):o[a++]=(l&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};hv.write=function(e,t,n){for(var r=n,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128);return n-r}});var jI=S((ZX,zI)=>{"use strict";zI.exports=zV;function zV(i,e,t){var n=t||8192,r=n>>>1,s=null,o=n;return function(l){if(l<1||l>r)return i(l);o+l>n&&(s=i(n),o=0);var c=e.call(s,o,o+=l);return o&7&&(o=(o|7)+1),c}}});var $I=S((JX,GI)=>{"use strict";GI.exports=bt;var vc=In();function bt(i,e){this.lo=i>>>0,this.hi=e>>>0}var js=bt.zero=new bt(0,0);js.toNumber=function(){return 0};js.zzEncode=js.zzDecode=function(){return this};js.length=function(){return 1};var jV=bt.zeroHash="\0\0\0\0\0\0\0\0";bt.fromNumber=function(e){if(e===0)return js;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new bt(n,r)};bt.from=function(e){if(typeof e=="number")return bt.fromNumber(e);if(vc.isString(e))if(vc.Long)e=vc.Long.fromString(e);else return bt.fromNumber(parseInt(e,10));return e.low||e.high?new bt(e.low>>>0,e.high>>>0):js};bt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+n*4294967296)}return this.lo+this.hi*4294967296};bt.prototype.toLong=function(e){return vc.Long?new vc.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Fr=String.prototype.charCodeAt;bt.fromHash=function(e){return e===jV?js:new bt((Fr.call(e,0)|Fr.call(e,1)<<8|Fr.call(e,2)<<16|Fr.call(e,3)<<24)>>>0,(Fr.call(e,4)|Fr.call(e,5)<<8|Fr.call(e,6)<<16|Fr.call(e,7)<<24)>>>0)};bt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};bt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};bt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};bt.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}});var In=S(fv=>{"use strict";var j=fv;j.asPromise=dv();j.base64=RI();j.EventEmitter=MI();j.float=VI();j.inquire=uv();j.utf8=qI();j.pool=jI();j.LongBits=$I();j.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);j.global=j.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||fv;j.emptyArray=Object.freeze?Object.freeze([]):[];j.emptyObject=Object.freeze?Object.freeze({}):{};j.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};j.isString=function(e){return typeof e=="string"||e instanceof String};j.isObject=function(e){return e&&typeof e=="object"};j.isset=j.isSet=function(e,t){var n=e[t];return n!=null&&e.hasOwnProperty(t)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};j.Buffer=function(){try{var i=j.inquire("buffer").Buffer;return i.prototype.utf8Write?i:null}catch{return null}}();j._Buffer_from=null;j._Buffer_allocUnsafe=null;j.newBuffer=function(e){return typeof e=="number"?j.Buffer?j._Buffer_allocUnsafe(e):new j.Array(e):j.Buffer?j._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};j.Array=typeof Uint8Array<"u"?Uint8Array:Array;j.Long=j.global.dcodeIO&&j.global.dcodeIO.Long||j.global.Long||j.inquire("long");j.key2Re=/^true|false|0|1$/;j.key32Re=/^-?(?:0|[1-9][0-9]*)$/;j.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;j.longToHash=function(e){return e?j.LongBits.from(e).toHash():j.LongBits.zeroHash};j.longFromHash=function(e,t){var n=j.LongBits.fromHash(e);return j.Long?j.Long.fromBits(n.lo,n.hi,t):n.toNumber(!!t)};function HI(i,e,t){for(var n=Object.keys(e),r=0;r<n.length;++r)(i[n[r]]===void 0||!t)&&(i[n[r]]=e[n[r]]);return i}j.merge=HI;j.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function WI(i){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&HI(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return i},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}j.newError=WI;j.ProtocolError=WI("ProtocolError");j.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var r=Object.keys(this),s=r.length-1;s>-1;--s)if(t[r[s]]===1&&this[r[s]]!==void 0&&this[r[s]]!==null)return r[s]}};j.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}};j.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};j._configure=function(){var i=j.Buffer;if(!i){j._Buffer_from=j._Buffer_allocUnsafe=null;return}j._Buffer_from=i.from!==Uint8Array.from&&i.from||function(t,n){return new i(t,n)},j._Buffer_allocUnsafe=i.allocUnsafe||function(t){return new i(t)}}});var Ch=S((tZ,XI)=>{"use strict";XI.exports=de;var Mi=In(),mv,Eh=Mi.LongBits,KI=Mi.base64,QI=Mi.utf8;function _c(i,e,t){this.fn=i,this.len=e,this.next=void 0,this.val=t}function gv(){}function GV(i){this.head=i.head,this.tail=i.tail,this.len=i.len,this.next=i.states}function de(){this.len=0,this.head=new _c(gv,0,0),this.tail=this.head,this.states=null}var YI=function(){return Mi.Buffer?function(){return(de.create=function(){return new mv})()}:function(){return new de}};de.create=YI();de.alloc=function(e){return new Mi.Array(e)};Mi.Array!==Array&&(de.alloc=Mi.pool(de.alloc,Mi.Array.prototype.subarray));de.prototype._push=function(e,t,n){return this.tail=this.tail.next=new _c(e,t,n),this.len+=t,this};function yv(i,e,t){e[t]=i&255}function $V(i,e,t){for(;i>127;)e[t++]=i&127|128,i>>>=7;e[t]=i}function vv(i,e){this.len=i,this.next=void 0,this.val=e}vv.prototype=Object.create(_c.prototype);vv.prototype.fn=$V;de.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new vv((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};de.prototype.int32=function(e){return e<0?this._push(_v,10,Eh.fromNumber(e)):this.uint32(e)};de.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function _v(i,e,t){for(;i.hi;)e[t++]=i.lo&127|128,i.lo=(i.lo>>>7|i.hi<<25)>>>0,i.hi>>>=7;for(;i.lo>127;)e[t++]=i.lo&127|128,i.lo=i.lo>>>7;e[t++]=i.lo}de.prototype.uint64=function(e){var t=Eh.from(e);return this._push(_v,t.length(),t)};de.prototype.int64=de.prototype.uint64;de.prototype.sint64=function(e){var t=Eh.from(e).zzEncode();return this._push(_v,t.length(),t)};de.prototype.bool=function(e){return this._push(yv,1,e?1:0)};function pv(i,e,t){e[t]=i&255,e[t+1]=i>>>8&255,e[t+2]=i>>>16&255,e[t+3]=i>>>24}de.prototype.fixed32=function(e){return this._push(pv,4,e>>>0)};de.prototype.sfixed32=de.prototype.fixed32;de.prototype.fixed64=function(e){var t=Eh.from(e);return this._push(pv,4,t.lo)._push(pv,4,t.hi)};de.prototype.sfixed64=de.prototype.fixed64;de.prototype.float=function(e){return this._push(Mi.float.writeFloatLE,4,e)};de.prototype.double=function(e){return this._push(Mi.float.writeDoubleLE,8,e)};var HV=Mi.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};de.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(yv,1,0);if(Mi.isString(e)){var n=de.alloc(t=KI.length(e));KI.decode(e,n,0),e=n}return this.uint32(t)._push(HV,t,e)};de.prototype.string=function(e){var t=QI.length(e);return t?this.uint32(t)._push(QI.write,t,e):this._push(yv,1,0)};de.prototype.fork=function(){return this.states=new GV(this),this.head=this.tail=new _c(gv,0,0),this.len=0,this};de.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new _c(gv,0,0),this.len=0),this};de.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this};de.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t};de._configure=function(i){mv=i,de.create=YI(),mv._configure()}});var eD=S((iZ,JI)=>{"use strict";JI.exports=Dn;var ZI=Ch();(Dn.prototype=Object.create(ZI.prototype)).constructor=Dn;var Lr=In();function Dn(){ZI.call(this)}Dn._configure=function(){Dn.alloc=Lr._Buffer_allocUnsafe,Dn.writeBytesBuffer=Lr.Buffer&&Lr.Buffer.prototype instanceof Uint8Array&&Lr.Buffer.prototype.set.name==="set"?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}};Dn.prototype.bytes=function(e){Lr.isString(e)&&(e=Lr._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Dn.writeBytesBuffer,t,e),this};function WV(i,e,t){i.length<40?Lr.utf8.write(i,e,t):e.utf8Write?e.utf8Write(i,t):e.write(i,t)}Dn.prototype.string=function(e){var t=Lr.Buffer.byteLength(e);return this.uint32(t),t&&this._push(WV,t,e),this};Dn._configure()});var xh=S((nZ,sD)=>{"use strict";sD.exports=Je;var Yi=In(),wv,nD=Yi.LongBits,KV=Yi.utf8;function Xi(i,e){return RangeError("index out of range: "+i.pos+" + "+(e||1)+" > "+i.len)}function Je(i){this.buf=i,this.pos=0,this.len=i.length}var tD=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Je(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Je(e);throw Error("illegal buffer")},rD=function(){return Yi.Buffer?function(t){return(Je.create=function(r){return Yi.Buffer.isBuffer(r)?new wv(r):tD(r)})(t)}:tD};Je.create=rD();Je.prototype._slice=Yi.Array.prototype.subarray||Yi.Array.prototype.slice;Je.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Xi(this,10);return e}}();Je.prototype.int32=function(){return this.uint32()|0};Je.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function bv(){var i=new nD(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(i.lo=(i.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return i;if(i.lo=(i.lo|(this.buf[this.pos]&127)<<28)>>>0,i.hi=(i.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return i;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Xi(this);if(i.lo=(i.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return i}return i.lo=(i.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,i}if(this.len-this.pos>4){for(;e<5;++e)if(i.hi=(i.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return i}else for(;e<5;++e){if(this.pos>=this.len)throw Xi(this);if(i.hi=(i.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return i}throw Error("invalid varint encoding")}Je.prototype.bool=function(){return this.uint32()!==0};function Th(i,e){return(i[e-4]|i[e-3]<<8|i[e-2]<<16|i[e-1]<<24)>>>0}Je.prototype.fixed32=function(){if(this.pos+4>this.len)throw Xi(this,4);return Th(this.buf,this.pos+=4)};Je.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Xi(this,4);return Th(this.buf,this.pos+=4)|0};function iD(){if(this.pos+8>this.len)throw Xi(this,8);return new nD(Th(this.buf,this.pos+=4),Th(this.buf,this.pos+=4))}Je.prototype.float=function(){if(this.pos+4>this.len)throw Xi(this,4);var e=Yi.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Je.prototype.double=function(){if(this.pos+8>this.len)throw Xi(this,4);var e=Yi.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Je.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw Xi(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var r=Yi.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)};Je.prototype.string=function(){var e=this.bytes();return KV.read(e,0,e.length)};Je.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Xi(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Xi(this);while(this.buf[this.pos++]&128);return this};Je.prototype.skipType=function(i){switch(i){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(i=this.uint32()&7)!==4;)this.skipType(i);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+i+" at offset "+this.pos)}return this};Je._configure=function(i){wv=i,Je.create=rD(),wv._configure();var e=Yi.Long?"toLong":"toNumber";Yi.merge(Je.prototype,{int64:function(){return bv.call(this)[e](!1)},uint64:function(){return bv.call(this)[e](!0)},sint64:function(){return bv.call(this).zzDecode()[e](!1)},fixed64:function(){return iD.call(this)[e](!0)},sfixed64:function(){return iD.call(this)[e](!1)}})}});var cD=S((rZ,lD)=>{"use strict";lD.exports=Gs;var aD=xh();(Gs.prototype=Object.create(aD.prototype)).constructor=Gs;var oD=In();function Gs(i){aD.call(this,i)}Gs._configure=function(){oD.Buffer&&(Gs.prototype._slice=oD.Buffer.prototype.slice)};Gs.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Gs._configure()});var uD=S((sZ,dD)=>{"use strict";dD.exports=bc;var Sv=In();(bc.prototype=Object.create(Sv.EventEmitter.prototype)).constructor=bc;function bc(i,e,t){if(typeof i!="function")throw TypeError("rpcImpl must be a function");Sv.EventEmitter.call(this),this.rpcImpl=i,this.requestDelimited=!!e,this.responseDelimited=!!t}bc.prototype.rpcCall=function i(e,t,n,r,s){if(!r)throw TypeError("request must be specified");var o=this;if(!s)return Sv.asPromise(i,o,e,t,n,r);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(l,c){if(l)return o.emit("error",l,e),s(l);if(c===null){o.end(!0);return}if(!(c instanceof n))try{c=n[o.responseDelimited?"decodeDelimited":"decode"](c)}catch(d){return o.emit("error",d,e),s(d)}return o.emit("data",c,e),s(null,c)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};bc.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Ev=S(hD=>{"use strict";var QV=hD;QV.Service=uD()});var Cv=S((aZ,fD)=>{"use strict";fD.exports={}});var gD=S(pD=>{"use strict";var di=pD;di.build="minimal";di.Writer=Ch();di.BufferWriter=eD();di.Reader=xh();di.BufferReader=cD();di.util=In();di.rpc=Ev();di.roots=Cv();di.configure=mD;function mD(){di.util._configure(),di.Writer._configure(di.BufferWriter),di.Reader._configure(di.BufferReader)}mD()});var vD=S((cZ,yD)=>{"use strict";yD.exports=Tv;function Tv(i,e){typeof i=="string"&&(e=i,i=void 0);var t=[];function n(s){if(typeof s!="string"){var o=r();if(Tv.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),l=new Array(a.length+1),c=new Array(a.length),d=0;d<a.length;)l[d]=a[d],c[d]=s[a[d++]];return l[d]=o,Function.apply(null,l).apply(null,c)}return Function(o)()}for(var u=new Array(arguments.length-1),h=0;h<u.length;)u[h]=arguments[++h];if(h=0,s=s.replace(/%([%dfijs])/g,function(g,_){var y=u[h++];switch(_){case"d":case"f":return String(Number(y));case"i":return String(Math.floor(y));case"j":return JSON.stringify(y);case"s":return String(y)}return"%"}),h!==u.length)throw Error("parameter count mismatch");return t.push(s),n}function r(s){return"function "+(s||e||"")+"("+(i&&i.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return n.toString=r,n}Tv.verbose=!1});var bD=S((dZ,_D)=>{"use strict";_D.exports=wc;var YV=dv(),XV=uv(),xv=XV("fs");function wc(i,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&xv&&xv.readFile?xv.readFile(i,function(r,s){return r&&typeof XMLHttpRequest<"u"?wc.xhr(i,e,t):r?t(r):t(null,e.binary?s:s.toString("utf8"))}):wc.xhr(i,e,t):YV(wc,this,i,e)}wc.xhr=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==0&&r.status!==200)return n(Error("status "+r.status));if(t.binary){var o=r.response;if(!o){o=[];for(var a=0;a<r.responseText.length;++a)o.push(r.responseText.charCodeAt(a)&255)}return n(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return n(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}});var ED=S(SD=>{"use strict";var Dv=SD,wD=Dv.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},Iv=Dv.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),n=wD(e),r="";n&&(r=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):n?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return r+t.join("/")};Dv.resolve=function(e,t,n){return n||(t=Iv(t)),wD(t)?t:(n||(e=Iv(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?Iv(e+"/"+t):t)}});var $s=S(CD=>{"use strict";var Sc=CD,ZV=wt(),JV=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Ec(i,e){var t=0,n={};for(e|=0;t<i.length;)n[JV[t+e]]=i[t++];return n}Sc.basic=Ec([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Sc.defaults=Ec([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",ZV.emptyArray,null]);Sc.long=Ec([0,0,0,1,1],7);Sc.mapKey=Ec([0,0,0,5,5,0,0,0,1,1,0,2],2);Sc.packed=Ec([1,5,0,0,0,5,5,0,0,0,1,1,0])});var Br=S((fZ,ID)=>{"use strict";ID.exports=Oi;var Ih=Hs();((Oi.prototype=Object.create(Ih.prototype)).constructor=Oi).className="Field";var TD=Zi(),xD=$s(),ct=wt(),Av,eU=/^required|optional|repeated$/;Oi.fromJSON=function(e,t){return new Oi(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function Oi(i,e,t,n,r,s,o){if(ct.isObject(n)?(o=r,s=n,n=r=void 0):ct.isObject(r)&&(o=s,s=r,r=void 0),Ih.call(this,i,s),!ct.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!ct.isString(t))throw TypeError("type must be a string");if(n!==void 0&&!eU.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(r!==void 0&&!ct.isString(r))throw TypeError("extend must be a string");n==="proto3_optional"&&(n="optional"),this.rule=n&&n!=="optional"?n:void 0,this.type=t,this.id=e,this.extend=r||void 0,this.required=n==="required",this.optional=!this.required,this.repeated=n==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=ct.Long?xD.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(Oi.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});Oi.prototype.setOption=function(e,t,n){return e==="packed"&&(this._packed=null),Ih.prototype.setOption.call(this,e,t,n)};Oi.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return ct.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Oi.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=xD.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Av?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof TD&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof TD))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=ct.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;ct.base64.test(this.typeDefault)?ct.base64.decode(this.typeDefault,e=ct.newBuffer(ct.base64.length(this.typeDefault)),0):ct.utf8.write(this.typeDefault,e=ct.newBuffer(ct.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=ct.emptyObject:this.repeated?this.defaultValue=ct.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Av&&(this.parent.ctor.prototype[this.name]=this.defaultValue),Ih.prototype.resolve.call(this)};Oi.d=function(e,t,n,r){return typeof t=="function"?t=ct.decorateType(t).name:t&&typeof t=="object"&&(t=ct.decorateEnum(t).name),function(o,a){ct.decorateType(o.constructor).add(new Oi(a,e,t,n,{default:r}))}};Oi._configure=function(e){Av=e}});var da=S((mZ,RD)=>{"use strict";RD.exports=Ni;var Ah=Hs();((Ni.prototype=Object.create(Ah.prototype)).constructor=Ni).className="OneOf";var DD=Br(),Dh=wt();function Ni(i,e,t,n){if(Array.isArray(e)||(t=e,e=void 0),Ah.call(this,i,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=n}Ni.fromJSON=function(e,t){return new Ni(e,t.oneof,t.options,t.comment)};Ni.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Dh.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function AD(i){if(i.parent)for(var e=0;e<i.fieldsArray.length;++e)i.fieldsArray[e].parent||i.parent.add(i.fieldsArray[e])}Ni.prototype.add=function(e){if(!(e instanceof DD))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,AD(this),this};Ni.prototype.remove=function(e){if(!(e instanceof DD))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};Ni.prototype.onAdd=function(e){Ah.prototype.onAdd.call(this,e);for(var t=this,n=0;n<this.oneof.length;++n){var r=e.get(this.oneof[n]);r&&!r.partOf&&(r.partOf=t,t.fieldsArray.push(r))}AD(this)};Ni.prototype.onRemove=function(e){for(var t=0,n;t<this.fieldsArray.length;++t)(n=this.fieldsArray[t]).parent&&n.parent.remove(n);Ah.prototype.onRemove.call(this,e)};Ni.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(r,s){Dh.decorateType(r.constructor).add(new Ni(s,e)),Object.defineProperty(r,s,{get:Dh.oneOfGetter(e),set:Dh.oneOfSetter(e)})}}});var fa=S((pZ,ND)=>{"use strict";ND.exports=fe;var Rv=Hs();((fe.prototype=Object.create(Rv.prototype)).constructor=fe).className="Namespace";var kD=Br(),Rh=wt(),tU=da(),ua,Cc,ha;fe.fromJSON=function(e,t){return new fe(e,t.options).addJSON(t.nested)};function MD(i,e){if(i&&i.length){for(var t={},n=0;n<i.length;++n)t[i[n].name]=i[n].toJSON(e);return t}}fe.arrayToJSON=MD;fe.isReservedId=function(e,t){if(e){for(var n=0;n<e.length;++n)if(typeof e[n]!="string"&&e[n][0]<=t&&e[n][1]>t)return!0}return!1};fe.isReservedName=function(e,t){if(e){for(var n=0;n<e.length;++n)if(e[n]===t)return!0}return!1};function fe(i,e){Rv.call(this,i,e),this.nested=void 0,this._nestedArray=null}function OD(i){return i._nestedArray=null,i}Object.defineProperty(fe.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Rh.toArray(this.nested))}});fe.prototype.toJSON=function(e){return Rh.toObject(["options",this.options,"nested",MD(this.nestedArray,e)])};fe.prototype.addJSON=function(e){var t=this;if(e)for(var n=Object.keys(e),r=0,s;r<n.length;++r)s=e[n[r]],t.add((s.fields!==void 0?ua.fromJSON:s.values!==void 0?ha.fromJSON:s.methods!==void 0?Cc.fromJSON:s.id!==void 0?kD.fromJSON:fe.fromJSON)(n[r],s));return this};fe.prototype.get=function(e){return this.nested&&this.nested[e]||null};fe.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof ha)return this.nested[e].values;throw Error("no such enum: "+e)};fe.prototype.add=function(e){if(!(e instanceof kD&&e.extend!==void 0||e instanceof ua||e instanceof tU||e instanceof ha||e instanceof Cc||e instanceof fe))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof fe&&e instanceof fe&&!(t instanceof ua||t instanceof Cc)){for(var n=t.nestedArray,r=0;r<n.length;++r)e.add(n[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),OD(this)};fe.prototype.remove=function(e){if(!(e instanceof Rv))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),OD(this)};fe.prototype.define=function(e,t){if(Rh.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var n=this;e.length>0;){var r=e.shift();if(n.nested&&n.nested[r]){if(n=n.nested[r],!(n instanceof fe))throw Error("path conflicts with non-namespace objects")}else n.add(n=new fe(r))}return t&&n.addJSON(t),n};fe.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof fe?e[t++].resolveAll():e[t++].resolve();return this.resolve()};fe.prototype.lookup=function(e,t,n){if(typeof t=="boolean"?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),Rh.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(e.length===1){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof fe&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof fe&&(r=this._nestedArray[s].lookup(e,t,!0)))return r;return this.parent===null||n?null:this.parent.lookup(e,t)};fe.prototype.lookupType=function(e){var t=this.lookup(e,[ua]);if(!t)throw Error("no such type: "+e);return t};fe.prototype.lookupEnum=function(e){var t=this.lookup(e,[ha]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};fe.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[ua,ha]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};fe.prototype.lookupService=function(e){var t=this.lookup(e,[Cc]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};fe._configure=function(i,e,t){ua=i,Cc=e,ha=t}});var kh=S((gZ,PD)=>{"use strict";PD.exports=ir;var kv=Br();((ir.prototype=Object.create(kv.prototype)).constructor=ir).className="MapField";var iU=$s(),Tc=wt();function ir(i,e,t,n,r,s){if(kv.call(this,i,e,n,void 0,void 0,r,s),!Tc.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}ir.fromJSON=function(e,t){return new ir(e,t.id,t.keyType,t.type,t.options,t.comment)};ir.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Tc.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};ir.prototype.resolve=function(){if(this.resolved)return this;if(iU.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return kv.prototype.resolve.call(this)};ir.d=function(e,t,n){return typeof n=="function"?n=Tc.decorateType(n).name:n&&typeof n=="object"&&(n=Tc.decorateEnum(n).name),function(s,o){Tc.decorateType(s.constructor).add(new ir(o,e,t,n))}}});var Mh=S((yZ,FD)=>{"use strict";FD.exports=Ws;var Mv=Hs();((Ws.prototype=Object.create(Mv.prototype)).constructor=Ws).className="Method";var ma=wt();function Ws(i,e,t,n,r,s,o,a,l){if(ma.isObject(r)?(o=r,r=s=void 0):ma.isObject(s)&&(o=s,s=void 0),!(e===void 0||ma.isString(e)))throw TypeError("type must be a string");if(!ma.isString(t))throw TypeError("requestType must be a string");if(!ma.isString(n))throw TypeError("responseType must be a string");Mv.call(this,i,o),this.type=e||"rpc",this.requestType=t,this.requestStream=r?!0:void 0,this.responseType=n,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=l}Ws.fromJSON=function(e,t){return new Ws(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};Ws.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return ma.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};Ws.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),Mv.prototype.resolve.call(this))}});var Oh=S((vZ,BD)=>{"use strict";BD.exports=Pi;var Vr=fa();((Pi.prototype=Object.create(Vr.prototype)).constructor=Pi).className="Service";var Ov=Mh(),xc=wt(),nU=Ev();function Pi(i,e){Vr.call(this,i,e),this.methods={},this._methodsArray=null}Pi.fromJSON=function(e,t){var n=new Pi(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),s=0;s<r.length;++s)n.add(Ov.fromJSON(r[s],t.methods[r[s]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n};Pi.prototype.toJSON=function(e){var t=Vr.prototype.toJSON.call(this,e),n=e?!!e.keepComments:!1;return xc.toObject(["options",t&&t.options||void 0,"methods",Vr.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])};Object.defineProperty(Pi.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=xc.toArray(this.methods))}});function LD(i){return i._methodsArray=null,i}Pi.prototype.get=function(e){return this.methods[e]||Vr.prototype.get.call(this,e)};Pi.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return Vr.prototype.resolve.call(this)};Pi.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof Ov?(this.methods[e.name]=e,e.parent=this,LD(this)):Vr.prototype.add.call(this,e)};Pi.prototype.remove=function(e){if(e instanceof Ov){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,LD(this)}return Vr.prototype.remove.call(this,e)};Pi.prototype.create=function(e,t,n){for(var r=new nU.Service(e,t,n),s=0,o;s<this.methodsArray.length;++s){var a=xc.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");r[a]=xc.codegen(["r","c"],xc.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return r}});var Nh=S((_Z,VD)=>{"use strict";VD.exports=An;var rU=In();function An(i){if(i)for(var e=Object.keys(i),t=0;t<e.length;++t)this[e[t]]=i[e[t]]}An.create=function(e){return this.$type.create(e)};An.encode=function(e,t){return this.$type.encode(e,t)};An.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};An.decode=function(e){return this.$type.decode(e)};An.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};An.verify=function(e){return this.$type.verify(e)};An.fromObject=function(e){return this.$type.fromObject(e)};An.toObject=function(e,t){return this.$type.toObject(e,t)};An.prototype.toJSON=function(){return this.$type.toObject(this,rU.toJSONOptions)}});var Nv=S((bZ,qD)=>{"use strict";qD.exports=aU;var sU=Zi(),nr=$s(),UD=wt();function oU(i){return"missing required '"+i.name+"'"}function aU(i){var e=UD.codegen(["r","l"],i.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(i.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");i.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var t=0;t<i.fieldsArray.length;++t){var n=i._fieldsArray[t].resolve(),r=n.resolvedType instanceof sU?"int32":n.type,s="m"+UD.safeProp(n.name);e("case %i: {",n.id),n.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),nr.defaults[n.keyType]!==void 0?e("k=%j",nr.defaults[n.keyType]):e("k=null"),nr.defaults[r]!==void 0?e("value=%j",nr.defaults[r]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",n.keyType)("case 2:"),nr.basic[r]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",r),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),nr.long[n.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):n.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),nr.packed[r]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,r)("}else"),nr.basic[r]===void 0?e(n.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,r)):nr.basic[r]===void 0?e(n.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,r),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<i._fieldsArray.length;++t){var o=i._fieldsArray[t];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",oU(o))}return e("return m")}});var Lv=S((wZ,zD)=>{"use strict";zD.exports=dU;var lU=Zi(),Pv=wt();function Fi(i,e){return i.name+": "+e+(i.repeated&&e!=="array"?"[]":i.map&&e!=="object"?"{k:"+i.keyType+"}":"")+" expected"}function Fv(i,e,t,n){if(e.resolvedType)if(e.resolvedType instanceof lU){i("switch(%s){",n)("default:")("return%j",Fi(e,"enum value"));for(var r=Object.keys(e.resolvedType.values),s=0;s<r.length;++s)i("case %i:",e.resolvedType.values[r[s]]);i("break")("}")}else i("{")("var e=types[%i].verify(%s);",t,n)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":i("if(!util.isInteger(%s))",n)("return%j",Fi(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":i("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",Fi(e,"integer|Long"));break;case"float":case"double":i('if(typeof %s!=="number")',n)("return%j",Fi(e,"number"));break;case"bool":i('if(typeof %s!=="boolean")',n)("return%j",Fi(e,"boolean"));break;case"string":i("if(!util.isString(%s))",n)("return%j",Fi(e,"string"));break;case"bytes":i('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",Fi(e,"buffer"));break}return i}function cU(i,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":i("if(!util.key32Re.test(%s))",t)("return%j",Fi(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":i("if(!util.key64Re.test(%s))",t)("return%j",Fi(e,"integer|Long key"));break;case"bool":i("if(!util.key2Re.test(%s))",t)("return%j",Fi(e,"boolean key"));break}return i}function dU(i){var e=Pv.codegen(["m"],i.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=i.oneofsArray,n={};t.length&&e("var p={}");for(var r=0;r<i.fieldsArray.length;++r){var s=i._fieldsArray[r].resolve(),o="m"+Pv.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",Fi(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),cU(e,s,"k[i]"),Fv(e,s,r,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",Fi(s,"array"))("for(var i=0;i<%s.length;++i){",o),Fv(e,s,r,o+"[i]")("}");else{if(s.partOf){var a=Pv.safeProp(s.partOf.name);n[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),n[s.partOf.name]=1,e("p%s=1",a)}Fv(e,s,r,o)}s.optional&&e("}")}return e("return null")}});var Uv=S(GD=>{"use strict";var jD=GD,Ic=Zi(),Rn=wt();function Bv(i,e,t,n){var r=!1;if(e.resolvedType)if(e.resolvedType instanceof Ic){i("switch(d%s){",n);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!r&&(i("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n),e.repeated||i("break"),r=!0),i("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",n,s[o[a]])("break");i("}")}else i('if(typeof d%s!=="object")',n)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,t,n);else{var l=!1;switch(e.type){case"double":case"float":i("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":i("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":i("m%s=d%s|0",n,n);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":i("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,l)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,l?"true":"");break;case"bytes":i('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":i("m%s=String(d%s)",n,n);break;case"bool":i("m%s=Boolean(d%s)",n,n);break}}return i}jD.fromObject=function(e){var t=e.fieldsArray,n=Rn.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),o=Rn.safeProp(s.name);s.map?(n("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),Bv(n,s,r,o+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),Bv(n,s,r,o+"[i]")("}")("}")):(s.resolvedType instanceof Ic||n("if(d%s!=null){",o),Bv(n,s,r,o),s.resolvedType instanceof Ic||n("}"))}return n("return m")};function Vv(i,e,t,n){if(e.resolvedType)e.resolvedType instanceof Ic?i("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,t,n,n,t,n,n):i("d%s=types[%i].toObject(m%s,o)",n,t,n);else{var r=!1;switch(e.type){case"double":case"float":i("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":r=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":i('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,r?"true":"",n);break;case"bytes":i("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:i("d%s=m%s",n,n);break}}return i}jD.toObject=function(e){var t=e.fieldsArray.slice().sort(Rn.compareFieldsById);if(!t.length)return Rn.codegen()("return {}");for(var n=Rn.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],s=[],o=[],a=0;a<t.length;++a)t[a].partOf||(t[a].resolve().repeated?r:t[a].map?s:o).push(t[a]);if(r.length){for(n("if(o.arrays||o.defaults){"),a=0;a<r.length;++a)n("d%s=[]",Rn.safeProp(r[a].name));n("}")}if(s.length){for(n("if(o.objects||o.defaults){"),a=0;a<s.length;++a)n("d%s={}",Rn.safeProp(s[a].name));n("}")}if(o.length){for(n("if(o.defaults){"),a=0;a<o.length;++a){var l=o[a],c=Rn.safeProp(l.name);if(l.resolvedType instanceof Ic)n("d%s=o.enums===String?%j:%j",c,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var d="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",c,d)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else n("d%s=%j",c,l.typeDefault)}n("}")}var u=!1;for(a=0;a<t.length;++a){var l=t[a],h=e._fieldsArray.indexOf(l),c=Rn.safeProp(l.name);l.map?(u||(u=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),Vv(n,l,h,c+"[ks2[j]]")("}")):l.repeated?(n("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),Vv(n,l,h,c+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",c,l.name),Vv(n,l,h,c),l.partOf&&n("if(o.oneofs)")("d%s=%j",Rn.safeProp(l.partOf.name),l.name)),n("}")}return n("return d")}});var qv=S($D=>{"use strict";var uU=$D,hU=Nh();uU[".google.protobuf.Any"]={fromObject:function(i){if(i&&i["@type"]){var e=i["@type"].substring(i["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var n=i["@type"].charAt(0)==="."?i["@type"].slice(1):i["@type"];return n.indexOf("/")===-1&&(n="/"+n),this.create({type_url:n,value:t.encode(t.fromObject(i)).finish()})}}return this.fromObject(i)},toObject:function(i,e){var t="type.googleapis.com/",n="",r="";if(e&&e.json&&i.type_url&&i.value){r=i.type_url.substring(i.type_url.lastIndexOf("/")+1),n=i.type_url.substring(0,i.type_url.lastIndexOf("/")+1);var s=this.lookup(r);s&&(i=s.decode(i.value))}if(!(i instanceof this.ctor)&&i instanceof hU){var o=i.$type.toObject(i,e),a=i.$type.fullName[0]==="."?i.$type.fullName.slice(1):i.$type.fullName;return n===""&&(n=t),r=n+a,o["@type"]=r,o}return this.toObject(i,e)}}});var Lh=S((CZ,WD)=>{"use strict";WD.exports=xe;var Ji=fa();((xe.prototype=Object.create(Ji.prototype)).constructor=xe).className="Type";var fU=Zi(),Gv=da(),Ph=Br(),mU=kh(),pU=Oh(),zv=Nh(),jv=xh(),gU=Ch(),Ut=wt(),yU=$v(),vU=Nv(),_U=Lv(),HD=Uv(),bU=qv();function xe(i,e){Ji.call(this,i,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(xe.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var i=Object.keys(this.fields),e=0;e<i.length;++e){var t=this.fields[i[e]],n=t.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=Ut.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=Ut.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=xe.generateConstructor(this)())},set:function(i){var e=i.prototype;e instanceof zv||((i.prototype=new zv).constructor=i,Ut.merge(i.prototype,e)),i.$type=i.prototype.$type=this,Ut.merge(i,zv,!0),this._ctor=i;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var n={};for(t=0;t<this.oneofsArray.length;++t)n[this._oneofsArray[t].resolve().name]={get:Ut.oneOfGetter(this._oneofsArray[t].oneof),set:Ut.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(i.prototype,n)}}});xe.generateConstructor=function(e){for(var t=Ut.codegen(["p"],e.name),n=0,r;n<e.fieldsArray.length;++n)(r=e._fieldsArray[n]).map?t("this%s={}",Ut.safeProp(r.name)):r.repeated&&t("this%s=[]",Ut.safeProp(r.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function Fh(i){return i._fieldsById=i._fieldsArray=i._oneofsArray=null,delete i.encode,delete i.decode,delete i.verify,i}xe.fromJSON=function(e,t){var n=new xe(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var r=Object.keys(t.fields),s=0;s<r.length;++s)n.add((typeof t.fields[r[s]].keyType<"u"?mU.fromJSON:Ph.fromJSON)(r[s],t.fields[r[s]]));if(t.oneofs)for(r=Object.keys(t.oneofs),s=0;s<r.length;++s)n.add(Gv.fromJSON(r[s],t.oneofs[r[s]]));if(t.nested)for(r=Object.keys(t.nested),s=0;s<r.length;++s){var o=t.nested[r[s]];n.add((o.id!==void 0?Ph.fromJSON:o.fields!==void 0?xe.fromJSON:o.values!==void 0?fU.fromJSON:o.methods!==void 0?pU.fromJSON:Ji.fromJSON)(r[s],o))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n};xe.prototype.toJSON=function(e){var t=Ji.prototype.toJSON.call(this,e),n=e?!!e.keepComments:!1;return Ut.toObject(["options",t&&t.options||void 0,"oneofs",Ji.arrayToJSON(this.oneofsArray,e),"fields",Ji.arrayToJSON(this.fieldsArray.filter(function(r){return!r.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])};xe.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return Ji.prototype.resolveAll.call(this)};xe.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};xe.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof Ph&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),Fh(this)}return e instanceof Gv?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),Fh(this)):Ji.prototype.add.call(this,e)};xe.prototype.remove=function(e){if(e instanceof Ph&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),Fh(this)}if(e instanceof Gv){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),Fh(this)}return Ji.prototype.remove.call(this,e)};xe.prototype.isReservedId=function(e){return Ji.isReservedId(this.reserved,e)};xe.prototype.isReservedName=function(e){return Ji.isReservedName(this.reserved,e)};xe.prototype.create=function(e){return new this.ctor(e)};xe.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=yU(this)({Writer:gU,types:t,util:Ut}),this.decode=vU(this)({Reader:jv,types:t,util:Ut}),this.verify=_U(this)({types:t,util:Ut}),this.fromObject=HD.fromObject(this)({types:t,util:Ut}),this.toObject=HD.toObject(this)({types:t,util:Ut});var r=bU[e];if(r){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(s),s.toObject=this.toObject,this.toObject=r.toObject.bind(s)}return this};xe.prototype.encode=function(e,t){return this.setup().encode(e,t)};xe.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};xe.prototype.decode=function(e,t){return this.setup().decode(e,t)};xe.prototype.decodeDelimited=function(e){return e instanceof jv||(e=jv.create(e)),this.decode(e,e.uint32())};xe.prototype.verify=function(e){return this.setup().verify(e)};xe.prototype.fromObject=function(e){return this.setup().fromObject(e)};xe.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};xe.d=function(e){return function(n){Ut.decorateType(n,e)}}});var Uh=S((TZ,ZD)=>{"use strict";ZD.exports=vi;var Vh=fa();((vi.prototype=Object.create(Vh.prototype)).constructor=vi).className="Root";var Wv=Br(),QD=Zi(),wU=da(),Ur=wt(),YD,Hv,Dc;function vi(i){Vh.call(this,"",i),this.deferred=[],this.files=[]}vi.fromJSON=function(e,t){return t||(t=new vi),e.options&&t.setOptions(e.options),t.addJSON(e.nested)};vi.prototype.resolvePath=Ur.path.resolve;vi.prototype.fetch=Ur.fetch;function XD(){}vi.prototype.load=function i(e,t,n){typeof t=="function"&&(n=t,t=void 0);var r=this;if(!n)return Ur.asPromise(i,r,e,t);var s=n===XD;function o(m,g){if(n){var _=n;if(n=null,s)throw m;_(m,g)}}function a(m){var g=m.lastIndexOf("google/protobuf/");if(g>-1){var _=m.substring(g);if(_ in Dc)return _}return null}function l(m,g){try{if(Ur.isString(g)&&g.charAt(0)==="{"&&(g=JSON.parse(g)),!Ur.isString(g))r.setOptions(g.options).addJSON(g.nested);else{Hv.filename=m;var _=Hv(g,r,t),y,A=0;if(_.imports)for(;A<_.imports.length;++A)(y=a(_.imports[A])||r.resolvePath(m,_.imports[A]))&&c(y);if(_.weakImports)for(A=0;A<_.weakImports.length;++A)(y=a(_.weakImports[A])||r.resolvePath(m,_.weakImports[A]))&&c(y,!0)}}catch(w){o(w)}!s&&!d&&o(null,r)}function c(m,g){if(m=a(m)||m,!(r.files.indexOf(m)>-1)){if(r.files.push(m),m in Dc){s?l(m,Dc[m]):(++d,setTimeout(function(){--d,l(m,Dc[m])}));return}if(s){var _;try{_=Ur.fs.readFileSync(m).toString("utf8")}catch(y){g||o(y);return}l(m,_)}else++d,r.fetch(m,function(y,A){if(--d,!!n){if(y){g?d||o(null,r):o(y);return}l(m,A)}})}}var d=0;Ur.isString(e)&&(e=[e]);for(var u=0,h;u<e.length;++u)(h=r.resolvePath("",e[u]))&&c(h);if(s)return r;d||o(null,r)};vi.prototype.loadSync=function(e,t){if(!Ur.isNode)throw Error("not supported");return this.load(e,t,XD)};vi.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return Vh.prototype.resolveAll.call(this)};var Bh=/^[A-Z]/;function KD(i,e){var t=e.parent.lookup(e.extend);if(t){var n=new Wv(e.fullName,e.id,e.type,e.rule,void 0,e.options);return t.get(n.name)||(n.declaringField=e,e.extensionField=n,t.add(n)),!0}return!1}vi.prototype._handleAdd=function(e){if(e instanceof Wv)e.extend!==void 0&&!e.extensionField&&(KD(this,e)||this.deferred.push(e));else if(e instanceof QD)Bh.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof wU)){if(e instanceof YD)for(var t=0;t<this.deferred.length;)KD(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);Bh.test(e.name)&&(e.parent[e.name]=e)}};vi.prototype._handleRemove=function(e){if(e instanceof Wv){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof QD)Bh.test(e.name)&&delete e.parent[e.name];else if(e instanceof Vh){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);Bh.test(e.name)&&delete e.parent[e.name]}};vi._configure=function(i,e,t){YD=i,Hv=e,Dc=t}});var wt=S((xZ,eA)=>{"use strict";var et=eA.exports=In(),JD=Cv(),Kv,Qv;et.codegen=vD();et.fetch=bD();et.path=ED();et.fs=et.inquire("fs");et.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]};et.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],s=e[n++];s!==void 0&&(t[r]=s)}return t};var SU=/\\/g,EU=/"/g;et.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};et.safeProp=function(e){return!/^[$\w_]+$/.test(e)||et.isReserved(e)?'["'+e.replace(SU,"\\\\").replace(EU,'\\"')+'"]':"."+e};et.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var CU=/_([a-z])/g;et.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(CU,function(t,n){return n.toUpperCase()})};et.compareFieldsById=function(e,t){return e.id-t.id};et.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(et.decorateRoot.remove(e.$type),e.$type.name=t,et.decorateRoot.add(e.$type)),e.$type;Kv||(Kv=Lh());var n=new Kv(t||e.name);return et.decorateRoot.add(n),n.ctor=e,Object.defineProperty(e,"$type",{value:n,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:n,enumerable:!1}),n};var TU=0;et.decorateEnum=function(e){if(e.$type)return e.$type;Qv||(Qv=Zi());var t=new Qv("Enum"+TU++,e);return et.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};et.setProperty=function(e,t,n){function r(s,o,a){var l=o.shift();if(l==="__proto__"||l==="prototype")return s;if(o.length>0)s[l]=r(s[l]||{},o,a);else{var c=s[l];c&&(a=[].concat(c).concat(a)),s[l]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),r(e,t,n)};Object.defineProperty(et,"decorateRoot",{get:function(){return JD.decorated||(JD.decorated=new(Uh()))}})});var Hs=S((IZ,tA)=>{"use strict";tA.exports=_i;_i.className="ReflectionObject";var qh=wt(),zh;function _i(i,e){if(!qh.isString(i))throw TypeError("name must be a string");if(e&&!qh.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=i,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(_i.prototype,{root:{get:function(){for(var i=this;i.parent!==null;)i=i.parent;return i}},fullName:{get:function(){for(var i=[this.name],e=this.parent;e;)i.unshift(e.name),e=e.parent;return i.join(".")}}});_i.prototype.toJSON=function(){throw Error()};_i.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof zh&&t._handleAdd(this)};_i.prototype.onRemove=function(e){var t=e.root;t instanceof zh&&t._handleRemove(this),this.parent=null,this.resolved=!1};_i.prototype.resolve=function(){return this.resolved?this:(this.root instanceof zh&&(this.resolved=!0),this)};_i.prototype.getOption=function(e){if(this.options)return this.options[e]};_i.prototype.setOption=function(e,t,n){return(!n||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=t),this};_i.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(n){var s=r.find(function(l){return Object.prototype.hasOwnProperty.call(l,e)});if(s){var o=s[e];qh.setProperty(o,n,t)}else s={},s[e]=qh.setProperty({},n,t),r.push(s)}else{var a={};a[e]=t,r.push(a)}return this};_i.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this};_i.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};_i._configure=function(i){zh=i}});var Zi=S((DZ,rA)=>{"use strict";rA.exports=kn;var iA=Hs();((kn.prototype=Object.create(iA.prototype)).constructor=kn).className="Enum";var nA=fa(),jh=wt();function kn(i,e,t,n,r,s){if(iA.call(this,i,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=r||{},this.valuesOptions=s,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}kn.fromJSON=function(e,t){var n=new kn(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n};kn.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return jh.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};kn.prototype.add=function(e,t,n,r){if(!jh.isString(e))throw TypeError("name must be a string");if(!jh.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return r&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=r||null),this.comments[e]=n||null,this};kn.prototype.remove=function(e){if(!jh.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};kn.prototype.isReservedId=function(e){return nA.isReservedId(this.reserved,e)};kn.prototype.isReservedName=function(e){return nA.isReservedName(this.reserved,e)}});var $v=S((AZ,oA)=>{"use strict";oA.exports=IU;var xU=Zi(),Yv=$s(),Xv=wt();function sA(i,e,t,n){return e.resolvedType.group?i("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,n,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):i("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,n,(e.id<<3|2)>>>0)}function IU(i){for(var e=Xv.codegen(["m","w"],i.name+"$encode")("if(!w)")("w=Writer.create()"),t,n,r=i.fieldsArray.slice().sort(Xv.compareFieldsById),t=0;t<r.length;++t){var s=r[t].resolve(),o=i._fieldsArray.indexOf(s),a=s.resolvedType instanceof xU?"int32":s.type,l=Yv.basic[a];n="m"+Xv.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",n,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",n)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|Yv.mapKey[s.keyType],s.keyType),l===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,n):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,a,n),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",n,n),s.packed&&Yv.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",n)("w.%s(%s[i])",a,n)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",n),l===void 0?sA(e,s,o,n+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|l)>>>0,a,n)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",n,s.name),l===void 0?sA(e,s,o,n):e("w.uint32(%i).%s(%s)",(s.id<<3|l)>>>0,a,n))}return e("return w")}});var lA=S((RZ,aA)=>{"use strict";var ae=aA.exports=gD();ae.build="light";function DU(i,e,t){return typeof e=="function"?(t=e,e=new ae.Root):e||(e=new ae.Root),e.load(i,t)}ae.load=DU;function AU(i,e){return e||(e=new ae.Root),e.loadSync(i)}ae.loadSync=AU;ae.encoder=$v();ae.decoder=Nv();ae.verifier=Lv();ae.converter=Uv();ae.ReflectionObject=Hs();ae.Namespace=fa();ae.Root=Uh();ae.Enum=Zi();ae.Type=Lh();ae.Field=Br();ae.OneOf=da();ae.MapField=kh();ae.Service=Oh();ae.Method=Mh();ae.Message=Nh();ae.wrappers=qv();ae.types=$s();ae.util=wt();ae.ReflectionObject._configure(ae.Root);ae.Namespace._configure(ae.Type,ae.Service,ae.Enum);ae.Root._configure(ae.Type);ae.Field._configure(ae.Type)});var Jv=S((kZ,uA)=>{"use strict";uA.exports=dA;var Zv=/[\s{}=;:[\],'"()<>]/g,RU=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,kU=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,MU=/^ *[*/]+ */,OU=/^\s*\*?\/*/,NU=/\n/g,PU=/\s/,FU=/\\(.?)/g,LU={0:"\0",r:"\r",n:`
`,t:"	"};function cA(i){return i.replace(FU,function(e,t){switch(t){case"\\":case"":return t;default:return LU[t]||""}})}dA.unescape=cA;function dA(i,e){i=i.toString();var t=0,n=i.length,r=1,s=0,o={},a=[],l=null;function c(k){return Error("illegal "+k+" (line "+r+")")}function d(){var k=l==="'"?kU:RU;k.lastIndex=t-1;var q=k.exec(i);if(!q)throw c("string");return t=k.lastIndex,y(l),l=null,cA(q[1])}function u(k){return i.charAt(k)}function h(k,q,K){var ne={type:i.charAt(k++),lineEmpty:!1,leading:K},ft;e?ft=2:ft=3;var Rt=k-ft,Te;do if(--Rt<0||(Te=i.charAt(Rt))===`
`){ne.lineEmpty=!0;break}while(Te===" "||Te==="	");for(var C=i.substring(k,q).split(NU),Ge=0;Ge<C.length;++Ge)C[Ge]=C[Ge].replace(e?OU:MU,"").trim();ne.text=C.join(`
`).trim(),o[r]=ne,s=r}function m(k){var q=g(k),K=i.substring(k,q),ne=/^\s*\/\//.test(K);return ne}function g(k){for(var q=k;q<n&&u(q)!==`
`;)q++;return q}function _(){if(a.length>0)return a.shift();if(l)return d();var k,q,K,ne,ft,Rt=t===0;do{if(t===n)return null;for(k=!1;PU.test(K=u(t));)if(K===`
`&&(Rt=!0,++r),++t===n)return null;if(u(t)==="/"){if(++t===n)throw c("comment");if(u(t)==="/")if(e){if(ne=t,ft=!1,m(t-1)){ft=!0;do if(t=g(t),t===n||(t++,!Rt))break;while(m(t))}else t=Math.min(n,g(t)+1);ft&&(h(ne,t,Rt),Rt=!0),r++,k=!0}else{for(ft=u(ne=t+1)==="/";u(++t)!==`
`;)if(t===n)return null;++t,ft&&(h(ne,t-1,Rt),Rt=!0),++r,k=!0}else if((K=u(t))==="*"){ne=t+1,ft=e||u(ne)==="*";do{if(K===`
`&&++r,++t===n)throw c("comment");q=K,K=u(t)}while(q!=="*"||K!=="/");++t,ft&&(h(ne,t-2,Rt),Rt=!0),k=!0}else return"/"}}while(k);var Te=t;Zv.lastIndex=0;var C=Zv.test(u(Te++));if(!C)for(;Te<n&&!Zv.test(u(Te));)++Te;var Ge=i.substring(t,t=Te);return(Ge==='"'||Ge==="'")&&(l=Ge),Ge}function y(k){a.push(k)}function A(){if(!a.length){var k=_();if(k===null)return null;y(k)}return a[0]}function w(k,q){var K=A(),ne=K===k;if(ne)return _(),!0;if(!q)throw c("token '"+K+"', '"+k+"' expected");return!1}function R(k){var q=null,K;return k===void 0?(K=o[r-1],delete o[r-1],K&&(e||K.type==="*"||K.lineEmpty)&&(q=K.leading?K.text:null)):(s<k&&A(),K=o[k],delete o[k],K&&!K.lineEmpty&&(e||K.type==="/")&&(q=K.leading?null:K.text)),q}return Object.defineProperty({next:_,peek:A,push:y,skip:w,cmnt:R},"line",{get:function(){return r}})}});var yA=S((MZ,gA)=>{"use strict";gA.exports=rr;rr.filename=null;rr.defaults={keepCase:!1};var BU=Jv(),hA=Uh(),fA=Lh(),mA=Br(),VU=kh(),pA=da(),UU=Zi(),qU=Oh(),zU=Mh(),e_=$s(),t_=wt(),jU=/^[1-9][0-9]*$/,GU=/^-?[1-9][0-9]*$/,$U=/^0[x][0-9a-fA-F]+$/,HU=/^-?0[x][0-9a-fA-F]+$/,WU=/^0[0-7]+$/,KU=/^-?0[0-7]+$/,QU=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,Mn=/^[a-zA-Z_][a-zA-Z_0-9]*$/,On=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,YU=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function rr(i,e,t){e instanceof hA||(t=e,e=new hA),t||(t=rr.defaults);var n=t.preferTrailingComment||!1,r=BU(i,t.alternateCommentMode||!1),s=r.next,o=r.push,a=r.peek,l=r.skip,c=r.cmnt,d=!0,u,h,m,g,_=!1,y=e,A=t.keepCase?function(x){return x}:t_.camelCase;function w(x,I,M){var H=rr.filename;return M||(rr.filename=null),Error("illegal "+(I||"token")+" '"+x+"' ("+(H?H+", ":"")+"line "+r.line+")")}function R(){var x=[],I;do{if((I=s())!=='"'&&I!=="'")throw w(I);x.push(s()),l(I),I=a()}while(I==='"'||I==="'");return x.join("")}function k(x){var I=s();switch(I){case"'":case'"':return o(I),R();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return K(I,!0)}catch{if(x&&On.test(I))return I;throw w(I,"value")}}function q(x,I){var M,H;do I&&((M=a())==='"'||M==="'")?x.push(R()):x.push([H=ne(s()),l("to",!0)?ne(s()):H]);while(l(",",!0));l(";")}function K(x,I){var M=1;switch(x.charAt(0)==="-"&&(M=-1,x=x.substring(1)),x){case"inf":case"INF":case"Inf":return M*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(jU.test(x))return M*parseInt(x,10);if($U.test(x))return M*parseInt(x,16);if(WU.test(x))return M*parseInt(x,8);if(QU.test(x))return M*parseFloat(x);throw w(x,"number",I)}function ne(x,I){switch(x){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!I&&x.charAt(0)==="-")throw w(x,"id");if(GU.test(x))return parseInt(x,10);if(HU.test(x))return parseInt(x,16);if(KU.test(x))return parseInt(x,8);throw w(x,"id")}function ft(){if(u!==void 0)throw w("package");if(u=s(),!On.test(u))throw w(u,"name");y=y.define(u),l(";")}function Rt(){var x=a(),I;switch(x){case"weak":I=m||(m=[]),s();break;case"public":s();default:I=h||(h=[]);break}x=R(),l(";"),I.push(x)}function Te(){if(l("="),g=R(),_=g==="proto3",!_&&g!=="proto2")throw w(g,"syntax");l(";")}function C(x,I){switch(I){case"option":return Ae(x,I),l(";"),!0;case"message":return T(x,I),!0;case"enum":return we(x,I),!0;case"service":return st(x,I),!0;case"extend":return Mo(x,I),!0}return!1}function Ge(x,I,M){var H=r.line;if(x&&(typeof x.comment!="string"&&(x.comment=c()),x.filename=rr.filename),l("{",!0)){for(var G;(G=s())!=="}";)I(G);l(";",!0)}else M&&M(),l(";"),x&&(typeof x.comment!="string"||n)&&(x.comment=c(H)||x.comment)}function T(x,I){if(!Mn.test(I=s()))throw w(I,"type name");var M=new fA(I);Ge(M,function(G){if(!C(M,G))switch(G){case"map":ce(M,G);break;case"required":case"repeated":f(M,G);break;case"optional":_?f(M,"proto3_optional"):f(M,"optional");break;case"oneof":Oe(M,G);break;case"extensions":q(M.extensions||(M.extensions=[]));break;case"reserved":q(M.reserved||(M.reserved=[]),!0);break;default:if(!_||!On.test(G))throw w(G);o(G),f(M,"optional");break}}),x.add(M)}function f(x,I,M){var H=s();if(H==="group"){L(x,I);return}for(;H.endsWith(".")||a().startsWith(".");)H+=s();if(!On.test(H))throw w(H,"type");var G=s();if(!Mn.test(G))throw w(G,"name");G=A(G),l("=");var re=new mA(G,ne(s()),H,I,M);if(Ge(re,function(fi){if(fi==="option")Ae(re,fi),l(";");else throw w(fi)},function(){kt(re)}),I==="proto3_optional"){var xt=new pA("_"+G);re.setOption("proto3_optional",!0),xt.add(re),x.add(xt)}else x.add(re);!_&&re.repeated&&(e_.packed[H]!==void 0||e_.basic[H]===void 0)&&re.setOption("packed",!1,!0)}function L(x,I){var M=s();if(!Mn.test(M))throw w(M,"name");var H=t_.lcFirst(M);M===H&&(M=t_.ucFirst(M)),l("=");var G=ne(s()),re=new fA(M);re.group=!0;var xt=new mA(H,G,M,I);xt.filename=rr.filename,Ge(re,function(fi){switch(fi){case"option":Ae(re,fi),l(";");break;case"required":case"repeated":f(re,fi);break;case"optional":_?f(re,"proto3_optional"):f(re,"optional");break;case"message":T(re,fi);break;case"enum":we(re,fi);break;default:throw w(fi)}}),x.add(re).add(xt)}function ce(x){l("<");var I=s();if(e_.mapKey[I]===void 0)throw w(I,"type");l(",");var M=s();if(!On.test(M))throw w(M,"type");l(">");var H=s();if(!Mn.test(H))throw w(H,"name");l("=");var G=new VU(A(H),ne(s()),I,M);Ge(G,function(xt){if(xt==="option")Ae(G,xt),l(";");else throw w(xt)},function(){kt(G)}),x.add(G)}function Oe(x,I){if(!Mn.test(I=s()))throw w(I,"name");var M=new pA(A(I));Ge(M,function(G){G==="option"?(Ae(M,G),l(";")):(o(G),f(M,"optional"))}),x.add(M)}function we(x,I){if(!Mn.test(I=s()))throw w(I,"name");var M=new UU(I);Ge(M,function(G){switch(G){case"option":Ae(M,G),l(";");break;case"reserved":q(M.reserved||(M.reserved=[]),!0);break;default:Xe(M,G)}}),x.add(M)}function Xe(x,I){if(!Mn.test(I))throw w(I,"name");l("=");var M=ne(s(),!0),H={options:void 0};H.setOption=function(G,re){this.options===void 0&&(this.options={}),this.options[G]=re},Ge(H,function(re){if(re==="option")Ae(H,re),l(";");else throw w(re)},function(){kt(H)}),x.add(I,M,H.comment,H.options)}function Ae(x,I){var M=l("(",!0);if(!On.test(I=s()))throw w(I,"name");var H=I,G=H,re;M&&(l(")"),H="("+H+")",G=H,I=a(),YU.test(I)&&(re=I.slice(1),H+=I,s())),l("=");var xt=$t(x,H);$e(x,G,xt,re)}function $t(x,I){if(l("{",!0)){for(var M={};!l("}",!0);){if(!Mn.test(Mt=s()))throw w(Mt,"name");if(Mt===null)throw w(Mt,"end of input");var H,G=Mt;if(l(":",!0),a()==="{")H=$t(x,I+"."+Mt);else if(a()==="["){H=[];var re;if(l("[",!0)){do re=k(!0),H.push(re);while(l(",",!0));l("]"),typeof re<"u"&&rt(x,I+"."+Mt,re)}}else H=k(!0),rt(x,I+"."+Mt,H);var xt=M[G];xt&&(H=[].concat(xt).concat(H)),M[G]=H,l(",",!0),l(";",!0)}return M}var vr=k(!0);return rt(x,I,vr),vr}function rt(x,I,M){x.setOption&&x.setOption(I,M)}function $e(x,I,M,H){x.setParsedOption&&x.setParsedOption(I,M,H)}function kt(x){if(l("[",!0)){do Ae(x,"option");while(l(",",!0));l("]")}return x}function st(x,I){if(!Mn.test(I=s()))throw w(I,"service name");var M=new qU(I);Ge(M,function(G){if(!C(M,G))if(G==="rpc")Ht(M,G);else throw w(G)}),x.add(M)}function Ht(x,I){var M=c(),H=I;if(!Mn.test(I=s()))throw w(I,"name");var G=I,re,xt,vr,fi;if(l("("),l("stream",!0)&&(xt=!0),!On.test(I=s())||(re=I,l(")"),l("returns"),l("("),l("stream",!0)&&(fi=!0),!On.test(I=s())))throw w(I);vr=I,l(")");var Jd=new zU(G,H,re,vr,xt,fi);Jd.comment=M,Ge(Jd,function(Gp){if(Gp==="option")Ae(Jd,Gp),l(";");else throw w(Gp)}),x.add(Jd)}function Mo(x,I){if(!On.test(I=s()))throw w(I,"reference");var M=I;Ge(null,function(G){switch(G){case"required":case"repeated":f(x,G,M);break;case"optional":_?f(x,"proto3_optional",M):f(x,"optional",M);break;default:if(!_||!On.test(G))throw w(G);o(G),f(x,"optional",M);break}})}for(var Mt;(Mt=s())!==null;)switch(Mt){case"package":if(!d)throw w(Mt);ft();break;case"import":if(!d)throw w(Mt);Rt();break;case"syntax":if(!d)throw w(Mt);Te();break;case"option":Ae(y,Mt),l(";");break;default:if(C(y,Mt)){d=!1;continue}throw w(Mt)}return rr.filename=null,{package:u,imports:h,weakImports:m,syntax:g,root:e}}});var bA=S((OZ,_A)=>{"use strict";_A.exports=en;var XU=/\/|\./;function en(i,e){XU.test(i)||(i="google/protobuf/"+i+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),en[i]=e}en("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var vA;en("duration",{Duration:vA={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});en("timestamp",{Timestamp:vA});en("empty",{Empty:{fields:{}}});en("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});en("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});en("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});en.get=function(e){return en[e]||null}});var SA=S((NZ,wA)=>{"use strict";var qr=wA.exports=lA();qr.build="full";qr.tokenize=Jv();qr.parse=yA();qr.common=bA();qr.Root._configure(qr.Type,qr.parse,qr.common)});var Gh=S((PZ,EA)=>{"use strict";EA.exports=SA()});var i_=S((FZ,ZU)=>{ZU.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var DA=S((ie,IA)=>{"use strict";var Jt=Gh();IA.exports=ie=Jt.descriptor=Jt.Root.fromJSON(i_()).lookup(".google.protobuf");var CA=Jt.Namespace,Ac=Jt.Root,sr=Jt.Enum,zr=Jt.Type,jr=Jt.Field,JU=Jt.MapField,$h=Jt.OneOf,Rc=Jt.Service,Hh=Jt.Method;Ac.fromDescriptor=function(e){typeof e.length=="number"&&(e=ie.FileDescriptorSet.decode(e));var t=new Ac;if(e.file)for(var n,r,s=0,o;s<e.file.length;++s){if(r=t,(n=e.file[s]).package&&n.package.length&&(r=t.define(n.package)),n.name&&n.name.length&&t.files.push(r.filename=n.name),n.messageType)for(o=0;o<n.messageType.length;++o)r.add(zr.fromDescriptor(n.messageType[o],n.syntax));if(n.enumType)for(o=0;o<n.enumType.length;++o)r.add(sr.fromDescriptor(n.enumType[o]));if(n.extension)for(o=0;o<n.extension.length;++o)r.add(jr.fromDescriptor(n.extension[o]));if(n.service)for(o=0;o<n.service.length;++o)r.add(Rc.fromDescriptor(n.service[o]));var a=pa(n.options,ie.FileOptions);if(a){var l=Object.keys(a);for(o=0;o<l.length;++o)r.setOption(l[o],a[l[o]])}}return t};Ac.prototype.toDescriptor=function(e){var t=ie.FileDescriptorSet.create();return TA(this,t.file,e),t};function TA(i,e,t){var n=ie.FileDescriptorProto.create({name:i.filename||(i.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});t&&(n.syntax=t),i instanceof Ac||(n.package=i.fullName.substring(1));for(var r=0,s;r<i.nestedArray.length;++r)(s=i._nestedArray[r])instanceof zr?n.messageType.push(s.toDescriptor(t)):s instanceof sr?n.enumType.push(s.toDescriptor()):s instanceof jr?n.extension.push(s.toDescriptor(t)):s instanceof Rc?n.service.push(s.toDescriptor()):s instanceof CA&&TA(s,e,t);n.options=ga(i.options,ie.FileOptions),n.messageType.length+n.enumType.length+n.extension.length+n.service.length&&e.push(n)}var eq=0;zr.fromDescriptor=function(e,t){typeof e.length=="number"&&(e=ie.DescriptorProto.decode(e));var n=new zr(e.name.length?e.name:"Type"+eq++,pa(e.options,ie.MessageOptions)),r;if(e.oneofDecl)for(r=0;r<e.oneofDecl.length;++r)n.add($h.fromDescriptor(e.oneofDecl[r]));if(e.field)for(r=0;r<e.field.length;++r){var s=jr.fromDescriptor(e.field[r],t);n.add(s),e.field[r].hasOwnProperty("oneofIndex")&&n.oneofsArray[e.field[r].oneofIndex].add(s)}if(e.extension)for(r=0;r<e.extension.length;++r)n.add(jr.fromDescriptor(e.extension[r],t));if(e.nestedType)for(r=0;r<e.nestedType.length;++r)n.add(zr.fromDescriptor(e.nestedType[r],t)),e.nestedType[r].options&&e.nestedType[r].options.mapEntry&&n.setOption("map_entry",!0);if(e.enumType)for(r=0;r<e.enumType.length;++r)n.add(sr.fromDescriptor(e.enumType[r]));if(e.extensionRange&&e.extensionRange.length)for(n.extensions=[],r=0;r<e.extensionRange.length;++r)n.extensions.push([e.extensionRange[r].start,e.extensionRange[r].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(n.reserved=[],e.reservedRange)for(r=0;r<e.reservedRange.length;++r)n.reserved.push([e.reservedRange[r].start,e.reservedRange[r].end]);if(e.reservedName)for(r=0;r<e.reservedName.length;++r)n.reserved.push(e.reservedName[r])}return n};zr.prototype.toDescriptor=function(e){var t=ie.DescriptorProto.create({name:this.name}),n;for(n=0;n<this.fieldsArray.length;++n){var r;if(t.field.push(r=this._fieldsArray[n].toDescriptor(e)),this._fieldsArray[n]instanceof JU){var s=n_(this._fieldsArray[n].keyType,this._fieldsArray[n].resolvedKeyType),o=n_(this._fieldsArray[n].type,this._fieldsArray[n].resolvedType),a=o===11||o===14?this._fieldsArray[n].resolvedType&&xA(this.parent,this._fieldsArray[n].resolvedType)||this._fieldsArray[n].type:void 0;t.nestedType.push(ie.DescriptorProto.create({name:r.typeName,field:[ie.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),ie.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:ie.MessageOptions.create({mapEntry:!0})}))}}for(n=0;n<this.oneofsArray.length;++n)t.oneofDecl.push(this._oneofsArray[n].toDescriptor());for(n=0;n<this.nestedArray.length;++n)this._nestedArray[n]instanceof jr?t.field.push(this._nestedArray[n].toDescriptor(e)):this._nestedArray[n]instanceof zr?t.nestedType.push(this._nestedArray[n].toDescriptor(e)):this._nestedArray[n]instanceof sr&&t.enumType.push(this._nestedArray[n].toDescriptor());if(this.extensions)for(n=0;n<this.extensions.length;++n)t.extensionRange.push(ie.DescriptorProto.ExtensionRange.create({start:this.extensions[n][0],end:this.extensions[n][1]}));if(this.reserved)for(n=0;n<this.reserved.length;++n)typeof this.reserved[n]=="string"?t.reservedName.push(this.reserved[n]):t.reservedRange.push(ie.DescriptorProto.ReservedRange.create({start:this.reserved[n][0],end:this.reserved[n][1]}));return t.options=ga(this.options,ie.MessageOptions),t};var tq=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;jr.fromDescriptor=function(e,t){if(typeof e.length=="number"&&(e=ie.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var n;e.typeName&&e.typeName.length?n=e.typeName:n=oq(e.type);var r;switch(e.label){case 1:r=void 0;break;case 2:r="required";break;case 3:r="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;e.extendee!==void 0&&(s=s.length?s:void 0);var o=new jr(e.name.length?e.name:"field"+e.number,e.number,n,r,s);if(o.options=pa(e.options,ie.FieldOptions),e.defaultValue&&e.defaultValue.length){var a=e.defaultValue;switch(a){case"true":case"TRUE":a=!0;break;case"false":case"FALSE":a=!1;break;default:var l=tq.exec(a);l&&(a=parseInt(a));break}o.setOption("default",a)}return aq(e.type)&&(t==="proto3"?e.options&&!e.options.packed&&o.setOption("packed",!1):e.options&&e.options.packed||o.setOption("packed",!1)),o};jr.prototype.toDescriptor=function(e){var t=ie.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=Jt.util.ucFirst(this.name),t.label=3;else{switch(t.type=n_(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:t.typeName=this.resolvedType?xA(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":t.label=3;break;case"required":t.label=2;break;default:t.label=1;break}}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=ga(this.options,ie.FieldOptions),this.options.default!=null&&(t.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((t.options||(t.options=ie.FieldOptions.create())).packed=!1):this.packed&&((t.options||(t.options=ie.FieldOptions.create())).packed=!0),t};var iq=0;sr.fromDescriptor=function(e){typeof e.length=="number"&&(e=ie.EnumDescriptorProto.decode(e));var t={};if(e.value)for(var n=0;n<e.value.length;++n){var r=e.value[n].name,s=e.value[n].number||0;t[r&&r.length?r:"NAME"+s]=s}return new sr(e.name&&e.name.length?e.name:"Enum"+iq++,t,pa(e.options,ie.EnumOptions))};sr.prototype.toDescriptor=function(){for(var e=[],t=0,n=Object.keys(this.values);t<n.length;++t)e.push(ie.EnumValueDescriptorProto.create({name:n[t],number:this.values[n[t]]}));return ie.EnumDescriptorProto.create({name:this.name,value:e,options:ga(this.options,ie.EnumOptions)})};var nq=0;$h.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ie.OneofDescriptorProto.decode(e)),new $h(e.name&&e.name.length?e.name:"oneof"+nq++)};$h.prototype.toDescriptor=function(){return ie.OneofDescriptorProto.create({name:this.name})};var rq=0;Rc.fromDescriptor=function(e){typeof e.length=="number"&&(e=ie.ServiceDescriptorProto.decode(e));var t=new Rc(e.name&&e.name.length?e.name:"Service"+rq++,pa(e.options,ie.ServiceOptions));if(e.method)for(var n=0;n<e.method.length;++n)t.add(Hh.fromDescriptor(e.method[n]));return t};Rc.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return ie.ServiceDescriptorProto.create({name:this.name,method:e,options:ga(this.options,ie.ServiceOptions)})};var sq=0;Hh.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ie.MethodDescriptorProto.decode(e)),new Hh(e.name&&e.name.length?e.name:"Method"+sq++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,pa(e.options,ie.MethodOptions))};Hh.prototype.toDescriptor=function(){return ie.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:ga(this.options,ie.MethodOptions)})};function oq(i){switch(i){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+i)}function aq(i){switch(i){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function n_(i,e){switch(i){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof sr)return 14;if(e instanceof zr)return e.group?10:11;throw Error("illegal type: "+i)}function pa(i,e){if(i){for(var t=[],n=0,r,s,o;n<e.fieldsArray.length;++n)(s=(r=e._fieldsArray[n]).name)!=="uninterpretedOption"&&i.hasOwnProperty(s)&&(o=i[s],r.resolvedType instanceof sr&&typeof o=="number"&&r.resolvedType.valuesById[o]!==void 0&&(o=r.resolvedType.valuesById[o]),t.push(lq(s),o));return t.length?Jt.util.toObject(t):void 0}}function ga(i,e){if(i){for(var t=[],n=0,r=Object.keys(i),s,o;n<r.length;++n)if(o=i[s=r[n]],s!=="default"){var a=e.fields[s];!a&&!(a=e.fields[s=Jt.util.camelCase(s)])||t.push(s,o)}return t.length?e.fromObject(Jt.util.toObject(t)):void 0}}function xA(i,e){var t=i.fullName.split("."),n=e.fullName.split("."),r=0,s=0,o=n.length-1;if(!(i instanceof Ac)&&e instanceof CA)for(;r<t.length&&s<o&&t[r]===n[s];){var a=e.lookup(t[r++],!0);if(a!==null&&a!==e)break;++s}else for(;r<t.length&&s<o&&t[r]===n[s];++r,++s);return n.slice(s).join(".")}function lq(i){return i.substring(0,1)+i.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}});var AA=S((LZ,cq)=>{cq.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var RA=S((BZ,dq)=>{dq.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var kA=S((VZ,uq)=>{uq.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var PA=S(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.addCommonProtos=Gr.loadProtosWithOptionsSync=Gr.loadProtosWithOptions=void 0;var MA=ge("fs"),OA=ge("path"),ya=Gh();function NA(i,e){let t=i.resolvePath;i.resolvePath=(n,r)=>{if(OA.isAbsolute(r))return r;for(let s of e){let o=OA.join(s,r);try{return MA.accessSync(o,MA.constants.R_OK),o}catch{continue}}return process.emitWarning(`${r} not found in any of the include paths ${e}`),t(n,r)}}function hq(i,e){return p(this,null,function*(){let t=new ya.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));NA(t,e.includeDirs)}let n=yield t.load(i,e);return n.resolveAll(),n})}Gr.loadProtosWithOptions=hq;function fq(i,e){let t=new ya.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");NA(t,e.includeDirs)}let n=t.loadSync(i,e);return n.resolveAll(),n}Gr.loadProtosWithOptionsSync=fq;function mq(){let i=AA(),e=i_(),t=RA(),n=kA();ya.common("api",i.nested.google.nested.protobuf.nested),ya.common("descriptor",e.nested.google.nested.protobuf.nested),ya.common("source_context",t.nested.google.nested.protobuf.nested),ya.common("type",n.nested.google.nested.protobuf.nested)}Gr.addCommonProtos=mq});var BA=S((LA,r_)=>{"use strict";var FA=function(i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(T,f,L){this.low=T|0,this.high=f|0,this.unsigned=!!L}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function n(T){return(T&&T.__isLong__)===!0}function r(T){var f=Math.clz32(T&-T);return T?31-f:f}t.isLong=n;var s={},o={};function a(T,f){var L,ce,Oe;return f?(T>>>=0,(Oe=0<=T&&T<256)&&(ce=o[T],ce)?ce:(L=c(T,0,!0),Oe&&(o[T]=L),L)):(T|=0,(Oe=-128<=T&&T<128)&&(ce=s[T],ce)?ce:(L=c(T,T<0?-1:0,!1),Oe&&(s[T]=L),L))}t.fromInt=a;function l(T,f){if(isNaN(T))return f?k:R;if(f){if(T<0)return k;if(T>=y)return Rt}else{if(T<=-A)return Te;if(T+1>=A)return ft}return T<0?l(-T,f).neg():c(T%_|0,T/_|0,f)}t.fromNumber=l;function c(T,f,L){return new t(T,f,L)}t.fromBits=c;var d=Math.pow;function u(T,f,L){if(T.length===0)throw Error("empty string");if(typeof f=="number"?(L=f,f=!1):f=!!f,T==="NaN"||T==="Infinity"||T==="+Infinity"||T==="-Infinity")return f?k:R;if(L=L||10,L<2||36<L)throw RangeError("radix");var ce;if((ce=T.indexOf("-"))>0)throw Error("interior hyphen");if(ce===0)return u(T.substring(1),f,L).neg();for(var Oe=l(d(L,8)),we=R,Xe=0;Xe<T.length;Xe+=8){var Ae=Math.min(8,T.length-Xe),$t=parseInt(T.substring(Xe,Xe+Ae),L);if(Ae<8){var rt=l(d(L,Ae));we=we.mul(rt).add(l($t))}else we=we.mul(Oe),we=we.add(l($t))}return we.unsigned=f,we}t.fromString=u;function h(T,f){return typeof T=="number"?l(T,f):typeof T=="string"?u(T,f):c(T.low,T.high,typeof f=="boolean"?f:T.unsigned)}t.fromValue=h;var m=65536,g=1<<24,_=m*m,y=_*_,A=y/2,w=a(g),R=a(0);t.ZERO=R;var k=a(0,!0);t.UZERO=k;var q=a(1);t.ONE=q;var K=a(1,!0);t.UONE=K;var ne=a(-1);t.NEG_ONE=ne;var ft=c(-1,2147483647,!1);t.MAX_VALUE=ft;var Rt=c(-1,-1,!0);t.MAX_UNSIGNED_VALUE=Rt;var Te=c(0,-2147483648,!1);t.MIN_VALUE=Te;var C=t.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*_+(this.low>>>0):this.high*_+(this.low>>>0)},C.toString=function(f){if(f=f||10,f<2||36<f)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Te)){var L=l(f),ce=this.div(L),Oe=ce.mul(L).sub(this);return ce.toString(f)+Oe.toInt().toString(f)}else return"-"+this.neg().toString(f);for(var we=l(d(f,6),this.unsigned),Xe=this,Ae="";;){var $t=Xe.div(we),rt=Xe.sub($t.mul(we)).toInt()>>>0,$e=rt.toString(f);if(Xe=$t,Xe.isZero())return $e+Ae;for(;$e.length<6;)$e="0"+$e;Ae=""+$e+Ae}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Te)?64:this.neg().getNumBitsAbs();for(var f=this.high!=0?this.high:this.low,L=31;L>0&&!(f&1<<L);L--);return this.high!=0?L+33:L+1},C.isZero=function(){return this.high===0&&this.low===0},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return(this.low&1)===1},C.isEven=function(){return(this.low&1)===0},C.equals=function(f){return n(f)||(f=h(f)),this.unsigned!==f.unsigned&&this.high>>>31===1&&f.high>>>31===1?!1:this.high===f.high&&this.low===f.low},C.eq=C.equals,C.notEquals=function(f){return!this.eq(f)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(f){return this.comp(f)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(f){return this.comp(f)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(f){return this.comp(f)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(f){return this.comp(f)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(f){if(n(f)||(f=h(f)),this.eq(f))return 0;var L=this.isNegative(),ce=f.isNegative();return L&&!ce?-1:!L&&ce?1:this.unsigned?f.high>>>0>this.high>>>0||f.high===this.high&&f.low>>>0>this.low>>>0?-1:1:this.sub(f).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(Te)?Te:this.not().add(q)},C.neg=C.negate,C.add=function(f){n(f)||(f=h(f));var L=this.high>>>16,ce=this.high&65535,Oe=this.low>>>16,we=this.low&65535,Xe=f.high>>>16,Ae=f.high&65535,$t=f.low>>>16,rt=f.low&65535,$e=0,kt=0,st=0,Ht=0;return Ht+=we+rt,st+=Ht>>>16,Ht&=65535,st+=Oe+$t,kt+=st>>>16,st&=65535,kt+=ce+Ae,$e+=kt>>>16,kt&=65535,$e+=L+Xe,$e&=65535,c(st<<16|Ht,$e<<16|kt,this.unsigned)},C.subtract=function(f){return n(f)||(f=h(f)),this.add(f.neg())},C.sub=C.subtract,C.multiply=function(f){if(this.isZero())return this;if(n(f)||(f=h(f)),e){var L=e.mul(this.low,this.high,f.low,f.high);return c(L,e.get_high(),this.unsigned)}if(f.isZero())return this.unsigned?k:R;if(this.eq(Te))return f.isOdd()?Te:R;if(f.eq(Te))return this.isOdd()?Te:R;if(this.isNegative())return f.isNegative()?this.neg().mul(f.neg()):this.neg().mul(f).neg();if(f.isNegative())return this.mul(f.neg()).neg();if(this.lt(w)&&f.lt(w))return l(this.toNumber()*f.toNumber(),this.unsigned);var ce=this.high>>>16,Oe=this.high&65535,we=this.low>>>16,Xe=this.low&65535,Ae=f.high>>>16,$t=f.high&65535,rt=f.low>>>16,$e=f.low&65535,kt=0,st=0,Ht=0,Mo=0;return Mo+=Xe*$e,Ht+=Mo>>>16,Mo&=65535,Ht+=we*$e,st+=Ht>>>16,Ht&=65535,Ht+=Xe*rt,st+=Ht>>>16,Ht&=65535,st+=Oe*$e,kt+=st>>>16,st&=65535,st+=we*rt,kt+=st>>>16,st&=65535,st+=Xe*$t,kt+=st>>>16,st&=65535,kt+=ce*$e+Oe*rt+we*$t+Xe*Ae,kt&=65535,c(Ht<<16|Mo,kt<<16|st,this.unsigned)},C.mul=C.multiply,C.divide=function(f){if(n(f)||(f=h(f)),f.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&f.low===-1&&f.high===-1)return this;var L=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,f.low,f.high);return c(L,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?k:R;var ce,Oe,we;if(this.unsigned){if(f.unsigned||(f=f.toUnsigned()),f.gt(this))return k;if(f.gt(this.shru(1)))return K;we=k}else{if(this.eq(Te)){if(f.eq(q)||f.eq(ne))return Te;if(f.eq(Te))return q;var Xe=this.shr(1);return ce=Xe.div(f).shl(1),ce.eq(R)?f.isNegative()?q:ne:(Oe=this.sub(f.mul(ce)),we=ce.add(Oe.div(f)),we)}else if(f.eq(Te))return this.unsigned?k:R;if(this.isNegative())return f.isNegative()?this.neg().div(f.neg()):this.neg().div(f).neg();if(f.isNegative())return this.div(f.neg()).neg();we=R}for(Oe=this;Oe.gte(f);){ce=Math.max(1,Math.floor(Oe.toNumber()/f.toNumber()));for(var Ae=Math.ceil(Math.log(ce)/Math.LN2),$t=Ae<=48?1:d(2,Ae-48),rt=l(ce),$e=rt.mul(f);$e.isNegative()||$e.gt(Oe);)ce-=$t,rt=l(ce,this.unsigned),$e=rt.mul(f);rt.isZero()&&(rt=q),we=we.add(rt),Oe=Oe.sub($e)}return we},C.div=C.divide,C.modulo=function(f){if(n(f)||(f=h(f)),e){var L=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,f.low,f.high);return c(L,e.get_high(),this.unsigned)}return this.sub(this.div(f).mul(f))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return c(~this.low,~this.high,this.unsigned)},C.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},C.clz=C.countLeadingZeros,C.countTrailingZeros=function(){return this.low?r(this.low):r(this.high)+32},C.ctz=C.countTrailingZeros,C.and=function(f){return n(f)||(f=h(f)),c(this.low&f.low,this.high&f.high,this.unsigned)},C.or=function(f){return n(f)||(f=h(f)),c(this.low|f.low,this.high|f.high,this.unsigned)},C.xor=function(f){return n(f)||(f=h(f)),c(this.low^f.low,this.high^f.high,this.unsigned)},C.shiftLeft=function(f){return n(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?c(this.low<<f,this.high<<f|this.low>>>32-f,this.unsigned):c(0,this.low<<f-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(f){return n(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?c(this.low>>>f|this.high<<32-f,this.high>>f,this.unsigned):c(this.high>>f-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(f){return n(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?c(this.low>>>f|this.high<<32-f,this.high>>>f,this.unsigned):f===32?c(this.high,0,this.unsigned):c(this.high>>>f-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.rotateLeft=function(f){var L;return n(f)&&(f=f.toInt()),(f&=63)===0?this:f===32?c(this.high,this.low,this.unsigned):f<32?(L=32-f,c(this.low<<f|this.high>>>L,this.high<<f|this.low>>>L,this.unsigned)):(f-=32,L=32-f,c(this.high<<f|this.low>>>L,this.low<<f|this.high>>>L,this.unsigned))},C.rotl=C.rotateLeft,C.rotateRight=function(f){var L;return n(f)&&(f=f.toInt()),(f&=63)===0?this:f===32?c(this.high,this.low,this.unsigned):f<32?(L=32-f,c(this.high<<L|this.low>>>f,this.low<<L|this.high>>>f,this.unsigned)):(f-=32,L=32-f,c(this.low<<L|this.high>>>f,this.high<<L|this.low>>>f,this.unsigned))},C.rotr=C.rotateRight,C.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},C.toBytes=function(f){return f?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var f=this.high,L=this.low;return[L&255,L>>>8&255,L>>>16&255,L>>>24,f&255,f>>>8&255,f>>>16&255,f>>>24]},C.toBytesBE=function(){var f=this.high,L=this.low;return[f>>>24,f>>>16&255,f>>>8&255,f&255,L>>>24,L>>>16&255,L>>>8&255,L&255]},t.fromBytes=function(f,L,ce){return ce?t.fromBytesLE(f,L):t.fromBytesBE(f,L)},t.fromBytesLE=function(f,L){return new t(f[0]|f[1]<<8|f[2]<<16|f[3]<<24,f[4]|f[5]<<8|f[6]<<16|f[7]<<24,L)},t.fromBytesBE=function(f,L){return new t(f[4]<<24|f[5]<<16|f[6]<<8|f[7],f[0]<<24|f[1]<<16|f[2]<<8|f[3],L)};var Ge=t;return i.default=Ge,"default"in i?i.default:i}({});typeof define=="function"&&define.amd?define([],function(){return FA}):typeof r_=="object"&&typeof LA=="object"&&(r_.exports=FA)});var l_=S(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.loadFileDescriptorSetFromObject=qt.loadFileDescriptorSetFromBuffer=qt.fromJSON=qt.loadSync=qt.load=qt.isAnyExtension=qt.Long=void 0;var pq=TI(),Nn=Gh(),o_=DA(),a_=PA(),gq=BA();qt.Long=gq;function yq(i){return"@type"in i&&typeof i["@type"]=="string"}qt.isAnyExtension=yq;var qA={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function vq(i,e){return i===""?e:i+"."+e}function _q(i){return i instanceof Nn.Service||i instanceof Nn.Type||i instanceof Nn.Enum}function bq(i){return i instanceof Nn.Namespace||i instanceof Nn.Root}function zA(i,e){let t=vq(e,i.name);return _q(i)?[[t,i]]:bq(i)&&typeof i.nested<"u"?Object.keys(i.nested).map(n=>zA(i.nested[n],t)).reduce((n,r)=>n.concat(r),[]):[]}function VA(i,e){return function(n){return i.toObject(i.decode(n),e)}}function UA(i){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${i.name} structure, got array instead`);let n=i.fromObject(t);return i.encode(n).finish()}}function wq(i,e,t,n){let r=i.resolvedRequestType,s=i.resolvedResponseType;return{path:"/"+e+"/"+i.name,requestStream:!!i.requestStream,responseStream:!!i.responseStream,requestSerialize:UA(r),requestDeserialize:VA(r,t),responseSerialize:UA(s),responseDeserialize:VA(s,t),originalName:pq(i.name),requestType:s_(r,n),responseType:s_(s,n)}}function Sq(i,e,t,n){let r={};for(let s of i.methodsArray)r[s.name]=wq(s,e,t,n);return r}function s_(i,e){let t=i.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:t.$type.toObject(t,qA),fileDescriptorProtos:e}}function Eq(i,e){let t=i.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:t.$type.toObject(t,qA),fileDescriptorProtos:e}}function Cq(i,e,t,n){if(i instanceof Nn.Service)return Sq(i,e,t,n);if(i instanceof Nn.Type)return s_(i,n);if(i instanceof Nn.Enum)return Eq(i,n);throw new Error("Type mismatch in reflection object handling")}function Wh(i,e){let t={};i.resolveAll();let r=i.toDescriptor("proto3").file.map(s=>Buffer.from(o_.FileDescriptorProto.encode(s).finish()));for(let[s,o]of zA(i,""))t[s]=Cq(o,s,e,r);return t}function jA(i,e){e=e||{};let t=Nn.Root.fromDescriptor(i);return t.resolveAll(),Wh(t,e)}function Tq(i,e){return(0,a_.loadProtosWithOptions)(i,e).then(t=>Wh(t,e))}qt.load=Tq;function xq(i,e){let t=(0,a_.loadProtosWithOptionsSync)(i,e);return Wh(t,e)}qt.loadSync=xq;function Iq(i,e){e=e||{};let t=Nn.Root.fromJSON(i);return t.resolveAll(),Wh(t,e)}qt.fromJSON=Iq;function Dq(i,e){let t=o_.FileDescriptorSet.decode(i);return jA(t,e)}qt.loadFileDescriptorSetFromBuffer=Dq;function Aq(i,e){let t=o_.FileDescriptorSet.fromObject(i);return jA(t,e)}qt.loadFileDescriptorSetFromObject=Aq;(0,a_.addCommonProtos)()});var Ks=S(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.setup=Ne.getChannelzServiceDefinition=Ne.getChannelzHandlers=Ne.unregisterChannelzRef=Ne.registerChannelzSocket=Ne.registerChannelzServer=Ne.registerChannelzSubchannel=Ne.registerChannelzChannel=Ne.ChannelzCallTracker=Ne.ChannelzChildrenTracker=Ne.ChannelzTrace=void 0;var GA=ge("net"),kc=Di(),Oc=he(),Rq=Tn(),kq=mh(),Mq=sv();function c_(i){return{channel_id:i.id,name:i.name}}function f_(i){return{subchannel_id:i.id,name:i.name}}function Oq(i){return{server_id:i.id}}function Qh(i){return{socket_id:i.id,name:i.name}}var $A=32,d_=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,n){let r=new Date;this.events.push({description:t,severity:e,timestamp:r,childChannel:n?.kind==="channel"?n:void 0,childSubchannel:n?.kind==="subchannel"?n:void 0}),this.events.length>=$A*2&&(this.events=this.events.slice($A)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:or(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:or(e.timestamp),channel_ref:e.childChannel?c_(e.childChannel):null,subchannel_ref:e.childSubchannel?f_(e.childSubchannel):null}))}}};Ne.ChannelzTrace=d_;var u_=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,n,r;switch(e.kind){case"channel":{let s=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(n=this.subchannelChildren.get(e.id))!==null&&n!==void 0?n:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(r=this.socketChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){let e=[];for(let{ref:r}of this.channelChildren.values())e.push(r);let t=[];for(let{ref:r}of this.subchannelChildren.values())t.push(r);let n=[];for(let{ref:r}of this.socketChildren.values())n.push(r);return{channels:e,subchannels:t,sockets:n}}};Ne.ChannelzChildrenTracker=u_;var h_=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};Ne.ChannelzCallTracker=h_;var Nq=1;function Yh(){return Nq++}var Mc=[],m_=[],$r=[],p_=[];function Pq(i,e,t){let n=Yh(),r={id:n,name:i,kind:"channel"};return t&&(Mc[n]={ref:r,getInfo:e}),r}Ne.registerChannelzChannel=Pq;function Fq(i,e,t){let n=Yh(),r={id:n,name:i,kind:"subchannel"};return t&&(m_[n]={ref:r,getInfo:e}),r}Ne.registerChannelzSubchannel=Fq;function Lq(i,e){let t=Yh(),n={id:t,kind:"server"};return e&&($r[t]={ref:n,getInfo:i}),n}Ne.registerChannelzServer=Lq;function Bq(i,e,t){let n=Yh(),r={id:n,name:i,kind:"socket"};return t&&(p_[n]={ref:r,getInfo:e}),r}Ne.registerChannelzSocket=Bq;function Vq(i){switch(i.kind){case"channel":delete Mc[i.id];return;case"subchannel":delete m_[i.id];return;case"server":delete $r[i.id];return;case"socket":delete p_[i.id];return}}Ne.unregisterChannelzRef=Vq;function Uq(i){let e=Number.parseInt(i,16);return[e/256|0,e%256]}function HA(i){if(i==="")return[];let e=i.split(":").map(n=>Uq(n));return[].concat(...e)}function qq(i){if((0,GA.isIPv4)(i))return Buffer.from(Uint8Array.from(i.split(".").map(e=>Number.parseInt(e))));if((0,GA.isIPv6)(i)){let e,t,n=i.indexOf("::");n===-1?(e=i,t=""):(e=i.substring(0,n),t=i.substring(n+2));let r=Buffer.from(HA(e)),s=Buffer.from(HA(t)),o=Buffer.alloc(16-r.length-s.length,0);return Buffer.concat([r,o,s])}else return null}function KA(i){switch(i){case kc.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case kc.ConnectivityState.IDLE:return{state:"IDLE"};case kc.ConnectivityState.READY:return{state:"READY"};case kc.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case kc.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function or(i){if(!i)return null;let e=i.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function QA(i){let e=i.getInfo();return{ref:c_(i.ref),data:{target:e.target,state:KA(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:or(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(t=>c_(t)),subchannel_ref:e.children.subchannels.map(t=>f_(t))}}function zq(i,e){let t=Number.parseInt(i.request.channel_id),n=Mc[t];if(n===void 0){e({code:Oc.Status.NOT_FOUND,details:"No channel data found for id "+t});return}e(null,{channel:QA(n)})}function jq(i,e){let t=Number.parseInt(i.request.max_results),n=[],r=Number.parseInt(i.request.start_channel_id);for(;r<Mc.length;r++){let s=Mc[r];if(s!==void 0&&(n.push(QA(s)),n.length>=t))break}e(null,{channel:n,end:r>=$r.length})}function YA(i){let e=i.getInfo();return{ref:Oq(i.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:or(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(t=>Qh(t))}}function Gq(i,e){let t=Number.parseInt(i.request.server_id),n=$r[t];if(n===void 0){e({code:Oc.Status.NOT_FOUND,details:"No server data found for id "+t});return}e(null,{server:YA(n)})}function $q(i,e){let t=Number.parseInt(i.request.max_results),n=[],r=Number.parseInt(i.request.start_server_id);for(;r<$r.length;r++){let s=$r[r];if(s!==void 0&&(n.push(YA(s)),n.length>=t))break}e(null,{server:n,end:r>=$r.length})}function Hq(i,e){let t=Number.parseInt(i.request.subchannel_id),n=m_[t];if(n===void 0){e({code:Oc.Status.NOT_FOUND,details:"No subchannel data found for id "+t});return}let r=n.getInfo(),s={ref:f_(n.ref),data:{target:r.target,state:KA(r.state),calls_started:r.callTracker.callsStarted,calls_succeeded:r.callTracker.callsSucceeded,calls_failed:r.callTracker.callsFailed,last_call_started_timestamp:or(r.callTracker.lastCallStartedTimestamp),trace:r.trace.getTraceMessage()},socket_ref:r.children.sockets.map(o=>Qh(o))};e(null,{subchannel:s})}function WA(i){var e;return(0,Rq.isTcpSubchannelAddress)(i)?{address:"tcpip_address",tcpip_address:{ip_address:(e=qq(i.host))!==null&&e!==void 0?e:void 0,port:i.port}}:{address:"uds_address",uds_address:{filename:i.path}}}function Wq(i,e){var t,n,r,s,o;let a=Number.parseInt(i.request.socket_id),l=p_[a];if(l===void 0){e({code:Oc.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let c=l.getInfo(),d=c.security?{model:"tls",tls:{cipher_suite:c.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(t=c.security.cipherSuiteStandardName)!==null&&t!==void 0?t:void 0,other_name:(n=c.security.cipherSuiteOtherName)!==null&&n!==void 0?n:void 0,local_certificate:(r=c.security.localCertificate)!==null&&r!==void 0?r:void 0,remote_certificate:(s=c.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,u={ref:Qh(l.ref),local:c.localAddress?WA(c.localAddress):null,remote:c.remoteAddress?WA(c.remoteAddress):null,remote_name:(o=c.remoteName)!==null&&o!==void 0?o:void 0,security:d,data:{keep_alives_sent:c.keepAlivesSent,streams_started:c.streamsStarted,streams_succeeded:c.streamsSucceeded,streams_failed:c.streamsFailed,last_local_stream_created_timestamp:or(c.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:or(c.lastRemoteStreamCreatedTimestamp),messages_received:c.messagesReceived,messages_sent:c.messagesSent,last_message_received_timestamp:or(c.lastMessageReceivedTimestamp),last_message_sent_timestamp:or(c.lastMessageSentTimestamp),local_flow_control_window:c.localFlowControlWindow?{value:c.localFlowControlWindow}:null,remote_flow_control_window:c.remoteFlowControlWindow?{value:c.remoteFlowControlWindow}:null}};e(null,{socket:u})}function Kq(i,e){let t=Number.parseInt(i.request.server_id),n=$r[t];if(n===void 0){e({code:Oc.Status.NOT_FOUND,details:"No server data found for id "+t});return}let r=Number.parseInt(i.request.start_socket_id),s=Number.parseInt(i.request.max_results),a=n.getInfo().sessionChildren.sockets.sort((d,u)=>d.id-u.id),l=[],c=0;for(;c<a.length&&!(a[c].id>=r&&(l.push(Qh(a[c])),l.length>=s));c++);e(null,{socket_ref:l,end:c>=a.length})}function XA(){return{GetChannel:zq,GetTopChannels:jq,GetServer:Gq,GetServers:$q,GetSubchannel:Hq,GetSocket:Wq,GetServerSockets:Kq}}Ne.getChannelzHandlers=XA;var Kh=null;function ZA(){if(Kh)return Kh;let i=l_().loadSync,e=i("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return Kh=(0,Mq.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,Kh}Ne.getChannelzServiceDefinition=ZA;function Qq(){(0,kq.registerAdminService)(ZA,XA)}Ne.setup=Qq});var JA=S(Zh=>{"use strict";Object.defineProperty(Zh,"__esModule",{value:!0});Zh.Subchannel=void 0;var Ie=Di(),Yq=hc(),g_=Ke(),Xh=he(),Xq=yi(),Zq=Tn(),va=Ks(),Jq="subchannel",ez=~(1<<31),y_=class{constructor(e,t,n,r,s){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=n,this.credentials=r,this.connector=s,this.connectivityState=Ie.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new va.ChannelzCallTracker,this.childrenTracker=new va.ChannelzChildrenTracker,this.streamTracker=new va.ChannelzCallTracker;let a={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new Yq.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,Zq.subchannelAddressToString)(t),this.keepaliveTime=(o=n["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,n["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new va.ChannelzTrace,this.channelzRef=(0,va.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(n,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){g_.trace(Xh.LogVerbosity.DEBUG,Jq,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){g_.trace(Xh.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([Ie.ConnectivityState.TRANSIENT_FAILURE],Ie.ConnectivityState.CONNECTING):this.transitionToState([Ie.ConnectivityState.TRANSIENT_FAILURE],Ie.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,ez);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(t=>{this.transitionToState([Ie.ConnectivityState.CONNECTING],Ie.ConnectivityState.READY)&&(this.transport=t,this.channelzEnabled&&this.childrenTracker.refChild(t.getChannelzRef()),t.addDisconnectListener(n=>{this.transitionToState([Ie.ConnectivityState.READY],Ie.ConnectivityState.IDLE),n&&this.keepaliveTime>0&&(this.keepaliveTime*=2,g_.log(Xh.LogVerbosity.ERROR,`Connection to ${(0,Xq.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))}))},t=>{this.transitionToState([Ie.ConnectivityState.CONNECTING],Ie.ConnectivityState.TRANSIENT_FAILURE,`${t}`)})}transitionToState(e,t,n){var r,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(Ie.ConnectivityState[this.connectivityState]+" -> "+Ie.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Ie.ConnectivityState[t]);let o=this.connectivityState;switch(this.connectivityState=t,t){case Ie.ConnectivityState.READY:this.stopBackoff();break;case Ie.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case Ie.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(r=this.transport)===null||r===void 0||r.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case Ie.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let a of this.stateListeners)a(this,o,t,this.keepaliveTime,n);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,va.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([Ie.ConnectivityState.CONNECTING,Ie.ConnectivityState.READY],Ie.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,t,n,r){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:o=>{o.code===Xh.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,t,n,r,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([Ie.ConnectivityState.IDLE],Ie.ConnectivityState.CONNECTING)||this.connectivityState===Ie.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([Ie.ConnectivityState.TRANSIENT_FAILURE],Ie.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};Zh.Subchannel=y_});var w_=S(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.setup=Kr.DEFAULT_PORT=void 0;var eR=En(),iR=ge("dns"),nR=ge("util"),tz=My(),v_=he(),__=Zt(),iz=Ke(),nz=he(),Hr=yi(),tR=ge("net"),rz=hc(),sz="dns_resolver";function Wr(i){iz.trace(nz.LogVerbosity.DEBUG,sz,i)}Kr.DEFAULT_PORT=443;var oz=3e4,az=nR.promisify(iR.resolveTxt),lz=nR.promisify(iR.lookup);function cz(...i){let e=[];for(let t=0;t<Math.max.apply(null,i.map(n=>n.length));t++)for(let n of i)t<n.length&&e.push(n[t]);return e}var b_=class{constructor(e,t,n){var r,s,o;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,Wr("Resolver constructed for target "+(0,Hr.uriToString)(e));let a=(0,Hr.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,tR.isIPv4)(a.host)||(0,tR.isIPv6)(a.host)?(this.ipResult=[{host:a.host,port:(r=a.port)!==null&&r!==void 0?r:Kr.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(s=a.port)!==null&&s!==void 0?s:Kr.DEFAULT_PORT),this.percentage=Math.random()*100,n["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:v_.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,Hr.uriToString)(this.target)}`,metadata:new __.Metadata};let l={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoff=new rz.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},l),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=n["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:oz,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(Wr("Returning IP address for target "+(0,Hr.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)Wr("Failed to parse DNS address "+(0,Hr.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:v_.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,Hr.uriToString)(this.target)}`,metadata:new __.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;Wr("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=lz(e,{all:!0}),this.pendingLookupPromise.then(t=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let n=t.filter(o=>o.family===4),r=t.filter(o=>o.family===6);this.latestLookupResult=cz(r,n).map(o=>({host:o.address,port:+this.port}));let s="["+this.latestLookupResult.map(o=>o.host+":"+o.port).join(",")+"]";if(Wr("Resolved addresses for target "+(0,Hr.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{this.pendingLookupPromise!==null&&(Wr("Resolution error for target "+(0,Hr.uriToString)(this.target)+": "+t.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=az(e),this.pendingTxtPromise.then(t=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,tz.extractAndSelectServiceConfig)(t,this.percentage)}catch(n){this.latestServiceConfigError={code:v_.Status.UNAVAILABLE,details:`Parsing service config failed with error ${n.message}`,metadata:new __.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},t=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?Wr('resolution update delayed by "min time between resolutions" rate limit'):Wr("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function dz(){(0,eR.registerResolver)("dns",b_),(0,eR.registerDefaultScheme)("dns")}Kr.setup=dz});var S_=S(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.getProxiedConnection=wa.mapProxyName=void 0;var Nc=Ke(),_a=he(),uz=En(),hz=ge("http"),fz=ge("tls"),mz=Ke(),rR=Tn(),ba=yi(),pz=ge("url"),gz=w_(),yz="proxy";function Qr(i){mz.trace(_a.LogVerbosity.DEBUG,yz,i)}function vz(){let i="",e="";if(process.env.grpc_proxy)e="grpc_proxy",i=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",i=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",i=process.env.http_proxy;else return{};let t;try{t=new pz.URL(i)}catch{return(0,Nc.log)(_a.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(t.protocol!=="http:")return(0,Nc.log)(_a.LogVerbosity.ERROR,`"${t.protocol}" scheme not supported in proxy URI`),{};let n=null;t.username&&(t.password?((0,Nc.log)(_a.LogVerbosity.INFO,"userinfo found in proxy URI"),n=`${t.username}:${t.password}`):n=t.username);let r=t.hostname,s=t.port;s===""&&(s="80");let o={address:`${r}:${s}`};return n&&(o.creds=n),Qr("Proxy server "+o.address+" set by environment variable "+e),o}function _z(){let i=process.env.no_grpc_proxy,e="no_grpc_proxy";return i||(i=process.env.no_proxy,e="no_proxy"),i?(Qr("No proxy server list set by environment variable "+e),i.split(",")):[]}function bz(i,e){var t;let n={target:i,extraOptions:{}};if(((t=e["grpc.enable_http_proxy"])!==null&&t!==void 0?t:1)===0||i.scheme==="unix")return n;let r=vz();if(!r.address)return n;let s=(0,ba.splitHostPort)(i.path);if(!s)return n;let o=s.host;for(let l of _z())if(l===o)return Qr("Not using proxy for target in no_proxy list: "+(0,ba.uriToString)(i)),n;let a={"grpc.http_connect_target":(0,ba.uriToString)(i)};return r.creds&&(a["grpc.http_connect_creds"]=r.creds),{target:{scheme:"dns",path:r.address},extraOptions:a}}wa.mapProxyName=bz;function wz(i,e,t){var n;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let r=e["grpc.http_connect_target"],s=(0,ba.parseUri)(r);if(s===null)return Promise.resolve({});let o=(0,ba.splitHostPort)(s.path);if(o===null)return Promise.resolve({});let a=`${o.host}:${(n=o.port)!==null&&n!==void 0?n:gz.DEFAULT_PORT}`,l={method:"CONNECT",path:a},c={Host:a};(0,rR.isTcpSubchannelAddress)(i)?(l.host=i.host,l.port=i.port):l.socketPath=i.path,"grpc.http_connect_creds"in e&&(c["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),l.headers=c;let d=(0,rR.subchannelAddressToString)(i);return Qr("Using proxy "+d+" to connect to "+l.path),new Promise((u,h)=>{let m=hz.request(l);m.once("connect",(g,_,y)=>{var A;if(m.removeAllListeners(),_.removeAllListeners(),g.statusCode===200)if(Qr("Successfully connected to "+l.path+" through proxy "+d),"secureContext"in t){let w=(0,uz.getDefaultAuthority)(s),R=(0,ba.splitHostPort)(w),k=(A=R?.host)!==null&&A!==void 0?A:w,q=fz.connect(Object.assign({host:k,servername:k,socket:_},t),()=>{Qr("Successfully established a TLS connection to "+l.path+" through proxy "+d),u({socket:q,realTarget:s})});q.on("error",K=>{Qr("Failed to establish a TLS connection to "+l.path+" through proxy "+d+" with error "+K.message),h()})}else Qr("Successfully established a plaintext connection to "+l.path+" through proxy "+d),u({socket:_,realTarget:s});else(0,Nc.log)(_a.LogVerbosity.ERROR,"Failed to connect to "+l.path+" through proxy "+d+" with status "+g.statusCode),h()}),m.once("error",g=>{m.removeAllListeners(),(0,Nc.log)(_a.LogVerbosity.ERROR,"Failed to connect to proxy "+d+" with error "+g.message),h()}),m.end()})}wa.getProxiedConnection=wz});var C_=S(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.StreamDecoder=void 0;var ar=function(i){return i[i.NO_DATA=0]="NO_DATA",i[i.READING_SIZE=1]="READING_SIZE",i[i.READING_MESSAGE=2]="READING_MESSAGE",i}(ar||{}),E_=class{constructor(){this.readState=ar.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t=0,n,r=[];for(;t<e.length;)switch(this.readState){case ar.NO_DATA:this.readCompressFlag=e.slice(t,t+1),t+=1,this.readState=ar.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case ar.READING_SIZE:if(n=Math.min(e.length-t,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+n),this.readSizeRemaining-=n,t+=n,this.readSizeRemaining===0)if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=ar.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=ar.NO_DATA,r.push(s)}break;case ar.READING_MESSAGE:if(n=Math.min(e.length-t,this.readMessageRemaining),this.readPartialMessage.push(e.slice(t,t+n)),this.readMessageRemaining-=n,t+=n,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(s,this.readMessageSize+5);this.readState=ar.NO_DATA,r.push(o)}break;default:throw new Error("Unexpected read state")}return r}};Jh.StreamDecoder=E_});var sR=S(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});ef.Http2SubchannelCall=void 0;var lr=ge("http2"),Sz=ge("os"),Ee=he(),Yr=Zt(),Ez=C_(),Cz=Ke(),Tz=he(),xz="subchannel_call";function Iz(i){for(let[e,t]of Object.entries(Sz.constants.errno))if(t===i)return e;return"Unknown system error "+i}var T_=class{constructor(e,t,n,r,s){this.http2Stream=e,this.callEventTracker=t,this.listener=n,this.transport=r,this.callId=s,this.decoder=new Ez.StreamDecoder,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=Ee.Status.UNKNOWN,this.finalStatus=null,this.internalError=null,e.on("response",(o,a)=>{let l="";for(let c of Object.keys(o))l+="		"+c+": "+o[c]+`
`;switch(this.trace(`Received server headers:
`+l),o[":status"]){case 400:this.mappedStatusCode=Ee.Status.INTERNAL;break;case 401:this.mappedStatusCode=Ee.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=Ee.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=Ee.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=Ee.Status.UNAVAILABLE;break;default:this.mappedStatusCode=Ee.Status.UNKNOWN}if(a&lr.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(o);else{let c;try{c=Yr.Metadata.fromHttp2Headers(o)}catch(d){this.endCall({code:Ee.Status.UNKNOWN,details:d.message,metadata:new Yr.Metadata});return}this.listener.onReceiveMetadata(c)}}),e.on("trailers",o=>{this.handleTrailers(o)}),e.on("data",o=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+o.length);let a=this.decoder.write(o);for(let l of a)this.trace("parsed message of length "+l.length),this.callEventTracker.addMessageReceived(),this.tryPush(l)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var o;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((o=this.finalStatus)===null||o===void 0?void 0:o.code)===Ee.Status.OK)return;let a,l="";switch(e.rstCode){case lr.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;a=Ee.Status.INTERNAL,l=`Received RST_STREAM with code ${e.rstCode}`;break;case lr.constants.NGHTTP2_REFUSED_STREAM:a=Ee.Status.UNAVAILABLE,l="Stream refused by server";break;case lr.constants.NGHTTP2_CANCEL:a=Ee.Status.CANCELLED,l="Call cancelled";break;case lr.constants.NGHTTP2_ENHANCE_YOUR_CALM:a=Ee.Status.RESOURCE_EXHAUSTED,l="Bandwidth exhausted or memory limit exceeded";break;case lr.constants.NGHTTP2_INADEQUATE_SECURITY:a=Ee.Status.PERMISSION_DENIED,l="Protocol not secure enough";break;case lr.constants.NGHTTP2_INTERNAL_ERROR:a=Ee.Status.INTERNAL,this.internalError===null?l=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(a=Ee.Status.UNAVAILABLE,l=this.internalError.message):l=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:a=Ee.Status.INTERNAL,l=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:a,details:l,metadata:new Yr.Metadata,rstCode:e.rstCode})})}),e.on("error",o=>{o.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+o.message+" code="+o.code+" errno="+Iz(o.errno)+" syscall="+o.syscall),this.internalError=o),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:Ee.Status.UNAVAILABLE,details:"Connection dropped",metadata:new Yr.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){Cz.trace(Tz.LogVerbosity.DEBUG,xz,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===Ee.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==Ee.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let t="";for(let l of Object.keys(e))t+="		"+l+": "+e[l]+`
`;this.trace(`Received server trailers:
`+t);let n;try{n=Yr.Metadata.fromHttp2Headers(e)}catch{n=new Yr.Metadata}let r=n.getMap(),s=this.mappedStatusCode;if(s===Ee.Status.UNKNOWN&&typeof r["grpc-status"]=="string"){let l=Number(r["grpc-status"]);l in Ee.Status&&(s=l,this.trace("received status code "+l+" from server")),n.remove("grpc-status")}let o="";if(typeof r["grpc-message"]=="string"){try{o=decodeURI(r["grpc-message"])}catch{o=r["grpc-message"]}n.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let a={code:s,details:o,metadata:n};this.endCall(a)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===Ee.Status.OK?t=lr.constants.NGHTTP2_NO_ERROR:t=lr.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new Yr.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==Ee.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let n=r=>{process.nextTick(()=>{var s;let o=Ee.Status.UNAVAILABLE;r?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=Ee.Status.INTERNAL),r&&this.cancelWithStatus(o,`Write error: ${r.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,n)}catch(r){this.endCall({code:Ee.Status.UNAVAILABLE,details:`Write failed with error ${r.message}`,metadata:new Yr.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};ef.Http2SubchannelCall=T_});var x_=S(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});tf.getNextCallNumber=void 0;var Dz=0;function Az(){return Dz++}tf.getNextCallNumber=Az});var lR=S(rf=>{"use strict";Object.defineProperty(rf,"__esModule",{value:!0});rf.Http2SubchannelConnector=void 0;var k_=ge("http2"),oR=ge("tls"),I_=Ks(),Pc=he(),Rz=S_(),Ea=Ke(),aR=En(),nf=Tn(),Sa=yi(),kz=ge("net"),Mz=sR(),Oz=x_(),D_="transport",Nz="transport_flowctrl",Pz=my().version,{HTTP2_HEADER_AUTHORITY:Fz,HTTP2_HEADER_CONTENT_TYPE:Lz,HTTP2_HEADER_METHOD:Bz,HTTP2_HEADER_PATH:Vz,HTTP2_HEADER_TE:Uz,HTTP2_HEADER_USER_AGENT:qz}=k_.constants,zz=2e4,jz=Buffer.from("too_many_pings","ascii"),A_=class{constructor(e,t,n,r){this.session=e,this.remoteName=r,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=zz,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new I_.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,nf.subchannelAddressToString)(t),n["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,I_.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[n["grpc.primary_user_agent"],`grpc-node-js/${Pz}`,n["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in n&&(this.keepaliveTimeMs=n["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in n&&(this.keepaliveTimeoutMs=n["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in n?this.keepaliveWithoutCalls=n["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,o,a)=>{let l=!1;s===k_.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(jz)&&(l=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+a?.toString()),this.reportDisconnectToOwner(l)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),Ea.isTracerEnabled(D_)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,n;let r=this.session.socket,s=r.remoteAddress?(0,nf.stringToSubchannelAddress)(r.remoteAddress,r.remotePort):null,o=r.localAddress?(0,nf.stringToSubchannelAddress)(r.localAddress,r.localPort):null,a;if(this.session.encrypted){let c=r,d=c.getCipher(),u=c.getCertificate(),h=c.getPeerCertificate();a={cipherSuiteStandardName:(e=d.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:d.standardName?null:d.name,localCertificate:u&&"raw"in u?u.raw:null,remoteCertificate:h&&"raw"in h?h.raw:null}}else a=null;return{remoteAddress:s,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(n=this.session.state.remoteWindowSize)!==null&&n!==void 0?n:null}}trace(e){Ea.trace(Pc.LogVerbosity.DEBUG,D_,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){Ea.trace(Pc.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){Ea.trace(Pc.LogVerbosity.DEBUG,Nz,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){Ea.trace(Pc.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0||t.call(e));try{this.session.ping((n,r,s)=>{n&&(this.keepaliveTrace("Ping failed with error "+n.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||t===void 0?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,n,r,s){let o=e.toHttp2Headers();o[Fz]=t,o[qz]=this.userAgent,o[Lz]="application/grpc",o[Bz]="POST",o[Vz]=n,o[Uz]="trailers";let a;try{a=this.session.request(o)}catch(d){throw this.handleDisconnect(),d}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let l,c;return this.channelzEnabled?(this.streamTracker.addCallStarted(),l={addMessageSent:()=>{var d;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(d=s.addMessageSent)===null||d===void 0||d.call(s)},addMessageReceived:()=>{var d;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(d=s.addMessageReceived)===null||d===void 0||d.call(s)},onCallEnd:d=>{var u;(u=s.onCallEnd)===null||u===void 0||u.call(s,d),this.removeActiveCall(c)},onStreamEnd:d=>{var u;d?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(u=s.onStreamEnd)===null||u===void 0||u.call(s,d)}}):l={addMessageSent:()=>{var d;(d=s.addMessageSent)===null||d===void 0||d.call(s)},addMessageReceived:()=>{var d;(d=s.addMessageReceived)===null||d===void 0||d.call(s)},onCallEnd:d=>{var u;(u=s.onCallEnd)===null||u===void 0||u.call(s,d),this.removeActiveCall(c)},onStreamEnd:d=>{var u;(u=s.onStreamEnd)===null||u===void 0||u.call(s,d)}},c=new Mz.Http2SubchannelCall(a,l,r,this,(0,Oz.getNextCallNumber)()),this.addActiveCall(c),c}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}shutdown(){this.session.close(),(0,I_.unregisterChannelzRef)(this.channelzRef)}},R_=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){Ea.trace(Pc.LogVerbosity.DEBUG,D_,(0,Sa.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,n,r){return this.isShutdown?Promise.reject():new Promise((s,o)=>{var a,l,c;let d;r.realTarget?(d=(0,Sa.uriToString)(r.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,Sa.uriToString)(r.realTarget))):(d=null,this.trace("creating HTTP/2 session to "+(0,nf.subchannelAddressToString)(e)));let u=(0,aR.getDefaultAuthority)((a=r.realTarget)!==null&&a!==void 0?a:this.channelTarget),h=t._getConnectionOptions()||{};h.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in n?h.maxSessionMemory=n["grpc-node.max_session_memory"]:h.maxSessionMemory=Number.MAX_SAFE_INTEGER;let m="http://";if("secureContext"in h){if(m="https://",n["grpc.ssl_target_name_override"]){let y=n["grpc.ssl_target_name_override"];h.checkServerIdentity=(A,w)=>(0,oR.checkServerIdentity)(y,w),h.servername=y}else{let y=(c=(l=(0,Sa.splitHostPort)(u))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";h.servername=y}r.socket&&(h.createConnection=(y,A)=>r.socket)}else h.createConnection=(y,A)=>r.socket?r.socket:kz.connect(e);h=Object.assign(Object.assign(Object.assign({},h),e),{enableTrace:n["grpc-node.tls_enable_trace"]===1});let g=k_.connect(m+u,h);this.session=g;let _="Failed to connect";g.unref(),g.once("connect",()=>{g.removeAllListeners(),s(new A_(g,e,n,d)),this.session=null}),g.once("close",()=>{this.session=null,setImmediate(()=>{o(`${_} (${new Date().toISOString()})`)})}),g.once("error",y=>{_=y.message,this.trace("connection failed with error "+_)})})}connect(e,t,n){var r,s;if(this.isShutdown)return Promise.reject();let o=t._getConnectionOptions()||{};if("secureContext"in o){if(o.ALPNProtocols=["h2"],n["grpc.ssl_target_name_override"]){let a=n["grpc.ssl_target_name_override"];o.checkServerIdentity=(l,c)=>(0,oR.checkServerIdentity)(a,c),o.servername=a}else if("grpc.http_connect_target"in n){let a=(0,aR.getDefaultAuthority)((r=(0,Sa.parseUri)(n["grpc.http_connect_target"]))!==null&&r!==void 0?r:{path:"localhost"}),l=(0,Sa.splitHostPort)(a);o.servername=(s=l?.host)!==null&&s!==void 0?s:a}n["grpc-node.tls_enable_trace"]&&(o.enableTrace=!0)}return(0,Rz.getProxiedConnection)(e,n,o).then(a=>this.createSession(e,t,n,a))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};rf.Http2SubchannelConnector=R_});var cR=S(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.getSubchannelPool=Ca.SubchannelPool=void 0;var Gz=Wx(),$z=JA(),Hz=Tn(),Wz=yi(),Kz=lR(),Qz=1e4,Fc=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let r=this.pool[t].filter(s=>!s.subchannel.unrefIfOneRef());r.length>0&&(e=!1),this.pool[t]=r}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},Qz),(t=(e=this.cleanupTimer).unref)===null||t===void 0||t.call(e))}getOrCreateSubchannel(e,t,n,r){this.ensureCleanupTask();let s=(0,Wz.uriToString)(e);if(s in this.pool){let a=this.pool[s];for(let l of a)if((0,Hz.subchannelAddressEqual)(t,l.subchannelAddress)&&(0,Gz.channelOptionsEqual)(n,l.channelArguments)&&r._equals(l.channelCredentials))return l.subchannel}let o=new $z.Subchannel(e,t,n,r,new Kz.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:t,channelArguments:n,channelCredentials:r,subchannel:o}),o.ref(),o}};Ca.SubchannelPool=Fc;var Yz=new Fc;function Xz(i){return i?Yz:new Fc}Ca.getSubchannelPool=Xz});var O_=S(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.FilterStackFactory=Ta.FilterStack=void 0;var sf=class{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let n=0;n<this.filters.length;n++)t=this.filters[n].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let n=this.filters.length-1;n>=0;n--)t=this.filters[n].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let n=0;n<this.filters.length;n++)t=this.filters[n].sendMessage(t);return t}receiveMessage(e){let t=e;for(let n=this.filters.length-1;n>=0;n--)t=this.filters[n].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let n=this.filters.length-1;n>=0;n--)t=this.filters[n].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};Ta.FilterStack=sf;var M_=class i{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new i([...this.factories])}createFilter(){return new sf(this.factories.map(e=>e.createFilter()))}};Ta.FilterStackFactory=M_});var N_=S(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});of.CompressionAlgorithms=void 0;var dR=function(i){return i[i.identity=0]="identity",i[i.deflate=1]="deflate",i[i.gzip=2]="gzip",i}(dR||(of.CompressionAlgorithms=dR={}))});var lf=S(af=>{"use strict";Object.defineProperty(af,"__esModule",{value:!0});af.BaseFilter=void 0;var P_=class{sendMetadata(e){return p(this,null,function*(){return e})}receiveMetadata(e){return e}sendMessage(e){return p(this,null,function*(){return e})}receiveMessage(e){return p(this,null,function*(){return e})}receiveTrailers(e){return e}};af.BaseFilter=P_});var fR=S(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.CompressionFilterFactory=Ia.CompressionFilter=void 0;var cf=ge("zlib"),hR=N_(),Zz=he(),Jz=lf(),ej=Ke(),tj=i=>typeof i=="number"&&typeof hR.CompressionAlgorithms[i]=="string",xa=class{writeMessage(e,t){return p(this,null,function*(){let n=e;t&&(n=yield this.compressMessage(n));let r=Buffer.allocUnsafe(n.length+5);return r.writeUInt8(t?1:0,0),r.writeUInt32BE(n.length,1),n.copy(r,5),r})}readMessage(e){return p(this,null,function*(){let t=e.readUInt8(0)===1,n=e.slice(5);return t&&(n=yield this.decompressMessage(n)),n})}},Qs=class extends xa{compressMessage(e){return p(this,null,function*(){return e})}writeMessage(e,t){return p(this,null,function*(){let n=Buffer.allocUnsafe(e.length+5);return n.writeUInt8(0,0),n.writeUInt32BE(e.length,1),e.copy(n,5),n})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},F_=class extends xa{compressMessage(e){return new Promise((t,n)=>{cf.deflate(e,(r,s)=>{r?n(r):t(s)})})}decompressMessage(e){return new Promise((t,n)=>{cf.inflate(e,(r,s)=>{r?n(r):t(s)})})}},L_=class extends xa{compressMessage(e){return new Promise((t,n)=>{cf.gzip(e,(r,s)=>{r?n(r):t(s)})})}decompressMessage(e){return new Promise((t,n)=>{cf.unzip(e,(r,s)=>{r?n(r):t(s)})})}},B_=class extends xa{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function uR(i){switch(i){case"identity":return new Qs;case"deflate":return new F_;case"gzip":return new L_;default:return new B_(i)}}var df=class extends Jz.BaseFilter{constructor(e,t){var n;super(),this.sharedFilterConfig=t,this.sendCompression=new Qs,this.receiveCompression=new Qs,this.currentCompressionAlgorithm="identity";let r=e["grpc.default_compression_algorithm"];if(r!==void 0)if(tj(r)){let s=hR.CompressionAlgorithms[r],o=(n=t.serverSupportedEncodingHeader)===null||n===void 0?void 0:n.split(",");(!o||o.includes(s))&&(this.currentCompressionAlgorithm=s,this.sendCompression=uR(this.currentCompressionAlgorithm))}else ej.log(Zz.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${r}`)}sendMetadata(e){return p(this,null,function*(){let t=yield e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t})}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let r=t[0];typeof r=="string"&&(this.receiveCompression=uR(r))}e.remove("grpc-encoding");let n=e.get("grpc-accept-encoding")[0];return n&&(this.sharedFilterConfig.serverSupportedEncodingHeader=n,n.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new Qs,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}sendMessage(e){return p(this,null,function*(){var t;let n=yield e,r;return this.sendCompression instanceof Qs?r=!1:r=(((t=n.flags)!==null&&t!==void 0?t:0)&2)===0,{message:yield this.sendCompression.writeMessage(n.message,r),flags:n.flags}})}receiveMessage(e){return p(this,null,function*(){return this.receiveCompression.readMessage(yield e)})}};Ia.CompressionFilter=df;var V_=class{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new df(this.options,this.sharedFilterConfig)}};Ia.CompressionFilterFactory=V_});var pR=S(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});Da.MaxMessageSizeFilterFactory=Da.MaxMessageSizeFilter=void 0;var ij=lf(),uf=he(),mR=Zt(),hf=class extends ij.BaseFilter{constructor(e){super(),this.maxSendMessageSize=uf.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=uf.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,"grpc.max_send_message_length"in e&&(this.maxSendMessageSize=e["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in e&&(this.maxReceiveMessageSize=e["grpc.max_receive_message_length"])}sendMessage(e){return p(this,null,function*(){if(this.maxSendMessageSize===-1)return e;{let t=yield e;if(t.message.length>this.maxSendMessageSize)throw{code:uf.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${t.message.length} vs. ${this.maxSendMessageSize})`,metadata:new mR.Metadata};return t}})}receiveMessage(e){return p(this,null,function*(){if(this.maxReceiveMessageSize===-1)return e;{let t=yield e;if(t.length>this.maxReceiveMessageSize)throw{code:uf.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${t.length} vs. ${this.maxReceiveMessageSize})`,metadata:new mR.Metadata};return t}})}};Da.MaxMessageSizeFilter=hf;var U_=class{constructor(e){this.options=e}createFilter(){return new hf(this.options)}};Da.MaxMessageSizeFilterFactory=U_});var ff=S(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.deadlineToString=Pn.getRelativeTimeout=Pn.getDeadlineTimeoutString=Pn.minDeadline=void 0;function nj(...i){let e=1/0;for(let t of i){let n=t instanceof Date?t.getTime():t;n<e&&(e=n)}return e}Pn.minDeadline=nj;var rj=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function sj(i){let e=new Date().getTime();i instanceof Date&&(i=i.getTime());let t=Math.max(i-e,0);for(let[n,r]of rj){let s=t/r;if(s<1e8)return String(Math.ceil(s))+n}throw new Error("Deadline is too far in the future")}Pn.getDeadlineTimeoutString=sj;var oj=2147483647;function aj(i){let e=i instanceof Date?i.getTime():i,t=new Date().getTime(),n=e-t;return n<0?0:n>oj?1/0:n}Pn.getRelativeTimeout=aj;function lj(i){if(i instanceof Date)return i.toISOString();{let e=new Date(i);return Number.isNaN(e.getTime())?""+i:e.toISOString()}}Pn.deadlineToString=lj});var pf=S(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});mf.restrictControlPlaneStatusCode=void 0;var Fn=he(),cj=[Fn.Status.OK,Fn.Status.INVALID_ARGUMENT,Fn.Status.NOT_FOUND,Fn.Status.ALREADY_EXISTS,Fn.Status.FAILED_PRECONDITION,Fn.Status.ABORTED,Fn.Status.OUT_OF_RANGE,Fn.Status.DATA_LOSS];function dj(i,e){return cj.includes(i)?{code:Fn.Status.INTERNAL,details:`Invalid status from control plane: ${i} ${Fn.Status[i]} ${e}`}:{code:i,details:e}}mf.restrictControlPlaneStatusCode=dj});var yR=S(vf=>{"use strict";Object.defineProperty(vf,"__esModule",{value:!0});vf.LoadBalancingCall=void 0;var gR=Di(),gf=he(),uj=ff(),yf=Zt(),Lc=Nr(),hj=yi(),fj=Ke(),q_=pf(),mj=ge("http2"),pj="load_balancing_call",z_=class{constructor(e,t,n,r,s,o,a){var l,c;this.channel=e,this.callConfig=t,this.methodName=n,this.host=r,this.credentials=s,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let d=this.methodName.split("/"),u="";d.length>=2&&(u=d[1]);let h=(c=(l=(0,hj.splitHostPort)(this.host))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";this.serviceUrl=`https://${h}/${u}`}trace(e){fj.trace(gf.LogVerbosity.DEBUG,pj,"["+this.callNumber+"] "+e)}outputStatus(e,t){var n,r;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:t});(n=this.listener)===null||n===void 0||n.onReceiveStatus(s),(r=this.onCallEnded)===null||r===void 0||r.call(this,s.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let n=this.channel.doPick(this.metadata,this.callConfig.pickInformation),r=n.subchannel?"("+n.subchannel.getChannelzRef().id+") "+n.subchannel.getAddress():""+n.subchannel;switch(this.trace("Pick result: "+Lc.PickResultType[n.pickResultType]+" subchannel: "+r+" status: "+((e=n.status)===null||e===void 0?void 0:e.code)+" "+((t=n.status)===null||t===void 0?void 0:t.details)),n.pickResultType){case Lc.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var l,c,d;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let u=this.metadata.clone();if(u.merge(a),u.get("authorization").length>1&&this.outputStatus({code:gf.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new yf.Metadata},"PROCESSED"),n.subchannel.getConnectivityState()!==gR.ConnectivityState.READY){this.trace("Picked subchannel "+r+" has state "+gR.ConnectivityState[n.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&u.set("grpc-timeout",(0,uj.getDeadlineTimeoutString)(this.deadline));try{this.child=n.subchannel.getRealSubchannel().createCall(u,this.host,this.methodName,{onReceiveMetadata:h=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(h)},onReceiveMessage:h=>{this.trace("Received message"),this.listener.onReceiveMessage(h)},onReceiveStatus:h=>{this.trace("Received status"),h.rstCode===mj.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(h,"REFUSED"):this.outputStatus(h,"PROCESSED")}})}catch(h){this.trace("Failed to start call on picked subchannel "+r+" with error "+h.message),this.outputStatus({code:gf.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+h.message,metadata:new yf.Metadata},"NOT_STARTED");return}(c=(l=this.callConfig).onCommitted)===null||c===void 0||c.call(l),(d=n.onCallStarted)===null||d===void 0||d.call(n),this.onCallEnded=n.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:l,details:c}=(0,q_.restrictControlPlaneStatusCode)(typeof a.code=="number"?a.code:gf.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:l,details:c,metadata:new yf.Metadata},"PROCESSED")});break;case Lc.PickResultType.DROP:let{code:s,details:o}=(0,q_.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:s,details:o,metadata:n.status.metadata},"DROP")});break;case Lc.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:l}=(0,q_.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:a,details:l,metadata:n.status.metadata},"PROCESSED")})}break;case Lc.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var n;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(n=this.child)===null||n===void 0||n.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new yf.Metadata},"PROCESSED")}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};vf.LoadBalancingCall=z_});var _R=S(bf=>{"use strict";Object.defineProperty(bf,"__esModule",{value:!0});bf.ResolvingCall=void 0;var Aa=he(),_f=ff(),vR=Zt(),gj=Ke(),yj=pf(),vj="resolving_call",j_=class{constructor(e,t,n,r,s,o){this.channel=e,this.method=t,this.filterStackFactory=r,this.credentials=s,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=n.deadline,this.host=n.host,n.parentCall&&(n.flags&Aa.Propagate.CANCELLATION&&n.parentCall.on("cancelled",()=>{this.cancelWithStatus(Aa.Status.CANCELLED,"Cancelled by parent call")}),n.flags&Aa.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+n.parentCall.getDeadline()),this.deadline=(0,_f.minDeadline)(this.deadline,n.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){gj.trace(Aa.LogVerbosity.DEBUG,vj,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,_f.deadlineToString)(this.deadline));let e=(0,_f.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(Aa.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(n=>n(t)),process.nextTick(()=>{var n;(n=this.listener)===null||n===void 0||n.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let n=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(r=>{this.writeFilterPending=!1,n.sendMessageWithContext(e,r.message),this.pendingHalfClose&&n.halfClose()},r=>{this.cancelWithStatus(r.code,r.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let t=e.config;if(t.status!==Aa.Status.OK){let{code:n,details:r}=(0,yj.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:n,details:r,metadata:new vR.Metadata});return}if(t.methodConfig.timeout){let n=new Date;n.setSeconds(n.getSeconds()+t.methodConfig.timeout.seconds),n.setMilliseconds(n.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,_f.minDeadline)(this.deadline,n),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(n=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(n,{onReceiveMetadata:r=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(r))},onReceiveMessage:r=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(r).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:r=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=r:this.outputStatus(r)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},n=>{this.outputStatus(n)})}reportResolverError(e){var t;!((t=this.metadata)===null||t===void 0)&&t.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var n;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(n=this.child)===null||n===void 0||n.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new vR.Metadata})}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};bf.ResolvingCall=j_});var bR=S(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.RetryingCall=Xr.MessageBufferTracker=Xr.RetryThrottler=void 0;var wf=he(),_j=Zt(),bj=Ke(),wj="retrying_call",$_=class{constructor(e,t,n){this.maxTokens=e,this.tokenRatio=t,n?this.tokens=n.tokens*(e/n.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};Xr.RetryThrottler=$_;var H_=class{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var n;let r=(n=this.allocatedPerCall.get(t))!==null&&n!==void 0?n:0;return this.limitPerCall-r<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(t,r+e),this.totalAllocated+=e,!0)}free(e,t){var n;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let r=(n=this.allocatedPerCall.get(t))!==null&&n!==void 0?n:0;if(r<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${r}`);this.allocatedPerCall.set(t,r-e)}freeAll(e){var t;let n=(t=this.allocatedPerCall.get(e))!==null&&t!==void 0?t:0;if(this.totalAllocated<n)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${n} > total allocated ${this.totalAllocated}`);this.totalAllocated-=n,this.allocatedPerCall.delete(e)}};Xr.MessageBufferTracker=H_;var G_="grpc-previous-rpc-attempts",W_=class{constructor(e,t,n,r,s,o,a,l,c){if(this.channel=e,this.callConfig=t,this.methodName=n,this.host=r,this.credentials=s,this.deadline=o,this.callNumber=a,this.bufferTracker=l,this.retryThrottler=c,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let d=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(d.initialBackoff.substring(0,d.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){bj.trace(wf.LogVerbosity.DEBUG,wj,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;(t=this.listener)===null||t===void 0||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new _j.Metadata});for(let{call:n}of this.underlyingCalls)n.cancelWithStatus(e,t)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return(t=this.writeBuffer[e-this.writeBufferOffset])!==null&&t!==void 0?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let n=this.getBufferEntry(t);n.allocated&&this.bufferTracker.free(n.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&this.underlyingCalls[t].state!=="COMPLETED"&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(wf.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,t=-1;for(let[n,r]of this.underlyingCalls.entries())r.state==="ACTIVE"&&r.nextMessageToSend>e&&(e=r.nextMessageToSend,t=n);t===-1?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(n=>n===t||n.toString().toLowerCase()===wf.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let n=Math.random()*this.nextRetryBackoffSec*1e3,r=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,r),n}maybeRetryCall(e,t){if(this.state!=="RETRY"){t(!1);return}let n=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(n.maxAttempts,5)){t(!1);return}let r;if(e===null)r=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else r=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,o;if(this.state!=="RETRY"){t(!1);return}(!((o=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&o!==void 0)||o)&&(t(!0),this.attempts+=1,this.startNewAttempt())},r)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,n){var r,s,o;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((r=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&r!==void 0?r:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let a;if(n===null)a=0;else if(n<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else a=n;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(t),this.reportStatus(e))},a)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(n,a=>{a||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e));break}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(t.length===0)return null;try{return parseInt(t[0])}catch{return-1}}handleChildStatus(e,t){var n;if(this.underlyingCalls[t].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===wf.Status.OK){(n=this.retryThrottler)===null||n===void 0||n.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let r=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,r):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,r);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,n;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let r=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(r.maxAttempts,5))return;let s=(e=r.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(n=(t=this.hedgingTimer).unref)===null||n===void 0||n.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let n=this.attempts-1,r=this.initialMetadata.clone();n>0&&r.set(G_,`${n}`);let s=!1;e.start(r,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),s=!0,n>0&&o.set(G_,`${n}`),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&n>0&&o.metadata.set(G_,`${n}`),this.handleChildStatus(o,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,n;let r=this.underlyingCalls[e],s=r.nextMessageToSend;(n=(t=this.getBufferEntry(s)).callback)===null||n===void 0||n.call(t),this.clearSentMessages(),r.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if(t.state!=="COMPLETED"&&this.getBufferEntry(t.nextMessageToSend)){let n=this.getBufferEntry(t.nextMessageToSend);switch(n.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:r=>{this.handleChildWriteCompleted(e)}},n.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,t){var n;this.trace("write() called with message of length "+t.length);let r={message:t,flags:e.flags},s=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:r,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(n=e.callback)===null||n===void 0||n.call(e);for(let[a,l]of this.underlyingCalls.entries())l.state==="ACTIVE"&&l.nextMessageToSend===s&&l.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(a)}},t)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===s&&a.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};Xr.RetryingCall=W_});var Ef=S(Sf=>{"use strict";Object.defineProperty(Sf,"__esModule",{value:!0});Sf.BaseSubchannelWrapper=void 0;var K_=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};Sf.BaseSubchannelWrapper=K_});var ER=S(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});xf.InternalChannel=void 0;var Sj=sh(),Ej=Hx(),Cj=cR(),wR=Nr(),Bc=he(),Tj=O_(),xj=fR(),SR=En(),Q_=Ke(),Ij=pR(),Dj=S_(),Cf=yi(),Ln=Di(),Vc=Ks(),Aj=yR(),Rj=ff(),kj=_R(),Y_=x_(),Mj=pf(),X_=bR(),Oj=Ef(),Nj=2147483647,Pj=1e3,Fj=30*60*1e3,Tf=new Map,Lj=1<<24,Bj=1<<20,Z_=class extends Oj.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(n,r,s,o)=>{t.throttleKeepalive(o)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},J_=class{constructor(e,t,n){var r,s,o,a,l,c,d,u;if(this.credentials=t,this.options=n,this.connectivityState=Ln.ConnectivityState.IDLE,this.currentPicker=new wR.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new Vc.ChannelzCallTracker,this.childrenTracker=new Vc.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof Sj.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(n&&typeof n!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let h=(0,Cf.parseUri)(e);if(h===null)throw new Error(`Could not parse target name "${e}"`);let m=(0,SR.mapUriDefaultScheme)(h);if(m===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},Nj),(s=(r=this.callRefTimer).unref)===null||s===void 0||s.call(r),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Vc.ChannelzTrace,this.channelzRef=(0,Vc.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,SR.getDefaultAuthority)(m);let g=(0,Dj.mapProxyName)(m,n);this.target=g.target,this.options=Object.assign({},this.options,g.extraOptions),this.subchannelPool=(0,Cj.getSubchannelPool)(((o=n["grpc.use_local_subchannel_pool"])!==null&&o!==void 0?o:0)===0),this.retryBufferTracker=new X_.MessageBufferTracker((a=n["grpc.retry_buffer_size"])!==null&&a!==void 0?a:Lj,(l=n["grpc.per_rpc_retry_buffer_size"])!==null&&l!==void 0?l:Bj),this.keepaliveTime=(c=n["grpc.keepalive_time_ms"])!==null&&c!==void 0?c:-1,this.idleTimeoutMs=Math.max((d=n["grpc.client_idle_timeout_ms"])!==null&&d!==void 0?d:Fj,Pj);let _={createSubchannel:(A,w)=>{let R=this.subchannelPool.getOrCreateSubchannel(this.target,A,Object.assign({},this.options,w),this.credentials);R.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",R.getChannelzRef());let k=new Z_(R,this);return this.wrappedSubchannels.add(k),k},updateState:(A,w)=>{this.currentPicker=w;let R=this.pickQueue.slice();this.pickQueue=[],R.length>0&&this.callRefTimerUnref();for(let k of R)k.doPick();this.updateState(A)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:A=>{this.channelzEnabled&&this.childrenTracker.refChild(A)},removeChannelzChild:A=>{this.channelzEnabled&&this.childrenTracker.unrefChild(A)}};this.resolvingLoadBalancer=new Ej.ResolvingLoadBalancer(this.target,_,n,(A,w)=>{A.retryThrottling?Tf.set(this.getTarget(),new X_.RetryThrottler(A.retryThrottling.maxTokens,A.retryThrottling.tokenRatio,Tf.get(this.getTarget()))):Tf.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=w,this.currentResolutionError=null,process.nextTick(()=>{let R=this.configSelectionQueue;this.configSelectionQueue=[],R.length>0&&this.callRefTimerUnref();for(let k of R)k.getConfig()})},A=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+A.code+' and details "'+A.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,Mj.restrictControlPlaneStatusCode)(A.code,A.details)),{metadata:A.metadata}));let w=this.configSelectionQueue;this.configSelectionQueue=[],w.length>0&&this.callRefTimerUnref();for(let R of w)R.reportResolverError(A)}),this.filterStackFactory=new Tj.FilterStackFactory([new Ij.MaxMessageSizeFilterFactory(this.options),new xj.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(n,void 0,2));let y=new Error;(0,Q_.trace)(Bc.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((u=y.stack)===null||u===void 0?void 0:u.substring(y.stack.indexOf(`
`)+1)))}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,Q_.trace)(t??Bc.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Cf.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,n,r;!((t=(e=this.callRefTimer).hasRef)===null||t===void 0)&&t.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(r=(n=this.callRefTimer).ref)===null||r===void 0||r.call(n))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(t=(e=this.callRefTimer).unref)===null||t===void 0||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(n=>n===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){(0,Q_.trace)(Bc.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Cf.uriToString)(this.target)+" "+Ln.ConnectivityState[this.connectivityState]+" -> "+Ln.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Ln.ConnectivityState[e]),this.connectivityState=e;let t=this.connectivityStateWatchers.slice();for(let n of t)e!==n.currentState&&(n.timer&&clearTimeout(n.timer),this.removeConnectivityStateWatcher(n),n.callback());e!==Ln.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let t of this.wrappedSubchannels)t.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(Ln.ConnectivityState.IDLE),this.currentPicker=new wR.QueuePicker(this.resolvingLoadBalancer)}maybeStartIdleTimer(){var e,t;this.connectivityState!==Ln.ConnectivityState.SHUTDOWN&&this.callCount===0&&(this.idleTimer=setTimeout(()=>{this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()},this.idleTimeoutMs),(t=(e=this.idleTimer).unref)===null||t===void 0||t.call(e))}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1,this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}onCallEnd(e){this.channelzEnabled&&(e.code===Bc.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,n,r,s){let o=(0,Y_.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+t+'"'),new Aj.LoadBalancingCall(this,e,t,n,r,s,o)}createRetryingCall(e,t,n,r,s){let o=(0,Y_.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+t+'"'),new X_.RetryingCall(this,e,t,n,r,s,o,this.retryBufferTracker,Tf.get(this.getTarget()))}createInnerCall(e,t,n,r,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,t,n,r,s):this.createRetryingCall(e,t,n,r,s)}createResolvingCall(e,t,n,r,s){let o=(0,Y_.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,Rj.deadlineToString)(t));let a={deadline:t,flags:s??Bc.Propagate.DEFAULTS,host:n??this.defaultAuthority,parentCall:r},l=new kj.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),o);return this.onCallStart(),l.addStatusWatcher(c=>{this.onCallEnd(c)}),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState(Ln.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,Vc.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,Cf.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,n){if(this.connectivityState===Ln.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let r=null;if(t!==1/0){let o=t instanceof Date?t:new Date(t),a=new Date;if(t===-1/0||o<=a){process.nextTick(n,new Error("Deadline passed without connectivity state change"));return}r=setTimeout(()=>{this.removeConnectivityStateWatcher(s),n(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let s={currentState:e,callback:n,timer:r};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,n,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===Ln.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,t,n,r,s)}};xf.InternalChannel=J_});var nv=S(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});If.ChannelImplementation=void 0;var Vj=sh(),Uj=ER(),eb=class{constructor(e,t,n){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof Vj.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(n&&typeof n!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new Uj.InternalChannel(e,t,n)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,n){this.internalChannel.watchConnectivityState(e,t,n)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,n,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,n,r,s)}};If.ChannelImplementation=eb});var OR=S(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0});Li.Http2ServerCallStream=Li.ServerDuplexStreamImpl=Li.ServerWritableStreamImpl=Li.ServerReadableStreamImpl=Li.ServerUnaryCallImpl=void 0;var DR=ge("events"),Ra=ge("http2"),nb=ge("stream"),AR=ge("zlib"),RR=ge("util"),Pe=he(),rb=Zt(),qj=C_(),kR=Ke(),qc=Ju(),MR="server_call",zj=(0,RR.promisify)(AR.unzip),jj=(0,RR.promisify)(AR.inflate);function Uc(i){kR.trace(Pe.LogVerbosity.DEBUG,MR,i)}var Gj="grpc-accept-encoding",$j="grpc-encoding",CR="grpc-message",TR="grpc-status",xR="grpc-timeout",Hj=/(\d{1,8})\s*([HMSmun])/,Wj={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},Kj={[Gj]:"identity,deflate,gzip",[$j]:"identity"},IR={[Ra.constants.HTTP2_HEADER_STATUS]:Ra.constants.HTTP_STATUS_OK,[Ra.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},Qj={waitForTrailers:!0},tb=class extends DR.EventEmitter{constructor(e,t,n){super(),this.call=e,this.metadata=t,this.request=n,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};Li.ServerUnaryCallImpl=tb;var Df=class extends nb.Readable{constructor(e,t,n,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=n,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,r)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};Li.ServerReadableStreamImpl=Df;var zc=class extends nb.Writable{constructor(e,t,n,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=n,this.request=r,this.cancelled=!1,this.trailingMetadata=new rb.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,n){try{let r=this.call.serializeMessage(e);if(!this.call.write(r)){this.call.once("drain",n);return}}catch(r){this.emit("error",{details:(0,qc.getErrorMessage)(r),code:Pe.Status.INTERNAL})}n()}_final(e){this.call.sendStatus({code:Pe.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};Li.ServerWritableStreamImpl=zc;var ka=class extends nb.Duplex{constructor(e,t,n,r,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=n,this.deserialize=r,this.cancelled=!1,this.trailingMetadata=new rb.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",o=>{this.call.sendError(o),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};Li.ServerDuplexStreamImpl=ka;ka.prototype._read=Df.prototype._read;ka.prototype._write=zc.prototype._write;ka.prototype._final=zc.prototype._final;var ib=class extends DR.EventEmitter{constructor(e,t,n){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=Pe.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=Pe.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",r=>{}),this.stream.once("close",()=>{var r;Uc("Request to method "+((r=this.handler)===null||r===void 0?void 0:r.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:Pe.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in n&&(this.maxSendMessageSize=n["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in n&&(this.maxReceiveMessageSize=n["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){return t==="deflate"?jj(e.subarray(5)):t==="gzip"?zj(e.subarray(5)):t==="identity"?e.subarray(5):Promise.reject({code:Pe.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,n=Object.assign(Object.assign(Object.assign({},IR),Kj),t);this.stream.respond(n,Qj)}receiveMetadata(e){let t=rb.Metadata.fromHttp2Headers(e);kR.isTracerEnabled(MR)&&Uc("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let n=t.get(xR);if(n.length>0){let r=n[0].toString().match(Hj);if(r===null){let a=new Error("Invalid deadline");return a.code=Pe.Status.OUT_OF_RANGE,this.sendError(a),t}let s=+r[1]*Wj[r[2]]|0,o=new Date;this.deadline=o.setMilliseconds(o.getMilliseconds()+s),this.deadlineTimer=setTimeout(Yj,s,this),t.remove(xR)}return t.remove(Ra.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(Ra.constants.HTTP2_HEADER_TE),t.remove(Ra.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,n)=>{let{stream:r}=this,s=0,o=this,a=[],l=this.maxReceiveMessageSize;this.stream.on("data",c),this.stream.on("end",d),this.stream.on("error",d);function c(u){if(s+=u.byteLength,l!==-1&&s>l){r.removeListener("data",c),r.removeListener("end",d),r.removeListener("error",d),n({code:Pe.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${l})`});return}a.push(u)}function d(u){if(r.removeListener("data",c),r.removeListener("end",d),r.removeListener("error",d),u!==void 0){n({code:Pe.Status.INTERNAL,details:u.message});return}if(s===0){n({code:Pe.Status.INTERNAL,details:"received empty unary message"});return}o.emit("receiveMessage");let h=Buffer.concat(a,s),g=h.readUInt8(0)===1?e:"identity",_=o.getDecompressedMessage(h,g);if(Buffer.isBuffer(_)){t(o.deserializeMessageWithInternalError(_));return}_.then(y=>t(o.deserializeMessageWithInternalError(y)),y=>n(y.code?y:{code:Pe.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}deserializeMessageWithInternalError(e){return p(this,null,function*(){try{return this.deserializeMessage(e)}catch(t){throw{details:(0,qc.getErrorMessage)(t),code:Pe.Status.INTERNAL}}})}serializeMessage(e){let t=this.handler.serialize(e),n=t.byteLength,r=Buffer.allocUnsafe(n+5);return r.writeUInt8(0,0),r.writeUInt32BE(n,1),t.copy(r,5),r}deserializeMessage(e){return this.handler.deserialize(e)}sendUnaryMessage(e,t,n,r){return p(this,null,function*(){if(!this.checkCancelled()){if(n===void 0&&(n=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&n&&(e.metadata=n),this.sendError(e);return}try{let s=this.serializeMessage(t);this.write(s),this.sendStatus({code:Pe.Status.OK,details:"OK",metadata:n})}catch(s){this.sendError({details:(0,qc.getErrorMessage)(s),code:Pe.Status.INTERNAL})}}})}sendStatus(e){var t,n;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===Pe.Status.OK),!this.checkCancelled())if(Uc("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+Pe.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var r;let s=Object.assign({[TR]:e.code,[CR]:encodeURI(e.details)},(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let r=Object.assign(Object.assign({[TR]:e.code,[CR]:encodeURI(e.details)},IR),(n=e.metadata)===null||n===void 0?void 0:n.toHttp2Headers());this.stream.respond(r,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:Pe.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&typeof e.details=="string"&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:Pe.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let n=new qj.StreamDecoder,r=!1,s=!1,o=!1,a=()=>p(this,null,function*(){!o&&r&&!s&&(o=!0,yield this.pushOrBufferMessage(e,null))});this.stream.on("data",l=>p(this,null,function*(){let c=n.write(l);s=!0,this.stream.pause();for(let d of c){if(this.maxReceiveMessageSize!==-1&&d.length>this.maxReceiveMessageSize){this.sendError({code:Pe.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${d.length} vs. ${this.maxReceiveMessageSize})`});return}this.emit("receiveMessage");let h=d.readUInt8(0)===1?t:"identity",m=yield this.getDecompressedMessage(d,h);if(!m)return;yield this.pushOrBufferMessage(e,m)}s=!1,this.stream.resume(),yield a()})),this.stream.once("end",()=>p(this,null,function*(){r=!0,yield a()}))}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),n=e.push(t);if(t===null||n===!1){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,t){return p(this,null,function*(){this.isPushPending?this.bufferedMessages.push(t):yield this.pushMessage(e,t)})}pushMessage(e,t){return p(this,null,function*(){if(t===null){Uc("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}Uc("Received message of length "+t.length),this.isPushPending=!0;try{let n=yield this.deserializeMessage(t);this.canPush?e.push(n)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(n)}catch(n){this.bufferedMessages.length=0;let r=(0,qc.getErrorCode)(n);(r===null||r<Pe.Status.OK||r>Pe.Status.UNAUTHENTICATED)&&(r=Pe.Status.INTERNAL),e.emit("error",{details:(0,qc.getErrorMessage)(n),code:r})}this.isPushPending=!1,this.bufferedMessages.length>0&&(yield this.pushMessage(e,this.bufferedMessages.shift()))})}getPeer(){var e;let t=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return t?.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};Li.Http2ServerCallStream=ib;function Yj(i){let e=new Error("Deadline exceeded");e.code=Pe.Status.DEADLINE_EXCEEDED,i.sendError(e),i.cancelled=!0,i.emit("cancelled","deadline")}});var ab=S(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});Af.ServerCredentials=void 0;var NR=Iy(),jc=class{static createInsecure(){return new sb}static createSsl(e,t,n=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if(typeof n!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let r=[],s=[];for(let o=0;o<t.length;o++){let a=t[o];if(a===null||typeof a!="object")throw new TypeError(`keyCertPair[${o}] must be an object`);if(!Buffer.isBuffer(a.private_key))throw new TypeError(`keyCertPair[${o}].private_key must be a Buffer`);if(!Buffer.isBuffer(a.cert_chain))throw new TypeError(`keyCertPair[${o}].cert_chain must be a Buffer`);r.push(a.cert_chain),s.push(a.private_key)}return new ob({ca:e||(0,NR.getDefaultRootsData)()||void 0,cert:r,key:s,requestCert:n,ciphers:NR.CIPHER_SUITES})}};Af.ServerCredentials=jc;var sb=class extends jc{_isSecure(){return!1}_getSettings(){return null}},ob=class extends jc{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var LR=S(Mf=>{"use strict";Object.defineProperty(Mf,"__esModule",{value:!0});Mf.Server=void 0;var Zr=ge("http2"),cr=he(),Ys=OR(),Xj=ab(),PR=En(),Rf=Ke(),tn=Tn(),Zj=yi(),ui=Ks(),kf=~(1<<31),Jj=~(1<<31),e3=2e4,{HTTP2_HEADER_PATH:FR}=Zr.constants,t3="server";function i3(){}function lb(i){return{code:cr.Status.UNIMPLEMENTED,details:`The server does not implement the method ${i}`}}function n3(i,e){let t=lb(e);switch(i){case"unary":return(n,r)=>{r(t,null)};case"clientStream":return(n,r)=>{r(t,null)};case"serverStream":return n=>{n.emit("error",t)};case"bidi":return n=>{n.emit("error",t)};default:throw new Error(`Invalid handlerType ${i}`)}}var cb=class{constructor(e){var t,n,r,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new ui.ChannelzTrace,this.callTracker=new ui.ChannelzCallTracker,this.listenerChildrenTracker=new ui.ChannelzChildrenTracker,this.sessionChildrenTracker=new ui.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,ui.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(t=this.options["grpc.max_connection_age_ms"])!==null&&t!==void 0?t:kf,this.maxConnectionAgeGraceMs=(n=this.options["grpc.max_connection_age_grace_ms"])!==null&&n!==void 0?n:kf,this.keepaliveTimeMs=(r=this.options["grpc.keepalive_time_ms"])!==null&&r!==void 0?r:Jj,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:e3,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,n,r;let s=this.sessions.get(e),o=e.socket,a=o.remoteAddress?(0,tn.stringToSubchannelAddress)(o.remoteAddress,o.remotePort):null,l=o.localAddress?(0,tn.stringToSubchannelAddress)(o.localAddress,o.localPort):null,c;if(e.encrypted){let u=o,h=u.getCipher(),m=u.getCertificate(),g=u.getPeerCertificate();c={cipherSuiteStandardName:(t=h.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:h.standardName?null:h.name,localCertificate:m&&"raw"in m?m.raw:null,remoteCertificate:g&&"raw"in g?g.raw:null}}else c=null;return{remoteAddress:a,localAddress:l,security:c,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(n=e.state.localWindowSize)!==null&&n!==void 0?n:null,remoteFlowControlWindow:(r=e.state.remoteWindowSize)!==null&&r!==void 0?r:null}}}trace(e){Rf.trace(cr.LogVerbosity.DEBUG,t3,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!="object"||t===null||typeof t!="object")throw new Error("addService() requires two objects as arguments");let n=Object.keys(e);if(n.length===0)throw new Error("Cannot add an empty service to a server");n.forEach(r=>{let s=e[r],o;s.requestStream?s.responseStream?o="bidi":o="clientStream":s.responseStream?o="serverStream":o="unary";let a=t[r],l;if(a===void 0&&typeof s.originalName=="string"&&(a=t[s.originalName]),a!==void 0?l=a.bind(t):l=n3(o,r),this.register(s.path,l,s.responseSerialize,s.requestDeserialize,o)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(n=>{let r=e[n];this.unregister(r.path)})}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,n){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(t===null||!(t instanceof Xj.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof n!="function")throw new TypeError("callback must be a function");let r=(0,Zj.parseUri)(e);if(r===null)throw new Error(`Could not parse port "${e}"`);let s=(0,PR.mapUriDefaultScheme)(r);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let o={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?o.maxSessionMemory=this.options["grpc-node.max_session_memory"]:o.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(o.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let a=(m,g)=>{process.nextTick(()=>n(m,g))},l=()=>{let m;if(t._isSecure()){let g=Object.assign(o,t._getSettings());g.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,m=Zr.createSecureServer(g),m.on("secureConnection",_=>{_.on("error",y=>{this.trace("An incoming TLS connection closed with error: "+y.message)})})}else m=Zr.createServer(o);return m.setTimeout(0,i3),this._setupHandlers(m),m},c=(m,g,_)=>m.length===0?Promise.resolve({port:g,count:_}):Promise.all(m.map(y=>{this.trace("Attempting to bind "+(0,tn.subchannelAddressToString)(y));let A;(0,tn.isTcpSubchannelAddress)(y)?A={host:y.host,port:g}:A=y;let w=l();return new Promise((R,k)=>{let q=K=>{this.trace("Failed to bind "+(0,tn.subchannelAddressToString)(y)+" with error "+K.message),R(K)};w.once("error",q),w.listen(A,()=>{if(this.shutdown){w.close(),R(new Error("bindAsync failed because server is shutdown"));return}let K=w.address(),ne;typeof K=="string"?ne={path:K}:ne={host:K.address,port:K.port};let ft=(0,ui.registerChannelzSocket)((0,tn.subchannelAddressToString)(ne),()=>({localAddress:ne,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(ft),this.http2ServerList.push({server:w,channelzRef:ft}),this.trace("Successfully bound "+(0,tn.subchannelAddressToString)(ne)),R("port"in ne?ne.port:g),w.removeListener("error",q)})})})).then(y=>{let A=0;for(let w of y)if(typeof w=="number"&&(A+=1,w!==g))throw new Error("Invalid state: multiple port numbers added from single address");return{port:g,count:A+_}}),d=m=>{if(m.length===0)return Promise.resolve({port:0,count:0});let g=m[0],_=l();return new Promise((y,A)=>{let w=R=>{this.trace("Failed to bind "+(0,tn.subchannelAddressToString)(g)+" with error "+R.message),y(d(m.slice(1)))};_.once("error",w),_.listen(g,()=>{if(this.shutdown){_.close(),y({port:0,count:0});return}let R=_.address(),k={host:R.address,port:R.port},q=(0,ui.registerChannelzSocket)((0,tn.subchannelAddressToString)(k),()=>({localAddress:k,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(q),this.http2ServerList.push({server:_,channelzRef:q}),this.trace("Successfully bound "+(0,tn.subchannelAddressToString)(k)),y(c(m.slice(1),R.port,1)),_.removeListener("error",w)})})},u={onSuccessfulResolution:(m,g,_)=>{if(u.onSuccessfulResolution=()=>{},this.shutdown&&a(new Error("bindAsync failed because server is shutdown"),0),m.length===0){a(new Error(`No addresses resolved for port ${e}`),0);return}let y;(0,tn.isTcpSubchannelAddress)(m[0])?m[0].port===0?y=d(m):y=c(m,m[0].port,0):y=c(m,1,0),y.then(A=>{if(A.count===0){let w=`No address added out of total ${m.length} resolved`;Rf.log(cr.LogVerbosity.ERROR,w),a(new Error(w),0)}else A.count<m.length&&Rf.log(cr.LogVerbosity.INFO,`WARNING Only ${A.count} addresses added out of total ${m.length} resolved`),a(null,A.port)},A=>{let w=`No address added out of total ${m.length} resolved`;Rf.log(cr.LogVerbosity.ERROR,w),a(new Error(w),0)})},onError:m=>{a(new Error(m.details),0)}};(0,PR.createResolver)(s,u,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,ui.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(Zr.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,ui.unregisterChannelzRef)(this.channelzRef)}register(e,t,n,r,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:t,serialize:n,deserialize:r,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=s=>{this.channelzEnabled&&(0,ui.unregisterChannelzRef)(this.channelzRef),e(s)},n=0;function r(){n--,n===0&&t()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:o}of this.http2ServerList)s.listening&&(n++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(o),(0,ui.unregisterChannelzRef)(o)),r()}));this.sessions.forEach((s,o)=>{o.closed||(n+=1,o.close(r))}),n===0&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let n=t[Zr.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof n!="string"||!n.startsWith("application/grpc")?(e.respond({[Zr.constants.HTTP2_HEADER_STATUS]:Zr.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return t===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,n=null){let r=new Ys.Http2ServerCallStream(t,null,this.options);e.code===void 0&&(e.code=cr.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),n?.streamTracker.addCallFailed()),r.sendError(e)}_channelzHandler(e,t){let n=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),n?.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),n?.streamTracker.addCallFailed();return}let r=t[FR],s=this._retrieveHandler(r);if(!s){this._respondWithError(lb(r),e,n);return}let o=new Ys.Http2ServerCallStream(e,s,this.options);o.once("callEnd",a=>{a===cr.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),n&&(o.once("streamEnd",a=>{a?n.streamTracker.addCallSucceeded():n.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{n.messagesSent+=1,n.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{n.messagesReceived+=1,n.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,s,t)||(this.callTracker.addCallFailed(),n?.streamTracker.addCallFailed(),o.sendError({code:cr.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,t){if(this._verifyContentType(e,t)!==!0)return;let n=t[FR],r=this._retrieveHandler(n);if(!r){this._respondWithError(lb(n),e,null);return}let s=new Ys.Http2ServerCallStream(e,r,this.options);this._runHandlerForCall(s,r,t)||s.sendError({code:cr.Status.INTERNAL,details:`Unknown handler type: ${r.type}`})}_runHandlerForCall(e,t,n){var r;let s=e.receiveMetadata(n),o=(r=s.get("grpc-encoding")[0])!==null&&r!==void 0?r:"identity";s.remove("grpc-encoding");let{type:a}=t;if(a==="unary")r3(e,t,s,o);else if(a==="clientStream")s3(e,t,s,o);else if(a==="serverStream")o3(e,t,s,o);else if(a==="bidi")a3(e,t,s,o);else return!1;return!0}_setupHandlers(e){if(e===null)return;let t=e.address(),n="null";t&&(typeof t=="string"?n=t:n=t.address+":"+t.port),this.serverAddressString=n;let r=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",r.bind(this)),e.on("session",s=>{var o,a,l,c,d;if(!this.started){s.destroy();return}let u=(0,ui.registerChannelzSocket)((o=s.socket.remoteAddress)!==null&&o!==void 0?o:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),h={ref:u,streamTracker:new ui.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,h);let m=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+m),this.sessionChildrenTracker.refChild(u));let g=null,_=null,y=!1;if(this.maxConnectionAgeMs!==kf){let w=this.maxConnectionAgeMs/10,R=Math.random()*w*2-w;g=(l=(a=setTimeout(()=>{var k,q;y=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+m);try{s.goaway(Zr.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==kf&&(_=(q=(k=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||q===void 0?void 0:q.call(k))},this.maxConnectionAgeMs+R)).unref)===null||l===void 0?void 0:l.call(a)}let A=(d=(c=setInterval(()=>{var w,R;let k=(R=(w=setTimeout(()=>{y=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+m),s.close()},this.keepaliveTimeoutMs)).unref)===null||R===void 0?void 0:R.call(w);try{s.ping((q,K,ne)=>{clearTimeout(k)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||d===void 0?void 0:d.call(c);s.on("close",()=>{this.channelzEnabled&&(y||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+m),this.sessionChildrenTracker.unrefChild(u),(0,ui.unregisterChannelzRef)(u)),g&&clearTimeout(g),_&&clearTimeout(_),A&&clearTimeout(A),this.sessions.delete(s)})})}};Mf.Server=cb;function r3(i,e,t,n){return p(this,null,function*(){try{let r=yield i.receiveUnaryMessage(n);if(r===void 0||i.cancelled)return;let s=new Ys.ServerUnaryCallImpl(i,t,r);e.func(s,(o,a,l,c)=>{i.sendUnaryMessage(o,a,l,c)})}catch(r){i.sendError(r)}})}function s3(i,e,t,n){let r=new Ys.ServerReadableStreamImpl(i,t,e.deserialize,n);function s(o,a,l,c){r.destroy(),i.sendUnaryMessage(o,a,l,c)}i.cancelled||(r.on("error",s),e.func(r,s))}function o3(i,e,t,n){return p(this,null,function*(){try{let r=yield i.receiveUnaryMessage(n);if(r===void 0||i.cancelled)return;let s=new Ys.ServerWritableStreamImpl(i,t,e.serialize,r);e.func(s)}catch(r){i.sendError(r)}})}function a3(i,e,t,n){let r=new Ys.ServerDuplexStreamImpl(i,t,e.serialize,e.deserialize,n);i.cancelled||e.func(r)}});var BR=S(Of=>{"use strict";Object.defineProperty(Of,"__esModule",{value:!0});Of.StatusBuilder=void 0;var db=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};Of.StatusBuilder=db});var ub=S(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.isDuration=Jr.durationToMs=Jr.msToDuration=void 0;function l3(i){return{seconds:i/1e3|0,nanos:i%1e3*1e6|0}}Jr.msToDuration=l3;function c3(i){return i.seconds*1e3+i.nanos/1e6|0}Jr.durationToMs=c3;function d3(i){return typeof i.seconds=="number"&&typeof i.nanos=="number"}Jr.isDuration=d3});var _b=S(es=>{"use strict";var hb;Object.defineProperty(es,"__esModule",{value:!0});es.setup=es.OutlierDetectionLoadBalancer=es.OutlierDetectionLoadBalancingConfig=void 0;var Pf=Di(),UR=he(),Xs=ub(),qR=bb(),zR=Rr(),u3=hh(),h3=Nr(),VR=Tn(),f3=Ef(),m3=Ke(),p3="outlier_detection";function St(i){m3.trace(UR.LogVerbosity.DEBUG,p3,i)}var vb="outlier_detection",g3=((hb=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&hb!==void 0?hb:"true")==="true",y3={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},v3={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function Ma(i,e,t,n){if(e in i&&typeof i[e]!==t){let r=n?`${n}.${e}`:e;throw new Error(`outlier detection config ${r} parse error: expected ${t}, got ${typeof i[e]}`)}}function fb(i,e,t){let n=t?`${t}.${e}`:e;if(e in i){if(!(0,Xs.isDuration)(i[e]))throw new Error(`outlier detection config ${n} parse error: expected Duration, got ${typeof i[e]}`);if(!(i[e].seconds>=0&&i[e].seconds<=315576e6&&i[e].nanos>=0&&i[e].nanos<=999999999))throw new Error(`outlier detection config ${n} parse error: values out of range for non-negative Duaration`)}}function Nf(i,e,t){let n=t?`${t}.${e}`:e;if(Ma(i,e,"number",t),e in i&&!(i[e]>=0&&i[e]<=100))throw new Error(`outlier detection config ${n} parse error: value out of range for percentage (0-100)`)}var Gc=class i{constructor(e,t,n,r,s,o,a){if(this.childPolicy=a,a.length>0&&a[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=t??3e4,this.maxEjectionTimeMs=n??3e5,this.maxEjectionPercent=r??10,this.successRateEjection=s?Object.assign(Object.assign({},y3),s):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},v3),o):null}getLoadBalancerName(){return vb}toJsonObject(){return{interval:(0,Xs.msToDuration)(this.intervalMs),base_ejection_time:(0,Xs.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,Xs.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new i(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(fb(e,"interval"),fb(e,"base_ejection_time"),fb(e,"max_ejection_time"),Nf(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");Ma(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),Nf(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),Ma(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),Ma(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");Nf(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),Nf(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),Ma(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),Ma(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new i(e.interval?(0,Xs.durationToMs)(e.interval):null,e.base_ejection_time?(0,Xs.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,Xs.durationToMs)(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(zR.validateLoadBalancingConfig))}};es.OutlierDetectionLoadBalancingConfig=Gc;var pb=class extends f3.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((n,r,s,o)=>{if(this.childSubchannelState=s,!this.ejected)for(let a of this.stateListeners)a(this,r,s,o)})}getConnectivityState(){return this.ejected?Pf.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,Pf.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,Pf.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function mb(){return{success:0,failure:0}}var gb=class{constructor(){this.activeBucket=mb(),this.inactiveBucket=mb()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=mb()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},yb=class{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType===h3.PickResultType.COMPLETE){let n=t.subchannel,r=n.getMapEntry();if(r){let s=t.onCallEnded;return this.countCalls&&(s=o=>{var a;o===UR.Status.OK?r.counter.addSuccess():r.counter.addFailure(),(a=t.onCallEnded)===null||a===void 0||a.call(t,o)}),Object.assign(Object.assign({},t),{subchannel:n.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},t),{subchannel:n.getWrappedSubchannel()})}else return t}},Ff=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new u3.ChildLoadBalancerHandler((0,qR.createChildChannelControlHelper)(e,{createSubchannel:(t,n)=>{let r=e.createSubchannel(t,n),s=this.addressMap.get((0,VR.subchannelAddressToString)(t)),o=new pb(r,s);return s?.currentEjectionTimestamp!==null&&o.eject(),s?.subchannelWrappers.push(o),o},updateState:(t,n)=>{t===Pf.ConnectivityState.READY?e.updateState(t,new yb(n,this.isCountingEnabled())):e.updateState(t,n)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())t.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;St("Running success rate check");let n=t.request_volume,r=0,s=[];for(let[u,h]of this.addressMap){let m=h.counter.getLastSuccesses(),g=h.counter.getLastFailures();St("Stats for "+u+": successes="+m+" failures="+g+" targetRequestVolume="+n),m+g>=n&&(r+=1,s.push(m/(m+g)))}if(St("Found "+r+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),r<t.minimum_hosts)return;let o=s.reduce((u,h)=>u+h)/s.length,a=0;for(let u of s){let h=u-o;a+=h*h}let l=a/s.length,c=Math.sqrt(l),d=o-c*(t.stdev_factor/1e3);St("stdev="+c+" ejectionThreshold="+d);for(let[u,h]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let m=h.counter.getLastSuccesses(),g=h.counter.getLastFailures();if(m+g<n)continue;let _=m/(m+g);if(St("Checking candidate "+u+" successRate="+_),_<d){let y=Math.random()*100;St("Candidate "+u+" randomNumber="+y+" enforcement_percentage="+t.enforcement_percentage),y<t.enforcement_percentage&&(St("Ejecting candidate "+u),this.eject(h,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;St("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let n=0;for(let r of this.addressMap.values()){let s=r.counter.getLastSuccesses(),o=r.counter.getLastFailures();s+o>=t.request_volume&&(n+=1)}if(!(n<t.minimum_hosts))for(let[r,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(St("Candidate successes="+o+" failures="+a),o+a<t.request_volume)continue;if(a*100/(a+o)>t.threshold){let c=Math.random()*100;St("Candidate "+r+" randomNumber="+c+" enforcement_percentage="+t.enforcement_percentage),c<t.enforcement_percentage&&(St("Ejecting candidate "+r),this.eject(s,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let n of e.subchannelWrappers)n.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,n;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(n=(t=this.ejectionTimer).unref)===null||n===void 0||n.call(t)}runChecks(){let e=new Date;if(St("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[t,n]of this.addressMap.entries())if(n.currentEjectionTimestamp===null)n.ejectionTimeMultiplier>0&&(n.ejectionTimeMultiplier-=1);else{let r=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(n.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(r*n.ejectionTimeMultiplier,Math.max(r,s))),o<new Date&&(St("Unejecting "+t),this.uneject(n))}}}updateAddressList(e,t,n){if(!(t instanceof Gc))return;let r=new Set;for(let o of e)r.add((0,VR.subchannelAddressToString)(o));for(let o of r)this.addressMap.has(o)||(St("Adding map entry for "+o),this.addressMap.set(o,{counter:new gb,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let o of this.addressMap.keys())r.has(o)||(St("Removing map entry for "+o),this.addressMap.delete(o));let s=(0,zR.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,n),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){St("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let o=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(o)}else St("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{St("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let o of this.addressMap.values())this.uneject(o),o.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return vb}};es.OutlierDetectionLoadBalancer=Ff;function _3(){g3&&(0,qR.registerLoadBalancerType)(vb,Ff,Gc)}es.setup=_3});var bb=S(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.OutlierDetectionLoadBalancingConfig=Y.BaseSubchannelWrapper=Y.registerAdminService=Y.FilterStackFactory=Y.BaseFilter=Y.PickResultType=Y.QueuePicker=Y.UnavailablePicker=Y.ChildLoadBalancerHandler=Y.subchannelAddressToString=Y.validateLoadBalancingConfig=Y.getFirstUsableConfig=Y.registerLoadBalancerType=Y.createChildChannelControlHelper=Y.BackoffTimeout=Y.durationToMs=Y.uriToString=Y.createResolver=Y.registerResolver=Y.log=Y.trace=void 0;var jR=Ke();Object.defineProperty(Y,"trace",{enumerable:!0,get:function(){return jR.trace}});Object.defineProperty(Y,"log",{enumerable:!0,get:function(){return jR.log}});var GR=En();Object.defineProperty(Y,"registerResolver",{enumerable:!0,get:function(){return GR.registerResolver}});Object.defineProperty(Y,"createResolver",{enumerable:!0,get:function(){return GR.createResolver}});var b3=yi();Object.defineProperty(Y,"uriToString",{enumerable:!0,get:function(){return b3.uriToString}});var w3=ub();Object.defineProperty(Y,"durationToMs",{enumerable:!0,get:function(){return w3.durationToMs}});var S3=hc();Object.defineProperty(Y,"BackoffTimeout",{enumerable:!0,get:function(){return S3.BackoffTimeout}});var Lf=Rr();Object.defineProperty(Y,"createChildChannelControlHelper",{enumerable:!0,get:function(){return Lf.createChildChannelControlHelper}});Object.defineProperty(Y,"registerLoadBalancerType",{enumerable:!0,get:function(){return Lf.registerLoadBalancerType}});Object.defineProperty(Y,"getFirstUsableConfig",{enumerable:!0,get:function(){return Lf.getFirstUsableConfig}});Object.defineProperty(Y,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return Lf.validateLoadBalancingConfig}});var E3=Tn();Object.defineProperty(Y,"subchannelAddressToString",{enumerable:!0,get:function(){return E3.subchannelAddressToString}});var C3=hh();Object.defineProperty(Y,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return C3.ChildLoadBalancerHandler}});var wb=Nr();Object.defineProperty(Y,"UnavailablePicker",{enumerable:!0,get:function(){return wb.UnavailablePicker}});Object.defineProperty(Y,"QueuePicker",{enumerable:!0,get:function(){return wb.QueuePicker}});Object.defineProperty(Y,"PickResultType",{enumerable:!0,get:function(){return wb.PickResultType}});var T3=lf();Object.defineProperty(Y,"BaseFilter",{enumerable:!0,get:function(){return T3.BaseFilter}});var x3=O_();Object.defineProperty(Y,"FilterStackFactory",{enumerable:!0,get:function(){return x3.FilterStackFactory}});var I3=mh();Object.defineProperty(Y,"registerAdminService",{enumerable:!0,get:function(){return I3.registerAdminService}});var D3=Ef();Object.defineProperty(Y,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return D3.BaseSubchannelWrapper}});var A3=_b();Object.defineProperty(Y,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return A3.OutlierDetectionLoadBalancingConfig}})});var $R=S(Bf=>{"use strict";Object.defineProperty(Bf,"__esModule",{value:!0});Bf.setup=void 0;var R3=En(),Sb=class{constructor(e,t,n){this.listener=t,this.addresses=[],this.hasReturnedResult=!1;let r;e.authority===""?r="/"+e.path:r=e.path,this.addresses=[{path:r}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function k3(){(0,R3.registerResolver)("unix",Sb)}Bf.setup=k3});var YR=S(qf=>{"use strict";Object.defineProperty(qf,"__esModule",{value:!0});qf.setup=void 0;var HR=ge("net"),Vf=he(),Eb=Zt(),WR=En(),KR=yi(),M3=Ke(),O3="ip_resolver";function QR(i){M3.trace(Vf.LogVerbosity.DEBUG,O3,i)}var Cb="ipv4",Tb="ipv6",N3=443,Uf=class{constructor(e,t,n){var r;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,QR("Resolver constructed for target "+(0,KR.uriToString)(e));let s=[];if(!(e.scheme===Cb||e.scheme===Tb)){this.error={code:Vf.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new Eb.Metadata};return}let o=e.path.split(",");for(let a of o){let l=(0,KR.splitHostPort)(a);if(l===null){this.error={code:Vf.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new Eb.Metadata};return}if(e.scheme===Cb&&!(0,HR.isIPv4)(l.host)||e.scheme===Tb&&!(0,HR.isIPv6)(l.host)){this.error={code:Vf.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new Eb.Metadata};return}s.push({host:l.host,port:(r=l.port)!==null&&r!==void 0?r:N3})}this.addresses=s,QR("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function P3(){(0,WR.registerResolver)(Cb,Uf),(0,WR.registerResolver)(Tb,Uf)}qf.setup=P3});var JR=S(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.setup=Bn.PickFirstLoadBalancer=Bn.shuffled=Bn.PickFirstLoadBalancingConfig=void 0;var XR=Rr(),zt=Di(),zf=Nr(),F3=Ke(),L3=he(),B3="pick_first";function xb(i){F3.trace(L3.LogVerbosity.DEBUG,B3,i)}var $c="pick_first",V3=250,Hc=class i{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return $c}toJsonObject(){return{[$c]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new i(e.shuffleAddressList===!0)}};Bn.PickFirstLoadBalancingConfig=Hc;var Ib=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:zf.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function ZR(i){let e=i.slice();for(let t=e.length-1;t>1;t--){let n=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[n],e[n]=r}return e}Bn.shuffled=ZR;var jf=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=zt.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(t,n,r,s,o)=>{this.onSubchannelStateUpdate(t,n,r,o)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(zt.ConnectivityState.READY,new Ib(this.currentPick)):this.children.length===0?this.updateState(zt.ConnectivityState.IDLE,new zf.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(zt.ConnectivityState.TRANSIENT_FAILURE,new zf.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(zt.ConnectivityState.CONNECTING,new zf.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,n,r){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){n!==zt.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){n===zt.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),n===zt.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,r&&(this.lastError=r),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,n]of this.children.entries())if(t>=e){let r=n.subchannel.getConnectivityState();if(r===zt.ConnectivityState.IDLE||r===zt.ConnectivityState.CONNECTING){this.startConnecting(t);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,n;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===zt.ConnectivityState.IDLE&&(xb("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var r;(r=this.children[e])===null||r===void 0||r.subchannel.startConnecting()})),this.connectionDelayTimeout=(n=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},V3)).unref)===null||n===void 0?void 0:n.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(xb("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){xb(zt.ConnectivityState[this.currentState]+" -> "+zt.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(n=>({subchannel:this.channelControlHelper.createSubchannel(n,{}),hasReportedTransientFailure:!1}));for(let{subchannel:n}of t)n.ref(),this.channelControlHelper.addChannelzChild(n.getChannelzRef());this.resetSubchannelList(),this.children=t;for(let{subchannel:n}of this.children)if(n.addConnectivityStateListener(this.subchannelStateListener),n.getConnectivityState()===zt.ConnectivityState.READY){this.pickSubchannel(n);return}for(let n of this.children)n.subchannel.getConnectivityState()===zt.ConnectivityState.TRANSIENT_FAILURE&&(n.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof Hc&&(t.getShuffleAddressList()&&(e=ZR(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===zt.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return $c}};Bn.PickFirstLoadBalancer=jf;function U3(){(0,XR.registerLoadBalancerType)($c,jf,Hc),(0,XR.registerDefaultLoadBalancerType)($c)}Bn.setup=U3});var t1=S(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.setup=Oa.RoundRobinLoadBalancer=void 0;var q3=Rr(),jt=Di(),Gf=Nr(),z3=Tn(),j3=Ke(),G3=he(),$3="round_robin";function e1(i){j3.trace(G3.LogVerbosity.DEBUG,$3,i)}var $f="round_robin",Db=class i{getLoadBalancerName(){return $f}constructor(){}toJsonObject(){return{[$f]:{}}}static createFromJson(e){return new i}},Ab=class{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:Gf.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},Hf=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=jt.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(t,n,r,s,o)=>{this.calculateAndUpdateState(),(r===jt.ConnectivityState.TRANSIENT_FAILURE||r===jt.ConnectivityState.IDLE)&&(o&&(this.lastError=o),this.channelControlHelper.requestReresolution(),t.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(jt.ConnectivityState.READY)>0){let e=this.subchannels.filter(n=>n.getConnectivityState()===jt.ConnectivityState.READY),t=0;this.currentReadyPicker!==null&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(jt.ConnectivityState.READY,new Ab(e,t))}else this.countSubchannelsWithState(jt.ConnectivityState.CONNECTING)>0?this.updateState(jt.ConnectivityState.CONNECTING,new Gf.QueuePicker(this)):this.countSubchannelsWithState(jt.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(jt.ConnectivityState.TRANSIENT_FAILURE,new Gf.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(jt.ConnectivityState.IDLE,new Gf.QueuePicker(this))}updateState(e,t){e1(jt.ConnectivityState[this.currentState]+" -> "+jt.ConnectivityState[e]),e===jt.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),e1("Connect to address list "+e.map(n=>(0,z3.subchannelAddressToString)(n))),this.subchannels=e.map(n=>this.channelControlHelper.createSubchannel(n,{}));for(let n of this.subchannels){n.ref(),n.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(n.getChannelzRef());let r=n.getConnectivityState();(r===jt.ConnectivityState.IDLE||r===jt.ConnectivityState.TRANSIENT_FAILURE)&&n.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return $f}};Oa.RoundRobinLoadBalancer=Hf;function H3(){(0,q3.registerLoadBalancerType)($f,Hf,Db)}Oa.setup=H3});var s1=S(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.experimental=U.addAdminServicesToServer=U.getChannelzHandlers=U.getChannelzServiceDefinition=U.InterceptorConfigurationError=U.InterceptingCall=U.RequesterBuilder=U.ListenerBuilder=U.StatusBuilder=U.getClientChannel=U.ServerCredentials=U.Server=U.setLogVerbosity=U.setLogger=U.load=U.loadObject=U.CallCredentials=U.ChannelCredentials=U.waitForClientReady=U.closeClient=U.Channel=U.makeGenericClientConstructor=U.makeClientConstructor=U.loadPackageDefinition=U.Client=U.compressionAlgorithms=U.propagate=U.connectivityState=U.status=U.logVerbosity=U.Metadata=U.credentials=void 0;var Wf=Ty();Object.defineProperty(U,"CallCredentials",{enumerable:!0,get:function(){return Wf.CallCredentials}});var W3=nv();Object.defineProperty(U,"Channel",{enumerable:!0,get:function(){return W3.ChannelImplementation}});var K3=N_();Object.defineProperty(U,"compressionAlgorithms",{enumerable:!0,get:function(){return K3.CompressionAlgorithms}});var Q3=Di();Object.defineProperty(U,"connectivityState",{enumerable:!0,get:function(){return Q3.ConnectivityState}});var Kf=sh();Object.defineProperty(U,"ChannelCredentials",{enumerable:!0,get:function(){return Kf.ChannelCredentials}});var i1=iv();Object.defineProperty(U,"Client",{enumerable:!0,get:function(){return i1.Client}});var Rb=he();Object.defineProperty(U,"logVerbosity",{enumerable:!0,get:function(){return Rb.LogVerbosity}});Object.defineProperty(U,"status",{enumerable:!0,get:function(){return Rb.Status}});Object.defineProperty(U,"propagate",{enumerable:!0,get:function(){return Rb.Propagate}});var n1=Ke(),kb=sv();Object.defineProperty(U,"loadPackageDefinition",{enumerable:!0,get:function(){return kb.loadPackageDefinition}});Object.defineProperty(U,"makeClientConstructor",{enumerable:!0,get:function(){return kb.makeClientConstructor}});Object.defineProperty(U,"makeGenericClientConstructor",{enumerable:!0,get:function(){return kb.makeClientConstructor}});var Y3=Zt();Object.defineProperty(U,"Metadata",{enumerable:!0,get:function(){return Y3.Metadata}});var X3=LR();Object.defineProperty(U,"Server",{enumerable:!0,get:function(){return X3.Server}});var Z3=ab();Object.defineProperty(U,"ServerCredentials",{enumerable:!0,get:function(){return Z3.ServerCredentials}});var J3=BR();Object.defineProperty(U,"StatusBuilder",{enumerable:!0,get:function(){return J3.StatusBuilder}});U.credentials={combineChannelCredentials:(i,...e)=>e.reduce((t,n)=>t.compose(n),i),combineCallCredentials:(i,...e)=>e.reduce((t,n)=>t.compose(n),i),createInsecure:Kf.ChannelCredentials.createInsecure,createSsl:Kf.ChannelCredentials.createSsl,createFromSecureContext:Kf.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:Wf.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:Wf.CallCredentials.createFromGoogleCredential,createEmpty:Wf.CallCredentials.createEmpty};var e4=i=>i.close();U.closeClient=e4;var t4=(i,e,t)=>i.waitForReady(e,t);U.waitForClientReady=t4;var i4=(i,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};U.loadObject=i4;var n4=(i,e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};U.load=n4;var r4=i=>{n1.setLogger(i)};U.setLogger=r4;var s4=i=>{n1.setLoggerVerbosity(i)};U.setLogVerbosity=s4;var o4=i=>i1.Client.prototype.getChannel.call(i);U.getClientChannel=o4;var Qf=Jy();Object.defineProperty(U,"ListenerBuilder",{enumerable:!0,get:function(){return Qf.ListenerBuilder}});Object.defineProperty(U,"RequesterBuilder",{enumerable:!0,get:function(){return Qf.RequesterBuilder}});Object.defineProperty(U,"InterceptingCall",{enumerable:!0,get:function(){return Qf.InterceptingCall}});Object.defineProperty(U,"InterceptorConfigurationError",{enumerable:!0,get:function(){return Qf.InterceptorConfigurationError}});var r1=Ks();Object.defineProperty(U,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return r1.getChannelzServiceDefinition}});Object.defineProperty(U,"getChannelzHandlers",{enumerable:!0,get:function(){return r1.getChannelzHandlers}});var a4=mh();Object.defineProperty(U,"addAdminServicesToServer",{enumerable:!0,get:function(){return a4.addAdminServicesToServer}});var l4=bb();U.experimental=l4;var c4=w_(),d4=$R(),u4=YR(),h4=JR(),f4=t1(),m4=_b(),p4=Ks();c4.setup(),d4.setup(),u4.setup(),h4.setup(),f4.setup(),m4.setup(),p4.setup()});var bP=[],AC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({imports:[ng.forRoot(bP),ng]});let i=e;return i})();function Yn(i){return i!=null&&`${i}`!="false"}function Lo(i,e=0){return wP(i)?Number(i):e}function wP(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}function Ll(i){return Array.isArray(i)?i:[i]}function He(i){return i instanceof Be?i.nativeElement:i}var ag;try{ag=typeof Intl<"u"&&Intl.v8BreakIterator}catch{ag=!1}var Ft=(()=>{let e=class e{constructor(n){this._platformId=n,this.isBrowser=this._platformId?dC(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||ag)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(r){return new(r||e)(N(fn))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var Bo,RC=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function lg(){if(Bo)return Bo;if(typeof document!="object"||!document)return Bo=new Set(RC),Bo;let i=document.createElement("input");return Bo=new Set(RC.filter(e=>(i.setAttribute("type",e),i.type===e))),Bo}var Bl;function SP(){if(Bl==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Bl=!0}))}finally{Bl=Bl||!1}return Bl}function Xn(i){return SP()?i:!!i.capture}var og;function EP(){if(og==null){let i=typeof document<"u"?document.head:null;og=!!(i&&(i.createShadowRoot||i.attachShadow))}return og}function cg(i){if(EP()){let e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function ks(i){return i.composedPath?i.composedPath()[0]:i.target}function kC(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var CP=new W("cdk-dir-doc",{providedIn:"root",factory:TP});function TP(){return Nt(lt)}var xP=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function IP(i){let e=i?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?xP.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var Vl=(()=>{let e=class e{constructor(n){if(this.value="ltr",this.change=new ot,n){let r=n.body?n.body.dir:null,s=n.documentElement?n.documentElement.dir:null;this.value=IP(r||s||"ltr")}}ngOnDestroy(){this.change.complete()}};e.\u0275fac=function(r){return new(r||e)(N(CP,8))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var dg=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({});let i=e;return i})();var AP=20,OC=(()=>{let e=class e{constructor(n,r,s){this._ngZone=n,this._platform=r,this._scrolled=new te,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=s}register(n){this.scrollContainers.has(n)||this.scrollContainers.set(n,n.elementScrolled().subscribe(()=>this._scrolled.next(n)))}deregister(n){let r=this.scrollContainers.get(n);r&&(r.unsubscribe(),this.scrollContainers.delete(n))}scrolled(n=AP){return this._platform.isBrowser?new mt(r=>{this._globalSubscription||this._addGlobalListener();let s=n>0?this._scrolled.pipe(Qp(n)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{s.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ot()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((n,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(n,r){let s=this.getAncestorScrollContainers(n);return this.scrolled(r).pipe(un(o=>!o||s.indexOf(o)>-1))}getAncestorScrollContainers(n){let r=[];return this.scrollContainers.forEach((s,o)=>{this._scrollableContainsElement(o,n)&&r.push(o)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(n,r){let s=He(r),o=n.getElementRef().nativeElement;do if(s==o)return!0;while(s=s.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let n=this._getWindow();return Kp(n.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}};e.\u0275fac=function(r){return new(r||e)(N(se),N(Ft),N(lt,8))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var RP=20,NC=(()=>{let e=class e{constructor(n,r,s){this._platform=n,this._change=new te,this._changeListener=o=>{this._change.next(o)},this._document=s,r.runOutsideAngular(()=>{if(n.isBrowser){let o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let n=this._getWindow();n.removeEventListener("resize",this._changeListener),n.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let n={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),n}getViewportRect(){let n=this.getViewportScrollPosition(),{width:r,height:s}=this.getViewportSize();return{top:n.top,left:n.left,bottom:n.top+s,right:n.left+r,height:s,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let n=this._document,r=this._getWindow(),s=n.documentElement,o=s.getBoundingClientRect(),a=-o.top||n.body.scrollTop||r.scrollY||s.scrollTop||0,l=-o.left||n.body.scrollLeft||r.scrollX||s.scrollLeft||0;return{top:a,left:l}}change(n=RP){return n>0?this._change.pipe(Qp(n)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let n=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:n.innerWidth,height:n.innerHeight}:{width:0,height:0}}};e.\u0275fac=function(r){return new(r||e)(N(Ft),N(se),N(lt,8))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var PC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({});let i=e;return i})();var MP=(()=>{let e=class e{create(n){return typeof MutationObserver>"u"?null:new MutationObserver(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var FC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({providers:[MP]});let i=e;return i})();var LC=new Set,Os,OP=(()=>{let e=class e{constructor(n,r){this._platform=n,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):PP}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&NP(n,this._nonce),this._matchMedia(n)}};e.\u0275fac=function(r){return new(r||e)(N(Ft),N(sC,8))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function NP(i,e){if(!LC.has(i))try{Os||(Os=document.createElement("style"),e&&(Os.nonce=e),Os.setAttribute("type","text/css"),document.head.appendChild(Os)),Os.sheet&&(Os.sheet.insertRule(`@media ${i} {body{ }}`,0),LC.add(i))}catch(t){console.error(t)}}function PP(i){return{matches:i==="all"||i==="",media:i,addListener:()=>{},removeListener:()=>{}}}var VC=(()=>{let e=class e{constructor(n,r){this._mediaMatcher=n,this._zone=r,this._queries=new Map,this._destroySubject=new te}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return BC(Ll(n)).some(s=>this._registerQuery(s).mql.matches)}observe(n){let s=BC(Ll(n)).map(a=>this._registerQuery(a).observable),o=YE(s);return o=XE(o.pipe(Ds(1)),o.pipe(rC(1),eC(0))),o.pipe(pe(a=>{let l={matches:!1,breakpoints:{}};return a.forEach(({matches:c,query:d})=>{l.matches=l.matches||c,l.breakpoints[d]=c}),l}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);let r=this._mediaMatcher.matchMedia(n),o={observable:new mt(a=>{let l=c=>this._zone.run(()=>a.next(c));return r.addListener(l),()=>{r.removeListener(l)}}).pipe(Ei(r),pe(({matches:a})=>({query:n,matches:a})),si(this._destroySubject)),mql:r};return this._queries.set(n,o),o}};e.\u0275fac=function(r){return new(r||e)(N(OP),N(se))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function BC(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function mu(i){return i.buttons===0||i.detail===0}function pu(i){let e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var UC="cdk-high-contrast-black-on-white",qC="cdk-high-contrast-white-on-black",ug="cdk-high-contrast-active",zC=(()=>{let e=class e{constructor(n,r){this._platform=n,this._document=r,this._breakpointSubscription=Nt(VC).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;let n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);let r=this._document.defaultView||window,s=r&&r.getComputedStyle?r.getComputedStyle(n):null,o=(s&&s.backgroundColor||"").replace(/ /g,"");switch(n.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let n=this._document.body.classList;n.remove(ug,UC,qC),this._hasCheckedHighContrastMode=!0;let r=this.getHighContrastMode();r===1?n.add(ug,UC):r===2&&n.add(ug,qC)}}};e.\u0275fac=function(r){return new(r||e)(N(Ft),N(lt))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function vg(i,e,t){for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];r?i.setProperty(n,r,t?.has(n)?"important":""):i.removeProperty(n)}return i}function Vo(i,e){let t=e?"":"none";vg(i.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function jC(i,e,t){vg(i.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},t)}function _u(i,e){return e&&e!="none"?i+" "+e:i}function GC(i){let e=i.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(i)*e}function LP(i){let e=getComputedStyle(i),t=hg(e,"transition-property"),n=t.find(a=>a==="transform"||a==="all");if(!n)return 0;let r=t.indexOf(n),s=hg(e,"transition-duration"),o=hg(e,"transition-delay");return GC(s[r])+GC(o[r])}function hg(i,e){return i.getPropertyValue(e).split(",").map(n=>n.trim())}function _g(i){let e=i.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function mg(i,e,t){let{top:n,bottom:r,left:s,right:o}=i;return t>=n&&t<=r&&e>=s&&e<=o}function ql(i,e,t){i.top+=e,i.bottom=i.top+i.height,i.left+=t,i.right=i.left+i.width}function $C(i,e,t,n){let{top:r,right:s,bottom:o,left:a,width:l,height:c}=i,d=l*e,u=c*e;return n>r-u&&n<o+u&&t>a-d&&t<s+d}var bu=class{constructor(e){this._document=e,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:_g(t)})})}handleScroll(e){let t=ks(e),n=this.positions.get(t);if(!n)return null;let r=n.scrollPosition,s,o;if(t===this._document){let c=this.getViewportScrollPosition();s=c.top,o=c.left}else s=t.scrollTop,o=t.scrollLeft;let a=r.top-s,l=r.left-o;return this.positions.forEach((c,d)=>{c.clientRect&&t!==d&&t.contains(d)&&ql(c.clientRect,a,l)}),r.top=s,r.left=o,{top:a,left:l}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function HC(i){let e=i.cloneNode(!0),t=e.querySelectorAll("[id]"),n=i.nodeName.toLowerCase();e.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return n==="canvas"?QC(i,e):(n==="input"||n==="select"||n==="textarea")&&KC(i,e),WC("canvas",i,e,QC),WC("input, textarea, select",i,e,KC),e}function WC(i,e,t,n){let r=e.querySelectorAll(i);if(r.length){let s=t.querySelectorAll(i);for(let o=0;o<r.length;o++)n(r[o],s[o])}}var BP=0;function KC(i,e){e.type!=="file"&&(e.value=i.value),e.type==="radio"&&e.name&&(e.name=`mat-clone-${e.name}-${BP++}`)}function QC(i,e){let t=e.getContext("2d");if(t)try{t.drawImage(i,0,0)}catch{}}var YC=Xn({passive:!0}),gu=Xn({passive:!1}),VP=800,fg=new Set(["position"]),pg=class{get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(e){e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>Vo(t,e)))}constructor(e,t,n,r,s,o){this._config=t,this._document=n,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new te,this._pointerMoveSubscription=zi.EMPTY,this._pointerUpSubscription=zi.EMPTY,this._scrollSubscription=zi.EMPTY,this._resizeSubscription=zi.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new te,this.started=new te,this.released=new te,this.ended=new te,this.entered=new te,this.exited=new te,this.dropped=new te,this.moved=this._moveEvents,this._pointerDown=a=>{if(this.beforeStarted.next(),this._handles.length){let l=this._getTargetHandle(a);l&&!this._disabledHandles.has(l)&&!this.disabled&&this._initializeDragSequence(l,a)}else this.disabled||this._initializeDragSequence(this._rootElement,a)},this._pointerMove=a=>{let l=this._getPointerPositionOnPage(a);if(!this._hasStartedDragging){let d=Math.abs(l.x-this._pickupPositionOnPage.x),u=Math.abs(l.y-this._pickupPositionOnPage.y);if(d+u>=this._config.dragStartThreshold){let m=Date.now()>=this._dragStartTime+this._getDragStartDelay(a),g=this._dropContainer;if(!m){this._endDragSequence(a);return}(!g||!g.isDragging()&&!g.isReceiving())&&(a.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(a)))}return}a.preventDefault();let c=this._getConstrainedPointerPosition(l);if(this._hasMoved=!0,this._lastKnownPointerPosition=l,this._updatePointerDirectionDelta(c),this._dropContainer)this._updateActiveDropContainer(c,l);else{let d=this.constrainPosition?this._initialClientRect:this._pickupPositionOnPage,u=this._activeTransform;u.x=c.x-d.x+this._passiveTransform.x,u.y=c.y-d.y+this._passiveTransform.y,this._applyRootElementTransform(u.x,u.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:c,event:a,distance:this._getDragDistance(c),delta:this._pointerDirectionDelta})})},this._pointerUp=a=>{this._endDragSequence(a)},this._nativeDragStart=a=>{if(this._handles.length){let l=this._getTargetHandle(a);l&&!this._disabledHandles.has(l)&&!this.disabled&&a.preventDefault()}else this.disabled||a.preventDefault()},this.withRootElement(e).withParent(t.parentDragRef||null),this._parentPositions=new bu(n),o.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(n=>He(n)),this._handles.forEach(n=>Vo(n,this.disabled)),this._toggleNativeDragInteractions();let t=new Set;return this._disabledHandles.forEach(n=>{this._handles.indexOf(n)>-1&&t.add(n)}),this._disabledHandles=t,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){let t=He(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,gu),t.addEventListener("touchstart",this._pointerDown,YC),t.addEventListener("dragstart",this._nativeDragStart,gu)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?He(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),Vo(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),Vo(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){let e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){let e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview?.remove(),this._previewRef?.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let t=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){Ul(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let t=this._dropContainer;if(t){let n=this._rootElement,r=n.parentNode,s=this._placeholder=this._createPlaceholderElement(),o=this._anchor=this._anchor||this._document.createComment(""),a=this._getShadowRoot();r.insertBefore(o,n),this._initialTransform=n.style.transform||"",this._preview=this._createPreviewElement(),jC(n,!1,fg),this._document.body.appendChild(r.replaceChild(s,n)),this._getPreviewInsertionPoint(r,a).appendChild(this._preview),this.started.next({source:this,event:e}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(e,t){this._parentDragRef&&t.stopPropagation();let n=this.isDragging(),r=Ul(t),s=!r&&t.button!==0,o=this._rootElement,a=ks(t),l=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+VP>Date.now(),c=r?pu(t):mu(t);if(a&&a.draggable&&t.type==="mousedown"&&t.preventDefault(),n||s||l||c)return;if(this._handles.length){let h=o.style;this._rootElementTapHighlight=h.webkitTapHighlightColor||"",h.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._initialClientRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(h=>this._updateOnScroll(h)),this._boundaryElement&&(this._boundaryRect=_g(this._boundaryElement));let d=this._previewTemplate;this._pickupPositionInElement=d&&d.template&&!d.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialClientRect,e,t);let u=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:u.x,y:u.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){jC(this._rootElement,!0,fg),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialClientRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let t=this._dropContainer,n=t.getItemIndex(this),r=this._getPointerPositionOnPage(e),s=this._getDragDistance(r),o=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:s,dropPoint:r,event:e}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:s,dropPoint:r,event:e}),t.drop(this,n,this._initialIndex,this._initialContainer,o,s,r,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:n,y:r}){let s=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,e,t,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(n,r),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,t):this._applyPreviewTransform(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_createPreviewElement(){let e=this._previewTemplate,t=this.previewClass,n=e?e.template:null,r;if(n&&e){let s=e.matchSize?this._initialClientRect:null,o=e.viewContainer.createEmbeddedView(n,e.context);o.detectChanges(),r=ZC(o,this._document),this._previewRef=o,e.matchSize?JC(r,s):r.style.transform=vu(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=HC(this._rootElement),JC(r,this._initialClientRect),this._initialTransform&&(r.style.transform=this._initialTransform);return vg(r.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},fg),Vo(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(s=>r.classList.add(s)):r.classList.add(t)),r}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let e=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);let t=LP(this._preview);return t===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(n=>{let r=o=>{(!o||ks(o)===this._preview&&o.propertyName==="transform")&&(this._preview?.removeEventListener("transitionend",r),n(),clearTimeout(s))},s=setTimeout(r,t*1.5);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){let e=this._placeholderTemplate,t=e?e.template:null,n;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),n=ZC(this._placeholderRef,this._document)):n=HC(this._rootElement),n.style.pointerEvents="none",n.classList.add("cdk-drag-placeholder"),n}_getPointerPositionInElement(e,t,n){let r=t===this._rootElement?null:t,s=r?r.getBoundingClientRect():e,o=Ul(n)?n.targetTouches[0]:n,a=this._getViewportScrollPosition(),l=o.pageX-s.left-a.left,c=o.pageY-s.top-a.top;return{x:s.left-e.left+l,y:s.top-e.top+c}}_getPointerPositionOnPage(e){let t=this._getViewportScrollPosition(),n=Ul(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,r=n.pageX-t.left,s=n.pageY-t.top;if(this._ownerSVGElement){let o=this._ownerSVGElement.getScreenCTM();if(o){let a=this._ownerSVGElement.createSVGPoint();return a.x=r,a.y=s,a.matrixTransform(o.inverse())}}return{x:r,y:s}}_getConstrainedPointerPosition(e){let t=this._dropContainer?this._dropContainer.lockAxis:null,{x:n,y:r}=this.constrainPosition?this.constrainPosition(e,this,this._initialClientRect,this._pickupPositionInElement):e;if(this.lockAxis==="x"||t==="x"?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||t==="y")&&(n=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:s,y:o}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:l,height:c}=this._getPreviewRect(),d=a.top+o,u=a.bottom-(c-o),h=a.left+s,m=a.right-(l-s);n=XC(n,h,m),r=XC(r,d,u)}return{x:n,y:r}}_updatePointerDirectionDelta(e){let{x:t,y:n}=e,r=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,o=Math.abs(t-s.x),a=Math.abs(n-s.y);return o>this._config.pointerDirectionChangeThreshold&&(r.x=t>s.x?1:-1,s.x=t),a>this._config.pointerDirectionChangeThreshold&&(r.y=n>s.y?1:-1,s.y=n),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,Vo(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,gu),e.removeEventListener("touchstart",this._pointerDown,YC),e.removeEventListener("dragstart",this._nativeDragStart,gu)}_applyRootElementTransform(e,t){let n=vu(e,t),r=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=r.transform&&r.transform!="none"?r.transform:""),r.transform=_u(n,this._initialTransform)}_applyPreviewTransform(e,t){let n=this._previewTemplate?.template?void 0:this._initialTransform,r=vu(e,t);this._preview.style.transform=_u(r,n)}_getDragDistance(e){let t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(e===0&&t===0||this.isDragging()||!this._boundaryElement)return;let n=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(r.width===0&&r.height===0||n.width===0&&n.height===0)return;let s=r.left-n.left,o=n.right-r.right,a=r.top-n.top,l=n.bottom-r.bottom;r.width>n.width?(s>0&&(e+=s),o>0&&(e-=o)):e=0,r.height>n.height?(a>0&&(t+=a),l>0&&(t-=l)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){let t=this.dragStartDelay;return typeof t=="number"?t:Ul(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){let t=this._parentPositions.handleScroll(e);if(t){let n=ks(e);this._boundaryRect&&n!==this._boundaryElement&&n.contains(this._boundaryElement)&&ql(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=cg(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,t){let n=this._previewContainer||"global";if(n==="parent")return e;if(n==="global"){let r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return He(n)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialClientRect),this._previewRect}_getTargetHandle(e){return this._handles.find(t=>e.target&&(e.target===t||t.contains(e.target)))}};function vu(i,e){return`translate3d(${Math.round(i)}px, ${Math.round(e)}px, 0)`}function XC(i,e,t){return Math.max(e,Math.min(t,i))}function Ul(i){return i.type[0]==="t"}function ZC(i,e){let t=i.rootNodes;if(t.length===1&&t[0].nodeType===e.ELEMENT_NODE)return t[0];let n=e.createElement("div");return t.forEach(r=>n.appendChild(r)),n}function JC(i,e){i.style.width=`${e.width}px`,i.style.height=`${e.height}px`,i.style.transform=vu(e.left,e.top)}function bg(i,e,t){let n=wu(e,i.length-1),r=wu(t,i.length-1);if(n===r)return;let s=i[n],o=r<n?-1:1;for(let a=n;a!==r;a+=o)i[a]=i[a+o];i[r]=s}function rT(i,e,t,n){let r=wu(t,i.length-1),s=wu(n,e.length);i.length&&e.splice(s,0,i.splice(r,1)[0])}function wu(i,e){return Math.max(0,Math.min(e,i))}var gg=class{constructor(e,t){this._element=e,this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(e){this.withItems(e)}sort(e,t,n,r){let s=this._itemPositions,o=this._getItemIndexFromPointerPosition(e,t,n,r);if(o===-1&&s.length>0)return null;let a=this.orientation==="horizontal",l=s.findIndex(y=>y.drag===e),c=s[o],d=s[l].clientRect,u=c.clientRect,h=l>o?1:-1,m=this._getItemOffsetPx(d,u,h),g=this._getSiblingOffsetPx(l,s,h),_=s.slice();return bg(s,l,o),s.forEach((y,A)=>{if(_[A]===y)return;let w=y.drag===e,R=w?m:g,k=w?e.getPlaceholderElement():y.drag.getRootElement();y.offset+=R,a?(k.style.transform=_u(`translate3d(${Math.round(y.offset)}px, 0, 0)`,y.initialTransform),ql(y.clientRect,0,R)):(k.style.transform=_u(`translate3d(0, ${Math.round(y.offset)}px, 0)`,y.initialTransform),ql(y.clientRect,R,0))}),this._previousSwap.overlaps=mg(u,t,n),this._previousSwap.drag=c.drag,this._previousSwap.delta=a?r.x:r.y,{previousIndex:l,currentIndex:o}}enter(e,t,n,r){let s=r==null||r<0?this._getItemIndexFromPointerPosition(e,t,n):r,o=this._activeDraggables,a=o.indexOf(e),l=e.getPlaceholderElement(),c=o[s];if(c===e&&(c=o[s+1]),!c&&(s==null||s===-1||s<o.length-1)&&this._shouldEnterAsFirstChild(t,n)&&(c=o[0]),a>-1&&o.splice(a,1),c&&!this._dragDropRegistry.isDragging(c)){let d=c.getRootElement();d.parentElement.insertBefore(l,d),o.splice(s,0,e)}else He(this._element).appendChild(l),o.push(e);l.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables.forEach(e=>{let t=e.getRootElement();if(t){let n=this._itemPositions.find(r=>r.drag===e)?.initialTransform;t.style.transform=n||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return(this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions).findIndex(n=>n.drag===e)}updateOnScroll(e,t){this._itemPositions.forEach(({clientRect:n})=>{ql(n,e,t)}),this._itemPositions.forEach(({drag:n})=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}_cacheItemPositions(){let e=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(t=>{let n=t.getVisibleElement();return{drag:t,offset:0,initialTransform:n.style.transform||"",clientRect:_g(n)}}).sort((t,n)=>e?t.clientRect.left-n.clientRect.left:t.clientRect.top-n.clientRect.top)}_getItemOffsetPx(e,t,n){let r=this.orientation==="horizontal",s=r?t.left-e.left:t.top-e.top;return n===-1&&(s+=r?t.width-e.width:t.height-e.height),s}_getSiblingOffsetPx(e,t,n){let r=this.orientation==="horizontal",s=t[e].clientRect,o=t[e+n*-1],a=s[r?"width":"height"]*n;if(o){let l=r?"left":"top",c=r?"right":"bottom";n===-1?a-=o.clientRect[l]-s[c]:a+=s[l]-o.clientRect[c]}return a}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;let n=this._itemPositions,r=this.orientation==="horizontal";if(n[0].drag!==this._activeDraggables[0]){let o=n[n.length-1].clientRect;return r?e>=o.right:t>=o.bottom}else{let o=n[0].clientRect;return r?e<=o.left:t<=o.top}}_getItemIndexFromPointerPosition(e,t,n,r){let s=this.orientation==="horizontal",o=this._itemPositions.findIndex(({drag:a,clientRect:l})=>{if(a===e)return!1;if(r){let c=s?r.x:r.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&c===this._previousSwap.delta)return!1}return s?t>=Math.floor(l.left)&&t<Math.floor(l.right):n>=Math.floor(l.top)&&n<Math.floor(l.bottom)});return o===-1||!this._sortPredicate(o,e)?-1:o}},eT=.05,sT=.05,yg=class{constructor(e,t,n,r,s){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new te,this.entered=new te,this.exited=new te,this.dropped=new te,this.sorted=new te,this.receivingStarted=new te,this.receivingStopped=new te,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=zi.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new te,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),ZE(0,Wp).pipe(si(this._stopScrollTimers)).subscribe(()=>{let o=this._scrollNode,a=this.autoScrollStep;this._verticalScrollDirection===1?o.scrollBy(0,-a):this._verticalScrollDirection===2&&o.scrollBy(0,a),this._horizontalScrollDirection===1?o.scrollBy(-a,0):this._horizontalScrollDirection===2&&o.scrollBy(a,0)})},this.element=He(e),this._document=n,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new bu(n),this._sortStrategy=new gg(this.element,t),this._sortStrategy.withSortPredicate((o,a)=>this.sortPredicate(o,a,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,t,n,r){this._draggingStarted(),r==null&&this.sortingDisabled&&(r=this._draggables.indexOf(e)),this._sortStrategy.enter(e,t,n,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,n,r,s,o,a,l={}){this._reset(),this.dropped.next({item:e,currentIndex:t,previousIndex:n,container:this,previousContainer:r,isPointerOverContainer:s,distance:o,dropPoint:a,event:l})}withItems(e){let t=this._draggables;return this._draggables=e,e.forEach(n=>n._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>e.indexOf(r)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._sortStrategy.direction=e,this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){return this._sortStrategy.orientation=e,this}withScrollableParents(e){let t=He(this.element);return this._scrollableElements=e.indexOf(t)===-1?[t,...e]:e.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,n,r){if(this.sortingDisabled||!this._clientRect||!$C(this._clientRect,eT,t,n))return;let s=this._sortStrategy.sort(e,t,n,r);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let n,r=0,s=0;if(this._parentPositions.positions.forEach((o,a)=>{a===this._document||!o.clientRect||n||$C(o.clientRect,eT,e,t)&&([r,s]=UP(a,o.clientRect,e,t),(r||s)&&(n=a))}),!r&&!s){let{width:o,height:a}=this._viewportRuler.getViewportSize(),l={width:o,height:a,top:0,right:o,bottom:a,left:0};r=oT(l,t),s=aT(l,e),n=window}n&&(r!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=s,this._scrollNode=n,(r||s)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let e=He(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){let e=He(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(e).clientRect}_reset(){this._isDragging=!1;let e=He(this.element).style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(e,t){return this._clientRect!=null&&mg(this._clientRect,e,t)}_getSiblingContainerFromPosition(e,t,n){return this._siblings.find(r=>r._canReceive(e,t,n))}_canReceive(e,t,n){if(!this._clientRect||!mg(this._clientRect,t,n)||!this.enterPredicate(e,this))return!1;let r=this._getShadowRoot().elementFromPoint(t,n);if(!r)return!1;let s=He(this.element);return r===s||s.contains(r)}_startReceiving(e,t){let n=this._activeSiblings;!n.has(e)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(n.add(e),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:e,receiver:this,items:t}))}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:e,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){let t=this._parentPositions.handleScroll(e);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let e=cg(He(this.element));this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let e=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,e))}};function oT(i,e){let{top:t,bottom:n,height:r}=i,s=r*sT;return e>=t-s&&e<=t+s?1:e>=n-s&&e<=n+s?2:0}function aT(i,e){let{left:t,right:n,width:r}=i,s=r*sT;return e>=t-s&&e<=t+s?1:e>=n-s&&e<=n+s?2:0}function UP(i,e,t,n){let r=oT(e,n),s=aT(e,t),o=0,a=0;if(r){let l=i.scrollTop;r===1?l>0&&(o=1):i.scrollHeight-l>i.clientHeight&&(o=2)}if(s){let l=i.scrollLeft;s===1?l>0&&(a=1):i.scrollWidth-l>i.clientWidth&&(a=2)}return[o,a]}var yu=Xn({passive:!1,capture:!0}),qP=(()=>{let e=class e{constructor(n,r){this._ngZone=n,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=s=>s.isDragging(),this.pointerMove=new te,this.pointerUp=new te,this.scroll=new te,this._preventDefaultWhileDragging=s=>{this._activeDragInstances.length>0&&s.preventDefault()},this._persistentTouchmoveListener=s=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&s.preventDefault(),this.pointerMove.next(s))},this._document=r}registerDropContainer(n){this._dropInstances.has(n)||this._dropInstances.add(n)}registerDragItem(n){this._dragInstances.add(n),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,yu)})}removeDropContainer(n){this._dropInstances.delete(n)}removeDragItem(n){this._dragInstances.delete(n),this.stopDragging(n),this._dragInstances.size===0&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,yu)}startDragging(n,r){if(!(this._activeDragInstances.indexOf(n)>-1)&&(this._activeDragInstances.push(n),this._activeDragInstances.length===1)){let s=r.type.startsWith("touch");this._globalListeners.set(s?"touchend":"mouseup",{handler:o=>this.pointerUp.next(o),options:!0}).set("scroll",{handler:o=>this.scroll.next(o),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:yu}),s||this._globalListeners.set("mousemove",{handler:o=>this.pointerMove.next(o),options:yu}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((o,a)=>{this._document.addEventListener(a,o.handler,o.options)})})}}stopDragging(n){let r=this._activeDragInstances.indexOf(n);r>-1&&(this._activeDragInstances.splice(r,1),this._activeDragInstances.length===0&&this._clearGlobalListeners())}isDragging(n){return this._activeDragInstances.indexOf(n)>-1}scrolled(n){let r=[this.scroll];return n&&n!==this._document&&r.push(new mt(s=>this._ngZone.runOutsideAngular(()=>{let a=l=>{this._activeDragInstances.length&&s.next(l)};return n.addEventListener("scroll",a,!0),()=>{n.removeEventListener("scroll",a,!0)}}))),br(...r)}ngOnDestroy(){this._dragInstances.forEach(n=>this.removeDragItem(n)),this._dropInstances.forEach(n=>this.removeDropContainer(n)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((n,r)=>{this._document.removeEventListener(r,n.handler,n.options)}),this._globalListeners.clear()}};e.\u0275fac=function(r){return new(r||e)(N(se),N(lt))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),zP={dragStartThreshold:5,pointerDirectionChangeThreshold:5},wg=(()=>{let e=class e{constructor(n,r,s,o){this._document=n,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=o}createDrag(n,r=zP){return new pg(n,r,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(n){return new yg(n,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}};e.\u0275fac=function(r){return new(r||e)(N(lt),N(se),N(NC),N(qP))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),tT=new W("CDK_DRAG_PARENT");var iT=new W("CdkDragHandle");var jP=new W("CdkDragPlaceholder");var GP=new W("CdkDragPreview");var lT=new W("CDK_DRAG_CONFIG"),$P="cdk-drag",cT=new W("CdkDropList"),dT=(()=>{let e=class e{get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(n){this._disabled=n,this._dragRef.disabled=this._disabled}constructor(n,r,s,o,a,l,c,d,u,h,m){this.element=n,this.dropContainer=r,this._ngZone=o,this._viewContainerRef=a,this._dir=c,this._changeDetectorRef=u,this._selfHandle=h,this._parentDrag=m,this._destroyed=new te,this.started=new ot,this.released=new ot,this.ended=new ot,this.entered=new ot,this.exited=new ot,this.dropped=new ot,this.moved=new mt(g=>{let _=this._dragRef.moved.pipe(pe(y=>({source:this,pointerPosition:y.pointerPosition,event:y.event,delta:y.delta,distance:y.distance}))).subscribe(g);return()=>{_.unsubscribe()}}),this._dragRef=d.createDrag(n,{dragStartThreshold:l&&l.dragStartThreshold!=null?l.dragStartThreshold:5,pointerDirectionChangeThreshold:l&&l.pointerDirectionChangeThreshold!=null?l.pointerDirectionChangeThreshold:5,zIndex:l?.zIndex}),this._dragRef.data=this,e._dragInstances.push(this),l&&this._assignDefaults(l),r&&(this._dragRef._withDropContainer(r._dropListRef),r.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(n){this._dragRef.setFreeDragPosition(n)}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Ds(1),si(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(n){let r=n.rootElementSelector,s=n.freeDragPosition;r&&!r.firstChange&&this._updateRootElement(),s&&!s.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);let n=e._dragInstances.indexOf(this);n>-1&&e._dragInstances.splice(n,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){let n=this.element.nativeElement,r=n;this.rootElementSelector&&(r=n.closest!==void 0?n.closest(this.rootElementSelector):n.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(r||n)}_getBoundaryElement(){let n=this.boundaryElement;return n?typeof n=="string"?this.element.nativeElement.closest(n):He(n):null}_syncInputs(n){n.beforeStarted.subscribe(()=>{if(!n.isDragging()){let r=this._dir,s=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,a=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;n.disabled=this.disabled,n.lockAxis=this.lockAxis,n.dragStartDelay=typeof s=="object"&&s?s:Lo(s),n.constrainPosition=this.constrainPosition,n.previewClass=this.previewClass,n.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(a).withPreviewContainer(this.previewContainer||"global"),r&&n.withDirection(r.value)}}),n.beforeStarted.pipe(Ds(1)).subscribe(()=>{if(this._parentDrag){n.withParent(this._parentDrag._dragRef);return}let r=this.element.nativeElement.parentElement;for(;r;){if(r.classList.contains($P)){n.withParent(e._dragInstances.find(s=>s.element.nativeElement===r)?._dragRef||null);break}r=r.parentElement}})}_handleEvents(n){n.started.subscribe(r=>{this.started.emit({source:this,event:r.event}),this._changeDetectorRef.markForCheck()}),n.released.subscribe(r=>{this.released.emit({source:this,event:r.event})}),n.ended.subscribe(r=>{this.ended.emit({source:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),n.entered.subscribe(r=>{this.entered.emit({container:r.container.data,item:this,currentIndex:r.currentIndex})}),n.exited.subscribe(r=>{this.exited.emit({container:r.container.data,item:this})}),n.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,isPointerOverContainer:r.isPointerOverContainer,item:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event})})}_assignDefaults(n){let{lockAxis:r,dragStartDelay:s,constrainPosition:o,previewClass:a,boundaryElement:l,draggingDisabled:c,rootElementSelector:d,previewContainer:u}=n;this.disabled=c??!1,this.dragStartDelay=s||0,r&&(this.lockAxis=r),o&&(this.constrainPosition=o),a&&(this.previewClass=a),l&&(this.boundaryElement=l),d&&(this.rootElementSelector=d),u&&(this.previewContainer=u)}_setupHandlesListener(){this._handles.changes.pipe(Ei(this._handles),wr(n=>{let r=n.filter(s=>s._parentDrag===this).map(s=>s.element);this._selfHandle&&this.rootElementSelector&&r.push(this.element),this._dragRef.withHandles(r)}),hn(n=>br(...n.map(r=>r._stateChanges.pipe(Ei(r))))),si(this._destroyed)).subscribe(n=>{let r=this._dragRef,s=n.element.nativeElement;n.disabled?r.disableHandle(s):r.enableHandle(s)})}};e._dragInstances=[],e.\u0275fac=function(r){return new(r||e)(V(Be),V(cT,12),V(lt),V(se),V(eg),V(lT,8),V(Vl,8),V(wg),V(Er),V(iT,10),V(tT,12))},e.\u0275dir=Le({type:e,selectors:[["","cdkDrag",""]],contentQueries:function(r,s,o){if(r&1&&(ai(o,GP,5),ai(o,jP,5),ai(o,iT,5)),r&2){let a;Ve(a=Ue())&&(s._previewTemplate=a.first),Ve(a=Ue())&&(s._placeholderTemplate=a.first),Ve(a=Ue())&&(s._handles=a)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(r,s){r&2&&Ze("cdk-drag-disabled",s.disabled)("cdk-drag-dragging",s._dragRef.isDragging())},inputs:{data:["cdkDragData","data"],lockAxis:["cdkDragLockAxis","lockAxis"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],boundaryElement:["cdkDragBoundary","boundaryElement"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"],disabled:["cdkDragDisabled","disabled",Tr],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],previewContainer:["cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[pi([{provide:tT,useExisting:e}]),Cr,Sr]});let i=e;return i})(),nT=new W("CdkDropListGroup");var HP=0,uT=(()=>{let e=class e{get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(n){this._dropListRef.disabled=this._disabled=n}constructor(n,r,s,o,a,l,c){this.element=n,this._changeDetectorRef=s,this._scrollDispatcher=o,this._dir=a,this._group=l,this._destroyed=new te,this.connectedTo=[],this.id=`cdk-drop-list-${HP++}`,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new ot,this.entered=new ot,this.exited=new ot,this.sorted=new ot,this._unsortedItems=new Set,this._dropListRef=r.createDropList(n),this._dropListRef.data=this,c&&this._assignDefaults(c),this._dropListRef.enterPredicate=(d,u)=>this.enterPredicate(d.data,u.data),this._dropListRef.sortPredicate=(d,u,h)=>this.sortPredicate(d,u.data,h.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),e._dropLists.push(this),l&&l._items.add(this)}addItem(n){this._unsortedItems.add(n),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(n){this._unsortedItems.delete(n),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((n,r)=>n._dragRef.getVisibleElement().compareDocumentPosition(r._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let n=e._dropLists.indexOf(this);n>-1&&e._dropLists.splice(n,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(n){this._dir&&this._dir.change.pipe(Ei(this._dir.value),si(this._destroyed)).subscribe(r=>n.withDirection(r)),n.beforeStarted.subscribe(()=>{let r=Ll(this.connectedTo).map(s=>{if(typeof s=="string"){let o=e._dropLists.find(a=>a.id===s);return o}return s});if(this._group&&this._group._items.forEach(s=>{r.indexOf(s)===-1&&r.push(s)}),!this._scrollableParentsResolved){let s=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(s),this._scrollableParentsResolved=!0}n.disabled=this.disabled,n.lockAxis=this.lockAxis,n.sortingDisabled=this.sortingDisabled,n.autoScrollDisabled=this.autoScrollDisabled,n.autoScrollStep=Lo(this.autoScrollStep,2),n.connectedTo(r.filter(s=>s&&s!==this).map(s=>s._dropListRef)).withOrientation(this.orientation)})}_handleEvents(n){n.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),n.entered.subscribe(r=>{this.entered.emit({container:this,item:r.item.data,currentIndex:r.currentIndex})}),n.exited.subscribe(r=>{this.exited.emit({container:this,item:r.item.data}),this._changeDetectorRef.markForCheck()}),n.sorted.subscribe(r=>{this.sorted.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,container:this,item:r.item.data})}),n.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,item:r.item.data,isPointerOverContainer:r.isPointerOverContainer,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),br(n.receivingStarted,n.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(n){let{lockAxis:r,draggingDisabled:s,sortingDisabled:o,listAutoScrollDisabled:a,listOrientation:l}=n;this.disabled=s??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=a??!1,this.orientation=l||"vertical",r&&(this.lockAxis=r)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(n=>n._dragRef))}};e._dropLists=[],e.\u0275fac=function(r){return new(r||e)(V(Be),V(wg),V(Er),V(OC),V(Vl,8),V(nT,12),V(lT,8))},e.\u0275dir=Le({type:e,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(r,s){r&2&&(Ci("id",s.id),Ze("cdk-drop-list-disabled",s.disabled)("cdk-drop-list-dragging",s._dropListRef.isDragging())("cdk-drop-list-receiving",s._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],data:["cdkDropListData","data"],orientation:["cdkDropListOrientation","orientation"],id:"id",lockAxis:["cdkDropListLockAxis","lockAxis"],disabled:["cdkDropListDisabled","disabled",Tr],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled",Tr],enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],sortPredicate:["cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled",Tr],autoScrollStep:["cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],standalone:!0,features:[pi([{provide:nT,useValue:void 0},{provide:cT,useExisting:e}]),Cr]});let i=e;return i})();var hT=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({providers:[wg],imports:[PC]});let i=e;return i})();var KP="firebase",QP="10.7.1";Kt(KP,QP,"app");var Ti=new ru("ANGULARFIRE2_VERSION");function Eg(i,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(i).getImmediate({optional:!0})}var zl=(i,e)=>{let t=e?[e]:fu(),n=[];return t.forEach(r=>{r.container.getProvider(i).instances.forEach(o=>{n.includes(o)||n.push(o)})}),n},_n=class{constructor(){return zl(YP)}},YP="app-check";function Uo(){}var Su=class{zone;delegate;constructor(e,t=WE){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,n)}},Sg=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Uo,{},Uo,Uo)),t.pipe(wr({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Zn=(()=>{class i{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Su(Zone.current)),this.insideAngular=t.run(()=>new Su(Zone.current,eu)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||i)(N(se))};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Eu(){let i=globalThis.\u0275AngularFireScheduler;if(!i)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return i}function XP(i){return Eu().ngZone.runOutsideAngular(()=>i())}function Ns(i){return Eu().ngZone.run(()=>i())}function Qt(i){return ZP(Eu())(i)}function ZP(i){return function(t){return t=t.lift(new Sg(i.ngZone)),t.pipe(Is(i.outsideAngular),_r(i.insideAngular))}}var JP=(i,e)=>function(){let n=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ns(()=>i.apply(void 0,n))},Ps=(i,e)=>function(){let t,n=arguments;for(let s=0;s<arguments.length;s++)typeof n[s]=="function"&&(e&&(t||=Ns(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Uo,{},Uo,Uo))),n[s]=JP(n[s],t));let r=XP(()=>i.apply(this,n));if(!e)if(r instanceof mt){let s=Eu();return r.pipe(Is(s.outsideAngular),_r(s.insideAngular))}else return Ns(()=>r);return r instanceof mt?r.pipe(Qt):r instanceof Promise?Ns(()=>new Promise((s,o)=>r.then(a=>Ns(()=>s(a)),a=>Ns(()=>o(a))))):typeof r=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),r.apply(this,arguments)}:Ns(()=>r)};var Fs=class{constructor(e){return e}},jl=class{constructor(){return fu()}};function eF(i){return i&&i.length===1?i[0]:new Fs(Fl())}var Cg=new W("angularfire2._apps"),tF={provide:Fs,useFactory:eF,deps:[[new Gi,Cg]]},iF={provide:jl,deps:[[new Gi,Cg]]};function nF(i){return(e,t)=>{let n=e.runOutsideAngular(()=>i(t));return new Fs(n)}}var rF=(()=>{class i{constructor(t){Kt("angularfire",Ti.full,"core"),Kt("angularfire",Ti.full,"app"),Kt("angular",su.full,t.toString())}static \u0275fac=function(n){return new(n||i)(N(fn))};static \u0275mod=ee({type:i});static \u0275inj=J({providers:[tF,iF]})}return i})();function mT(i,...e){return{ngModule:rF,providers:[{provide:Cg,useFactory:nF(i),multi:!0,deps:[se,Ol,Zn,...e]}]}}var pT=Ps(DC,!0);var YY=$p(_P(),1);var sL="auth";var Cu=class{constructor(){return zl(sL)}};import{inspect as g4,TextEncoder as y4,TextDecoder as v4}from"util";import{randomBytes as _4}from"crypto";var oL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wi={},P,Hg=Hg||{},Q=oL||self;function Bu(i){var e=typeof i;return e=e!="object"?e:i?Array.isArray(i)?"array":e:"null",e=="array"||e=="object"&&typeof i.length=="number"}function nc(i){var e=typeof i;return e=="object"&&i!=null||e=="function"}function aL(i){return Object.prototype.hasOwnProperty.call(i,Tg)&&i[Tg]||(i[Tg]=++lL)}var Tg="closure_uid_"+(1e9*Math.random()>>>0),lL=0;function cL(i,e,t){return i.call.apply(i.bind,arguments)}function dL(i,e,t){if(!i)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),i.apply(e,r)}}return function(){return i.apply(e,arguments)}}function Lt(i,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Lt=cL:Lt=dL,Lt.apply(null,arguments)}function Tu(i,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),i.apply(this,n)}}function _t(i,e){function t(){}t.prototype=e.prototype,i.$=e.prototype,i.prototype=new t,i.prototype.constructor=i,i.ac=function(n,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(n,o)}}function xr(){this.s=this.s,this.o=this.o}var uL=0;xr.prototype.s=!1;xr.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),uL!=0)&&aL(this)};xr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var DT=Array.prototype.indexOf?function(i,e){return Array.prototype.indexOf.call(i,e,void 0)}:function(i,e){if(typeof i=="string")return typeof e!="string"||e.length!=1?-1:i.indexOf(e,0);for(let t=0;t<i.length;t++)if(t in i&&i[t]===e)return t;return-1};function Wg(i){let e=i.length;if(0<e){let t=Array(e);for(let n=0;n<e;n++)t[n]=i[n];return t}return[]}function gT(i,e){for(let t=1;t<arguments.length;t++){let n=arguments[t];if(Bu(n)){let r=i.length||0,s=n.length||0;i.length=r+s;for(let o=0;o<s;o++)i[r+o]=n[o]}else i.push(n)}}function Bt(i,e){this.type=i,this.g=this.target=e,this.defaultPrevented=!1}Bt.prototype.h=function(){this.defaultPrevented=!0};var hL=function(){if(!Q.addEventListener||!Object.defineProperty)return!1;var i=!1,e=Object.defineProperty({},"passive",{get:function(){i=!0}});try{let t=()=>{};Q.addEventListener("test",t,e),Q.removeEventListener("test",t,e)}catch{}return i}();function Ql(i){return/^[\s\xa0]*$/.test(i)}function Vu(){var i=Q.navigator;return i&&(i=i.userAgent)?i:""}function bn(i){return Vu().indexOf(i)!=-1}function Kg(i){return Kg[" "](i),i}Kg[" "]=function(){};function fL(i,e){var t=t2;return Object.prototype.hasOwnProperty.call(t,i)?t[i]:t[i]=e(i)}var mL=bn("Opera"),Go=bn("Trident")||bn("MSIE"),AT=bn("Edge"),Rg=AT||Go,RT=bn("Gecko")&&!(Vu().toLowerCase().indexOf("webkit")!=-1&&!bn("Edge"))&&!(bn("Trident")||bn("MSIE"))&&!bn("Edge"),pL=Vu().toLowerCase().indexOf("webkit")!=-1&&!bn("Edge");function kT(){var i=Q.document;return i?i.documentMode:void 0}var kg;e:{if(xu="",Iu=function(){var i=Vu();if(RT)return/rv:([^\);]+)(\)|;)/.exec(i);if(AT)return/Edge\/([\d\.]+)/.exec(i);if(Go)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(i);if(pL)return/WebKit\/(\S+)/.exec(i);if(mL)return/(?:Version)[ \/]?(\S+)/.exec(i)}(),Iu&&(xu=Iu?Iu[1]:""),Go&&(Du=kT(),Du!=null&&Du>parseFloat(xu))){kg=String(Du);break e}kg=xu}var xu,Iu,Du,Mg;Q.document&&Go?(xg=kT(),Mg=xg||parseInt(kg,10)||void 0):Mg=void 0;var xg,gL=Mg;function Yl(i,e){if(Bt.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var t=this.type=i.type,n=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=e,e=i.relatedTarget){if(RT){e:{try{Kg(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else t=="mouseover"?e=i.fromElement:t=="mouseout"&&(e=i.toElement);this.relatedTarget=e,n?(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType=typeof i.pointerType=="string"?i.pointerType:yL[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&Yl.$.h.call(this)}}_t(Yl,Bt);var yL={2:"touch",3:"pen",4:"mouse"};Yl.prototype.h=function(){Yl.$.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var rc="closure_listenable_"+(1e6*Math.random()|0),vL=0;function _L(i,e,t,n,r){this.listener=i,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.la=r,this.key=++vL,this.fa=this.ia=!1}function Uu(i){i.fa=!0,i.listener=null,i.proxy=null,i.src=null,i.la=null}function Qg(i,e,t){for(let n in i)e.call(t,i[n],n,i)}function bL(i,e){for(let t in i)e.call(void 0,i[t],t,i)}function MT(i){let e={};for(let t in i)e[t]=i[t];return e}var yT="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function OT(i,e){let t,n;for(let r=1;r<arguments.length;r++){n=arguments[r];for(t in n)i[t]=n[t];for(let s=0;s<yT.length;s++)t=yT[s],Object.prototype.hasOwnProperty.call(n,t)&&(i[t]=n[t])}}function qu(i){this.src=i,this.g={},this.h=0}qu.prototype.add=function(i,e,t,n,r){var s=i.toString();i=this.g[s],i||(i=this.g[s]=[],this.h++);var o=Ng(i,e,n,r);return-1<o?(e=i[o],t||(e.ia=!1)):(e=new _L(e,this.src,s,!!n,r),e.ia=t,i.push(e)),e};function Og(i,e){var t=e.type;if(t in i.g){var n=i.g[t],r=DT(n,e),s;(s=0<=r)&&Array.prototype.splice.call(n,r,1),s&&(Uu(e),i.g[t].length==0&&(delete i.g[t],i.h--))}}function Ng(i,e,t,n){for(var r=0;r<i.length;++r){var s=i[r];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==n)return r}return-1}var Yg="closure_lm_"+(1e6*Math.random()|0),Ig={};function NT(i,e,t,n,r){if(n&&n.once)return FT(i,e,t,n,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)NT(i,e[s],t,n,r);return null}return t=Jg(t),i&&i[rc]?i.O(e,t,nc(n)?!!n.capture:!!n,r):PT(i,e,t,!1,n,r)}function PT(i,e,t,n,r,s){if(!e)throw Error("Invalid event type");var o=nc(r)?!!r.capture:!!r,a=Zg(i);if(a||(i[Yg]=a=new qu(i)),t=a.add(e,t,n,o,s),t.proxy)return t;if(n=wL(),t.proxy=n,n.src=i,n.listener=t,i.addEventListener)hL||(r=o),r===void 0&&(r=!1),i.addEventListener(e.toString(),n,r);else if(i.attachEvent)i.attachEvent(BT(e.toString()),n);else if(i.addListener&&i.removeListener)i.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return t}function wL(){function i(t){return e.call(i.src,i.listener,t)}let e=SL;return i}function FT(i,e,t,n,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)FT(i,e[s],t,n,r);return null}return t=Jg(t),i&&i[rc]?i.P(e,t,nc(n)?!!n.capture:!!n,r):PT(i,e,t,!0,n,r)}function LT(i,e,t,n,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)LT(i,e[s],t,n,r);else n=nc(n)?!!n.capture:!!n,t=Jg(t),i&&i[rc]?(i=i.i,e=String(e).toString(),e in i.g&&(s=i.g[e],t=Ng(s,t,n,r),-1<t&&(Uu(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete i.g[e],i.h--)))):i&&(i=Zg(i))&&(e=i.g[e.toString()],i=-1,e&&(i=Ng(e,t,n,r)),(t=-1<i?e[i]:null)&&Xg(t))}function Xg(i){if(typeof i!="number"&&i&&!i.fa){var e=i.src;if(e&&e[rc])Og(e.i,i);else{var t=i.type,n=i.proxy;e.removeEventListener?e.removeEventListener(t,n,i.capture):e.detachEvent?e.detachEvent(BT(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=Zg(e))?(Og(t,i),t.h==0&&(t.src=null,e[Yg]=null)):Uu(i)}}}function BT(i){return i in Ig?Ig[i]:Ig[i]="on"+i}function SL(i,e){if(i.fa)i=!0;else{e=new Yl(e,this);var t=i.listener,n=i.la||i.src;i.ia&&Xg(i),i=t.call(n,e)}return i}function Zg(i){return i=i[Yg],i instanceof qu?i:null}var Dg="__closure_events_fn_"+(1e9*Math.random()>>>0);function Jg(i){return typeof i=="function"?i:(i[Dg]||(i[Dg]=function(e){return i.handleEvent(e)}),i[Dg])}function vt(){xr.call(this),this.i=new qu(this),this.S=this,this.J=null}_t(vt,xr);vt.prototype[rc]=!0;vt.prototype.removeEventListener=function(i,e,t,n){LT(this,i,e,t,n)};function Dt(i,e){var t,n=i.J;if(n)for(t=[];n;n=n.J)t.push(n);if(i=i.S,n=e.type||e,typeof e=="string")e=new Bt(e,i);else if(e instanceof Bt)e.target=e.target||i;else{var r=e;e=new Bt(n,i),OT(e,r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];r=Au(o,n,!0,e)&&r}if(o=e.g=i,r=Au(o,n,!0,e)&&r,r=Au(o,n,!1,e)&&r,t)for(s=0;s<t.length;s++)o=e.g=t[s],r=Au(o,n,!1,e)&&r}vt.prototype.N=function(){if(vt.$.N.call(this),this.i){var i=this.i,e;for(e in i.g){for(var t=i.g[e],n=0;n<t.length;n++)Uu(t[n]);delete i.g[e],i.h--}}this.J=null};vt.prototype.O=function(i,e,t,n){return this.i.add(String(i),e,!1,t,n)};vt.prototype.P=function(i,e,t,n){return this.i.add(String(i),e,!0,t,n)};function Au(i,e,t,n){if(e=i.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,l=o.la||o.src;o.ia&&Og(i.i,o),r=a.call(l,n)!==!1&&r}}return r&&!n.defaultPrevented}var ey=Q.JSON.stringify,Pg=class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function EL(){var i=ty;let e=null;return i.g&&(e=i.g,i.g=i.g.next,i.g||(i.h=null),e.next=null),e}var Fg=class{constructor(){this.h=this.g=null}add(e,t){let n=VT.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},VT=new Pg(()=>new Lg,i=>i.reset()),Lg=class{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}};function CL(i){var e=1;i=i.split(":");let t=[];for(;0<e&&i.length;)t.push(i.shift()),e--;return i.length&&t.push(i.join(":")),t}function TL(i){Q.setTimeout(()=>{throw i},0)}var Xl,Zl=!1,ty=new Fg,UT=()=>{let i=Q.Promise.resolve(void 0);Xl=()=>{i.then(xL)}},xL=()=>{for(var i;i=EL();){try{i.h.call(i.g)}catch(t){TL(t)}var e=VT;e.j(i),100>e.h&&(e.h++,i.next=e.g,e.g=i)}Zl=!1};function zu(i,e){vt.call(this),this.h=i||1,this.g=e||Q,this.j=Lt(this.qb,this),this.l=Date.now()}_t(zu,vt);P=zu.prototype;P.ga=!1;P.T=null;P.qb=function(){if(this.ga){var i=Date.now()-this.l;0<i&&i<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-i):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Dt(this,"tick"),this.ga&&(iy(this),this.start()))}};P.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function iy(i){i.ga=!1,i.T&&(i.g.clearTimeout(i.T),i.T=null)}P.N=function(){zu.$.N.call(this),iy(this),delete this.g};function ny(i,e,t){if(typeof i=="function")t&&(i=Lt(i,t));else if(i&&typeof i.handleEvent=="function")i=Lt(i.handleEvent,i);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Q.setTimeout(i,e||0)}function qT(i){i.g=ny(()=>{i.g=null,i.i&&(i.i=!1,qT(i))},i.j);let e=i.h;i.h=null,i.m.apply(null,e)}var Bg=class extends xr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:qT(this)}N(){super.N(),this.g&&(Q.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Jl(i){xr.call(this),this.h=i,this.g={}}_t(Jl,xr);var vT=[];function zT(i,e,t,n){Array.isArray(t)||(t&&(vT[0]=t.toString()),t=vT);for(var r=0;r<t.length;r++){var s=NT(e,t[r],n||i.handleEvent,!1,i.h||i);if(!s)break;i.g[s.key]=s}}function jT(i){Qg(i.g,function(e,t){this.g.hasOwnProperty(t)&&Xg(e)},i),i.g={}}Jl.prototype.N=function(){Jl.$.N.call(this),jT(this)};Jl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ju(){this.g=!0}ju.prototype.Ea=function(){this.g=!1};function IL(i,e,t,n,r,s){i.info(function(){if(i.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");o=2<=u.length&&u[1]=="type"?o+(d+"="+c+"&"):o+(d+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+e+`
`+t+`
`+o})}function DL(i,e,t,n,r,s,o){i.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+e+`
`+t+`
`+s+" "+o})}function zo(i,e,t,n){i.info(function(){return"XMLHTTP TEXT ("+e+"): "+RL(i,t)+(n?" "+n:"")})}function AL(i,e){i.info(function(){return"TIMEOUT: "+e})}ju.prototype.info=function(){};function RL(i,e){if(!i.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(i=0;i<t.length;i++)if(Array.isArray(t[i])){var n=t[i];if(!(2>n.length)){var r=n[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return ey(t)}catch{return e}}var Us={},_T=null;function Gu(){return _T=_T||new vt}Us.Ta="serverreachability";function GT(i){Bt.call(this,Us.Ta,i)}_t(GT,Bt);function ec(i){let e=Gu();Dt(e,new GT(e))}Us.STAT_EVENT="statevent";function $T(i,e){Bt.call(this,Us.STAT_EVENT,i),this.stat=e}_t($T,Bt);function Yt(i){let e=Gu();Dt(e,new $T(e,i))}Us.Ua="timingevent";function HT(i,e){Bt.call(this,Us.Ua,i),this.size=e}_t(HT,Bt);function sc(i,e){if(typeof i!="function")throw Error("Fn must not be null and must be a function");return Q.setTimeout(function(){i()},e)}var $u={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},WT={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function ry(){}ry.prototype.h=null;function bT(i){return i.h||(i.h=i.i())}function KT(){}var oc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function sy(){Bt.call(this,"d")}_t(sy,Bt);function oy(){Bt.call(this,"c")}_t(oy,Bt);var Vg;function Hu(){}_t(Hu,ry);Hu.prototype.g=function(){return new XMLHttpRequest};Hu.prototype.i=function(){return{}};Vg=new Hu;function ac(i,e,t,n){this.l=i,this.j=e,this.m=t,this.W=n||1,this.U=new Jl(this),this.P=kL,i=Rg?125:void 0,this.V=new zu(i),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new QT}function QT(){this.i=null,this.g="",this.h=!1}var kL=45e3,YT={},Ug={};P=ac.prototype;P.setTimeout=function(i){this.P=i};function qg(i,e,t){i.L=1,i.A=Ku(er(e)),i.u=t,i.S=!0,XT(i,null)}function XT(i,e){i.G=Date.now(),lc(i),i.B=er(i.A);var t=i.B,n=i.W;Array.isArray(n)||(n=[String(n)]),sx(t.i,"t",n),i.o=0,t=i.l.J,i.h=new QT,i.g=xx(i.l,t?e:null,!i.u),0<i.O&&(i.M=new Bg(Lt(i.Pa,i,i.g),i.O)),zT(i.U,i.g,"readystatechange",i.nb),e=i.I?MT(i.I):{},i.u?(i.v||(i.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",i.g.ha(i.B,i.v,i.u,e)):(i.v="GET",i.g.ha(i.B,i.v,null,e)),ec(),IL(i.j,i.v,i.B,i.m,i.W,i.u)}P.nb=function(i){i=i.target;let e=this.M;e&&wn(i)==3?e.l():this.Pa(i)};P.Pa=function(i){try{if(i==this.g)e:{let d=wn(this.g);var e=this.g.Ia();let u=this.g.da();if(!(3>d)&&(d!=3||Rg||this.g&&(this.h.h||this.g.ja()||CT(this.g)))){this.J||d!=4||e==7||(e==8||0>=u?ec(3):ec(2)),Wu(this);var t=this.g.da();this.ca=t;t:if(ZT(this)){var n=CT(this.g);i="";var r=n.length,s=wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ls(this),Kl(this);var o="";break t}this.h.i=new Q.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,i+=this.h.i.decode(n[e],{stream:s&&e==r-1});n.length=0,this.h.g+=i,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=t==200,DL(this.j,this.v,this.B,this.m,this.W,d,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ql(a)){var c=a;break t}}c=null}if(t=c)zo(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zg(this,t);else{this.i=!1,this.s=3,Yt(12),Ls(this),Kl(this);break e}}this.S?(JT(this,d,o),Rg&&this.i&&d==3&&(zT(this.U,this.V,"tick",this.mb),this.V.start())):(zo(this.j,this.m,o,null),zg(this,o)),d==4&&Ls(this),this.i&&!this.J&&(d==4?Sx(this.l,this):(this.i=!1,lc(this)))}else ZL(this.g),t==400&&0<o.indexOf("Unknown SID")?(this.s=3,Yt(12)):(this.s=0,Yt(13)),Ls(this),Kl(this)}}}catch{}finally{}};function ZT(i){return i.g?i.v=="GET"&&i.L!=2&&i.l.Ha:!1}function JT(i,e,t){let n=!0,r;for(;!i.J&&i.o<t.length;)if(r=ML(i,t),r==Ug){e==4&&(i.s=4,Yt(14),n=!1),zo(i.j,i.m,null,"[Incomplete Response]");break}else if(r==YT){i.s=4,Yt(15),zo(i.j,i.m,t,"[Invalid Chunk]"),n=!1;break}else zo(i.j,i.m,r,null),zg(i,r);ZT(i)&&i.o!=0&&(i.h.g=i.h.g.slice(i.o),i.o=0),e!=4||t.length!=0||i.h.h||(i.s=1,Yt(16),n=!1),i.i=i.i&&n,n?0<t.length&&!i.ba&&(i.ba=!0,e=i.l,e.g==i&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),hy(e),e.M=!0,Yt(11))):(zo(i.j,i.m,t,"[Invalid Chunked Response]"),Ls(i),Kl(i))}P.mb=function(){if(this.g){var i=wn(this.g),e=this.g.ja();this.o<e.length&&(Wu(this),JT(this,i,e),this.i&&i!=4&&lc(this))}};function ML(i,e){var t=i.o,n=e.indexOf(`
`,t);return n==-1?Ug:(t=Number(e.substring(t,n)),isNaN(t)?YT:(n+=1,n+t>e.length?Ug:(e=e.slice(n,n+t),i.o=n+t,e)))}P.cancel=function(){this.J=!0,Ls(this)};function lc(i){i.Y=Date.now()+i.P,ex(i,i.P)}function ex(i,e){if(i.C!=null)throw Error("WatchDog timer not null");i.C=sc(Lt(i.lb,i),e)}function Wu(i){i.C&&(Q.clearTimeout(i.C),i.C=null)}P.lb=function(){this.C=null;let i=Date.now();0<=i-this.Y?(AL(this.j,this.B),this.L!=2&&(ec(),Yt(17)),Ls(this),this.s=2,Kl(this)):ex(this,this.Y-i)};function Kl(i){i.l.H==0||i.J||Sx(i.l,i)}function Ls(i){Wu(i);var e=i.M;e&&typeof e.sa=="function"&&e.sa(),i.M=null,iy(i.V),jT(i.U),i.g&&(e=i.g,i.g=null,e.abort(),e.sa())}function zg(i,e){try{var t=i.l;if(t.H!=0&&(t.g==i||jg(t.i,i))){if(!i.K&&jg(t.i,i)&&t.H==3){try{var n=t.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&n.length==3){var r=n;if(r[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<i.G)Nu(t),Xu(t);else break e;uy(t),Yt(18)}}else t.Fa=r[1],0<t.Fa-t.V&&37500>r[2]&&t.G&&t.A==0&&!t.v&&(t.v=sc(Lt(t.ib,t),6e3));if(1>=lx(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Bs(t,11)}else if((i.K||t.g==i)&&Nu(t),!Ql(e))for(r=t.Ja.g.parse(e),e=0;e<r.length;e++){let c=r[e];if(t.V=c[0],c=c[1],t.H==2)if(c[0]=="c"){t.K=c[1],t.pa=c[2];let d=c[3];d!=null&&(t.ra=d,t.l.info("VER="+t.ra));let u=c[4];u!=null&&(t.Ga=u,t.l.info("SVER="+t.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(n=1.5*h,t.L=n,t.l.info("backChannelRequestTimeoutMs_="+n)),n=t;let m=i.g;if(m){let g=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var s=n.i;s.g||g.indexOf("spdy")==-1&&g.indexOf("quic")==-1&&g.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(ay(s,s.h),s.h=null))}if(n.F){let _=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;_&&(n.Da=_,ke(n.I,n.F,_))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-i.G,t.l.info("Handshake RTT: "+t.S+"ms")),n=t;var o=i;if(n.wa=Tx(n,n.J?n.pa:null,n.Y),o.K){cx(n.i,o);var a=o,l=n.L;l&&a.setTimeout(l),a.C&&(Wu(a),lc(a)),n.g=o}else bx(n);0<t.j.length&&Zu(t)}else c[0]!="stop"&&c[0]!="close"||Bs(t,7);else t.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Bs(t,7):dy(t):c[0]!="noop"&&t.h&&t.h.Aa(c),t.A=0)}}ec(4)}catch{}}function OL(i){if(i.Z&&typeof i.Z=="function")return i.Z();if(typeof Map<"u"&&i instanceof Map||typeof Set<"u"&&i instanceof Set)return Array.from(i.values());if(typeof i=="string")return i.split("");if(Bu(i)){for(var e=[],t=i.length,n=0;n<t;n++)e.push(i[n]);return e}e=[],t=0;for(n in i)e[t++]=i[n];return e}function NL(i){if(i.ta&&typeof i.ta=="function")return i.ta();if(!i.Z||typeof i.Z!="function"){if(typeof Map<"u"&&i instanceof Map)return Array.from(i.keys());if(!(typeof Set<"u"&&i instanceof Set)){if(Bu(i)||typeof i=="string"){var e=[];i=i.length;for(var t=0;t<i;t++)e.push(t);return e}e=[],t=0;for(let n in i)e[t++]=n;return e}}}function tx(i,e){if(i.forEach&&typeof i.forEach=="function")i.forEach(e,void 0);else if(Bu(i)||typeof i=="string")Array.prototype.forEach.call(i,e,void 0);else for(var t=NL(i),n=OL(i),r=n.length,s=0;s<r;s++)e.call(void 0,n[s],t&&t[s],i)}var ix=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PL(i,e){if(i){i=i.split("&");for(var t=0;t<i.length;t++){var n=i[t].indexOf("="),r=null;if(0<=n){var s=i[t].substring(0,n);r=i[t].substring(n+1)}else s=i[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function Vs(i){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,i instanceof Vs){this.h=i.h,Mu(this,i.j),this.s=i.s,this.g=i.g,Ou(this,i.m),this.l=i.l;var e=i.i,t=new tc;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),wT(this,t),this.o=i.o}else i&&(e=String(i).match(ix))?(this.h=!1,Mu(this,e[1]||"",!0),this.s=Hl(e[2]||""),this.g=Hl(e[3]||"",!0),Ou(this,e[4]),this.l=Hl(e[5]||"",!0),wT(this,e[6]||"",!0),this.o=Hl(e[7]||"")):(this.h=!1,this.i=new tc(null,this.h))}Vs.prototype.toString=function(){var i=[],e=this.j;e&&i.push(Wl(e,ST,!0),":");var t=this.g;return(t||e=="file")&&(i.push("//"),(e=this.s)&&i.push(Wl(e,ST,!0),"@"),i.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&i.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&i.push("/"),i.push(Wl(t,t.charAt(0)=="/"?BL:LL,!0))),(t=this.i.toString())&&i.push("?",t),(t=this.o)&&i.push("#",Wl(t,UL)),i.join("")};function er(i){return new Vs(i)}function Mu(i,e,t){i.j=t?Hl(e,!0):e,i.j&&(i.j=i.j.replace(/:$/,""))}function Ou(i,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);i.m=e}else i.m=null}function wT(i,e,t){e instanceof tc?(i.i=e,qL(i.i,i.h)):(t||(e=Wl(e,VL)),i.i=new tc(e,i.h))}function ke(i,e,t){i.i.set(e,t)}function Ku(i){return ke(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function Hl(i,e){return i?e?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function Wl(i,e,t){return typeof i=="string"?(i=encodeURI(i).replace(e,FL),t&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function FL(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var ST=/[#\/\?@]/g,LL=/[#\?:]/g,BL=/[#\?]/g,VL=/[#\?@]/g,UL=/#/g;function tc(i,e){this.h=this.g=null,this.i=i||null,this.j=!!e}function Ir(i){i.g||(i.g=new Map,i.h=0,i.i&&PL(i.i,function(e,t){i.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}P=tc.prototype;P.add=function(i,e){Ir(this),this.i=null,i=$o(this,i);var t=this.g.get(i);return t||this.g.set(i,t=[]),t.push(e),this.h+=1,this};function nx(i,e){Ir(i),e=$o(i,e),i.g.has(e)&&(i.i=null,i.h-=i.g.get(e).length,i.g.delete(e))}function rx(i,e){return Ir(i),e=$o(i,e),i.g.has(e)}P.forEach=function(i,e){Ir(this),this.g.forEach(function(t,n){t.forEach(function(r){i.call(e,r,n,this)},this)},this)};P.ta=function(){Ir(this);let i=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let n=0;n<e.length;n++){let r=i[n];for(let s=0;s<r.length;s++)t.push(e[n])}return t};P.Z=function(i){Ir(this);let e=[];if(typeof i=="string")rx(this,i)&&(e=e.concat(this.g.get($o(this,i))));else{i=Array.from(this.g.values());for(let t=0;t<i.length;t++)e=e.concat(i[t])}return e};P.set=function(i,e){return Ir(this),this.i=null,i=$o(this,i),rx(this,i)&&(this.h-=this.g.get(i).length),this.g.set(i,[e]),this.h+=1,this};P.get=function(i,e){return i?(i=this.Z(i),0<i.length?String(i[0]):e):e};function sx(i,e,t){nx(i,e),0<t.length&&(i.i=null,i.g.set($o(i,e),Wg(t)),i.h+=t.length)}P.toString=function(){if(this.i)return this.i;if(!this.g)return"";let i=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var n=e[t];let s=encodeURIComponent(String(n)),o=this.Z(n);for(n=0;n<o.length;n++){var r=s;o[n]!==""&&(r+="="+encodeURIComponent(String(o[n]))),i.push(r)}}return this.i=i.join("&")};function $o(i,e){return e=String(e),i.j&&(e=e.toLowerCase()),e}function qL(i,e){e&&!i.j&&(Ir(i),i.i=null,i.g.forEach(function(t,n){var r=n.toLowerCase();n!=r&&(nx(this,n),sx(this,r,t))},i)),i.j=e}var zL=class{constructor(i,e){this.g=i,this.map=e}};function ox(i){this.l=i||jL,Q.PerformanceNavigationTiming?(i=Q.performance.getEntriesByType("navigation"),i=0<i.length&&(i[0].nextHopProtocol=="hq"||i[0].nextHopProtocol=="h2")):i=!!(Q.g&&Q.g.Ka&&Q.g.Ka()&&Q.g.Ka().dc),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var jL=10;function ax(i){return i.h?!0:i.g?i.g.size>=i.j:!1}function lx(i){return i.h?1:i.g?i.g.size:0}function jg(i,e){return i.h?i.h==e:i.g?i.g.has(e):!1}function ay(i,e){i.g?i.g.add(e):i.h=e}function cx(i,e){i.h&&i.h==e?i.h=null:i.g&&i.g.has(e)&&i.g.delete(e)}ox.prototype.cancel=function(){if(this.i=dx(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let i of this.g.values())i.cancel();this.g.clear()}};function dx(i){if(i.h!=null)return i.i.concat(i.h.F);if(i.g!=null&&i.g.size!==0){let e=i.i;for(let t of i.g.values())e=e.concat(t.F);return e}return Wg(i.i)}var GL=class{stringify(i){return Q.JSON.stringify(i,void 0)}parse(i){return Q.JSON.parse(i,void 0)}};function $L(){this.g=new GL}function HL(i,e,t){let n=t||"";try{tx(i,function(r,s){let o=r;nc(r)&&(o=ey(r)),e.push(n+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(n+"type="+encodeURIComponent("_badmap")),r}}function WL(i,e){let t=new ju;if(Q.Image){let n=new Image;n.onload=Tu(Ru,t,n,"TestLoadImage: loaded",!0,e),n.onerror=Tu(Ru,t,n,"TestLoadImage: error",!1,e),n.onabort=Tu(Ru,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=Tu(Ru,t,n,"TestLoadImage: timeout",!1,e),Q.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=i}else e(!1)}function Ru(i,e,t,n,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(n)}catch{}}function cc(i){this.l=i.ec||null,this.j=i.ob||!1}_t(cc,ry);cc.prototype.g=function(){return new Qu(this.l,this.j)};cc.prototype.i=function(i){return function(){return i}}({});function Qu(i,e){vt.call(this),this.F=i,this.u=e,this.m=void 0,this.readyState=ly,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}_t(Qu,vt);var ly=0;P=Qu.prototype;P.open=function(i,e){if(this.readyState!=ly)throw this.abort(),Error("Error reopening a connection");this.C=i,this.B=e,this.readyState=1,ic(this)};P.send=function(i){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};i&&(e.body=i),(this.F||Q).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};P.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,dc(this)),this.readyState=ly};P.$a=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,ic(this)),this.g&&(this.readyState=3,ic(this),this.g)))if(this.responseType==="arraybuffer")i.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Q.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ux(this)}else i.text().then(this.Za.bind(this),this.ka.bind(this))};function ux(i){i.j.read().then(i.Xa.bind(i)).catch(i.ka.bind(i))}P.Xa=function(i){if(this.g){if(this.u&&i.value)this.response.push(i.value);else if(!this.u){var e=i.value?i.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!i.done}))&&(this.response=this.responseText+=e)}i.done?dc(this):ic(this),this.readyState==3&&ux(this)}};P.Za=function(i){this.g&&(this.response=this.responseText=i,dc(this))};P.Ya=function(i){this.g&&(this.response=i,dc(this))};P.ka=function(){this.g&&dc(this)};function dc(i){i.readyState=4,i.l=null,i.j=null,i.A=null,ic(i)}P.setRequestHeader=function(i,e){this.v.append(i,e)};P.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""};P.getAllResponseHeaders=function(){if(!this.h)return"";let i=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,i.push(t[0]+": "+t[1]),t=e.next();return i.join(`\r
`)};function ic(i){i.onreadystatechange&&i.onreadystatechange.call(i)}Object.defineProperty(Qu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(i){this.m=i?"include":"same-origin"}});var KL=Q.JSON.parse;function We(i){vt.call(this),this.headers=new Map,this.u=i||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=hx,this.L=this.M=!1}_t(We,vt);var hx="",QL=/^https?$/i,YL=["POST","PUT"];P=We.prototype;P.Oa=function(i){this.M=i};P.ha=function(i,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+i);e=e?e.toUpperCase():"GET",this.I=i,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Vg.g(),this.C=this.u?bT(this.u):bT(Vg),this.g.onreadystatechange=Lt(this.La,this);try{this.G=!0,this.g.open(e,String(i),!0),this.G=!1}catch(s){ET(this,s);return}if(i=t||"",t=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var r in n)t.set(r,n[r]);else if(typeof n.keys=="function"&&typeof n.get=="function")for(let s of n.keys())t.set(s,n.get(s));else throw Error("Unknown input type for opt_headers: "+String(n));n=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),r=Q.FormData&&i instanceof Q.FormData,!(0<=DT(YL,e))||n||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{px(this),0<this.B&&((this.L=XL(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Lt(this.ua,this)):this.A=ny(this.ua,this.B,this)),this.v=!0,this.g.send(i),this.v=!1}catch(s){ET(this,s)}};function XL(i){return Go&&typeof i.timeout=="number"&&i.ontimeout!==void 0}P.ua=function(){typeof Hg<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Dt(this,"timeout"),this.abort(8))};function ET(i,e){i.h=!1,i.g&&(i.l=!0,i.g.abort(),i.l=!1),i.j=e,i.m=5,fx(i),Yu(i)}function fx(i){i.F||(i.F=!0,Dt(i,"complete"),Dt(i,"error"))}P.abort=function(i){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=i||7,Dt(this,"complete"),Dt(this,"abort"),Yu(this))};P.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Yu(this,!0)),We.$.N.call(this)};P.La=function(){this.s||(this.G||this.v||this.l?mx(this):this.kb())};P.kb=function(){mx(this)};function mx(i){if(i.h&&typeof Hg<"u"&&(!i.C[1]||wn(i)!=4||i.da()!=2)){if(i.v&&wn(i)==4)ny(i.La,0,i);else if(Dt(i,"readystatechange"),wn(i)==4){i.h=!1;try{let o=i.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=o===0){var r=String(i.I).match(ix)[1]||null;!r&&Q.self&&Q.self.location&&(r=Q.self.location.protocol.slice(0,-1)),n=!QL.test(r?r.toLowerCase():"")}t=n}if(t)Dt(i,"complete"),Dt(i,"success");else{i.m=6;try{var s=2<wn(i)?i.g.statusText:""}catch{s=""}i.j=s+" ["+i.da()+"]",fx(i)}}finally{Yu(i)}}}}function Yu(i,e){if(i.g){px(i);let t=i.g,n=i.C[0]?()=>{}:null;i.g=null,i.C=null,e||Dt(i,"ready");try{t.onreadystatechange=n}catch{}}}function px(i){i.g&&i.L&&(i.g.ontimeout=null),i.A&&(Q.clearTimeout(i.A),i.A=null)}P.isActive=function(){return!!this.g};function wn(i){return i.g?i.g.readyState:0}P.da=function(){try{return 2<wn(this)?this.g.status:-1}catch{return-1}};P.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};P.Wa=function(i){if(this.g){var e=this.g.responseText;return i&&e.indexOf(i)==0&&(e=e.substring(i.length)),KL(e)}};function CT(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.K){case hx:case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}function ZL(i){let e={};i=(i.g&&2<=wn(i)&&i.g.getAllResponseHeaders()||"").split(`\r
`);for(let n=0;n<i.length;n++){if(Ql(i[n]))continue;var t=CL(i[n]);let r=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();let s=e[r]||[];e[r]=s,s.push(t)}bL(e,function(n){return n.join(", ")})}P.Ia=function(){return this.m};P.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function gx(i){let e="";return Qg(i,function(t,n){e+=n,e+=":",e+=t,e+=`\r
`}),e}function cy(i,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=gx(t),typeof i=="string"?t!=null&&encodeURIComponent(String(t)):ke(i,e,t))}function Gl(i,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[i]||e}function yx(i){this.Ga=0,this.j=[],this.l=new ju,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Gl("failFast",!1,i),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Gl("baseRetryDelayMs",5e3,i),this.hb=Gl("retryDelaySeedMs",1e4,i),this.eb=Gl("forwardChannelMaxRetries",2,i),this.xa=Gl("forwardChannelRequestTimeoutMs",2e4,i),this.va=i&&i.xmlHttpFactory||void 0,this.Ha=i&&i.useFetchStreams||!1,this.L=void 0,this.J=i&&i.supportsCrossDomainXhr||!1,this.K="",this.i=new ox(i&&i.concurrentRequestLimit),this.Ja=new $L,this.P=i&&i.fastHandshake||!1,this.O=i&&i.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=i&&i.bc||!1,i&&i.Ea&&this.l.Ea(),i&&i.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&i&&i.detectBufferingProxy||!1,this.qa=void 0,i&&i.longPollingTimeout&&0<i.longPollingTimeout&&(this.qa=i.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}P=yx.prototype;P.ra=8;P.H=1;function dy(i){if(vx(i),i.H==3){var e=i.W++,t=er(i.I);if(ke(t,"SID",i.K),ke(t,"RID",e),ke(t,"TYPE","terminate"),uc(i,t),e=new ac(i,i.l,e),e.L=2,e.A=Ku(er(t)),t=!1,Q.navigator&&Q.navigator.sendBeacon)try{t=Q.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&Q.Image&&(new Image().src=e.A,t=!0),t||(e.g=xx(e.l,null),e.g.ha(e.A)),e.G=Date.now(),lc(e)}Cx(i)}function Xu(i){i.g&&(hy(i),i.g.cancel(),i.g=null)}function vx(i){Xu(i),i.u&&(Q.clearTimeout(i.u),i.u=null),Nu(i),i.i.cancel(),i.m&&(typeof i.m=="number"&&Q.clearTimeout(i.m),i.m=null)}function Zu(i){if(!ax(i.i)&&!i.m){i.m=!0;var e=i.Na;Xl||UT(),Zl||(Xl(),Zl=!0),ty.add(e,i),i.C=0}}function JL(i,e){return lx(i.i)>=i.i.j-(i.m?1:0)?!1:i.m?(i.j=e.F.concat(i.j),!0):i.H==1||i.H==2||i.C>=(i.cb?0:i.eb)?!1:(i.m=sc(Lt(i.Na,i,e),Ex(i,i.C)),i.C++,!0)}P.Na=function(i){if(this.m)if(this.m=null,this.H==1){if(!i){this.W=Math.floor(1e5*Math.random()),i=this.W++;let r=new ac(this,this.l,i),s=this.s;if(this.U&&(s?(s=MT(s),OT(s,this.U)):s=this.U),this.o!==null||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var n=this.j[t];if("__data__"in n.map&&(n=n.map.__data__,typeof n=="string")){n=n.length;break t}n=void 0}if(n===void 0)break;if(e+=n,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=_x(this,r,e),t=er(this.I),ke(t,"RID",i),ke(t,"CVER",22),this.F&&ke(t,"X-HTTP-Session-Id",this.F),uc(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(gx(s)))+"&"+e:this.o&&cy(t,this.o,s)),ay(this.i,r),this.bb&&ke(t,"TYPE","init"),this.P?(ke(t,"$req",e),ke(t,"SID","null"),r.aa=!0,qg(r,t,null)):qg(r,t,e),this.H=2}}else this.H==3&&(i?TT(this,i):this.j.length==0||ax(this.i)||TT(this))};function TT(i,e){var t;e?t=e.m:t=i.W++;let n=er(i.I);ke(n,"SID",i.K),ke(n,"RID",t),ke(n,"AID",i.V),uc(i,n),i.o&&i.s&&cy(n,i.o,i.s),t=new ac(i,i.l,t,i.C+1),i.o===null&&(t.I=i.s),e&&(i.j=e.F.concat(i.j)),e=_x(i,t,1e3),t.setTimeout(Math.round(.5*i.xa)+Math.round(.5*i.xa*Math.random())),ay(i.i,t),qg(t,n,e)}function uc(i,e){i.na&&Qg(i.na,function(t,n){ke(e,n,t)}),i.h&&tx({},function(t,n){ke(e,n,t)})}function _x(i,e,t){t=Math.min(i.j.length,t);var n=i.h?Lt(i.h.Va,i.h,i):null;e:{var r=i.j;let s=-1;for(;;){let o=["count="+t];s==-1?0<t?(s=r[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<t;l++){let c=r[l].g,d=r[l].map;if(c-=s,0>c)s=Math.max(0,r[l].g-100),a=!1;else try{HL(d,o,"req"+c+"_")}catch{n&&n(d)}}if(a){n=o.join("&");break e}}}return i=i.j.splice(0,t),e.F=i,n}function bx(i){if(!i.g&&!i.u){i.ba=1;var e=i.Ma;Xl||UT(),Zl||(Xl(),Zl=!0),ty.add(e,i),i.A=0}}function uy(i){return i.g||i.u||3<=i.A?!1:(i.ba++,i.u=sc(Lt(i.Ma,i),Ex(i,i.A)),i.A++,!0)}P.Ma=function(){if(this.u=null,wx(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var i=2*this.S;this.l.info("BP detection timer enabled: "+i),this.B=sc(Lt(this.jb,this),i)}};P.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Yt(10),Xu(this),wx(this))};function hy(i){i.B!=null&&(Q.clearTimeout(i.B),i.B=null)}function wx(i){i.g=new ac(i,i.l,"rpc",i.ba),i.o===null&&(i.g.I=i.s),i.g.O=0;var e=er(i.wa);ke(e,"RID","rpc"),ke(e,"SID",i.K),ke(e,"AID",i.V),ke(e,"CI",i.G?"0":"1"),!i.G&&i.qa&&ke(e,"TO",i.qa),ke(e,"TYPE","xmlhttp"),uc(i,e),i.o&&i.s&&cy(e,i.o,i.s),i.L&&i.g.setTimeout(i.L);var t=i.g;i=i.pa,t.L=1,t.A=Ku(er(e)),t.u=null,t.S=!0,XT(t,i)}P.ib=function(){this.v!=null&&(this.v=null,Xu(this),uy(this),Yt(19))};function Nu(i){i.v!=null&&(Q.clearTimeout(i.v),i.v=null)}function Sx(i,e){var t=null;if(i.g==e){Nu(i),hy(i),i.g=null;var n=2}else if(jg(i.i,e))t=e.F,cx(i.i,e),n=1;else return;if(i.H!=0){if(e.i)if(n==1){t=e.u?e.u.length:0,e=Date.now()-e.G;var r=i.C;n=Gu(),Dt(n,new HT(n,t)),Zu(i)}else bx(i);else if(r=e.s,r==3||r==0&&0<e.ca||!(n==1&&JL(i,e)||n==2&&uy(i)))switch(t&&0<t.length&&(e=i.i,e.i=e.i.concat(t)),r){case 1:Bs(i,5);break;case 4:Bs(i,10);break;case 3:Bs(i,6);break;default:Bs(i,2)}}}function Ex(i,e){let t=i.ab+Math.floor(Math.random()*i.hb);return i.isActive()||(t*=2),t*e}function Bs(i,e){if(i.l.info("Error code "+e),e==2){var t=null;i.h&&(t=null);var n=Lt(i.pb,i);t||(t=new Vs("//www.google.com/images/cleardot.gif"),Q.location&&Q.location.protocol=="http"||Mu(t,"https"),Ku(t)),WL(t.toString(),n)}else Yt(2);i.H=0,i.h&&i.h.za(e),Cx(i),vx(i)}P.pb=function(i){i?(this.l.info("Successfully pinged google.com"),Yt(2)):(this.l.info("Failed to ping google.com"),Yt(1))};function Cx(i){if(i.H=0,i.ma=[],i.h){let e=dx(i.i);(e.length!=0||i.j.length!=0)&&(gT(i.ma,e),gT(i.ma,i.j),i.i.i.length=0,Wg(i.j),i.j.length=0),i.h.ya()}}function Tx(i,e,t){var n=t instanceof Vs?er(t):new Vs(t);if(n.g!="")e&&(n.g=e+"."+n.g),Ou(n,n.m);else{var r=Q.location;n=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Vs(null);n&&Mu(s,n),e&&(s.g=e),r&&Ou(s,r),t&&(s.l=t),n=s}return t=i.F,e=i.Da,t&&e&&ke(n,t,e),ke(n,"VER",i.ra),uc(i,n),n}function xx(i,e,t){if(e&&!i.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=i.Ha&&!i.va?new We(new cc({ob:t})):new We(i.va),e.Oa(i.J),e}P.isActive=function(){return!!this.h&&this.h.isActive(this)};function Ix(){}P=Ix.prototype;P.Ba=function(){};P.Aa=function(){};P.za=function(){};P.ya=function(){};P.isActive=function(){return!0};P.Va=function(){};function Pu(){if(Go&&!(10<=Number(gL)))throw Error("Environmental error: no available transport.")}Pu.prototype.g=function(i,e){return new gi(i,e)};function gi(i,e){vt.call(this),this.g=new yx(e),this.l=i,this.h=e&&e.messageUrlParams||null,i=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.s=i,i=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(i?i["X-WebChannel-Content-Type"]=e.messageContentType:i={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(i?i["X-WebChannel-Client-Profile"]=e.Ca:i={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=i,(i=e&&e.cc)&&!Ql(i)&&(this.g.o=i),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ql(e)&&(this.g.F=e,i=this.h,i!==null&&e in i&&(i=this.h,e in i&&delete i[e])),this.j=new Ho(this)}_t(gi,vt);gi.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var i=this.g,e=this.l,t=this.h||void 0;Yt(0),i.Y=e,i.na=t||{},i.G=i.aa,i.I=Tx(i,null,i.Y),Zu(i)};gi.prototype.close=function(){dy(this.g)};gi.prototype.u=function(i){var e=this.g;if(typeof i=="string"){var t={};t.__data__=i,i=t}else this.v&&(t={},t.__data__=ey(i),i=t);e.j.push(new zL(e.fb++,i)),e.H==3&&Zu(e)};gi.prototype.N=function(){this.g.h=null,delete this.j,dy(this.g),delete this.g,gi.$.N.call(this)};function Dx(i){sy.call(this),i.__headers__&&(this.headers=i.__headers__,this.statusCode=i.__status__,delete i.__headers__,delete i.__status__);var e=i.__sm__;if(e){e:{for(let t in e){i=t;break e}i=void 0}(this.i=i)&&(i=this.i,e=e!==null&&i in e?e[i]:void 0),this.data=e}else this.data=i}_t(Dx,sy);function Ax(){oy.call(this),this.status=1}_t(Ax,oy);function Ho(i){this.g=i}_t(Ho,Ix);Ho.prototype.Ba=function(){Dt(this.g,"a")};Ho.prototype.Aa=function(i){Dt(this.g,new Dx(i))};Ho.prototype.za=function(i){Dt(this.g,new Ax)};Ho.prototype.ya=function(){Dt(this.g,"b")};function e2(){this.blockSize=-1}function Hi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}_t(Hi,e2);Hi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Ag(i,e,t){t||(t=0);var n=Array(16);if(typeof e=="string")for(var r=0;16>r;++r)n[r]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(r=0;16>r;++r)n[r]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=i.g[0],t=i.g[1],r=i.g[2];var s=i.g[3],o=e+(s^t&(r^s))+n[0]+3614090360&4294967295;e=t+(o<<7&4294967295|o>>>25),o=s+(r^e&(t^r))+n[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(t^s&(e^t))+n[2]+606105819&4294967295,r=s+(o<<17&4294967295|o>>>15),o=t+(e^r&(s^e))+n[3]+3250441966&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(s^t&(r^s))+n[4]+4118548399&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(r^e&(t^r))+n[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(t^s&(e^t))+n[6]+2821735955&4294967295,r=s+(o<<17&4294967295|o>>>15),o=t+(e^r&(s^e))+n[7]+4249261313&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(s^t&(r^s))+n[8]+1770035416&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(r^e&(t^r))+n[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(t^s&(e^t))+n[10]+4294925233&4294967295,r=s+(o<<17&4294967295|o>>>15),o=t+(e^r&(s^e))+n[11]+2304563134&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(s^t&(r^s))+n[12]+1804603682&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(r^e&(t^r))+n[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(t^s&(e^t))+n[14]+2792965006&4294967295,r=s+(o<<17&4294967295|o>>>15),o=t+(e^r&(s^e))+n[15]+1236535329&4294967295,t=r+(o<<22&4294967295|o>>>10),o=e+(r^s&(t^r))+n[1]+4129170786&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^r&(e^t))+n[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(s^e))+n[11]+643717713&4294967295,r=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(r^s))+n[0]+3921069994&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(t^r))+n[5]+3593408605&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^r&(e^t))+n[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(s^e))+n[15]+3634488961&4294967295,r=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(r^s))+n[4]+3889429448&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(t^r))+n[9]+568446438&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^r&(e^t))+n[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(s^e))+n[3]+4107603335&4294967295,r=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(r^s))+n[8]+1163531501&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(t^r))+n[13]+2850285829&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^r&(e^t))+n[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^t&(s^e))+n[7]+1735328473&4294967295,r=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(r^s))+n[12]+2368359562&4294967295,t=r+(o<<20&4294967295|o>>>12),o=e+(t^r^s)+n[5]+4294588738&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^r)+n[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^t)+n[11]+1839030562&4294967295,r=s+(o<<16&4294967295|o>>>16),o=t+(r^s^e)+n[14]+4259657740&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(t^r^s)+n[1]+2763975236&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^r)+n[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^t)+n[7]+4139469664&4294967295,r=s+(o<<16&4294967295|o>>>16),o=t+(r^s^e)+n[10]+3200236656&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(t^r^s)+n[13]+681279174&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^r)+n[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^t)+n[3]+3572445317&4294967295,r=s+(o<<16&4294967295|o>>>16),o=t+(r^s^e)+n[6]+76029189&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(t^r^s)+n[9]+3654602809&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^r)+n[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^t)+n[15]+530742520&4294967295,r=s+(o<<16&4294967295|o>>>16),o=t+(r^s^e)+n[2]+3299628645&4294967295,t=r+(o<<23&4294967295|o>>>9),o=e+(r^(t|~s))+n[0]+4096336452&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~r))+n[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~t))+n[14]+2878612391&4294967295,r=s+(o<<15&4294967295|o>>>17),o=t+(s^(r|~e))+n[5]+4237533241&4294967295,t=r+(o<<21&4294967295|o>>>11),o=e+(r^(t|~s))+n[12]+1700485571&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~r))+n[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~t))+n[10]+4293915773&4294967295,r=s+(o<<15&4294967295|o>>>17),o=t+(s^(r|~e))+n[1]+2240044497&4294967295,t=r+(o<<21&4294967295|o>>>11),o=e+(r^(t|~s))+n[8]+1873313359&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~r))+n[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~t))+n[6]+2734768916&4294967295,r=s+(o<<15&4294967295|o>>>17),o=t+(s^(r|~e))+n[13]+1309151649&4294967295,t=r+(o<<21&4294967295|o>>>11),o=e+(r^(t|~s))+n[4]+4149444226&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~r))+n[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~t))+n[2]+718787259&4294967295,r=s+(o<<15&4294967295|o>>>17),o=t+(s^(r|~e))+n[9]+3951481745&4294967295,i.g[0]=i.g[0]+e&4294967295,i.g[1]=i.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,i.g[2]=i.g[2]+r&4294967295,i.g[3]=i.g[3]+s&4294967295}Hi.prototype.j=function(i,e){e===void 0&&(e=i.length);for(var t=e-this.blockSize,n=this.m,r=this.h,s=0;s<e;){if(r==0)for(;s<=t;)Ag(this,i,s),s+=this.blockSize;if(typeof i=="string"){for(;s<e;)if(n[r++]=i.charCodeAt(s++),r==this.blockSize){Ag(this,n),r=0;break}}else for(;s<e;)if(n[r++]=i[s++],r==this.blockSize){Ag(this,n),r=0;break}}this.h=r,this.i+=e};Hi.prototype.l=function(){var i=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);i[0]=128;for(var e=1;e<i.length-8;++e)i[e]=0;var t=8*this.i;for(e=i.length-8;e<i.length;++e)i[e]=t&255,t/=256;for(this.j(i),i=Array(16),e=t=0;4>e;++e)for(var n=0;32>n;n+=8)i[t++]=this.g[e]>>>n&255;return i};function _e(i,e){this.h=e;for(var t=[],n=!0,r=i.length-1;0<=r;r--){var s=i[r]|0;n&&s==e||(t[r]=s,n=!1)}this.g=t}var t2={};function fy(i){return-128<=i&&128>i?fL(i,function(e){return new _e([e|0],0>e?-1:0)}):new _e([i|0],0>i?-1:0)}function Sn(i){if(isNaN(i)||!isFinite(i))return jo;if(0>i)return It(Sn(-i));for(var e=[],t=1,n=0;i>=t;n++)e[n]=i/t|0,t*=Gg;return new _e(e,0)}function Rx(i,e){if(i.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(i.charAt(0)=="-")return It(Rx(i.substring(1),e));if(0<=i.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Sn(Math.pow(e,8)),n=jo,r=0;r<i.length;r+=8){var s=Math.min(8,i.length-r),o=parseInt(i.substring(r,r+s),e);8>s?(s=Sn(Math.pow(e,s)),n=n.R(s).add(Sn(o))):(n=n.R(t),n=n.add(Sn(o)))}return n}var Gg=4294967296,jo=fy(0),$g=fy(1),xT=fy(16777216);P=_e.prototype;P.ea=function(){if(xi(this))return-It(this).ea();for(var i=0,e=1,t=0;t<this.g.length;t++){var n=this.D(t);i+=(0<=n?n:Gg+n)*e,e*=Gg}return i};P.toString=function(i){if(i=i||10,2>i||36<i)throw Error("radix out of range: "+i);if(Jn(this))return"0";if(xi(this))return"-"+It(this).toString(i);for(var e=Sn(Math.pow(i,6)),t=this,n="";;){var r=Lu(t,e).g;t=Fu(t,r.R(e));var s=((0<t.g.length?t.g[0]:t.h)>>>0).toString(i);if(t=r,Jn(t))return s+n;for(;6>s.length;)s="0"+s;n=s+n}};P.D=function(i){return 0>i?0:i<this.g.length?this.g[i]:this.h};function Jn(i){if(i.h!=0)return!1;for(var e=0;e<i.g.length;e++)if(i.g[e]!=0)return!1;return!0}function xi(i){return i.h==-1}P.X=function(i){return i=Fu(this,i),xi(i)?-1:Jn(i)?0:1};function It(i){for(var e=i.g.length,t=[],n=0;n<e;n++)t[n]=~i.g[n];return new _e(t,~i.h).add($g)}P.abs=function(){return xi(this)?It(this):this};P.add=function(i){for(var e=Math.max(this.g.length,i.g.length),t=[],n=0,r=0;r<=e;r++){var s=n+(this.D(r)&65535)+(i.D(r)&65535),o=(s>>>16)+(this.D(r)>>>16)+(i.D(r)>>>16);n=o>>>16,s&=65535,o&=65535,t[r]=o<<16|s}return new _e(t,t[t.length-1]&-2147483648?-1:0)};function Fu(i,e){return i.add(It(e))}P.R=function(i){if(Jn(this)||Jn(i))return jo;if(xi(this))return xi(i)?It(this).R(It(i)):It(It(this).R(i));if(xi(i))return It(this.R(It(i)));if(0>this.X(xT)&&0>i.X(xT))return Sn(this.ea()*i.ea());for(var e=this.g.length+i.g.length,t=[],n=0;n<2*e;n++)t[n]=0;for(n=0;n<this.g.length;n++)for(var r=0;r<i.g.length;r++){var s=this.D(n)>>>16,o=this.D(n)&65535,a=i.D(r)>>>16,l=i.D(r)&65535;t[2*n+2*r]+=o*l,ku(t,2*n+2*r),t[2*n+2*r+1]+=s*l,ku(t,2*n+2*r+1),t[2*n+2*r+1]+=o*a,ku(t,2*n+2*r+1),t[2*n+2*r+2]+=s*a,ku(t,2*n+2*r+2)}for(n=0;n<e;n++)t[n]=t[2*n+1]<<16|t[2*n];for(n=e;n<2*e;n++)t[n]=0;return new _e(t,0)};function ku(i,e){for(;(i[e]&65535)!=i[e];)i[e+1]+=i[e]>>>16,i[e]&=65535,e++}function $l(i,e){this.g=i,this.h=e}function Lu(i,e){if(Jn(e))throw Error("division by zero");if(Jn(i))return new $l(jo,jo);if(xi(i))return e=Lu(It(i),e),new $l(It(e.g),It(e.h));if(xi(e))return e=Lu(i,It(e)),new $l(It(e.g),e.h);if(30<i.g.length){if(xi(i)||xi(e))throw Error("slowDivide_ only works with positive integers.");for(var t=$g,n=e;0>=n.X(i);)t=IT(t),n=IT(n);var r=qo(t,1),s=qo(n,1);for(n=qo(n,2),t=qo(t,2);!Jn(n);){var o=s.add(n);0>=o.X(i)&&(r=r.add(t),s=o),n=qo(n,1),t=qo(t,1)}return e=Fu(i,r.R(e)),new $l(r,e)}for(r=jo;0<=i.X(e);){for(t=Math.max(1,Math.floor(i.ea()/e.ea())),n=Math.ceil(Math.log(t)/Math.LN2),n=48>=n?1:Math.pow(2,n-48),s=Sn(t),o=s.R(e);xi(o)||0<o.X(i);)t-=n,s=Sn(t),o=s.R(e);Jn(s)&&(s=$g),r=r.add(s),i=Fu(i,o)}return new $l(r,i)}P.gb=function(i){return Lu(this,i).h};P.and=function(i){for(var e=Math.max(this.g.length,i.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)&i.D(n);return new _e(t,this.h&i.h)};P.or=function(i){for(var e=Math.max(this.g.length,i.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)|i.D(n);return new _e(t,this.h|i.h)};P.xor=function(i){for(var e=Math.max(this.g.length,i.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)^i.D(n);return new _e(t,this.h^i.h)};function IT(i){for(var e=i.g.length+1,t=[],n=0;n<e;n++)t[n]=i.D(n)<<1|i.D(n-1)>>>31;return new _e(t,i.h)}function qo(i,e){var t=e>>5;e%=32;for(var n=i.g.length-t,r=[],s=0;s<n;s++)r[s]=0<e?i.D(s+t)>>>e|i.D(s+t+1)<<32-e:i.D(s+t);return new _e(r,i.h)}Pu.prototype.createWebChannel=Pu.prototype.g;gi.prototype.send=gi.prototype.u;gi.prototype.open=gi.prototype.m;gi.prototype.close=gi.prototype.close;$u.NO_ERROR=0;$u.TIMEOUT=8;$u.HTTP_ERROR=6;WT.COMPLETE="complete";KT.EventType=oc;oc.OPEN="a";oc.CLOSE="b";oc.ERROR="c";oc.MESSAGE="d";vt.prototype.listen=vt.prototype.O;We.prototype.listenOnce=We.prototype.P;We.prototype.getLastError=We.prototype.Sa;We.prototype.getLastErrorCode=We.prototype.Ia;We.prototype.getStatus=We.prototype.da;We.prototype.getResponseJson=We.prototype.Wa;We.prototype.getResponseText=We.prototype.ja;We.prototype.send=We.prototype.ha;We.prototype.setWithCredentials=We.prototype.Oa;Hi.prototype.digest=Hi.prototype.l;Hi.prototype.reset=Hi.prototype.reset;Hi.prototype.update=Hi.prototype.j;_e.prototype.add=_e.prototype.add;_e.prototype.multiply=_e.prototype.R;_e.prototype.modulo=_e.prototype.gb;_e.prototype.compare=_e.prototype.X;_e.prototype.toNumber=_e.prototype.ea;_e.prototype.toString=_e.prototype.toString;_e.prototype.getBits=_e.prototype.D;_e.fromNumber=Sn;_e.fromString=Rx;var aX=Wi.createWebChannelTransport=function(){return new Pu},lX=Wi.getStatEventTarget=function(){return Gu()},cX=Wi.ErrorCode=$u,dX=Wi.EventType=WT,uX=Wi.Event=Us,hX=Wi.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},fX=Wi.FetchXmlHttpFactory=cc,mX=Wi.WebChannel=KT,pX=Wi.XhrIo=We,kx=Wi.Md5=Hi,qs=Wi.Integer=_e;var ao=$p(s1(),1),gk=$p(l_(),1);var o1="@firebase/firestore",a1="4.4.0";var ht=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ht.UNAUTHENTICATED=new ht(null);ht.GOOGLE_CREDENTIALS=new ht("google-credentials-uid");ht.FIRST_PARTY=new ht("first-party-uid");ht.MOCK_USER=new ht("mock-user");var b4="10.7.0";var fl=b4;function w4(i){fl=i}function S4(i){return g4(i,{depth:100})}var ls=new hu("@firebase/firestore");function qa(){return ls.logLevel}function Uw(i){ls.setLogLevel(i)}function D(i,...e){if(ls.logLevel<=vn.DEBUG){let t=e.map(qw);ls.debug(`Firestore (${fl}): ${i}`,...t)}}function ze(i,...e){if(ls.logLevel<=vn.ERROR){let t=e.map(qw);ls.error(`Firestore (${fl}): ${i}`,...t)}}function Vi(i,...e){if(ls.logLevel<=vn.WARN){let t=e.map(qw);ls.warn(`Firestore (${fl}): ${i}`,...t)}}function qw(i){if(typeof i=="string")return i;try{return S4(i)}catch{return i}}function B(i="Unexpected state"){let e=`FIRESTORE (${fl}) INTERNAL ASSERTION FAILED: `+i;throw ze(e),new Error(e)}function z(i,e){i||B()}function yk(i,e){i||B()}function F(i,e){return i}var b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},E=class extends TC{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var tt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var om=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},qb=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ht.UNAUTHENTICATED))}shutdown(){}},zb=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},jb=class{constructor(e){this.authProvider=e,this.currentUser=ht.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.tokenCounter,r=l=>this.tokenCounter!==n?(n=this.tokenCounter,t(l)):Promise.resolve(),s=new tt;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new tt,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>p(this,null,function*(){yield l.promise,yield r(this.currentUser)}))},a=l=>{D("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.tokenListener),o()};this.authProvider.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.authProvider.getImmediate({optional:!0});l?a(l):(D("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new tt)}},0),o()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.tokenCounter!==e?(D("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(z(typeof n.accessToken=="string"),new om(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.tokenListener)}getUser(){let e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string"),new ht(e)}},Gb=class{constructor(e,t,n){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=n,this.type="FirstParty",this.user=ht.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},$b=class{constructor(e,t,n){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=n}getToken(){return Promise.resolve(new Gb(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Hb=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Wb=class{constructor(e){this.appCheckProvider=e,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(e,t){let n=s=>{s.error!=null&&D("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,D("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>n(s))};let r=s=>{D("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?r(s):D("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(z(typeof t.token=="string"),this.latestAppCheckToken=t.token,new Hb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.tokenListener)}};function E4(i){if(!i)return new qb;switch(i.type){case"firstParty":return new $b(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new E(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function C4(i){return _4(i)}var am=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="",r=20;for(;n.length<r;){let s=C4(40);for(let o=0;o<s.length;++o)n.length<r&&s[o]<t&&(n+=e.charAt(s[o]%e.length))}return n}};function X(i,e){return i<e?-1:i>e?1:0}function lo(i,e,t){return i.length!==e.length?!1:i.every((n,r)=>t(n,e[r]))}function vk(i){return i+"\0"}var l1=-62135596800,c1=1e6,je=class i{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new E(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new E(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<l1)throw new E(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new E(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return i.fromMillis(Date.now())}static fromDate(e){return i.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),n=Math.floor((e-t*1e3)*c1);return new i(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return this.seconds*1e3+this.nanoseconds/c1}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-l1,t=String(e).padStart(12,"0"),n=String(this.nanoseconds).padStart(9,"0");return t+"."+n}};var $=class i{constructor(e){this.timestamp=e}static fromTimestamp(e){return new i(e)}static min(){return new i(new je(0,0))}static max(){return new i(new je(253402300799,1e9-1))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return this.timestamp.seconds*1e6+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var d1="__name__",lm=class i{constructor(e,t,n){t===void 0?t=0:t>e.length&&B(),n===void 0?n=e.length-t:n>e.length-t&&B(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return i.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof i?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},me=class i extends lm{construct(e,t,n){return new i(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new E(b.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new i(t)}static emptyPath(){return new i([])}},T4=/^[_a-zA-Z][_a-zA-Z0-9]*$/,nt=class i extends lm{construct(e,t,n){return new i(e,t,n)}static isValidIdentifier(e){return T4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),i.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===d1}static keyField(){return new i([d1])}static fromServerFormat(e){let t=[],n="",r=0,s=()=>{if(n.length===0)throw new E(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},o=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new E(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(!(l==="\\"||l==="."||l==="`"))throw new E(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,r+=2}else a==="`"?(o=!o,r++):a==="."&&!o?(s(),r++):(n+=a,r++)}if(s(),o)throw new E(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new i(t)}static emptyPath(){return new i([])}};var O=class i{constructor(e){this.path=e}static fromPath(e){return new i(me.fromString(e))}static fromName(e){return new i(me.fromString(e).popFirst(5))}static empty(){return new i(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return me.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new i(new me(e.slice()))}};var Ya=-1,x4=0,Kb=(()=>{class i{constructor(t,n,r,s){this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=s}}return i.UNKNOWN_ID=-1,i})();function zw(i){return i.fields.find(e=>e.kind===2)}function co(i){return i.fields.filter(e=>e.kind!==2)}function I4(i){let e=co(i);return e.length===0?0:e[e.length-1].kind}function D4(i){return`id=${i.indexId}|cg=${i.collectionGroup}|f=${i.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}var Wa=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var sd=class i{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new i(x4,Ui.min())}};function _k(i,e){let t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=$.fromTimestamp(n===1e9?new je(t+1,0):new je(t,n));return new Ui(r,O.empty(),e)}function bk(i){return new Ui(i.readTime,i.key,Ya)}var Ui=class i{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new i($.min(),O.empty(),Ya)}static max(){return new i($.max(),O.empty(),Ya)}};function jw(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0||(t=O.comparator(i.documentKey,e.documentKey),t!==0)?t:X(i.largestBatchId,e.largestBatchId)}var wk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",cm=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function bs(i){return p(this,null,function*(){if(i.code===b.FAILED_PRECONDITION&&i.message===wk)D("LocalStore","Unexpectedly lost primary lease");else throw i})}var v=class i{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new i((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof i?t:i.resolve(t)}catch(t){return i.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):i.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):i.reject(t)}static resolve(e){return new i((t,n)=>{t(e)})}static reject(e){return new i((t,n)=>{n(e)})}static waitFor(e){return new i((t,n)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},l=>n(l))}),o=!0,s===r&&t()})}static or(e){let t=i.resolve(!1);for(let n of e)t=t.next(r=>r?i.resolve(r):n());return t}static forEach(e,t){let n=[];return e.forEach((r,s)=>{n.push(t.call(this,r,s))}),this.waitFor(n)}static mapArray(e,t){return new i((n,r)=>{let s=e.length,o=new Array(s),a=0;for(let l=0;l<s;l++){let c=l;t(e[c]).next(d=>{o[c]=d,++a,a===s&&n(o)},d=>r(d))}})}static doWhile(e,t){return new i((n,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):n()};s()})}};var bi="SimpleDb",A4=3,dm=class i{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.completionDeferred=new tt,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{t.error?this.completionDeferred.reject(new oo(e,t.error)):this.completionDeferred.resolve()},this.transaction.onerror=n=>{let r=Gw(n.target.error);this.completionDeferred.reject(new oo(e,r))}}static open(e,t,n,r){try{return new i(t,e.transaction(r,n))}catch(s){throw new oo(t,s)}}get completionPromise(){return this.completionDeferred.promise}abort(e){e&&this.completionDeferred.reject(e),this.aborted||(D(bi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let e=this.transaction;!this.aborted&&typeof e.commit=="function"&&e.commit()}store(e){let t=this.transaction.objectStore(e);return new Yb(t)}},cs=class i{constructor(e,t,n){this.name=e,this.version=t,this.schemaConverter=n,i.getIOSVersion(du())===12.2&&ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return D(bi,"Removing database:",e),Js(window.indexedDB.deleteDatabase(e)).toPromise()}static isAvailable(){if(!uu())return!1;if(i.isMockPersistence())return!0;let e=du(),t=i.getIOSVersion(e),n=0<t&&t<10,r=i.getAndroidVersion(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static isMockPersistence(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.USE_MOCK_PERSISTENCE)==="YES"}static getStore(e,t){return e.store(t)}static getIOSVersion(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static getAndroidVersion(e){let t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}ensureDb(e){return p(this,null,function*(){return this.db||(D(bi,"Opening database:",this.name),this.db=yield new Promise((t,n)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{let o=s.target.result;t(o)},r.onblocked=()=>{n(new oo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{let o=s.target.error;o.name==="VersionError"?n(new E(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new E(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new oo(e,o))},r.onupgradeneeded=s=>{D(bi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.schemaConverter.createOrUpgrade(o,r.transaction,s.oldVersion,this.version).next(()=>{D(bi,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=t=>this.versionchangelistener(t)),this.db})}setVersionChangeListener(e){this.versionchangelistener=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,r){return p(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.ensureDb(e);let a=dm.open(this.db,e,s?"readonly":"readwrite",n),l=r(a).next(c=>(a.maybeCommit(),c)).catch(c=>(a.abort(c),v.reject(c))).toPromise();return l.catch(()=>{}),yield a.completionPromise,l}catch(a){let l=a,c=l.name!=="FirebaseError"&&o<A4;if(D(bi,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}})}close(){this.db&&this.db.close(),this.db=void 0}},Qb=class{constructor(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(e){this.dbCursor=e}done(){this.shouldStop=!0}skip(e){this.nextKey=e}delete(){return Js(this.dbCursor.delete())}},oo=class extends E{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function ws(i){return i.name==="IndexedDbTransactionError"}var Yb=class{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(D(bi,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(D(bi,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Js(n)}add(e){D(bi,"ADD",this.store.name,e,e);let t=this.store.add(e);return Js(t)}get(e){let t=this.store.get(e);return Js(t).next(n=>(n===void 0&&(n=null),D(bi,"GET",this.store.name,e,n),n))}delete(e){D(bi,"DELETE",this.store.name,e);let t=this.store.delete(e);return Js(t)}count(){D(bi,"COUNT",this.store.name);let e=this.store.count();return Js(e)}loadAll(e,t){let n=this.options(e,t);if(!n.index&&typeof this.store.getAll=="function"){let r=this.store.getAll(n.range);return new v((s,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{s(a.target.result)}})}else{let r=this.cursor(n),s=[];return this.iterateCursor(r,(o,a)=>{s.push(a)}).next(()=>s)}}loadFirst(e,t){let n=this.store.getAll(e,t===null?void 0:t);return new v((r,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{r(o.target.result)}})}deleteAll(e,t){D(bi,"DELETE ALL",this.store.name);let n=this.options(e,t);n.keysOnly=!1;let r=this.cursor(n);return this.iterateCursor(r,(s,o,a)=>a.delete())}iterate(e,t){let n;t?n=e:(n={},t=e);let r=this.cursor(n);return this.iterateCursor(r,t)}iterateSerial(e){let t=this.cursor({});return new v((n,r)=>{t.onerror=s=>{let o=Gw(s.target.error);r(o)},t.onsuccess=s=>{let o=s.target.result;if(!o){n();return}e(o.primaryKey,o.value).next(a=>{a?o.continue():n()})}})}iterateCursor(e,t){let n=[];return new v((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a){r();return}let l=new Qb(a),c=t(a.primaryKey,a.value,l);if(c instanceof v){let d=c.catch(u=>(l.done(),v.reject(u)));n.push(d)}l.isDone?r():l.skipToKey===null?a.continue():a.continue(l.skipToKey)}}).next(()=>v.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}else return this.store.openCursor(e.range,t)}};function Js(i){return new v((e,t)=>{i.onsuccess=n=>{let r=n.target.result;e(r)},i.onerror=n=>{let r=Gw(n.target.error);t(r)}})}var u1=!1;function Gw(i){let e=cs.getIOSVersion(du());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(t)>=0){let n=new E("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return u1||(u1=!0,setTimeout(()=>{throw n},0)),n}}return i}var Jc="IndexBackiller",R4=15*1e3,k4=60*1e3,M4=50,Xb=class{constructor(e,t){this.asyncQueue=e,this.backfiller=t,this.task=null}start(){this.schedule(R4)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}schedule(e){D(Jc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>p(this,null,function*(){this.task=null;try{let t=yield this.backfiller.backfill();D(Jc,`Documents written: ${t}`)}catch(t){ws(t)?D(Jc,"Ignoring IndexedDB error during index backfill: ",t):yield bs(t)}yield this.schedule(k4)}))}},Zb=class{constructor(e,t){this.localStore=e,this.persistence=t}backfill(){return p(this,arguments,function*(e=M4){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.writeIndexEntries(t,e))})}writeIndexEntries(e,t){let n=new Set,r=t,s=!0;return v.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o===null||n.has(o))s=!1;else return D(Jc,`Processing collection: ${o}`),this.writeEntriesForCollectionGroup(e,o,r).next(a=>{r-=a,n.add(o)})})).next(()=>t-r)}writeEntriesForCollectionGroup(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.getNewOffset(r,s)).next(a=>(D(Jc,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}getNewOffset(e,t){let n=e;return t.changes.forEach((r,s)=>{let o=bk(s);jw(o,n)>0&&(n=o)}),new Ui(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}};var wi=(()=>{class i{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.setPreviousValue(r),this.writeNewSequenceNumber=r=>n.writeSequenceNumber(r))}setPreviousValue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t}}i.INVALID=-1;return i})(),Ka="",Jb="",Sk="",Ek="";function ti(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=h1(e)),e=O4(i.get(t),e);return h1(e)}function O4(i,e){let t=e,n=i.length;for(let r=0;r<n;r++){let s=i.charAt(r);switch(s){case"\0":t+=Ka+Sk;break;case Ka:t+=Ka+Ek;break;default:t+=s}}return t}function h1(i){return i+Ka+Jb}function Un(i){let e=i.length;if(z(e>=2),e===2)return z(i.charAt(0)===Ka&&i.charAt(1)===Jb),me.emptyPath();let t=e-2,n=[],r="";for(let s=0;s<e;){let o=i.indexOf(Ka,s);switch((o<0||o>t)&&B(),i.charAt(o+1)){case Jb:let l=i.substring(s,o),c;r.length===0?c=l:(r+=l,c=r,r=""),n.push(c);break;case Sk:r+=i.substring(s,o),r+="\0";break;case Ek:r+=i.substring(s,o+1);break;default:B()}s=o+2}return new me(n)}var eo="remoteDocuments";var kd="owner",Na="owner",Md="mutationQueues",N4="userId",nn="mutations",Ck="batchId",ro="userMutationsIndex",Tk=["userId","batchId"];function P4(i){return[i]}function em(i,e){return[i,ti(e)]}function xk(i,e,t){return[i,ti(e),t]}var F4={},ml="documentMutations",Zm="remoteDocumentsV14",L4=["prefixPath","collectionGroup","readTime","documentId"],tm="documentKeyIndex",B4=["prefixPath","collectionGroup","documentId"],Ik="collectionGroupIndex",V4=["collectionGroup","readTime","prefixPath","documentId"],Od="remoteDocumentGlobal",e0="remoteDocumentGlobalKey",pl="targets",U4="targetId",Dk="queryTargetsIndex",q4=["canonicalId","targetId"],gl="targetDocuments",z4=["targetId","path"],$w="documentTargetsIndex",j4=["path","targetId"],um="targetGlobalKey",Eo="targetGlobal",od="collectionParents",G4=["collectionId","parent"],Xa="clientMetadata",$4="clientId",Jm="bundles",H4="bundleId",ep="namedQueries",W4="name",Hw="indexConfiguration",K4="indexId",t0="collectionGroupIndex",Q4="collectionGroup",Ww="indexState",Y4=["indexId","uid"],Ak="sequenceNumberIndex",X4=["uid","sequenceNumber"],Kw="indexEntries",Z4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Rk="documentKeyIndex",J4=["indexId","uid","orderedDocumentKey"],tp="documentOverlays",e6=["userId","collectionPath","documentId"],i0="collectionPathOverlayIndex",t6=["userId","collectionPath","largestBatchId"],kk="collectionGroupOverlayIndex",i6=["userId","collectionGroup","largestBatchId"],n6=[Md,nn,ml,eo,pl,kd,Eo,gl],r6=n6,s6=[...r6,Xa],o6=[...s6,Od],a6=[...o6,od],Mk=[...a6,Jm,ep],l6=[...Mk,tp],Ok=[Md,nn,ml,Zm,pl,kd,Eo,gl,Xa,Od,od,Jm,ep,tp],Nk=Ok,c6=[...Nk,Hw,Ww,Kw];function d6(i){if(i===15)return c6;if(i===14)return Nk;if(i===13)return Ok;if(i===12)return l6;if(i===11)return Mk;B()}var ad=class extends cm{constructor(e,t){super(),this.simpleDbTransaction=e,this.currentSequenceNumber=t}};function Tt(i,e){let t=F(i);return cs.getStore(t.simpleDbTransaction,e)}function f1(i){let e=0;for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Co(i,e){for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function Pk(i){for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}var Me=class i{constructor(e,t){this.comparator=e,this.root=t||ed.EMPTY}insert(e,t){return new i(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ed.BLACK,null,null))}remove(e){return new i(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ed.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $a(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $a(this.root,e,this.comparator,!1)}getReverseIterator(){return new $a(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $a(this.root,e,this.comparator,!0)}},$a=class{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ed=(()=>{class i{constructor(t,n,r,s,o){this.key=t,this.value=n,this.color=r??i.RED,this.left=s??i.EMPTY,this.right=o??i.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,s,o){return new i(t??this.key,n??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let s=this,o=r(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,n,r),null):o===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return i.EMPTY;let t=this;return!t.left.isRed()&&!t.left.left.isRed()&&(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,s=this;if(n(t,s.key)<0)!s.left.isEmpty()&&!s.left.isRed()&&!s.left.left.isRed()&&(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),!s.right.isEmpty()&&!s.right.isRed()&&!s.right.left.isRed()&&(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return i.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,i.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();let t=this.left.check();if(t!==this.right.check())throw B();return t+(this.isRed()?0:1)}}return i.EMPTY=null,i.RED=!0,i.BLACK=!1,i})(),n0=class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(e,t,n,r,s){return this}insert(e,t,n){return new ed(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};ed.EMPTY=new n0;var Ce=class i{constructor(e){this.comparator=e,this.data=new Me(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(t!==void 0?n=this.data.getIteratorFrom(t):n=this.data.getIterator();n.hasNext();){let r=n.getNext();if(!e(r.key))return}}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new hm(this.data.getIterator())}getIteratorFrom(e){return new hm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof i)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new i(this.comparator);return t.data=e,t}},hm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function u6(i,e,t,n,r){let s=i.getIterator(),o=e.getIterator(),a=Pa(s),l=Pa(o);for(;a||l;){let c=!1,d=!1;if(a&&l){let u=t(a,l);u<0?d=!0:u>0&&(c=!0)}else a!=null?d=!0:c=!0;c?(n(l),l=Pa(o)):d?(r(a),a=Pa(s)):(a=Pa(s),l=Pa(o))}}function Pa(i){return i.hasNext()?i.getNext():void 0}var Si=class i{constructor(e){this.fields=e,e.sort(nt.comparator)}static empty(){return new i([])}unionWith(e){let t=new Ce(nt.comparator);for(let n of this.fields)t=t.add(n);for(let n of e)t=t.add(n);return new i(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return lo(this.fields,e.fields,(t,n)=>t.isEqual(n))}};function h6(i){return Buffer.from(i,"base64").toString("binary")}function f6(i){return Buffer.from(i,"binary").toString("base64")}function Fk(){return!0}var Ct=class i{constructor(e){this.binaryString=e}static fromBase64String(e){let t=h6(e);return new i(t)}static fromUint8Array(e){let t=m6(e);return new i(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return f6(this.binaryString)}toUint8Array(){return p6(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ct.EMPTY_BYTE_STRING=new Ct("");function m6(i){let e="";for(let t=0;t<i.length;++t)e+=String.fromCharCode(i[t]);return e}function p6(i){let e=new Uint8Array(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}var g6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ds(i){if(z(!!i),typeof i=="string"){let e=0,t=g6.exec(i);if(z(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}else{let e=Ye(i.seconds),t=Ye(i.nanos);return{seconds:e,nanos:t}}}function Ye(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function us(i){return typeof i=="string"?Ct.fromBase64String(i):Ct.fromUint8Array(i)}var Lk="server_timestamp",Bk="__type__",Vk="__previous_value__",Uk="__local_write_time__";function ip(i){var e,t;return((t=(((e=i?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Bk])===null||t===void 0?void 0:t.stringValue)===Lk}function y6(i,e){let t={fields:{[Bk]:{stringValue:Lk},[Uk]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return e&&ip(e)&&(e=Qw(e)),e&&(t.fields[Vk]=e),{mapValue:t}}function Qw(i){let e=i.mapValue.fields[Vk];return ip(e)?Qw(e):e}function ld(i){let e=ds(i.mapValue.fields[Uk].timestampValue);return new je(e.seconds,e.nanos)}var r0=class{constructor(e,t,n,r,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}},s0="(default)",hs=class i{constructor(e,t){this.projectId=e,this.database=t||s0}static empty(){return new i("","")}get isDefaultDatabase(){return this.database===s0}isEqual(e){return e instanceof i&&e.projectId===this.projectId&&e.database===this.database}};function v6(i,e){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new E(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hs(i.options.projectId,e)}var as=-1;function Nd(i){return i==null}function cd(i){return i===0&&1/i===1/-0}function qk(i){return typeof i=="number"&&Number.isInteger(i)&&!cd(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}var zk="__max__",ss={mapValue:{fields:{__type__:{stringValue:zk}}}},im={nullValue:"NULL_VALUE"};function uo(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?ip(i)?4:jk(i)?9007199254740991:10:B()}function rn(i,e){if(i===e)return!0;let t=uo(i),n=uo(e);if(t!==n)return!1;switch(t){case 0:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return ld(i).isEqual(ld(e));case 3:return _6(i,e);case 5:return i.stringValue===e.stringValue;case 6:return w6(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return b6(i,e);case 2:return S6(i,e);case 9:return lo(i.arrayValue.values||[],e.arrayValue.values||[],rn);case 10:return E6(i,e);case 9007199254740991:return!0;default:return B()}}function _6(i,e){if(typeof i.timestampValue=="string"&&typeof e.timestampValue=="string"&&i.timestampValue.length===e.timestampValue.length)return i.timestampValue===e.timestampValue;let t=ds(i.timestampValue),n=ds(e.timestampValue);return t.seconds===n.seconds&&t.nanos===n.nanos}function b6(i,e){return Ye(i.geoPointValue.latitude)===Ye(e.geoPointValue.latitude)&&Ye(i.geoPointValue.longitude)===Ye(e.geoPointValue.longitude)}function w6(i,e){return us(i.bytesValue).isEqual(us(e.bytesValue))}function S6(i,e){if("integerValue"in i&&"integerValue"in e)return Ye(i.integerValue)===Ye(e.integerValue);if("doubleValue"in i&&"doubleValue"in e){let t=Ye(i.doubleValue),n=Ye(e.doubleValue);return t===n?cd(t)===cd(n):isNaN(t)&&isNaN(n)}return!1}function E6(i,e){let t=i.mapValue.fields||{},n=e.mapValue.fields||{};if(f1(t)!==f1(n))return!1;for(let r in t)if(t.hasOwnProperty(r)&&(n[r]===void 0||!rn(t[r],n[r])))return!1;return!0}function dd(i,e){return(i.values||[]).find(t=>rn(t,e))!==void 0}function fs(i,e){if(i===e)return 0;let t=uo(i),n=uo(e);if(t!==n)return X(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return X(i.booleanValue,e.booleanValue);case 2:return C6(i,e);case 3:return m1(i.timestampValue,e.timestampValue);case 4:return m1(ld(i),ld(e));case 5:return X(i.stringValue,e.stringValue);case 6:return I6(i.bytesValue,e.bytesValue);case 7:return T6(i.referenceValue,e.referenceValue);case 8:return x6(i.geoPointValue,e.geoPointValue);case 9:return D6(i.arrayValue,e.arrayValue);case 10:return A6(i.mapValue,e.mapValue);default:throw B()}}function C6(i,e){let t=Ye(i.integerValue||i.doubleValue),n=Ye(e.integerValue||e.doubleValue);return t<n?-1:t>n?1:t===n?0:isNaN(t)?isNaN(n)?0:-1:1}function m1(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return X(i,e);let t=ds(i),n=ds(e),r=X(t.seconds,n.seconds);return r!==0?r:X(t.nanos,n.nanos)}function T6(i,e){let t=i.split("/"),n=e.split("/");for(let r=0;r<t.length&&r<n.length;r++){let s=X(t[r],n[r]);if(s!==0)return s}return X(t.length,n.length)}function x6(i,e){let t=X(Ye(i.latitude),Ye(e.latitude));return t!==0?t:X(Ye(i.longitude),Ye(e.longitude))}function I6(i,e){let t=us(i),n=us(e);return t.compareTo(n)}function D6(i,e){let t=i.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){let s=fs(t[r],n[r]);if(s)return s}return X(t.length,n.length)}function A6(i,e){if(i===ss.mapValue&&e===ss.mapValue)return 0;if(i===ss.mapValue)return 1;if(e===ss.mapValue)return-1;let t=i.fields||{},n=Object.keys(t),r=e.fields||{},s=Object.keys(r);n.sort(),s.sort();for(let o=0;o<n.length&&o<s.length;++o){let a=X(n[o],s[o]);if(a!==0)return a;let l=fs(t[n[o]],r[s[o]]);if(l!==0)return l}return X(n.length,s.length)}function Za(i){return Yw(i)}function Yw(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?k6(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?R6(i.bytesValue):"referenceValue"in i?O6(i.referenceValue):"geoPointValue"in i?M6(i.geoPointValue):"arrayValue"in i?P6(i.arrayValue):"mapValue"in i?N6(i.mapValue):B()}function R6(i){return us(i).toBase64()}function k6(i){let e=ds(i);return`time(${e.seconds},${e.nanos})`}function M6(i){return`geo(${i.latitude},${i.longitude})`}function O6(i){return O.fromName(i).toString()}function N6(i){let e=Object.keys(i.fields||{}).sort(),t="{",n=!0;for(let r of e)n?n=!1:t+=",",t+=`${r}:${Yw(i.fields[r])}`;return t+"}"}function P6(i){let e="[",t=!0;for(let n of i.values||[])t?t=!1:e+=",",e+=Yw(n);return e+"]"}function ho(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function o0(i){return!!i&&"integerValue"in i}function F6(i){return!!i&&"doubleValue"in i}function L6(i){return o0(i)||F6(i)}function ud(i){return!!i&&"arrayValue"in i}function p1(i){return!!i&&"nullValue"in i}function g1(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function nm(i){return!!i&&"mapValue"in i}function td(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){let e={mapValue:{fields:{}}};return Co(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=td(n)),e}else if(i.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=td(i.arrayValue.values[t]);return e}else return Object.assign({},i)}function jk(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===zk}function B6(i){return"nullValue"in i?im:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?ho(hs.empty(),O.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?{mapValue:{}}:B()}function V6(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?ho(hs.empty(),O.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?{mapValue:{}}:"mapValue"in i?ss:B()}function y1(i,e){let t=fs(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function v1(i,e){let t=fs(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}var Gt=class i{constructor(e){this.value=e}static empty(){return new i({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!nm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){let n=this.getFieldsMap(e.popLast());n[e.lastSegment()]=td(t)}setAll(e){let t=nt.emptyPath(),n={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,n,r),n={},r=[],t=a.popLast()}o?n[a.lastSegment()]=td(o):r.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){let t=this.field(e.popLast());nm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];(!nm(r)||!r.mapValue.fields)&&(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Co(t,(r,s)=>e[r]=s);for(let r of n)delete e[r]}clone(){return new i(td(this.value))}};function Gk(i){let e=[];return Co(i.fields,(t,n)=>{let r=new nt([t]);if(nm(n)){let o=Gk(n.mapValue).fields;if(o.length===0)e.push(r);else for(let a of o)e.push(r.child(a))}else e.push(r)}),new Si(e)}var ut=class i{constructor(e,t,n,r,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new i(e,0,$.min(),$.min(),$.min(),Gt.empty(),0)}static newFoundDocument(e,t,n,r){return new i(e,1,t,$.min(),n,r,0)}static newNoDocument(e,t){return new i(e,2,t,$.min(),$.min(),Gt.empty(),0)}static newUnknownDocument(e,t){return new i(e,3,t,$.min(),$.min(),Gt.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual($.min())&&(this.documentType===2||this.documentType===0)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Gt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Gt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof i&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new i(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};function U6(i,e,t){let n=e.data.field(i),r=t.data.field(i);return n!==null&&r!==null?fs(n,r):B()}var Gn=class{constructor(e,t){this.position=e,this.inclusive=t}};function $k(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){let s=e[r],o=i.position[r];if(s.field.isKeyField())n=O.comparator(O.fromName(o.referenceValue),t.key);else{let a=t.data.field(s.field);n=fs(o,a)}if(s.dir==="desc"&&(n=n*-1),n!==0)break}return n}function q6(i,e,t){let n=$k(i,e,t);return i.inclusive?n>=0:n>0}function z6(i,e,t){let n=$k(i,e,t);return i.inclusive?n<=0:n<0}function _1(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++){let n=i.position[t],r=e.position[t];if(!rn(n,r))return!1}return!0}var fo=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function j6(i){return i.field.canonicalString()+i.dir}function G6(i){return`${i.field.canonicalString()} (${i.dir})`}function $6(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}var fm=class{},oe=class i extends fm{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new c0(e,t,n):t==="array-contains"?new h0(e,n):t==="in"?new mm(e,n):t==="not-in"?new f0(e,n):t==="array-contains-any"?new m0(e,n):new i(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new d0(e,n):new u0(e,n)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(fs(t,this.value)):t!==null&&uo(this.value)===uo(t)&&this.matchesComparison(fs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},be=class i extends fm{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new i(e,t)}matches(e){return Ja(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.memoizedFlattenedFilters!==null?this.memoizedFlattenedFilters:(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[]),this.memoizedFlattenedFilters)}getFilters(){return Object.assign([],this.filters)}};function Ja(i){return i.op==="and"}function a0(i){return i.op==="or"}function Xw(i){return Hk(i)&&Ja(i)}function Hk(i){for(let e of i.filters)if(e instanceof be)return!1;return!0}function l0(i){if(i instanceof oe)return i.field.canonicalString()+i.op.toString()+Za(i.value);if(Xw(i))return i.filters.map(e=>l0(e)).join(",");{let e=i.filters.map(t=>l0(t)).join(",");return`${i.op}(${e})`}}function Wk(i,e){if(i instanceof oe)return H6(i,e);if(i instanceof be)return W6(i,e);B()}function H6(i,e){return e instanceof oe&&i.op===e.op&&i.field.isEqual(e.field)&&rn(i.value,e.value)}function W6(i,e){return e instanceof be&&i.op===e.op&&i.filters.length===e.filters.length?i.filters.reduce((n,r,s)=>n&&Wk(r,e.filters[s]),!0):!1}function Kk(i,e){let t=i.filters.concat(e);return be.create(t,i.op)}function Qk(i){return i instanceof oe?Q6(i):i instanceof be?K6(i):"Filter"}function K6(i){return i.op.toString()+" {"+i.getFilters().map(Qk).join(" ,")+"}"}function Q6(i){return`${i.field.canonicalString()} ${i.op} ${Za(i.value)}`}var c0=class extends oe{constructor(e,t,n){super(e,t,n),this.key=O.fromName(n.referenceValue)}matches(e){let t=O.comparator(e.key,this.key);return this.matchesComparison(t)}},d0=class extends oe{constructor(e,t){super(e,"in",t),this.keys=Yk("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},u0=class extends oe{constructor(e,t){super(e,"not-in",t),this.keys=Yk("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Yk(i,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>O.fromName(n.referenceValue))}var h0=class extends oe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ud(t)&&dd(t.arrayValue,this.value)}},mm=class extends oe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&dd(this.value.arrayValue,t)}},f0=class extends oe{constructor(e,t){super(e,"not-in",t)}matches(e){if(dd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!dd(this.value.arrayValue,t)}},m0=class extends oe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!ud(t)||!t.arrayValue.values?!1:t.arrayValue.values.some(n=>dd(this.value.arrayValue,n))}};var p0=class{constructor(e,t=null,n=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}};function g0(i,e=null,t=[],n=[],r=null,s=null,o=null){return new p0(i,e,t,n,r,s,o)}function mo(i){let e=F(i);if(e.memoizedCanonicalId===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>l0(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>j6(n)).join(","),Nd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Za(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Za(n)).join(",")),e.memoizedCanonicalId=t}return e.memoizedCanonicalId}function Y6(i){let e=i.path.canonicalString();return i.collectionGroup!==null&&(e+=" collectionGroup="+i.collectionGroup),i.filters.length>0&&(e+=`, filters: [${i.filters.map(t=>Qk(t)).join(", ")}]`),Nd(i.limit)||(e+=", limit: "+i.limit),i.orderBy.length>0&&(e+=`, orderBy: [${i.orderBy.map(t=>G6(t)).join(", ")}]`),i.startAt&&(e+=", startAt: ",e+=i.startAt.inclusive?"b:":"a:",e+=i.startAt.position.map(t=>Za(t)).join(",")),i.endAt&&(e+=", endAt: ",e+=i.endAt.inclusive?"a:":"b:",e+=i.endAt.position.map(t=>Za(t)).join(",")),`Target(${e})`}function Pd(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!$6(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!Wk(i.filters[t],e.filters[t]))return!1;return i.collectionGroup!==e.collectionGroup||!i.path.isEqual(e.path)||!_1(i.startAt,e.startAt)?!1:_1(i.endAt,e.endAt)}function pm(i){return O.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function np(i,e){return i.filters.filter(t=>t instanceof oe&&t.field.isEqual(e))}function X6(i,e){let t=zw(e);if(t===void 0)return null;for(let n of np(i,t.fieldPath))switch(n.op){case"array-contains-any":return n.value.arrayValue.values||[];case"array-contains":return[n.value]}return null}function Z6(i,e){let t=new Map;for(let n of co(e))for(let r of np(i,n.fieldPath))switch(r.op){case"==":case"in":t.set(n.fieldPath.canonicalString(),r.value);break;case"not-in":case"!=":return t.set(n.fieldPath.canonicalString(),r.value),Array.from(t.values())}return null}function J6(i,e){let t=[],n=!0;for(let r of co(e)){let s=r.kind===0?Xk(i,r.fieldPath,i.startAt):Zk(i,r.fieldPath,i.startAt);t.push(s.value),n&&(n=s.inclusive)}return new Gn(t,n)}function eG(i,e){let t=[],n=!0;for(let r of co(e)){let s=r.kind===0?Zk(i,r.fieldPath,i.endAt):Xk(i,r.fieldPath,i.endAt);t.push(s.value),n&&(n=s.inclusive)}return new Gn(t,n)}function Xk(i,e,t){let n=im,r=!0;for(let s of np(i,e)){let o=im,a=!0;switch(s.op){case"<":case"<=":o=B6(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=im;break}y1({value:n,inclusive:r},{value:o,inclusive:a})<0&&(n=o,r=a)}if(t!==null){for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){let a=t.position[s];y1({value:n,inclusive:r},{value:a,inclusive:t.inclusive})<0&&(n=a,r=t.inclusive);break}}return{value:n,inclusive:r}}function Zk(i,e,t){let n=ss,r=!0;for(let s of np(i,e)){let o=ss,a=!0;switch(s.op){case">=":case">":o=V6(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=ss;break}v1({value:n,inclusive:r},{value:o,inclusive:a})>0&&(n=o,r=a)}if(t!==null){for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){let a=t.position[s];v1({value:n,inclusive:r},{value:a,inclusive:t.inclusive})>0&&(n=a,r=t.inclusive);break}}return{value:n,inclusive:r}}function tG(i){let e=new Ce(nt.comparator),t=!1;for(let n of i.filters)for(let r of n.getFlattenedFilters())r.field.isKeyField()||(r.op==="array-contains"||r.op==="array-contains-any"?t=!0:e=e.add(r.field));for(let n of i.orderBy)n.field.isKeyField()||(e=e.add(n.field));return e.size+(t?1:0)}function iG(i){return i.limit!==null}var sn=class{constructor(e,t=null,n=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}};function Jk(i,e,t,n,r,s,o,a){return new sn(i,e,t,n,r,s,o,a)}function yl(i){return new sn(i)}function nG(i,e){return new sn(e,null,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}function b1(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function rG(i){let e=new Ce(nt.comparator);return i.filters.forEach(t=>{t.getFlattenedFilters().forEach(r=>{r.isInequality()&&(e=e.add(r.field))})}),e}function sG(i){return new sn(me.emptyPath(),i)}function oG(i){return O.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function Zw(i){return i.collectionGroup!==null}function el(i){let e=F(i);if(e.memoizedNormalizedOrderBy===null){e.memoizedNormalizedOrderBy=[];let t=new Set;for(let s of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(s),t.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";rG(e).forEach(s=>{!t.has(s.canonicalString())&&!s.isKeyField()&&e.memoizedNormalizedOrderBy.push(new fo(s,n))}),t.has(nt.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new fo(nt.keyField(),n))}return e.memoizedNormalizedOrderBy}function ii(i){let e=F(i);return e.memoizedTarget||(e.memoizedTarget=aG(e,el(i))),e.memoizedTarget}function aG(i,e){if(i.limitType==="F")return g0(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new fo(r.field,s)});let t=i.endAt?new Gn(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new Gn(i.startAt.position,i.startAt.inclusive):null;return g0(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function Jw(i,e){let t=i.filters.concat([e]);return new sn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function lG(i,e){let t=i.explicitOrderBy.concat([e]);return new sn(i.path,i.collectionGroup,t,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}function gm(i,e,t){return new sn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function cG(i,e){return new sn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,e,i.endAt)}function dG(i,e){return new sn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,e)}function Fd(i,e){return Pd(ii(i),ii(e))&&i.limitType===e.limitType}function eM(i){return`${mo(ii(i))}|lt:${i.limitType}`}function za(i){return`Query(target=${Y6(ii(i))}; limitType=${i.limitType})`}function Ld(i,e){return e.isFoundDocument()&&uG(i,e)&&hG(i,e)&&fG(i,e)&&mG(i,e)}function uG(i,e){let t=e.key.path;return i.collectionGroup!==null?e.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(t):O.isDocumentKey(i.path)?i.path.isEqual(t):i.path.isImmediateParentOf(t)}function hG(i,e){for(let t of el(i))if(!t.field.isKeyField()&&e.data.field(t.field)===null)return!1;return!0}function fG(i,e){for(let t of i.filters)if(!t.matches(e))return!1;return!0}function mG(i,e){return!(i.startAt&&!z6(i.startAt,el(i),e)||i.endAt&&!q6(i.endAt,el(i),e))}function tM(i){return i.collectionGroup||(i.path.length%2===1?i.path.lastSegment():i.path.get(i.path.length-2))}function iM(i){return(e,t)=>{let n=!1;for(let r of el(i)){let s=pG(r,e,t);if(s!==0)return s;n=n||r.field.isKeyField()}return 0}}function pG(i,e,t){let n=i.field.isKeyField()?O.comparator(e.key,t.key):U6(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return B()}}var $n=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[r,s]of n)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0){this.inner[n]=[[e,t]],this.innerSize++;return}for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e)){r[s]=[e,t];return}r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Co(this.inner,(t,n)=>{for(let[r,s]of n)e(r,s)})}isEmpty(){return Pk(this.inner)}size(){return this.innerSize}};var gG=new Me(O.comparator);function hi(){return gG}var nM=new Me(O.comparator);function Xc(...i){let e=nM;for(let t of i)e=e.insert(t.key,t);return e}function yG(){return hd()}function rM(i){let e=nM;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function qn(){return hd()}function sM(){return hd()}function hd(){return new $n(i=>i.toString(),(i,e)=>i.isEqual(e))}var vG=new Me(O.comparator);function _G(){return vG}var bG=new Ce(O.comparator);function Z(...i){let e=bG;for(let t of i)e=e.add(t);return e}var wG=new Ce(X);function eS(){return wG}function oM(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cd(e)?"-0":e}}function aM(i){return{integerValue:""+i}}function lM(i,e){return qk(e)?aM(e):oM(i,e)}var tl=class{constructor(){this._=void 0}};function SG(i,e,t){return i instanceof ms?y6(t,e):i instanceof ur?dM(i,e):i instanceof hr?uM(i,e):TG(i,e)}function EG(i,e,t){return i instanceof ur?dM(i,e):i instanceof hr?uM(i,e):t}function cM(i,e){return i instanceof ps?L6(e)?e:{integerValue:0}:null}function CG(i,e){return i instanceof ur&&e instanceof ur||i instanceof hr&&e instanceof hr?lo(i.elements,e.elements,rn):i instanceof ps&&e instanceof ps?rn(i.operand,e.operand):i instanceof ms&&e instanceof ms}var ms=class extends tl{},ur=class extends tl{constructor(e){super(),this.elements=e}};function dM(i,e){let t=hM(e);for(let n of i.elements)t.some(r=>rn(r,n))||t.push(n);return{arrayValue:{values:t}}}var hr=class extends tl{constructor(e){super(),this.elements=e}};function uM(i,e){let t=hM(e);for(let n of i.elements)t=t.filter(r=>!rn(r,n));return{arrayValue:{values:t}}}var ps=class extends tl{constructor(e,t){super(),this.serializer=e,this.operand=t}};function TG(i,e){let t=cM(i,e),n=w1(t)+w1(i.operand);return o0(t)&&o0(i.operand)?aM(n):oM(i.serializer,n)}function w1(i){return Ye(i.integerValue||i.doubleValue)}function hM(i){return ud(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}var po=class{constructor(e,t){this.field=e,this.transform=t}};function xG(i,e){return i.field.isEqual(e.field)&&CG(i.transform,e.transform)}function IG(i,e){return i===void 0&&e===void 0?!0:i&&e?lo(i,e,(t,n)=>xG(t,n)):!1}var y0=class{constructor(e,t){this.version=e,this.transformResults=t}},Qe=class i{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new i}static exists(e){return new i(void 0,e)}static updateTime(e){return new i(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function rp(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists!==void 0?i.exists===e.isFoundDocument():!0}var il=class{};function fM(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new ys(i.key,Qe.none()):new gs(i.key,i.data,Qe.none());{let t=i.data,n=Gt.empty(),r=new Ce(nt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),r=r.add(s)}return new on(i.key,n,new Si(r.toArray()),Qe.none())}}function DG(i,e,t){i instanceof gs?RG(i,e,t):i instanceof on?MG(i,e,t):NG(i,e,t)}function id(i,e,t,n){return i instanceof gs?kG(i,e,t,n):i instanceof on?OG(i,e,t,n):PG(i,e,t)}function AG(i,e){let t=null;for(let n of i.fieldTransforms){let r=e.data.field(n.field),s=cM(n.transform,r||null);s!=null&&(t===null&&(t=Gt.empty()),t.set(n.field,s))}return t||null}function S1(i,e){return i.type!==e.type||!i.key.isEqual(e.key)||!i.precondition.isEqual(e.precondition)||!IG(i.fieldTransforms,e.fieldTransforms)?!1:i.type===0?i.value.isEqual(e.value):i.type===1?i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask):!0}var gs=class extends il{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}};function RG(i,e,t){let n=i.value.clone(),r=pM(i.fieldTransforms,e,t.transformResults);n.setAll(r),e.convertToFoundDocument(t.version,n).setHasCommittedMutations()}function kG(i,e,t,n){if(!rp(i.precondition,e))return t;let r=i.value.clone(),s=gM(i.fieldTransforms,n,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}var on=class extends il{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function MG(i,e,t){if(!rp(i.precondition,e)){e.convertToUnknownDocument(t.version);return}let n=pM(i.fieldTransforms,e,t.transformResults),r=e.data;r.setAll(mM(i)),r.setAll(n),e.convertToFoundDocument(t.version,r).setHasCommittedMutations()}function OG(i,e,t,n){if(!rp(i.precondition,e))return t;let r=gM(i.fieldTransforms,n,e),s=e.data;return s.setAll(mM(i)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),t===null?null:t.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(o=>o.field))}function mM(i){let e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let n=i.data.field(t);e.set(t,n)}}),e}function pM(i,e,t){let n=new Map;z(i.length===t.length);for(let r=0;r<t.length;r++){let s=i[r],o=s.transform,a=e.data.field(s.field);n.set(s.field,EG(o,a,t[r]))}return n}function gM(i,e,t){let n=new Map;for(let r of i){let s=r.transform,o=t.data.field(r.field);n.set(r.field,SG(s,o,e))}return n}var ys=class extends il{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};function NG(i,e,t){e.convertToNoDocument(t.version).setHasCommittedMutations()}function PG(i,e,t){return rp(i.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):t}var fd=class extends il{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var md=class{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];if(s.key.isEqual(e.key)){let o=n[r];DG(s,e,o)}}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=id(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=id(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=sM();return this.mutations.forEach(r=>{let s=e.get(r.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;let l=fM(o,a);l!==null&&n.set(r.key,l),o.isValidDocument()||o.convertToNoDocument($.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Z())}isEqual(e){return this.batchId===e.batchId&&lo(this.mutations,e.mutations,(t,n)=>S1(t,n))&&lo(this.baseMutations,e.baseMutations,(t,n)=>S1(t,n))}},v0=class i{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){z(e.mutations.length===n.length);let r=_G(),s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,n[o].version);return new i(e,t,n,r)}};var pd=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var _0=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Et=function(i){return i[i.OK=0]="OK",i[i.CANCELLED=1]="CANCELLED",i[i.UNKNOWN=2]="UNKNOWN",i[i.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",i[i.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",i[i.NOT_FOUND=5]="NOT_FOUND",i[i.ALREADY_EXISTS=6]="ALREADY_EXISTS",i[i.PERMISSION_DENIED=7]="PERMISSION_DENIED",i[i.UNAUTHENTICATED=16]="UNAUTHENTICATED",i[i.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",i[i.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",i[i.ABORTED=10]="ABORTED",i[i.OUT_OF_RANGE=11]="OUT_OF_RANGE",i[i.UNIMPLEMENTED=12]="UNIMPLEMENTED",i[i.INTERNAL=13]="INTERNAL",i[i.UNAVAILABLE=14]="UNAVAILABLE",i[i.DATA_LOSS=15]="DATA_LOSS",i}(Et||{});function yM(i){switch(i){case b.OK:return B();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0;default:return B()}}function FG(i){return yM(i)&&i!==b.ABORTED}function rm(i){if(i===void 0)return ze("GRPC error has no .code"),b.UNKNOWN;switch(i){case Et.OK:return b.OK;case Et.CANCELLED:return b.CANCELLED;case Et.UNKNOWN:return b.UNKNOWN;case Et.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Et.INTERNAL:return b.INTERNAL;case Et.UNAVAILABLE:return b.UNAVAILABLE;case Et.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Et.NOT_FOUND:return b.NOT_FOUND;case Et.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Et.ABORTED:return b.ABORTED;case Et.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Et.DATA_LOSS:return b.DATA_LOSS;default:return B()}}var b0=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Mb=null;function vM(){return new y4}function LG(){return new v4("utf-8")}var BG=new qs([4294967295,4294967295],0);function E1(i){let e=vM().encode(i),t=new kx;return t.update(e),new Uint8Array(t.digest())}function C1(i){let e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0),o=new qs([t,n],0),a=new qs([r,s],0);return[o,a]}var w0=class i{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new so(`Invalid padding: ${t}`);if(n<0)throw new so(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new so(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new so(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=e.length*8-t,this.bitCountInInteger=qs.fromNumber(this.bitCount)}getBitIndex(e,t,n){let r=e.add(t.multiply(qs.fromNumber(n)));return r.compare(BG)===1&&(r=new qs([r.getBits(0),r.getBits(1)],0)),r.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){let t=this.bitmap[Math.floor(e/8)],n=e%8;return(t&1<<n)!==0}mightContain(e){if(this.bitCount===0)return!1;let t=E1(e),[n,r]=C1(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(n,r,s);if(!this.isBitSet(o))return!1}return!0}static create(e,t,n){let r=e%8===0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new i(s,r,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.bitCount===0)return;let t=E1(e),[n,r]=C1(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(n,r,s);this.setBit(o)}}setBit(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},so=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var gd=class i{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let r=new Map;return r.set(e,yd.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new i($.min(),r,new Me(X),hi(),Z())}},yd=class i{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new i(n,t,Z(),Z(),Z())}};var Qa=class{constructor(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r}},ym=class{constructor(e,t){this.targetId=e,this.existenceFilter=t}},vm=class{constructor(e,t,n=Ct.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}},_m=class{constructor(){this.pendingResponses=0,this.documentChanges=x1(),this._resumeToken=Ct.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return this.pendingResponses!==0}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=Z(),t=Z(),n=Z();return this.documentChanges.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:B()}}),new yd(this._resumeToken,this._current,e,t,n)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=x1()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,z(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}},VG="WatchChangeAggregator",S0=class{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=hi(),this.pendingDocumentTargetMapping=T1(),this.pendingTargetResets=new Me(X)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let n=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&n.updateResumeToken(e.resumeToken);break;case 1:n.recordTargetResponse(),n.isPending||n.clearPendingChanges(),n.updateResumeToken(e.resumeToken);break;case 2:n.recordTargetResponse(),n.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(n.markCurrent(),n.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),n.updateResumeToken(e.resumeToken));break;default:B()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((n,r)=>{this.isActiveTarget(r)&&t(r)})}handleExistenceFilter(e){let t=e.targetId,n=e.existenceFilter.count,r=this.targetDataForActiveTarget(t);if(r){let s=r.target;if(pm(s))if(n===0){let o=new O(s.path);this.removeDocumentFromTarget(t,o,ut.newNoDocument(o,$.min()))}else z(n===1);else{let o=this.getCurrentDocumentCountForTarget(t);if(o!==n){let a=this.parseBloomFilter(e),l=a?this.applyBloomFilter(a,e,o):1;if(l!==0){this.resetTarget(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,c)}Mb?.notifyOnExistenceFilterMismatch(UG(o,e.existenceFilter,this.metadataProvider.getDatabaseId(),a,l))}}}}parseBloomFilter(e){let t=e.existenceFilter.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t,o;try{o=us(n).toUint8Array()}catch(l){if(l instanceof b0)return Vi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}let a;try{a=new w0(o,r,s)}catch(l){return l instanceof so?Vi("BloomFilter error: ",l):Vi("Applying bloom filter failed: ",l),null}return a.bitCount===0?null:a}applyBloomFilter(e,t,n){let r=t.existenceFilter.count,s=this.filterRemovedDocuments(e,t.targetId);return r===n-s?0:2}filterRemovedDocuments(e,t){let n=this.metadataProvider.getRemoteKeysForTarget(t),r=0;return n.forEach(s=>{let o=this.metadataProvider.getDatabaseId(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.removeDocumentFromTarget(t,s,null),r++)}),r}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((s,o)=>{let a=this.targetDataForActiveTarget(o);if(a){if(s.current&&pm(a.target)){let l=new O(a.target.path);this.pendingDocumentUpdates.get(l)===null&&!this.targetContainsDocument(o,l)&&this.removeDocumentFromTarget(o,l,ut.newNoDocument(l,e))}s.hasPendingChanges&&(t.set(o,s.toTargetChange()),s.clearPendingChanges())}});let n=Z();this.pendingDocumentTargetMapping.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{let c=this.targetDataForActiveTarget(l);return c&&c.purpose!=="TargetPurposeLimboResolution"?(a=!1,!1):!0}),a&&(n=n.add(s))}),this.pendingDocumentUpdates.forEach((s,o)=>o.setReadTime(e));let r=new gd(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,n);return this.pendingDocumentUpdates=hi(),this.pendingDocumentTargetMapping=T1(),this.pendingTargetResets=new Me(X),r}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let n=this.targetContainsDocument(e,t.key)?2:0;this.ensureTargetState(e).addDocumentChange(t.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,n){if(!this.isActiveTarget(e))return;let r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,1):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,n))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let n=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new _m,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new Ce(X),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}isActiveTarget(e){let t=this.targetDataForActiveTarget(e)!==null;return t||D(VG,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new _m),this.metadataProvider.getRemoteKeysForTarget(e).forEach(n=>{this.removeDocumentFromTarget(e,n,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}};function T1(){return new Me(O.comparator)}function x1(){return new Me(O.comparator)}function UG(i,e,t,n,r){var s,o,a,l,c,d;let u={localCacheCount:i,existenceFilterCount:e.count,databaseId:t.database,projectId:t.projectId},h=e.unchangedNames;return h&&(u.bloomFilter={applied:r===0,hashCount:(s=h?.hashCount)!==null&&s!==void 0?s:0,bitmapLength:(l=(a=(o=h?.bits)===null||o===void 0?void 0:o.bitmap)===null||a===void 0?void 0:a.length)!==null&&l!==void 0?l:0,padding:(d=(c=h?.bits)===null||c===void 0?void 0:c.padding)!==null&&d!==void 0?d:0,mightContain:m=>{var g;return(g=n?.mightContain(m))!==null&&g!==void 0?g:!1}}),u}var qG=(()=>{let i={};return i.asc="ASCENDING",i.desc="DESCENDING",i})(),zG=(()=>{let i={};return i["<"]="LESS_THAN",i["<="]="LESS_THAN_OR_EQUAL",i[">"]="GREATER_THAN",i[">="]="GREATER_THAN_OR_EQUAL",i["=="]="EQUAL",i["!="]="NOT_EQUAL",i["array-contains"]="ARRAY_CONTAINS",i.in="IN",i["not-in"]="NOT_IN",i["array-contains-any"]="ARRAY_CONTAINS_ANY",i})(),jG=(()=>{let i={};return i.and="AND",i.or="OR",i})();var E0=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function GG(i){let e=i.code===void 0?b.UNKNOWN:rm(i.code);return new E(e,i.message||"")}function C0(i,e){return i.useProto3Json||Nd(e)?e:{value:e}}function $G(i){let e;return typeof i=="object"?e=i.value:e=i,Nd(e)?null:e}function nl(i,e){if(i.useProto3Json){let n=new Date(e.seconds*1e3).toISOString().replace(/\.\d*/,"").replace("Z",""),r=("000000000"+e.nanoseconds).slice(-9);return`${n}.${r}Z`}else return{seconds:""+e.seconds,nanos:e.nanoseconds}}function HG(i){let e=ds(i);return new je(e.seconds,e.nanos)}function _M(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function WG(i,e){return i.useProto3Json?(z(e===void 0||typeof e=="string"),Ct.fromBase64String(e||"")):(z(e===void 0||e instanceof Uint8Array),Ct.fromUint8Array(e||new Uint8Array))}function KG(i,e){return nl(i,e.toTimestamp())}function it(i){return z(!!i),$.fromTimestamp(HG(i))}function tS(i,e){return QG(i).child("documents").child(e).canonicalString()}function bM(i){let e=me.fromString(i);return z(AM(e)),e}function vd(i,e){return tS(i.databaseId,e.path)}function zn(i,e){let t=bM(e);if(t.get(1)!==i.databaseId.projectId)throw new E(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new E(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new O(SM(t))}function T0(i,e){return tS(i.databaseId,e)}function wM(i){let e=bM(i);return e.length===4?me.emptyPath():SM(e)}function _d(i){return new me(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function QG(i){return new me(["projects",i.projectId,"databases",i.database])}function SM(i){return z(i.length>4&&i.get(4)==="documents"),i.popFirst(5)}function I1(i,e,t){return{name:vd(i,e),fields:t.value.mapValue.fields}}function YG(i,e){return{name:vd(i,e.key),fields:e.data.value.mapValue.fields,updateTime:nl(i,e.version.toTimestamp()),createTime:nl(i,e.createTime.toTimestamp())}}function EM(i,e,t){let n=zn(i,e.name),r=it(e.updateTime),s=e.createTime?it(e.createTime):$.min(),o=new Gt({mapValue:{fields:e.fields}}),a=ut.newFoundDocument(n,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function XG(i,e){z(!!e.found),e.found.name,e.found.updateTime;let t=zn(i,e.found.name),n=it(e.found.updateTime),r=e.found.createTime?it(e.found.createTime):$.min(),s=new Gt({mapValue:{fields:e.found.fields}});return ut.newFoundDocument(t,n,r,s)}function ZG(i,e){z(!!e.missing),z(!!e.readTime);let t=zn(i,e.missing),n=it(e.readTime);return ut.newNoDocument(t,n)}function JG(i,e){return"found"in e?XG(i,e):"missing"in e?ZG(i,e):B()}function e$(i,e){let t;if("targetChange"in e){e.targetChange;let n=t$(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=WG(i,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&GG(o);t=new vm(n,r,s,a||null)}else if("documentChange"in e){e.documentChange;let n=e.documentChange;n.document,n.document.name,n.document.updateTime;let r=zn(i,n.document.name),s=it(n.document.updateTime),o=n.document.createTime?it(n.document.createTime):$.min(),a=new Gt({mapValue:{fields:n.document.fields}}),l=ut.newFoundDocument(r,s,o,a),c=n.targetIds||[],d=n.removedTargetIds||[];t=new Qa(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let n=e.documentDelete;n.document;let r=zn(i,n.document),s=n.readTime?it(n.readTime):$.min(),o=ut.newNoDocument(r,s),a=n.removedTargetIds||[];t=new Qa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let n=e.documentRemove;n.document;let r=zn(i,n.document),s=n.removedTargetIds||[];t=new Qa([],s,r,null)}else if("filter"in e){e.filter;let n=e.filter;n.targetId;let{count:r=0,unchangedNames:s}=n,o=new _0(r,s),a=n.targetId;t=new ym(a,o)}else return B();return t}function t$(i){return i==="NO_CHANGE"?0:i==="ADD"?1:i==="REMOVE"?2:i==="CURRENT"?3:i==="RESET"?4:B()}function i$(i){if(!("targetChange"in i))return $.min();let e=i.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?$.min():it(e.readTime)}function bd(i,e){let t;if(e instanceof gs)t={update:I1(i,e.key,e.value)};else if(e instanceof ys)t={delete:vd(i,e.key)};else if(e instanceof on)t={update:I1(i,e.key,e.data),updateMask:P$(e.fieldMask)};else if(e instanceof fd)t={verify:vd(i,e.key)};else return B();return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>a$(i,n))),e.precondition.isNone||(t.currentDocument=n$(i,e.precondition)),t}function x0(i,e){let t=e.currentDocument?r$(e.currentDocument):Qe.none(),n=e.updateTransforms?e.updateTransforms.map(r=>l$(i,r)):[];if(e.update){e.update.name;let r=zn(i,e.update.name),s=new Gt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=F$(e.updateMask);return new on(r,s,o,t,n)}else return new gs(r,s,t,n)}else if(e.delete){let r=zn(i,e.delete);return new ys(r,t)}else if(e.verify){let r=zn(i,e.verify);return new fd(r,t)}else return B()}function n$(i,e){return e.updateTime!==void 0?{updateTime:KG(i,e.updateTime)}:e.exists!==void 0?{exists:e.exists}:B()}function r$(i){return i.updateTime!==void 0?Qe.updateTime(it(i.updateTime)):i.exists!==void 0?Qe.exists(i.exists):Qe.none()}function s$(i,e){let t=i.updateTime?it(i.updateTime):it(e);return t.isEqual($.min())&&(t=it(e)),new y0(t,i.transformResults||[])}function o$(i,e){return i&&i.length>0?(z(e!==void 0),i.map(t=>s$(t,e))):[]}function a$(i,e){let t=e.transform;if(t instanceof ms)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof ur)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof hr)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof ps)return{fieldPath:e.field.canonicalString(),increment:t.operand};throw B()}function l$(i,e){let t=null;if("setToServerValue"in e)z(e.setToServerValue==="REQUEST_TIME"),t=new ms;else if("appendMissingElements"in e){let r=e.appendMissingElements.values||[];t=new ur(r)}else if("removeAllFromArray"in e){let r=e.removeAllFromArray.values||[];t=new hr(r)}else"increment"in e?t=new ps(i,e.increment):B();let n=nt.fromServerFormat(e.fieldPath);return new po(n,t)}function CM(i,e){return{documents:[T0(i,e.path)]}}function c$(i){let e=i.documents.length;z(e===1);let t=i.documents[0];return ii(yl(wM(t)))}function TM(i,e){let t={structuredQuery:{}},n=e.path;e.collectionGroup!==null?(t.parent=T0(i,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=T0(i,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);let r=m$(e.filters);r&&(t.structuredQuery.where=r);let s=g$(e.orderBy);s&&(t.structuredQuery.orderBy=s);let o=C0(i,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=v$(e.startAt)),e.endAt&&(t.structuredQuery.endAt=_$(e.endAt)),t}function xM(i){let e=wM(i.parent),t=i.structuredQuery,n=t.from?t.from.length:0,r=null;if(n>0){z(n===1);let d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=p$(t.where));let o=[];t.orderBy&&(o=y$(t.orderBy));let a=null;t.limit&&(a=$G(t.limit));let l=null;t.startAt&&(l=b$(t.startAt));let c=null;return t.endAt&&(c=w$(t.endAt)),Jk(e,r,o,s,a,"F",l,c)}function d$(i){return ii(xM(i))}function u$(i,e){let t=h$(e.purpose);return t==null?null:{"goog-listen-tags":t}}function h$(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B()}}function f$(i,e){let t,n=e.target;if(pm(n)?t={documents:CM(i,n)}:t={query:TM(i,n)},t.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){t.resumeToken=_M(i,e.resumeToken);let r=C0(i,e.expectedCount);r!==null&&(t.expectedCount=r)}else if(e.snapshotVersion.compareTo($.min())>0){t.readTime=nl(i,e.snapshotVersion.toTimestamp());let r=C0(i,e.expectedCount);r!==null&&(t.expectedCount=r)}return t}function m$(i){if(i.length!==0)return DM(be.create(i,"and"))}function p$(i){let e=IM(i);return e instanceof be&&Xw(e)?e.getFilters():[e]}function IM(i){return i.unaryFilter!==void 0?M$(i):i.fieldFilter!==void 0?O$(i):i.compositeFilter!==void 0?N$(i):B()}function g$(i){if(i.length!==0)return i.map(e=>D$(e))}function y$(i){return i.map(e=>A$(e))}function v$(i){return{before:i.inclusive,values:i.position}}function _$(i){return{before:!i.inclusive,values:i.position}}function b$(i){let e=!!i.before,t=i.values||[];return new Gn(t,e)}function w$(i){let e=!i.before,t=i.values||[];return new Gn(t,e)}function S$(i){return qG[i]}function E$(i){switch(i){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function C$(i){return zG[i]}function T$(i){return jG[i]}function x$(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return B();default:return B()}}function I$(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B()}}function ja(i){return{fieldPath:i.canonicalString()}}function Ha(i){return nt.fromServerFormat(i.fieldPath)}function D$(i){return{field:ja(i.field),direction:S$(i.dir)}}function A$(i){return new fo(Ha(i.field),E$(i.direction))}function DM(i){return i instanceof oe?k$(i):i instanceof be?R$(i):B()}function R$(i){let e=i.getFilters().map(t=>DM(t));return e.length===1?e[0]:{compositeFilter:{op:T$(i.op),filters:e}}}function k$(i){if(i.op==="=="){if(g1(i.value))return{unaryFilter:{field:ja(i.field),op:"IS_NAN"}};if(p1(i.value))return{unaryFilter:{field:ja(i.field),op:"IS_NULL"}}}else if(i.op==="!="){if(g1(i.value))return{unaryFilter:{field:ja(i.field),op:"IS_NOT_NAN"}};if(p1(i.value))return{unaryFilter:{field:ja(i.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ja(i.field),op:C$(i.op),value:i.value}}}function M$(i){switch(i.unaryFilter.op){case"IS_NAN":let e=Ha(i.unaryFilter.field);return oe.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=Ha(i.unaryFilter.field);return oe.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let n=Ha(i.unaryFilter.field);return oe.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let r=Ha(i.unaryFilter.field);return oe.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return B();default:return B()}}function O$(i){return oe.create(Ha(i.fieldFilter.field),x$(i.fieldFilter.op),i.fieldFilter.value)}function N$(i){return be.create(i.compositeFilter.filters.map(e=>IM(e)),I$(i.compositeFilter.op))}function P$(i){let e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function F$(i){let e=i.fieldPaths||[];return new Si(e.map(t=>nt.fromServerFormat(t)))}function AM(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}var rl=class i{constructor(e,t,n,r,s=$.min(),o=$.min(),a=Ct.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new i(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new i(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var bm=class{constructor(e){this.remoteSerializer=e}};function L$(i,e){let t;if(e.document)t=EM(i.remoteSerializer,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let n=O.fromSegments(e.noDocument.path),r=yo(e.noDocument.readTime);t=ut.newNoDocument(n,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else if(e.unknownDocument){let n=O.fromSegments(e.unknownDocument.path),r=yo(e.unknownDocument.version);t=ut.newUnknownDocument(n,r)}else return B();return e.readTime&&t.setReadTime(B$(e.readTime)),t}function D1(i,e){let t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:sp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=YG(i.remoteSerializer,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:go(e.version)};else if(e.isUnknownDocument())n.unknownDocument={path:t.path.toArray(),version:go(e.version)};else return B();return n}function sp(i){let e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function B$(i){let e=new je(i[0],i[1]);return $.fromTimestamp(e)}function go(i){let e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function yo(i){let e=new je(i.seconds,i.nanoseconds);return $.fromTimestamp(e)}function V$(i,e,t){let n=t.baseMutations.map(s=>bd(i.remoteSerializer,s)),r=t.mutations.map(s=>bd(i.remoteSerializer,s));return{userId:e,batchId:t.batchId,localWriteTimeMs:t.localWriteTime.toMillis(),baseMutations:n,mutations:r}}function to(i,e){let t=(e.baseMutations||[]).map(s=>x0(i.remoteSerializer,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let n=e.mutations.map(s=>x0(i.remoteSerializer,s)),r=je.fromMillis(e.localWriteTimeMs);return new md(e.batchId,r,t,n)}function Zc(i){let e=yo(i.readTime),t=i.lastLimboFreeSnapshotVersion!==void 0?yo(i.lastLimboFreeSnapshotVersion):$.min(),n;return U$(i.query)?n=c$(i.query):n=d$(i.query),new rl(n,i.targetId,"TargetPurposeListen",i.lastListenSequenceNumber,e,t,Ct.fromBase64String(i.resumeToken))}function RM(i,e){let t=go(e.snapshotVersion),n=go(e.lastLimboFreeSnapshotVersion),r;pm(e.target)?r=CM(i.remoteSerializer,e.target):r=TM(i.remoteSerializer,e.target);let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:mo(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:r}}function U$(i){return i.documents!==void 0}function q$(i){return{id:i.bundleId,createTime:yo(i.createTime),version:i.version}}function z$(i){return{bundleId:i.id,createTime:go(it(i.createTime)),version:i.version}}function j$(i){return{name:i.name,query:iS(i.bundledQuery),readTime:yo(i.readTime)}}function G$(i){return{name:i.name,readTime:go(it(i.readTime)),bundledQuery:i.bundledQuery}}function iS(i){let e=xM({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?gm(e,e.limit,"L"):e}function $$(i){return{name:i.name,query:iS(i.bundledQuery),readTime:it(i.readTime)}}function H$(i){return{id:i.id,version:i.version,createTime:it(i.createTime)}}function Ob(i,e){return new pd(e.largestBatchId,x0(i.remoteSerializer,e.overlayMutation))}function W$(i,e,t){let[n,r,s]=kM(e,t.mutation.key);return{userId:e,collectionPath:r,documentId:s,collectionGroup:t.mutation.key.getCollectionGroup(),largestBatchId:t.largestBatchId,overlayMutation:bd(i.remoteSerializer,t.mutation)}}function kM(i,e){let t=e.path.lastSegment(),n=ti(e.path.popLast());return[i,n,t]}function K$(i){return{indexId:i.indexId,collectionGroup:i.collectionGroup,fields:i.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}function Q$(i,e){let t=e?new sd(e.sequenceNumber,new Ui(yo(e.readTime),new O(Un(e.documentKey)),e.largestBatchId)):sd.empty(),n=i.fields.map(([r,s])=>new Wa(nt.fromServerFormat(r),s));return new Kb(i.indexId,i.collectionGroup,n,t)}function A1(i,e,t,n){return{indexId:i,uid:e.uid||"",sequenceNumber:t,readTime:go(n.readTime),documentKey:ti(n.documentKey.path),largestBatchId:n.largestBatchId}}var I0=class{getBundleMetadata(e,t){return R1(e).get(t).next(n=>{if(n)return q$(n)})}saveBundleMetadata(e,t){return R1(e).put(z$(t))}getNamedQuery(e,t){return k1(e).get(t).next(n=>{if(n)return j$(n)})}saveNamedQuery(e,t){return k1(e).put(G$(t))}};function R1(i){return Tt(i,Jm)}function k1(i){return Tt(i,ep)}var wm=class i{constructor(e,t){this.serializer=e,this.userId=t}static forUser(e,t){let n=t.uid||"";return new i(e,n)}getOverlay(e,t){return Wc(e).get(kM(this.userId,t)).next(n=>n?Ob(this.serializer,n):null)}getOverlays(e,t){let n=qn();return v.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){let r=[];return n.forEach((s,o)=>{let a=new pd(t,o);r.push(this.saveOverlay(e,a))}),v.waitFor(r)}removeOverlaysForBatchId(e,t,n){let r=new Set;t.forEach(o=>r.add(ti(o.getCollectionPath())));let s=[];return r.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(Wc(e).deleteAll(i0,a))}),v.waitFor(s)}getOverlaysForCollection(e,t,n){let r=qn(),s=ti(t),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Wc(e).loadAll(i0,o).next(a=>{for(let l of a){let c=Ob(this.serializer,l);r.set(c.getKey(),c)}return r})}getOverlaysForCollectionGroup(e,t,n,r){let s=qn(),o,a=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Wc(e).iterate({index:kk,range:a},(l,c,d)=>{let u=Ob(this.serializer,c);s.size()<r||u.largestBatchId===o?(s.set(u.getKey(),u),o=u.largestBatchId):d.done()}).next(()=>s)}saveOverlay(e,t){return Wc(e).put(W$(this.serializer,this.userId,t))}};function Wc(i){return Tt(i,tp)}var Y$=5,X$=10,Z$=13,M1=15,J$=20,e5=25,t5=30,i5=37,n5=45,r5=50,s5=55,o5=60,a5=2,dr=class{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,Y$);else if("booleanValue"in e)this.writeValueTypeLabel(t,X$),t.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(t,M1),t.writeNumber(Ye(e.integerValue));else if("doubleValue"in e){let n=Ye(e.doubleValue);isNaN(n)?this.writeValueTypeLabel(t,Z$):(this.writeValueTypeLabel(t,M1),cd(n)?t.writeNumber(0):t.writeNumber(n))}else if("timestampValue"in e){let n=e.timestampValue;this.writeValueTypeLabel(t,J$),typeof n=="string"?t.writeString(n):(t.writeString(`${n.seconds||""}`),t.writeNumber(n.nanos||0))}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,t5),t.writeBytes(us(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.writeValueTypeLabel(t,n5),t.writeNumber(n.latitude||0),t.writeNumber(n.longitude||0)}else"mapValue"in e?jk(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):B()}writeIndexString(e,t){this.writeValueTypeLabel(t,e5),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let n=e.fields||{};this.writeValueTypeLabel(t,s5);for(let r of Object.keys(n))this.writeIndexString(r,t),this.writeIndexValueAux(n[r],t)}writeIndexArray(e,t){let n=e.values||[];this.writeValueTypeLabel(t,r5);for(let r of n)this.writeIndexValueAux(r,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,i5),O.fromName(e).path.forEach(r=>{this.writeValueTypeLabel(t,o5),this.writeUnlabeledIndexString(r,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(a5)}};dr.INSTANCE=new dr;var O1="\uD800",N1="\uDBFF",Fa=0,P1=255,F1=1,La=255,L1=255,B1=0,l5=64,c5=8,d5=1024;function u5(i){let e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,i,!1),new Uint8Array(e.buffer)}function h5(i){if(i===0)return 8;let e=0;return i>>4||(e+=4,i=i<<4),i>>6||(e+=2,i=i<<2),i>>7||(e+=1),e}function f5(i){let e=0;for(let t=0;t<8;++t){let n=h5(i[t]&255);if(e+=n,n!==8)break}return e}function V1(i){let e=l5-f5(i);return Math.ceil(e/c5)}var D0=class{constructor(){this.buffer=new Uint8Array(d5),this.position=0}writeBytesAscending(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.writeByteAscending(n.value),n=t.next();this.writeSeparatorAscending()}writeBytesDescending(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.writeByteDescending(n.value),n=t.next();this.writeSeparatorDescending()}writeUtf8Ascending(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.writeByteAscending(n);else if(n<2048)this.writeByteAscending(960|n>>>6),this.writeByteAscending(128|63&n);else if(t<O1||N1<t)this.writeByteAscending(480|n>>>12),this.writeByteAscending(128|63&n>>>6),this.writeByteAscending(128|63&n);else{let r=t.codePointAt(0);this.writeByteAscending(240|r>>>18),this.writeByteAscending(128|63&r>>>12),this.writeByteAscending(128|63&r>>>6),this.writeByteAscending(128|63&r)}}this.writeSeparatorAscending()}writeUtf8Descending(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.writeByteDescending(n);else if(n<2048)this.writeByteDescending(960|n>>>6),this.writeByteDescending(128|63&n);else if(t<O1||N1<t)this.writeByteDescending(480|n>>>12),this.writeByteDescending(128|63&n>>>6),this.writeByteDescending(128|63&n);else{let r=t.codePointAt(0);this.writeByteDescending(240|r>>>18),this.writeByteDescending(128|63&r>>>12),this.writeByteDescending(128|63&r>>>6),this.writeByteDescending(128|63&r)}}this.writeSeparatorDescending()}writeNumberAscending(e){let t=this.toOrderedBits(e),n=V1(t);this.ensureAvailable(1+n),this.buffer[this.position++]=n&255;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=t[r]&255}writeNumberDescending(e){let t=this.toOrderedBits(e),n=V1(t);this.ensureAvailable(1+n),this.buffer[this.position++]=~(n&255);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(t[r]&255)}writeInfinityAscending(){this.writeEscapedByteAscending(La),this.writeEscapedByteAscending(L1)}writeInfinityDescending(){this.writeEscapedByteDescending(La),this.writeEscapedByteDescending(L1)}reset(){this.position=0}seed(e){this.ensureAvailable(e.length),this.buffer.set(e,this.position),this.position+=e.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(e){let t=u5(e),n=(t[0]&128)!==0;t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}writeByteAscending(e){let t=e&255;t===Fa?(this.writeEscapedByteAscending(Fa),this.writeEscapedByteAscending(P1)):t===La?(this.writeEscapedByteAscending(La),this.writeEscapedByteAscending(B1)):this.writeEscapedByteAscending(t)}writeByteDescending(e){let t=e&255;t===Fa?(this.writeEscapedByteDescending(Fa),this.writeEscapedByteDescending(P1)):t===La?(this.writeEscapedByteDescending(La),this.writeEscapedByteDescending(B1)):this.writeEscapedByteDescending(e)}writeSeparatorAscending(){this.writeEscapedByteAscending(Fa),this.writeEscapedByteAscending(F1)}writeSeparatorDescending(){this.writeEscapedByteDescending(Fa),this.writeEscapedByteDescending(F1)}writeEscapedByteAscending(e){this.ensureAvailable(1),this.buffer[this.position++]=e}writeEscapedByteDescending(e){this.ensureAvailable(1),this.buffer[this.position++]=~e}ensureAvailable(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=this.buffer.length*2;n<t&&(n=t);let r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}},A0=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesAscending(e)}writeString(e){this.orderedCode.writeUtf8Ascending(e)}writeNumber(e){this.orderedCode.writeNumberAscending(e)}writeInfinity(){this.orderedCode.writeInfinityAscending()}},R0=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesDescending(e)}writeString(e){this.orderedCode.writeUtf8Descending(e)}writeNumber(e){this.orderedCode.writeNumberDescending(e)}writeInfinity(){this.orderedCode.writeInfinityDescending()}},io=class{constructor(){this.orderedCode=new D0,this.ascending=new A0(this.orderedCode),this.descending=new R0(this.orderedCode)}seed(e){this.orderedCode.seed(e)}forKind(e){return e===0?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}};var no=class i{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}successor(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new i(this.indexId,this.documentKey,this.arrayValue,n)}};function ts(i,e){let t=i.indexId-e.indexId;return t!==0||(t=U1(i.arrayValue,e.arrayValue),t!==0)||(t=U1(i.directionalValue,e.directionalValue),t!==0)?t:O.comparator(i.documentKey,e.documentKey)}function U1(i,e){for(let t=0;t<i.length&&t<e.length;++t){let n=i[t]-e[t];if(n!==0)return n}return i.length-e.length}var Sm=class{constructor(e){this.inequalityFilters=new Ce((t,n)=>nt.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.orderBys=e.orderBy,this.equalityFilters=[];for(let t of e.filters){let n=t;n.isInequality()?this.inequalityFilters=this.inequalityFilters.add(n):this.equalityFilters.push(n)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(e){if(z(e.collectionGroup===this.collectionId),this.hasMultipleInequality)return!1;let t=zw(e);if(t!==void 0&&!this.hasMatchingEqualityFilter(t))return!1;let n=co(e),r=new Set,s=0,o=0;for(;s<n.length&&this.hasMatchingEqualityFilter(n[s]);++s)r=r.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.inequalityFilters.size>0){let a=this.inequalityFilters.getIterator().getNext();if(!r.has(a.field.canonicalString())){let l=n[s];if(!this.matchesFilter(a,l)||!this.matchesOrderBy(this.orderBys[o++],l))return!1}++s}for(;s<n.length;++s){let a=n[s];if(o>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[o++],a))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let e=new Ce(nt.comparator),t=[];for(let n of this.equalityFilters){if(n.field.isKeyField())continue;if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Wa(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Wa(n.field,0))}}for(let n of this.orderBys)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Wa(n.field,n.dir==="asc"?0:1)));return new Kb(Kb.UNKNOWN_ID,this.collectionId,t,sd.empty())}hasMatchingEqualityFilter(e){for(let t of this.equalityFilters)if(this.matchesFilter(t,e))return!0;return!1}matchesFilter(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}matchesOrderBy(e,t){return e.field.isEqual(t.fieldPath)?t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc":!1}};function MM(i){var e,t;if(z(i instanceof oe||i instanceof be),i instanceof oe)if(i instanceof mm){let r=((t=(e=i.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>oe.create(i.field,"==",s)))||[];return be.create(r,"or")}else return i;let n=i.filters.map(r=>MM(r));return be.create(n,i.op)}function m5(i){if(i.getFilters().length===0)return[];let e=k0(MM(i));return z(OM(e)),nS(e)||rS(e)?[e]:e.getFilters()}function nS(i){return i instanceof oe}function rS(i){return i instanceof be&&Xw(i)}function OM(i){return nS(i)||rS(i)||p5(i)}function p5(i){if(i instanceof be&&a0(i)){for(let e of i.getFilters())if(!nS(e)&&!rS(e))return!1;return!0}return!1}function k0(i){if(z(i instanceof oe||i instanceof be),i instanceof oe)return i;if(i.filters.length===1)return k0(i.filters[0]);let e=i.filters.map(n=>k0(n)),t=be.create(e,i.op);return t=Em(t),OM(t)?t:(z(t instanceof be),z(Ja(t)),z(t.filters.length>1),t.filters.reduce((n,r)=>sS(n,r)))}function sS(i,e){z(i instanceof oe||i instanceof be),z(e instanceof oe||e instanceof be);let t;return i instanceof oe?e instanceof oe?t=g5(i,e):t=q1(i,e):e instanceof oe?t=q1(e,i):t=y5(i,e),Em(t)}function g5(i,e){return be.create([i,e],"and")}function y5(i,e){if(z(i.filters.length>0&&e.filters.length>0),Ja(i)&&Ja(e))return Kk(i,e.getFilters());let t=a0(i)?i:e,n=a0(i)?e:i,r=t.filters.map(s=>sS(s,n));return be.create(r,"or")}function q1(i,e){if(Ja(e))return Kk(e,i.getFilters());{let t=e.filters.map(n=>sS(i,n));return be.create(t,"or")}}function Em(i){if(z(i instanceof oe||i instanceof be),i instanceof oe)return i;let e=i.getFilters();if(e.length===1)return Em(e[0]);if(Hk(i))return i;let t=e.map(r=>Em(r)),n=[];return t.forEach(r=>{r instanceof oe?n.push(r):r instanceof be&&(r.op===i.op?n.push(...r.filters):n.push(r))}),n.length===1?n[0]:be.create(n,i.op)}var M0=class{constructor(){this.collectionParentIndex=new wd}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),v.resolve()}getCollectionParents(e,t){return v.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return v.resolve()}deleteFieldIndex(e,t){return v.resolve()}deleteAllFieldIndexes(e){return v.resolve()}createTargetIndexes(e,t){return v.resolve()}getDocumentsMatchingTarget(e,t){return v.resolve(null)}getIndexType(e,t){return v.resolve(0)}getFieldIndexes(e,t){return v.resolve([])}getNextCollectionGroupToUpdate(e){return v.resolve(null)}getMinOffset(e,t){return v.resolve(Ui.min())}getMinOffsetFromCollectionGroup(e,t){return v.resolve(Ui.min())}updateCollectionGroup(e,t,n){return v.resolve()}updateIndexEntries(e,t){return v.resolve()}},wd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ce(me.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ce(me.comparator)).toArray()}};var z1="IndexedDbIndexManager",Yf=new Uint8Array(0),O0=class{constructor(e,t){this.user=e,this.databaseId=t,this.collectionParentsCache=new wd,this.targetToDnfSubTargets=new $n(n=>mo(n),(n,r)=>Pd(n,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.collectionParentsCache.has(t)){let n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.collectionParentsCache.add(t)});let s={collectionId:n,parent:ti(r)};return j1(e).put(s)}return v.resolve()}getCollectionParents(e,t){let n=[],r=IDBKeyRange.bound([t,""],[vk(t),""],!1,!0);return j1(e).loadAll(r).next(s=>{for(let o of s){if(o.collectionId!==t)break;n.push(Un(o.parent))}return n})}addFieldIndex(e,t){let n=Kc(e),r=K$(t);delete r.indexId;let s=n.add(r);if(t.indexState){let o=Va(e);return s.next(a=>{o.put(A1(a,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}else return s.next()}deleteFieldIndex(e,t){let n=Kc(e),r=Va(e),s=Ba(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Kc(e),n=Ba(e),r=Va(e);return t.deleteAll().next(()=>n.deleteAll()).next(()=>r.deleteAll())}createTargetIndexes(e,t){return v.forEach(this.getSubTargets(t),n=>this.getIndexType(e,n).next(r=>{if(r===0||r===1){let o=new Sm(n).buildTargetIndex();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let n=Ba(e),r=!0,s=new Map;return v.forEach(this.getSubTargets(t),o=>this.getFieldIndex(e,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=Z(),a=[];return v.forEach(s,(l,c)=>{D(z1,`Using index ${D4(l)} to execute ${mo(t)}`);let d=X6(c,l),u=Z6(c,l),h=J6(c,l),m=eG(c,l),g=this.encodeBound(l,c,h),_=this.encodeBound(l,c,m),y=this.encodeValues(l,c,u),A=this.generateIndexRanges(l.indexId,d,g,h.inclusive,_,m.inclusive,y);return v.forEach(A,w=>n.loadFirst(w,t.limit).next(R=>{R.forEach(k=>{let q=O.fromSegments(k.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}else return v.resolve(null)})}getSubTargets(e){let t=this.targetToDnfSubTargets.get(e);return t||(e.filters.length===0?t=[e]:t=m5(be.create(e.filters,"and")).map(r=>g0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.targetToDnfSubTargets.set(e,t),t)}generateIndexRanges(e,t,n,r,s,o,a){let l=(t!=null?t.length:1)*Math.max(n.length,s.length),c=l/(t!=null?t.length:1),d=[];for(let u=0;u<l;++u){let h=t?this.encodeSingleElement(t[u/c]):Yf,m=this.generateLowerBound(e,h,n[u%c],r),g=this.generateUpperBound(e,h,s[u%c],o),_=a.map(y=>this.generateLowerBound(e,h,y,!0));d.push(...this.createRange(m,g,_))}return d}generateLowerBound(e,t,n,r){let s=new no(e,O.empty(),t,n);return r?s:s.successor()}generateUpperBound(e,t,n,r){let s=new no(e,O.empty(),t,n);return r?s.successor():s}getFieldIndex(e,t){let n=new Sm(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(let a of s)n.servedByIndex(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let n=2,r=this.getSubTargets(t);return v.forEach(r,s=>this.getFieldIndex(e,s).next(o=>{o?n!==0&&o.fields.length<tG(s)&&(n=1):n=0})).next(()=>iG(t)&&r.length>1&&n===2?1:n)}encodeDirectionalElements(e,t){let n=new io;for(let r of co(e)){let s=t.data.field(r.fieldPath);if(s==null)return null;let o=n.forKind(r.kind);dr.INSTANCE.writeIndexValue(s,o)}return n.encodedBytes()}encodeSingleElement(e){let t=new io;return dr.INSTANCE.writeIndexValue(e,t.forKind(0)),t.encodedBytes()}encodeDirectionalKey(e,t){let n=new io;return dr.INSTANCE.writeIndexValue(ho(this.databaseId,t),n.forKind(I4(e))),n.encodedBytes()}encodeValues(e,t,n){if(n===null)return[];let r=[];r.push(new io);let s=0;for(let o of co(e)){let a=n[s++];for(let l of r)if(this.isInFilter(t,o.fieldPath)&&ud(a))r=this.expandIndexValues(r,o,a);else{let c=l.forKind(o.kind);dr.INSTANCE.writeIndexValue(a,c)}}return this.getEncodedBytes(r)}encodeBound(e,t,n){return this.encodeValues(e,t,n.position)}getEncodedBytes(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].encodedBytes();return t}expandIndexValues(e,t,n){let r=[...e],s=[];for(let o of n.arrayValue.values||[])for(let a of r){let l=new io;l.seed(a.encodedBytes()),dr.INSTANCE.writeIndexValue(o,l.forKind(t.kind)),s.push(l)}return s}isInFilter(e,t){return!!e.filters.find(n=>n instanceof oe&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){let n=Kc(e),r=Va(e);return(t?n.loadAll(t0,IDBKeyRange.bound(t,t)):n.loadAll()).next(s=>{let o=[];return v.forEach(s,a=>r.get([a.indexId,this.uid]).next(l=>{o.push(Q$(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,r)=>{let s=n.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:X(n.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){let r=Kc(e),s=Va(e);return this.getNextSequenceNumber(e).next(o=>r.loadAll(t0,IDBKeyRange.bound(t,t)).next(a=>v.forEach(a,l=>s.put(A1(l.indexId,this.user,o,n)))))}updateIndexEntries(e,t){let n=new Map;return v.forEach(t,(r,s)=>{let o=n.get(r.collectionGroup);return(o?v.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(n.set(r.collectionGroup,l),v.forEach(l,c=>this.getExistingIndexEntries(e,r,c).next(d=>{let u=this.computeIndexEntries(s,c);return d.isEqual(u)?v.resolve():this.updateEntries(e,s,c,d,u)}))))})}addIndexEntry(e,t,n,r){return Ba(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(n,t.key),documentKey:t.key.path.toArray()})}deleteIndexEntry(e,t,n,r){return Ba(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.encodeDirectionalKey(n,t.key),t.key.path.toArray()])}getExistingIndexEntries(e,t,n){let r=Ba(e),s=new Ce(ts);return r.iterate({index:Rk,range:IDBKeyRange.only([n.indexId,this.uid,this.encodeDirectionalKey(n,t)])},(o,a)=>{s=s.add(new no(n.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}computeIndexEntries(e,t){let n=new Ce(ts),r=this.encodeDirectionalElements(t,e);if(r==null)return n;let s=zw(t);if(s!=null){let o=e.data.field(s.fieldPath);if(ud(o))for(let a of o.arrayValue.values||[])n=n.add(new no(t.indexId,e.key,this.encodeSingleElement(a),r))}else n=n.add(new no(t.indexId,e.key,Yf,r));return n}updateEntries(e,t,n,r,s){D(z1,"Updating index entries for document '%s'",t.key);let o=[];return u6(r,s,ts,a=>{o.push(this.addIndexEntry(e,t,n,a))},a=>{o.push(this.deleteIndexEntry(e,t,n,a))}),v.waitFor(o)}getNextSequenceNumber(e){let t=1;return Va(e).iterate({index:Ak,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,o)=>{o.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((o,a)=>ts(o,a)).filter((o,a,l)=>!a||ts(o,l[a-1])!==0);let r=[];r.push(e);for(let o of n){let a=ts(o,e),l=ts(o,t);if(a===0)r[0]=e.successor();else if(a>0&&l<0)r.push(o),r.push(o.successor());else if(l>0)break}r.push(t);let s=[];for(let o=0;o<r.length;o+=2){if(this.isRangeMatchable(r[o],r[o+1]))return[];let a=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Yf,[]],l=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Yf,[]];s.push(IDBKeyRange.bound(a,l))}return s}isRangeMatchable(e,t){return ts(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(G1)}getMinOffset(e,t){return v.mapArray(this.getSubTargets(t),n=>this.getFieldIndex(e,n).next(r=>r||B())).next(G1)}};function j1(i){return Tt(i,od)}function Ba(i){return Tt(i,Kw)}function Kc(i){return Tt(i,Hw)}function Va(i){return Tt(i,Ww)}function G1(i){z(i.length!==0);let e=i[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<i.length;n++){let r=i[n].indexState.offset;jw(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ui(e.readTime,e.documentKey,t)}function NM(i,e,t){let n=i.store(nn),r=i.store(ml),s=[],o=IDBKeyRange.only(t.batchId),a=0,l=n.iterate({range:o},(d,u,h)=>(a++,h.delete()));s.push(l.next(()=>{z(a===1)}));let c=[];for(let d of t.mutations){let u=xk(e,d.key.path,t.batchId);s.push(r.delete(u)),c.push(d.key)}return v.waitFor(s).next(()=>c)}function Cm(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else if(i.noDocument)e=i.noDocument;else throw B();return JSON.stringify(e).length}var Tm=class i{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}static forUser(e,t,n,r){z(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new i(s,t,n,r)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return is(e).iterate({index:ro,range:n},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,n,r){let s=Ga(e),o=is(e);return o.add({}).next(a=>{z(typeof a=="number");let l=new md(a,t,n,r),c=V$(this.serializer,this.userId,l),d=[],u=new Ce((h,m)=>X(h.canonicalString(),m.canonicalString()));for(let h of r){let m=xk(this.userId,h.key.path,a);u=u.add(h.key.path.popLast()),d.push(o.put(c)),d.push(s.put(m,F4))}return u.forEach(h=>{d.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.documentKeysByBatchId[a]=l.keys()}),v.waitFor(d).next(()=>l)})}lookupMutationBatch(e,t){return is(e).get(t).next(n=>n?(z(n.userId===this.userId),to(this.serializer,n)):null)}lookupMutationKeys(e,t){return this.documentKeysByBatchId[t]?v.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){let r=n.keys();return this.documentKeysByBatchId[t]=r,r}else return null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]),s=null;return is(e).iterate({index:ro,range:r},(o,a,l)=>{a.userId===this.userId&&(z(a.batchId>=n),s=to(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=as;return is(e).iterate({index:ro,range:t,reverse:!0},(r,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,as],[this.userId,Number.POSITIVE_INFINITY]);return is(e).loadAll(ro,t).next(n=>n.map(r=>to(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=em(this.userId,t.path),r=IDBKeyRange.lowerBound(n),s=[];return Ga(e).iterate({range:r},(o,a,l)=>{let[c,d,u]=o,h=Un(d);if(c!==this.userId||!t.path.isEqual(h)){l.done();return}return is(e).get(u).next(m=>{if(!m)throw B();z(m.userId===this.userId),s.push(to(this.serializer,m))})}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ce(X),r=[];return t.forEach(s=>{let o=em(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Ga(e).iterate({range:a},(c,d,u)=>{let[h,m,g]=c,_=Un(m);if(h!==this.userId||!s.path.isEqual(_)){u.done();return}n=n.add(g)});r.push(l)}),v.waitFor(r).next(()=>this.lookupMutationBatches(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,s=em(this.userId,n),o=IDBKeyRange.lowerBound(s),a=new Ce(X);return Ga(e).iterate({range:o},(l,c,d)=>{let[u,h,m]=l,g=Un(h);if(u!==this.userId||!n.isPrefixOf(g)){d.done();return}g.length===r&&(a=a.add(m))}).next(()=>this.lookupMutationBatches(e,a))}lookupMutationBatches(e,t){let n=[],r=[];return t.forEach(s=>{r.push(is(e).get(s).next(o=>{if(o===null)throw B();z(o.userId===this.userId),n.push(to(this.serializer,o))}))}),v.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return NM(e.simpleDbTransaction,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.removeCachedMutationKeys(t.batchId)}),v.forEach(n,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}removeCachedMutationKeys(e){delete this.documentKeysByBatchId[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return v.resolve();let n=IDBKeyRange.lowerBound(P4(this.userId)),r=[];return Ga(e).iterate({range:n},(s,o,a)=>{if(s[0]!==this.userId){a.done();return}else{let c=Un(s[1]);r.push(c)}}).next(()=>{z(r.length===0)})})}containsKey(e,t){return PM(e,this.userId,t)}getMutationQueueMetadata(e){return FM(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:as,lastStreamToken:""})}};function PM(i,e,t){let n=em(e,t.path),r=n[1],s=IDBKeyRange.lowerBound(n),o=!1;return Ga(i).iterate({range:s,keysOnly:!0},(a,l,c)=>{let[d,u,h]=a;d===e&&u===r&&(o=!0),c.done()}).next(()=>o)}function v5(i,e){let t=!1;return FM(i).iterateSerial(n=>PM(i,n,e).next(r=>(r&&(t=!0),v.resolve(!r)))).next(()=>t)}function is(i){return Tt(i,nn)}function Ga(i){return Tt(i,ml)}function FM(i){return Tt(i,Md)}var Nb=2,sl=class i{constructor(e){this.lastId=e}next(){return this.lastId+=Nb,this.lastId}static forTargetCache(){return new i(2-Nb)}static forSyncEngine(){return new i(1-Nb)}};var N0=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.retrieveMetadata(e).next(t=>{let n=new sl(t.highestTargetId);return t.highestTargetId=n.next(),this.saveMetadata(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.retrieveMetadata(e).next(t=>$.fromTimestamp(new je(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.retrieveMetadata(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.retrieveMetadata(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.saveMetadata(e,r)))}addTargetData(e,t){return this.saveTargetData(e,t).next(()=>this.retrieveMetadata(e).next(n=>(n.targetCount+=1,this.updateMetadataFromTargetData(t,n),this.saveMetadata(e,n))))}updateTargetData(e,t){return this.saveTargetData(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ua(e).delete(t.targetId)).next(()=>this.retrieveMetadata(e)).next(n=>(z(n.targetCount>0),n.targetCount-=1,this.saveMetadata(e,n)))}removeTargets(e,t,n){let r=0,s=[];return Ua(e).iterate((o,a)=>{let l=Zc(a);l.sequenceNumber<=t&&n.get(l.targetId)===null&&(r++,s.push(this.removeTargetData(e,l)))}).next(()=>v.waitFor(s)).next(()=>r)}forEachTarget(e,t){return Ua(e).iterate((n,r)=>{let s=Zc(r);t(s)})}retrieveMetadata(e){return $1(e).get(um).next(t=>(z(t!==null),t))}saveMetadata(e,t){return $1(e).put(um,t)}saveTargetData(e,t){return Ua(e).put(RM(this.serializer,t))}updateMetadataFromTargetData(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.retrieveMetadata(e).next(t=>t.targetCount)}getTargetData(e,t){let n=mo(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),s=null;return Ua(e).iterate({range:r,index:Dk},(o,a,l)=>{let c=Zc(a);Pd(t,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,t,n){let r=[],s=rs(e);return t.forEach(o=>{let a=ti(o.path);r.push(s.put({targetId:n,path:a})),r.push(this.referenceDelegate.addReference(e,n,o))}),v.waitFor(r)}removeMatchingKeys(e,t,n){let r=rs(e);return v.forEach(t,s=>{let o=ti(s.path);return v.waitFor([r.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){let n=rs(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),r=rs(e),s=Z();return r.iterate({range:n,keysOnly:!0},(o,a,l)=>{let c=Un(o[1]),d=new O(c);s=s.add(d)}).next(()=>s)}containsKey(e,t){let n=ti(t.path),r=IDBKeyRange.bound([n],[vk(n)],!1,!0),s=0;return rs(e).iterate({index:$w,keysOnly:!0,range:r},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}getTargetDataForTarget(e,t){return Ua(e).get(t).next(n=>n?Zc(n):null)}};function Ua(i){return Tt(i,pl)}function $1(i){return Tt(i,Eo)}function rs(i){return Tt(i,gl)}var H1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Bd=-1,LM=40*1024*1024,Bi=class i{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new i(e,i.DEFAULT_COLLECTION_PERCENTILE,i.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Bi.DEFAULT_COLLECTION_PERCENTILE=10;Bi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;Bi.DEFAULT=new Bi(LM,Bi.DEFAULT_COLLECTION_PERCENTILE,Bi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);Bi.DISABLED=new Bi(Bd,0,0);var W1="LruGarbageCollector",K1=1*1024*1024,_5=1*60*1e3,b5=5*60*1e3;function Q1([i,e],[t,n]){let r=X(i,t);return r===0?X(e,n):r}var P0=class{constructor(e){this.maxElements=e,this.buffer=new Ce(Q1),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let n=this.buffer.last();Q1(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}},F0=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==Bd&&this.scheduleGC(_5)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return this.gcTask!==null}scheduleGC(e){D(W1,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>p(this,null,function*(){this.gcTask=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){ws(t)?D(W1,"Ignoring IndexedDB error during garbage collection: ",t):yield bs(t)}yield this.scheduleGC(b5)}))}},L0=class{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return v.resolve(wi.INVALID);let n=new P0(t);return this.delegate.forEachTarget(e,r=>n.addElement(r.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,r=>n.addElement(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.delegate.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===Bd?(D("LruGarbageCollector","Garbage collection skipped; disabled"),v.resolve(H1)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(D("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),H1):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let n,r,s,o,a,l,c,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(D("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),r=this.params.maximumSequenceNumbersToCollect):r=u,o=Date.now(),this.nthSequenceNumber(e,r))).next(u=>(n=u,a=Date.now(),this.removeTargets(e,n,t))).next(u=>(s=u,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(u=>{if(c=Date.now(),qa()<=vn.DEBUG){let h=`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in ${a-o}ms
	Removed ${s} targets in ${l-a}ms
	Removed ${u} documents in ${c-l}ms
Total Duration: ${c-d}ms`;D("LruGarbageCollector",h)}return v.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:u})})}};function w5(i,e){return new L0(i,e)}var B0=class{constructor(e,t){this.db=e,this.garbageCollector=w5(this,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}forEachOrphanedDocumentSequenceNumber(e,t){return this.forEachOrphanedDocument(e,(n,r)=>t(r))}addReference(e,t,n){return Xf(e,n)}removeReference(e,t,n){return Xf(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Xf(e,t)}isPinned(e,t){return v5(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[],o=0;return this.forEachOrphanedDocument(e,(l,c)=>{if(c<=t){let d=this.isPinned(e,l).next(u=>{if(!u)return o++,r.getEntry(e,l).next(()=>(r.removeEntry(l,$.min()),rs(e).delete(S5(l))))});s.push(d)}}).next(()=>v.waitFor(s)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Xf(e,t)}forEachOrphanedDocument(e,t){let n=rs(e),r=wi.INVALID,s;return n.iterate({index:$w},([o,a],{path:l,sequenceNumber:c})=>{o===0?(r!==wi.INVALID&&t(new O(Un(s)),r),r=c,s=l):r=wi.INVALID}).next(()=>{r!==wi.INVALID&&t(new O(Un(s)),r)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function S5(i){return[0,ti(i.path)]}function E5(i,e){return{targetId:0,path:ti(i.path),sequenceNumber:e}}function Xf(i,e){return rs(i).put(E5(e,i.currentSequenceNumber))}var xm=class{constructor(){this.changes=new $n(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ut.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n!==void 0?v.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var V0=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Zs(e).put(n)}removeEntry(e,t,n){return Zs(e).delete(C5(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.setMetadata(e,n)))}getEntry(e,t){let n=ut.newInvalidDocument(t);return Zs(e).iterate({index:tm,range:IDBKeyRange.only(Qc(t))},(r,s)=>{n=this.maybeDecodeDocument(t,s)}).next(()=>n)}getSizedEntry(e,t){let n={size:0,document:ut.newInvalidDocument(t)};return Zs(e).iterate({index:tm,range:IDBKeyRange.only(Qc(t))},(r,s)=>{n={document:this.maybeDecodeDocument(t,s),size:Cm(s)}}).next(()=>n)}getEntries(e,t){let n=hi();return this.forEachDbEntry(e,t,(r,s)=>{let o=this.maybeDecodeDocument(r,s);n=n.insert(r,o)}).next(()=>n)}getSizedEntries(e,t){let n=hi(),r=new Me(O.comparator);return this.forEachDbEntry(e,t,(s,o)=>{let a=this.maybeDecodeDocument(s,o);n=n.insert(s,a),r=r.insert(s,Cm(o))}).next(()=>({documents:n,sizeMap:r}))}forEachDbEntry(e,t,n){if(t.isEmpty())return v.resolve();let r=new Ce(Z1);t.forEach(l=>r=r.add(l));let s=IDBKeyRange.bound(Qc(r.first()),Qc(r.last())),o=r.getIterator(),a=o.getNext();return Zs(e).iterate({index:tm,range:s},(l,c,d)=>{let u=O.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&Z1(a,u)<0;)n(a,null),a=o.getNext();a&&a.isEqual(u)&&(n(a,c),a=o.hasNext()?o.getNext():null),a?d.skip(Qc(a)):d.done()}).next(()=>{for(;a;)n(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,n,r,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),sp(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Zs(e).loadAll(IDBKeyRange.bound(a,l,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let d=hi();for(let u of c){let h=this.maybeDecodeDocument(O.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);h.isFoundDocument()&&(Ld(t,h)||r.has(h.key))&&(d=d.insert(h.key,h))}return d})}getAllFromCollectionGroup(e,t,n,r){let s=hi(),o=X1(t,n),a=X1(t,Ui.max());return Zs(e).iterate({index:Ik,range:IDBKeyRange.bound(o,a,!0)},(l,c,d)=>{let u=this.maybeDecodeDocument(O.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(u.key,u),s.size===r&&d.done()}).next(()=>s)}newChangeBuffer(e){return new U0(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Y1(e).get(e0).next(t=>(z(!!t),t))}setMetadata(e,t){return Y1(e).put(e0,t)}maybeDecodeDocument(e,t){if(t){let n=L$(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual($.min())))return n}return ut.newInvalidDocument(e)}};function BM(i){return new V0(i)}var U0=class extends xm{constructor(e,t){super(),this.documentCache=e,this.trackRemovals=t,this.documentStates=new $n(n=>n.toString(),(n,r)=>n.isEqual(r))}applyChanges(e){let t=[],n=0,r=new Ce((s,o)=>X(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.documentStates.get(s);if(t.push(this.documentCache.removeEntry(e,s,a.readTime)),o.isValidDocument()){let l=D1(this.documentCache.serializer,o);r=r.add(s.path.popLast());let c=Cm(l);n+=c-a.size,t.push(this.documentCache.addEntry(e,s,l))}else if(n-=a.size,this.trackRemovals){let l=D1(this.documentCache.serializer,o.convertToNoDocument($.min()));t.push(this.documentCache.addEntry(e,s,l))}}),r.forEach(s=>{t.push(this.documentCache.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.documentCache.updateMetadata(e,n)),v.waitFor(t)}getFromCache(e,t){return this.documentCache.getSizedEntry(e,t).next(n=>(this.documentStates.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.documentCache.getSizedEntries(e,t).next(({documents:n,sizeMap:r})=>(r.forEach((s,o)=>{this.documentStates.set(s,{size:o,readTime:n.get(s).readTime})}),n))}};function Y1(i){return Tt(i,Od)}function Zs(i){return Tt(i,Zm)}function Qc(i){let e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function C5(i,e){let t=i.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],sp(e),t[t.length-1]]}function X1(i,e){let t=e.documentKey.path.toArray();return[i,sp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Z1(i,e){let t=i.path.toArray(),n=e.path.toArray(),r=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(r=X(t[s],n[s]),r)return r;return r=X(t.length,n.length),r||(r=X(t[t.length-2],n[n.length-2]),r)?r:X(t[t.length-1],n[n.length-1])}var T5=15;var q0=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Im=class{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&id(n.mutation,r,Si.empty(),je.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Z()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Z()){let r=qn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(s=>{let o=Xc();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let n=qn();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Z()))}populateOverlays(e,t,n){let r=[];return n.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,r){let s=hi(),o=hd(),a=yG();return t.forEach((l,c)=>{let d=n.get(c.key);r.has(c.key)&&(d===void 0||d.mutation instanceof on)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),id(d.mutation,c,d.mutation.getFieldMask(),je.now())):o.set(c.key,Si.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>{var u;return a.set(c,new q0(d,(u=o.get(c))!==null&&u!==void 0?u:null))}),a))}recalculateAndSaveOverlays(e,t){let n=hd(),r=new Me((o,a)=>o-a),s=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let d=n.get(l)||Si.empty();d=a.applyToLocalView(c,d),n.set(l,d);let u=(r.get(a.batchId)||Z()).add(l);r=r.insert(a.batchId,u)})}).next(()=>{let o=[],a=r.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,d=l.value,u=sM();d.forEach(h=>{if(!s.has(h)){let m=fM(t.get(h),n.get(h));m!==null&&u.set(h,m),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,u))}return v.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return oG(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Zw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):v.resolve(qn()),a=Ya,l=s;return o.next(c=>v.forEach(c,(d,u)=>(a<u.largestBatchId&&(a=u.largestBatchId),s.get(d)?v.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{l=l.insert(d,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Z())).next(d=>({batchId:a,changes:rM(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new O(t)).next(n=>{let r=Xc();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){let s=t.collectionGroup,o=Xc();return this.indexManager.getCollectionParents(e,s).next(a=>v.forEach(a,l=>{let c=nG(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,r).next(d=>{d.forEach((u,h)=>{o=o.insert(u,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(o=>{s.forEach((l,c)=>{let d=c.getKey();o.get(d)===null&&(o=o.insert(d,ut.newInvalidDocument(d)))});let a=Xc();return o.forEach((l,c)=>{let d=s.get(l);d!==void 0&&id(d.mutation,c,Si.empty(),je.now()),Ld(t,c)&&(a=a.insert(l,c))}),a})}};var z0=class{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return v.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,H$(t)),v.resolve()}getNamedQuery(e,t){return v.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,$$(t)),v.resolve()}};var j0=class{constructor(){this.overlays=new Me(O.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return v.resolve(this.overlays.get(t))}getOverlays(e,t){let n=qn();return v.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,s)=>{this.saveOverlay(e,t,s)}),v.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.overlayByBatchId.get(n);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.overlayByBatchId.delete(n)),v.resolve()}getOverlaysForCollection(e,t,n){let r=qn(),s=t.length+1,o=new O(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>n&&r.set(c.getKey(),c)}return v.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Me((c,d)=>c-d),o=this.overlays.getIterator();for(;o.hasNext();){let d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let h=s.get(d.largestBatchId);h===null&&(h=qn(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}let a=qn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=r)););return v.resolve(a)}saveOverlay(e,t,n){let r=this.overlays.get(n.key);if(r!==null){let o=this.overlayByBatchId.get(r.largestBatchId).delete(n.key);this.overlayByBatchId.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new pd(t,n));let s=this.overlayByBatchId.get(t);s===void 0&&(s=Z(),this.overlayByBatchId.set(t,s)),this.overlayByBatchId.set(t,s.add(n.key))}};var Sd=class{constructor(){this.refsByKey=new Ce(dt.compareByKey),this.refsByTarget=new Ce(dt.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let n=new dt(e,t);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)}addReferences(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.removeRef(new dt(e,t))}removeReferences(e,t){e.forEach(n=>this.removeReference(n,t))}removeReferencesForId(e){let t=new O(new me([])),n=new dt(t,e),r=new dt(t,e+1),s=[];return this.refsByTarget.forEachInRange([n,r],o=>{this.removeRef(o),s.push(o.key)}),s}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new O(new me([])),n=new dt(t,e),r=new dt(t,e+1),s=Z();return this.refsByTarget.forEachInRange([n,r],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new dt(e,0),n=this.refsByKey.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},dt=class{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return O.comparator(e.key,t.key)||X(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return X(e.targetOrBatchId,t.targetOrBatchId)||O.comparator(e.key,t.key)}};var G0=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new Ce(dt.compareByKey)}checkEmpty(e){return v.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){let s=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new md(s,t,n,r);this.mutationQueue.push(o);for(let a of r)this.batchesByDocumentKey=this.batchesByDocumentKey.add(new dt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return v.resolve(o)}lookupMutationBatch(e,t){return v.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=this.indexOfBatchId(n),s=r<0?0:r;return v.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return v.resolve(this.mutationQueue.length===0?as:this.nextBatchId-1)}getAllMutationBatches(e){return v.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new dt(t,0),r=new dt(t,Number.POSITIVE_INFINITY),s=[];return this.batchesByDocumentKey.forEachInRange([n,r],o=>{let a=this.findMutationBatch(o.targetOrBatchId);s.push(a)}),v.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ce(X);return t.forEach(r=>{let s=new dt(r,0),o=new dt(r,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([s,o],a=>{n=n.add(a.targetOrBatchId)})}),v.resolve(this.findMutationBatches(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,s=n;O.isDocumentKey(s)||(s=s.child(""));let o=new dt(new O(s),0),a=new Ce(X);return this.batchesByDocumentKey.forEachWhile(l=>{let c=l.key.path;return n.isPrefixOf(c)?(c.length===r&&(a=a.add(l.targetOrBatchId)),!0):!1},o),v.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(n=>{let r=this.findMutationBatch(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){let n=this.indexOfExistingBatchId(t.batchId,"removed");z(n===0),this.mutationQueue.shift();let r=this.batchesByDocumentKey;return v.forEach(t.mutations,s=>{let o=new dt(s.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.batchesByDocumentKey=r})}removeCachedMutationKeys(e){}containsKey(e,t){let n=new dt(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return v.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,v.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){if(this.mutationQueue.length===0)return 0;let t=this.mutationQueue[0].batchId;return e-t}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};function x5(){return new Me(O.comparator)}var $0=class{constructor(e){this.sizer=e,this.docs=x5(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),s=r?r.size:0,o=this.sizer(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return v.resolve(n?n.document.mutableCopy():ut.newInvalidDocument(t))}getEntries(e,t){let n=hi();return t.forEach(r=>{let s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():ut.newInvalidDocument(r))}),v.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=hi(),o=t.path,a=new O(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||jw(bk(d),n)<=0||!r.has(d.key)&&!Ld(t,d)||(s=s.insert(d.key,d.mutableCopy()))}return v.resolve(s)}getAllFromCollectionGroup(e,t,n,r){B()}forEachDocumentKey(e,t){return v.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new H0(this)}getSize(e){return v.resolve(this.size)}};function I5(i){return new $0(i)}var H0=class extends xm{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.documentCache.addEntry(e,r)):this.documentCache.removeEntry(n)}),v.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}};var W0=class{constructor(e){this.persistence=e,this.targets=new $n(t=>mo(t),Pd),this.lastRemoteSnapshotVersion=$.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Sd,this.targetCount=0,this.targetIdGenerator=sl.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((n,r)=>t(r)),v.resolve()}getLastRemoteSnapshotVersion(e){return v.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return v.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),v.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),v.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new sl(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,v.resolve()}updateTargetData(e,t){return this.saveTargetData(t),v.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,v.resolve()}removeTargets(e,t,n){let r=0,s=[];return this.targets.forEach((o,a)=>{a.sequenceNumber<=t&&n.get(a.targetId)===null&&(this.targets.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),v.waitFor(s).next(()=>r)}getTargetCount(e){return v.resolve(this.targetCount)}getTargetData(e,t){let n=this.targets.get(t)||null;return v.resolve(n)}addMatchingKeys(e,t,n){return this.references.addReferences(t,n),v.resolve()}removeMatchingKeys(e,t,n){this.references.removeReferences(t,n);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),v.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),v.resolve()}getMatchingKeysForTargetId(e,t){let n=this.references.referencesForId(t);return v.resolve(n)}containsKey(e,t){return v.resolve(this.references.containsKey(t))}};var D5="MemoryPersistence",Dm=class{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new wi(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new W0(this);let n=r=>this.referenceDelegate.documentSize(r);this.indexManager=new M0,this.remoteDocumentCache=I5(n),this.serializer=new bm(t),this.bundleCache=new z0(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new j0,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.mutationQueues[e.toKey()];return n||(n=new G0(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=n),n}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,n){D(D5,"Starting transaction:",e);let r=new K0(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(r).next(s=>this.referenceDelegate.onTransactionCommitted(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}mutationQueuesContainKey(e,t){return v.or(Object.values(this.mutationQueues).map(n=>()=>n.containsKey(e,t)))}},K0=class extends cm{constructor(e){super(),this.currentSequenceNumber=e}},Am=class i{constructor(e){this.persistence=e,this.localViewReferences=new Sd,this._orphanedDocuments=null}static factory(e){return new i(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw B()}addReference(e,t,n){return this.localViewReferences.addReference(n,t),this.orphanedDocuments.delete(n.toString()),v.resolve()}removeReference(e,t,n){return this.localViewReferences.removeReference(n,t),this.orphanedDocuments.add(n.toString()),v.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),v.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(s=>this.orphanedDocuments.add(s.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.orphanedDocuments.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return v.forEach(this.orphanedDocuments,r=>{let s=O.fromPath(r);return this.isReferenced(e,s).next(o=>{o||n.removeEntry(s,$.min())})}).next(()=>(this._orphanedDocuments=null,n.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(n=>{n?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return v.or([()=>v.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}};var Q0=class{constructor(e){this.serializer=e}createOrUpgrade(e,t,n,r){let s=new dm("createOrUpgrade",t);n<1&&r>=1&&(R5(e),k5(e),J1(e),O5(e));let o=v.resolve();return n<3&&r>=3&&(n!==0&&(F5(e),J1(e)),o=o.next(()=>B5(s))),n<4&&r>=4&&(n!==0&&(o=o.next(()=>M5(e,s))),o=o.next(()=>{V5(e)})),n<5&&r>=5&&(o=o.next(()=>this.removeAcknowledgedMutations(s))),n<6&&r>=6&&(o=o.next(()=>(P5(e),this.addDocumentGlobal(s)))),n<7&&r>=7&&(o=o.next(()=>this.ensureSequenceNumbers(s))),n<8&&r>=8&&(o=o.next(()=>this.createCollectionParentIndex(e,s))),n<9&&r>=9&&(o=o.next(()=>{L5(e)})),n<10&&r>=10&&(o=o.next(()=>this.rewriteCanonicalIds(s))),n<11&&r>=11&&(o=o.next(()=>{U5(e),q5(e)})),n<12&&r>=12&&(o=o.next(()=>{j5(e)})),n<13&&r>=13&&(o=o.next(()=>N5(e)).next(()=>this.rewriteRemoteDocumentCache(e,s)).next(()=>e.deleteObjectStore(eo))),n<14&&r>=14&&(o=o.next(()=>this.runOverlayMigration(e,s))),n<15&&r>=15&&(o=o.next(()=>z5(e))),o}addDocumentGlobal(e){let t=0;return e.store(eo).iterate((n,r)=>{t+=Cm(r)}).next(()=>{let n={byteSize:t};return e.store(Od).put(e0,n)})}removeAcknowledgedMutations(e){let t=e.store(Md),n=e.store(nn);return t.loadAll().next(r=>v.forEach(r,s=>{let o=IDBKeyRange.bound([s.userId,as],[s.userId,s.lastAcknowledgedBatchId]);return n.loadAll(ro,o).next(a=>v.forEach(a,l=>{z(l.userId===s.userId);let c=to(this.serializer,l);return NM(e,s.userId,c).next(()=>{})}))}))}ensureSequenceNumbers(e){let t=e.store(gl),n=e.store(eo);return e.store(Eo).get(um).next(s=>{let o=l=>t.put({targetId:0,path:ti(l),sequenceNumber:s.highestListenSequenceNumber}),a=[];return n.iterate((l,c)=>{let d=new me(l),u=A5(d);a.push(t.get(u).next(h=>h?v.resolve():o(d)))}).next(()=>v.waitFor(a))})}createCollectionParentIndex(e,t){e.createObjectStore(od,{keyPath:G4});let n=t.store(od),r=new wd,s=o=>{if(r.add(o)){let a=o.lastSegment(),l=o.popLast();return n.put({collectionId:a,parent:ti(l)})}};return t.store(eo).iterate({keysOnly:!0},(o,a)=>{let l=new me(o);return s(l.popLast())}).next(()=>t.store(ml).iterate({keysOnly:!0},([o,a,l],c)=>{let d=Un(a);return s(d.popLast())}))}rewriteCanonicalIds(e){let t=e.store(pl);return t.iterate((n,r)=>{let s=Zc(r),o=RM(this.serializer,s);return t.put(o)})}rewriteRemoteDocumentCache(e,t){let n=t.store(eo),r=[];return n.iterate((s,o)=>{let a=t.store(Zm),l=G5(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(c))}).next(()=>v.waitFor(r))}runOverlayMigration(e,t){let n=t.store(nn),r=BM(this.serializer),s=new Dm(Am.factory,this.serializer.remoteSerializer);return n.loadAll().next(o=>{let a=new Map;return o.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:Z();to(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),v.forEach(a,(l,c)=>{let d=new ht(c),u=wm.forUser(this.serializer,d),h=s.getIndexManager(d),m=Tm.forUser(d,this.serializer,h,s.referenceDelegate);return new Im(r,m,u,h).recalculateAndSaveOverlaysForDocumentKeys(new ad(t,wi.INVALID),l).next()})})}};function A5(i){return[0,ti(i)]}function R5(i){i.createObjectStore(kd)}function k5(i){i.createObjectStore(Md,{keyPath:N4}),i.createObjectStore(nn,{keyPath:Ck,autoIncrement:!0}).createIndex(ro,Tk,{unique:!0}),i.createObjectStore(ml)}function M5(i,e){return e.store(nn).loadAll().next(n=>{i.deleteObjectStore(nn),i.createObjectStore(nn,{keyPath:Ck,autoIncrement:!0}).createIndex(ro,Tk,{unique:!0});let s=e.store(nn),o=n.map(a=>s.put(a));return v.waitFor(o)})}function O5(i){i.createObjectStore(eo)}function N5(i){let e=i.createObjectStore(Zm,{keyPath:L4});e.createIndex(tm,B4),e.createIndex(Ik,V4)}function P5(i){i.createObjectStore(Od)}function J1(i){i.createObjectStore(gl,{keyPath:z4}).createIndex($w,j4,{unique:!0}),i.createObjectStore(pl,{keyPath:U4}).createIndex(Dk,q4,{unique:!0}),i.createObjectStore(Eo)}function F5(i){i.deleteObjectStore(gl),i.deleteObjectStore(pl),i.deleteObjectStore(Eo)}function L5(i){i.objectStoreNames.contains("remoteDocumentChanges")&&i.deleteObjectStore("remoteDocumentChanges")}function B5(i){let e=i.store(Eo),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:$.min().toTimestamp(),targetCount:0};return e.put(um,t)}function V5(i){i.createObjectStore(Xa,{keyPath:$4})}function U5(i){i.createObjectStore(Jm,{keyPath:H4})}function q5(i){i.createObjectStore(ep,{keyPath:W4})}function z5(i){i.createObjectStore(Hw,{keyPath:K4,autoIncrement:!0}).createIndex(t0,Q4,{unique:!1}),i.createObjectStore(Ww,{keyPath:Y4}).createIndex(Ak,X4,{unique:!1}),i.createObjectStore(Kw,{keyPath:Z4}).createIndex(Rk,J4,{unique:!1})}function j5(i){let e=i.createObjectStore(tp,{keyPath:e6});e.createIndex(i0,t6,{unique:!1}),e.createIndex(kk,i6,{unique:!1})}function G5(i){return i.document?new O(me.fromString(i.document.name).popFirst(5)):i.noDocument?O.fromSegments(i.noDocument.path):i.unknownDocument?O.fromSegments(i.unknownDocument.path):B()}var ns="IndexedDbPersistence",Pb=30*60*1e3,Fb=5e3,$5=4e3,Lb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",H5="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",W5="firestore_zombie",VM="main",Y0=class i{constructor(e,t,n,r,s,o,a,l,c,d,u=T5){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.queue=s,this.window=o,this.document=a,this.sequenceNumberSyncer=c,this.forceOwningTab=d,this.schemaVersion=u,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=h=>Promise.resolve(),!i.isAvailable())throw new E(b.UNIMPLEMENTED,H5);this.referenceDelegate=new B0(this,r),this.dbName=t+VM,this.serializer=new bm(l),this.simpleDb=new cs(this.dbName,this.schemaVersion,new Q0(this.serializer)),this.targetCache=new N0(this.referenceDelegate,this.serializer),this.remoteDocumentCache=BM(this.serializer),this.bundleCache=new I0,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,d===!1&&ze(ns,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new E(b.FAILED_PRECONDITION,Lb);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.targetCache.getHighestSequenceNumber(e))}).then(e=>{this.listenSequence=new wi(e,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(e=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(e)))}setPrimaryStateListener(e){return this.primaryStateListener=t=>p(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.simpleDb.setVersionChangeListener(t=>p(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(()=>p(this,null,function*(){this.started&&(yield this.updateClientMetadataAndTryBecomePrimary())})))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Zf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(e).next(n=>{n||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(e)).next(n=>this.isPrimary&&!n?this.releasePrimaryLeaseIfHeld(e).next(()=>!1):n?this.acquireOrExtendPrimaryLease(e).next(()=>!0):!1)).catch(e=>{if(ws(e))return D(ns,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return D(ns,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.queue.enqueueRetryable(()=>this.primaryStateListener(e)),this.isPrimary=e})}verifyPrimaryLease(e){return Yc(e).get(Na).next(n=>v.resolve(this.isLocalClient(n)))}removeClientMetadata(e){return Zf(e).delete(this.clientId)}maybeGarbageCollectMultiClientState(){return p(this,null,function*(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,Pb)){this.lastGarbageCollectionTime=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let n=Tt(t,Xa);return n.loadAll().next(r=>{let s=this.filterActiveClients(r,Pb),o=r.filter(a=>s.indexOf(a)===-1);return v.forEach(o,a=>n.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.webStorage)for(let t of e)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(t.clientId))}})}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",$5,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(e){return e?e.ownerId===this.clientId:!1}canActAsPrimary(e){return this.forceOwningTab?v.resolve(!0):Yc(e).get(Na).next(n=>{if(n!==null&&this.isWithinAge(n.leaseTimestampMs,Fb)&&!this.isClientZombied(n.ownerId)){if(this.isLocalClient(n)&&this.networkEnabled)return!0;if(!this.isLocalClient(n)){if(!n.allowTabSynchronization)throw new E(b.FAILED_PRECONDITION,Lb);return!1}}return this.networkEnabled&&this.inForeground?!0:Zf(e).loadAll().next(s=>this.filterActiveClients(s,Fb).find(a=>{if(this.clientId!==a.clientId){let l=!this.networkEnabled&&a.networkEnabled,c=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(l||c&&d)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&D(ns,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return p(this,null,function*(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),yield this.simpleDb.runTransaction("shutdown","readwrite",[kd,Xa],e=>{let t=new ad(e,wi.INVALID);return this.releasePrimaryLeaseIfHeld(t).next(()=>this.removeClientMetadata(t))}),this.simpleDb.close(),this.removeClientZombiedEntry()})}filterActiveClients(e,t){return e.filter(n=>this.isWithinAge(n.updateTimeMs,t)&&!this.isClientZombied(n.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",e=>Zf(e).loadAll().next(t=>this.filterActiveClients(t,Pb).map(n=>n.clientId)))}get started(){return this._started}getMutationQueue(e,t){return Tm.forUser(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new O0(e,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(e){return wm.forUser(this.serializer,e)}getBundleCache(){return this.bundleCache}runTransaction(e,t,n){D(ns,"Starting transaction:",e);let r=t==="readonly"?"readonly":"readwrite",s=d6(this.schemaVersion),o;return this.simpleDb.runTransaction(e,r,s,a=>(o=new ad(a,this.listenSequence?this.listenSequence.next():wi.INVALID),t==="readwrite-primary"?this.verifyPrimaryLease(o).next(l=>l?!0:this.canActAsPrimary(o)).next(l=>{if(!l)throw ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new E(b.FAILED_PRECONDITION,wk);return n(o)}).next(l=>this.acquireOrExtendPrimaryLease(o).next(()=>l)):this.verifyAllowTabSynchronization(o).next(()=>n(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}verifyAllowTabSynchronization(e){return Yc(e).get(Na).next(n=>{if(n!==null&&this.isWithinAge(n.leaseTimestampMs,Fb)&&!this.isClientZombied(n.ownerId)&&!this.isLocalClient(n)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!n.allowTabSynchronization))throw new E(b.FAILED_PRECONDITION,Lb)})}acquireOrExtendPrimaryLease(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Yc(e).put(Na,t)}static isAvailable(){return cs.isAvailable()}releasePrimaryLeaseIfHeld(e){let t=Yc(e);return t.get(Na).next(n=>this.isLocalClient(n)?(D(ns,"Releasing primary lease."),t.delete(Na)):v.resolve())}isWithinAge(e,t){let n=Date.now(),r=n-t,s=n;return e<r?!1:e>s?(ze(`Detected an update time that is in the future: ${e} > ${s}`),!1):!0}attachVisibilityHandler(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground=this.document.visibilityState==="visible")}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.windowUnloadHandler=()=>{this.markClientZombied();let t=/(?:Version|Mobile)\/1[456]/;CC()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(e){var t;try{let n=((t=this.webStorage)===null||t===void 0?void 0:t.getItem(this.zombiedClientLocalStorageKey(e)))!==null;return D(ns,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return ze(ns,"Failed to get zombied client id.",n),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){ze("Failed to set zombie client id.",e)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch{}}zombiedClientLocalStorageKey(e){return`${W5}_${this.persistenceKey}_${e}`}};function Yc(i){return Tt(i,kd)}function Zf(i){return Tt(i,Xa)}function oS(i,e){let t=i.projectId;return i.isDefaultDatabase||(t+="."+i.database),"firestore/"+e+"/"+t+"/"}function K5(i){return p(this,null,function*(){if(!cs.isAvailable())return Promise.resolve();let e=i+VM;yield cs.delete(e)})}var aS="LocalStore",Q5=5*60*1e6,Ed=class{constructor(e,t,n,r){this.persistence=e,this.queryEngine=t,this.serializer=r,this.targetDataByTarget=new Me(X),this.targetIdByTarget=new $n(s=>mo(s),Pd),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(n)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Im(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}};function UM(i,e,t,n){return new Ed(i,e,t,n)}function qM(i,e){return p(this,null,function*(){let t=F(i);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,t.initializeUserComponents(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],l=[],c=Z();for(let d of s){a.push(d.batchId);for(let u of d.mutations)c=c.add(u.key)}for(let d of o){l.push(d.batchId);for(let u of d.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(r,c).next(d=>({affectedDocuments:d,removedBatchIds:a,addedBatchIds:l}))})})})}function Y5(i,e){let t=F(i),n=je.now(),r=e.reduce((a,l)=>a.add(l.key),Z()),s,o;return t.persistence.runTransaction("Locally write mutations","readwrite",a=>{let l=hi(),c=Z();return t.remoteDocuments.getEntries(a,r).next(d=>{l=d,l.forEach((u,h)=>{h.isValidDocument()||(c=c.add(u))})}).next(()=>t.localDocuments.getOverlayedDocuments(a,l)).next(d=>{s=d;let u=[];for(let h of e){let m=AG(h,s.get(h.key).overlayedDocument);m!=null&&u.push(new on(h.key,m,Gk(m.value.mapValue),Qe.exists(!0)))}return t.mutationQueue.addMutationBatch(a,n,u,e)}).next(d=>{o=d;let u=d.applyToLocalDocumentSet(s,c);return t.documentOverlayCache.saveOverlays(a,d.batchId,u)})}).then(()=>({batchId:o.batchId,changes:rM(s)}))}function X5(i,e){let t=F(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let r=e.batch.keys(),s=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return a9(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,Z5(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function Z5(i){let e=Z();for(let t=0;t<i.mutationResults.length;++t)i.mutationResults[t].transformResults.length>0&&(e=e.add(i.batch.mutations[t].key));return e}function J5(i,e){let t=F(i);return t.persistence.runTransaction("Reject batch","readwrite-primary",n=>{let r;return t.mutationQueue.lookupMutationBatch(n,e).next(s=>(z(s!==null),r=s.keys(),t.mutationQueue.removeMutationBatch(n,s))).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,r)).next(()=>t.localDocuments.getDocuments(n,r))})}function e9(i){let e=F(i);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",t=>e.mutationQueue.getHighestUnacknowledgedBatchId(t))}function zM(i){let e=F(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.targetCache.getLastRemoteSnapshotVersion(t))}function t9(i,e){let t=F(i),n=e.snapshotVersion,r=t.targetDataByTarget;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});r=t.targetDataByTarget;let a=[];e.targetChanges.forEach((d,u)=>{let h=r.get(u);if(!h)return;a.push(t.targetCache.removeMatchingKeys(s,d.removedDocuments,u).next(()=>t.targetCache.addMatchingKeys(s,d.addedDocuments,u)));let m=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(u)!==null?m=m.withResumeToken(Ct.EMPTY_BYTE_STRING,$.min()).withLastLimboFreeSnapshotVersion($.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,n)),r=r.insert(u,m),i9(h,m,d)&&a.push(t.targetCache.updateTargetData(s,m))});let l=hi(),c=Z();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(jM(s,o,e.documentUpdates).next(d=>{l=d.changedDocuments,c=d.existenceChangedKeys})),!n.isEqual($.min())){let d=t.targetCache.getLastRemoteSnapshotVersion(s).next(u=>t.targetCache.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(d)}return v.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(t.targetDataByTarget=r,s))}function jM(i,e,t){let n=Z(),r=Z();return t.forEach(s=>n=n.add(s)),e.getEntries(i,n).next(s=>{let o=hi();return t.forEach((a,l)=>{let c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual($.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):D(aS,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{changedDocuments:o,existenceChangedKeys:r}})}function i9(i,e,t){return i.resumeToken.approximateByteSize()===0||e.snapshotVersion.toMicroseconds()-i.snapshotVersion.toMicroseconds()>=Q5?!0:t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size>0}function n9(i,e){return p(this,null,function*(){let t=F(i);try{yield t.persistence.runTransaction("notifyLocalViewChanges","readwrite",n=>v.forEach(e,r=>v.forEach(r.addedKeys,s=>t.persistence.referenceDelegate.addReference(n,r.targetId,s)).next(()=>v.forEach(r.removedKeys,s=>t.persistence.referenceDelegate.removeReference(n,r.targetId,s)))))}catch(n){if(ws(n))D(aS,"Failed to update sequence numbers: "+n);else throw n}for(let n of e){let r=n.targetId;if(!n.fromCache){let s=t.targetDataByTarget.get(r),o=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(o);t.targetDataByTarget=t.targetDataByTarget.insert(r,a)}}})}function r9(i,e){let t=F(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=as),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function s9(i,e){let t=F(i);return t.persistence.runTransaction("read document","readonly",n=>t.localDocuments.getDocument(n,e))}function ol(i,e){let t=F(i);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.targetCache.getTargetData(n,e).next(s=>s?(r=s,v.resolve(r)):t.targetCache.allocateTargetId(n).next(o=>(r=new rl(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.targetCache.addTargetData(n,r).next(()=>r))))}).then(n=>{let r=t.targetDataByTarget.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.targetDataByTarget=t.targetDataByTarget.insert(n.targetId,n),t.targetIdByTarget.set(e,n.targetId)),n})}function o9(i,e,t){let n=F(i),r=n.targetIdByTarget.get(t);return r!==void 0?v.resolve(n.targetDataByTarget.get(r)):n.targetCache.getTargetData(e,t)}function al(i,e,t){return p(this,null,function*(){let n=F(i),r=n.targetDataByTarget.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(ws(o))D(aS,`Failed to update sequence numbers for target ${e}: ${o}`);else throw o}n.targetDataByTarget=n.targetDataByTarget.remove(e),n.targetIdByTarget.delete(r.target)})}function op(i,e,t){let n=F(i),r=$.min(),s=Z();return n.persistence.runTransaction("Execute query","readwrite",o=>o9(n,o,ii(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>n.queryEngine.getDocumentsMatchingQuery(o,e,t?r:$.min(),t?s:Z())).next(a=>(HM(n,tM(e),a),{documents:a,remoteKeys:s})))}function a9(i,e,t,n){let r=t.batch,s=r.keys(),o=v.resolve();return s.forEach(a=>{o=o.next(()=>n.getEntry(e,a)).next(l=>{let c=t.docVersions.get(a);z(c!==null),l.version.compareTo(c)<0&&(r.applyToRemoteDocument(l,t),l.isValidDocument()&&(l.setReadTime(t.commitVersion),n.addEntry(l)))})}),o.next(()=>i.mutationQueue.removeMutationBatch(e,r))}function l9(i,e){let t=F(i),n=F(t.mutationQueue);return t.persistence.runTransaction("Lookup mutation documents","readonly",r=>n.lookupMutationKeys(r,e).next(s=>s?t.localDocuments.getDocuments(r,s):v.resolve(null)))}function c9(i,e){F(F(i,Ed).mutationQueue).removeCachedMutationKeys(e)}function d9(i){return F(F(i,Ed).persistence).getActiveClients()}function GM(i,e){let t=F(i),n=F(t.targetCache),r=t.targetDataByTarget.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>n.getTargetDataForTarget(s,e).next(o=>o?o.target:null))}function $M(i,e){let t=F(i),n=t.collectionGroupReadTime.get(e)||$.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.remoteDocuments.getAllFromCollectionGroup(r,e,_k(n,Ya),Number.MAX_SAFE_INTEGER)).then(r=>(HM(t,e,r),r))}function HM(i,e,t){let n=i.collectionGroupReadTime.get(e)||$.min();t.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),i.collectionGroupReadTime.set(e,n)}function u9(i){return ii(yl(me.fromString(`__bundle__/docs/${i}`)))}function h9(i,e,t,n){return p(this,null,function*(){let r=F(i),s=Z(),o=hi();for(let c of t){let d=e.toDocumentKey(c.metadata.name);c.document&&(s=s.add(d));let u=e.toMutableDocument(c);u.setReadTime(e.toSnapshotVersion(c.metadata.readTime)),o=o.insert(d,u)}let a=r.remoteDocuments.newChangeBuffer({trackRemovals:!0}),l=yield ol(r,u9(n));return r.persistence.runTransaction("Apply bundle documents","readwrite",c=>jM(c,a,o).next(d=>(a.apply(c),d)).next(d=>r.targetCache.removeMatchingKeysForTargetId(c,l.targetId).next(()=>r.targetCache.addMatchingKeys(c,s,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(c,d.changedDocuments,d.existenceChangedKeys)).next(()=>d.changedDocuments)))})}function f9(i,e){let t=F(i),n=it(e.createTime);return t.persistence.runTransaction("hasNewerBundle","readonly",r=>t.bundleCache.getBundleMetadata(r,e.id)).then(r=>!!r&&r.createTime.compareTo(n)>=0)}function m9(i,e){let t=F(i);return t.persistence.runTransaction("Save bundle","readwrite",n=>t.bundleCache.saveBundleMetadata(n,e))}function p9(i,e){let t=F(i);return t.persistence.runTransaction("Get named query","readonly",n=>t.bundleCache.getNamedQuery(n,e))}function g9(n,r){return p(this,arguments,function*(i,e,t=Z()){let s=yield ol(i,ii(iS(e.bundledQuery))),o=F(i);return o.persistence.runTransaction("Save named query","readwrite",a=>{let l=it(e.readTime);if(s.snapshotVersion.compareTo(l)>=0)return o.bundleCache.saveNamedQuery(a,e);let c=s.withResumeToken(Ct.EMPTY_BYTE_STRING,l);return o.targetDataByTarget=o.targetDataByTarget.insert(c.targetId,c),o.targetCache.updateTargetData(a,c).next(()=>o.targetCache.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.targetCache.addMatchingKeys(a,t,s.targetId)).next(()=>o.bundleCache.saveNamedQuery(a,e))})})}var X0=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var y9=100,v9=8,Rm=class{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=y9,this.relativeIndexReadCostPerDocument=v9}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,n,r){let s={result:null};return this.performQueryUsingIndex(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.performQueryUsingRemoteKeys(e,t,r,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new X0;return this.executeFullCollectionScan(e,t,o).next(a=>{if(s.result=a,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,o,a.size)})}).next(()=>s.result)}createCacheIndexes(e,t,n,r){return n.documentReadCount<this.indexAutoCreationMinCollectionSize?(qa()<=vn.DEBUG&&D("QueryEngine","SDK will not create cache indexes for query:",za(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),v.resolve()):(qa()<=vn.DEBUG&&D("QueryEngine","Query:",za(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.relativeIndexReadCostPerDocument*r?(qa()<=vn.DEBUG&&D("QueryEngine","The SDK decides to create cache indexes for query:",za(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ii(t))):v.resolve())}performQueryUsingIndex(e,t){if(b1(t))return v.resolve(null);let n=ii(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=gm(t,null,"F"),n=ii(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let o=Z(...s);return this.localDocumentsView.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(l=>{let c=this.applyQuery(t,a);return this.needsRefill(t,c,o,l.readTime)?this.performQueryUsingIndex(e,gm(t,null,"F")):this.appendRemainingResults(e,c,t,l)}))})))}performQueryUsingRemoteKeys(e,t,n,r){return b1(t)||r.isEqual($.min())?v.resolve(null):this.localDocumentsView.getDocuments(e,n).next(s=>{let o=this.applyQuery(t,s);return this.needsRefill(t,o,n,r)?v.resolve(null):(qa()<=vn.DEBUG&&D("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),za(t)),this.appendRemainingResults(e,o,t,_k(r,Ya)).next(a=>a))})}applyQuery(e,t){let n=new Ce(iM(e));return t.forEach((r,s)=>{Ld(e,s)&&(n=n.add(s))}),n}needsRefill(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return s?s.hasPendingWrites||s.version.compareTo(r)>0:!1}executeFullCollectionScan(e,t,n){return qa()<=vn.DEBUG&&D("QueryEngine","Using full collection scan to execute query:",za(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,Ui.min(),n)}appendRemainingResults(e,t,n,r){return this.localDocumentsView.getDocumentsMatchingQuery(e,n,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var WM="firestore_clients";function ek(i,e){return`${WM}_${i}_${e}`}var KM="firestore_mutations";function tk(i,e,t){let n=`${KM}_${i}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}var QM="firestore_targets";function Bb(i,e){return`${QM}_${i}_${e}`}var _9="firestore_online_state";function b9(i){return`${_9}_${i}`}var w9="firestore_bundle_loaded_v2";function S9(i){return`${w9}_${i}`}var E9="firestore_sequence_number";function C9(i){return`${E9}_${i}`}var Vn="SharedClientState",km=class i{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static fromWebStorageEntry(e,t,n){let r=JSON.parse(n),s=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object"),o;return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(o=new E(r.error.code,r.error.message))),s?new i(e,t,r.state,o):(ze(Vn,`Failed to parse mutation state for ID '${t}': ${n}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},nd=class i{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static fromWebStorageEntry(e,t){let n=JSON.parse(t),r=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object"),s;return r&&n.error&&(r=typeof n.error.message=="string"&&typeof n.error.code=="string",r&&(s=new E(n.error.code,n.error.message))),r?new i(e,n.state,s):(ze(Vn,`Failed to parse target state for ID '${e}': ${t}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Mm=class i{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static fromWebStorageEntry(e,t){let n=JSON.parse(t),r=typeof n=="object"&&n.activeTargetIds instanceof Array,s=eS();for(let o=0;r&&o<n.activeTargetIds.length;++o)r=qk(n.activeTargetIds[o]),s=s.add(n.activeTargetIds[o]);return r?new i(e,s):(ze(Vn,`Failed to parse client data for instance '${e}': ${t}`),null)}},Z0=class i{constructor(e,t){this.clientId=e,this.onlineState=t}static fromWebStorageEntry(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new i(t.clientId,t.onlineState):(ze(Vn,`Failed to parse online state: ${e}`),null)}},Cd=class{constructor(){this.activeTargetIds=eS()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},rd=class{constructor(e,t,n,r,s){this.window=e,this.queue=t,this.persistenceKey=n,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new Me(X),this.started=!1,this.earlyEvents=[];let o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.localClientStorageKey=ek(this.persistenceKey,this.localClientId),this.sequenceNumberKey=C9(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new Cd),this.clientStateKeyRe=new RegExp(`^${WM}_${o}_([^_]*)$`),this.mutationBatchKeyRe=new RegExp(`^${KM}_${o}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=new RegExp(`^${QM}_${o}_(\\d+)$`),this.onlineStateKey=b9(this.persistenceKey),this.bundleLoadedKey=S9(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(e){return!!(e&&e.localStorage)}start(){return p(this,null,function*(){let e=yield this.syncEngine.getActiveClients();for(let n of e){if(n===this.localClientId)continue;let r=this.getItem(ek(this.persistenceKey,n));if(r){let s=Mm.fromWebStorageEntry(n,r);s&&(this.activeClients=this.activeClients.insert(s.clientId,s))}}this.persistClientState();let t=this.storage.getItem(this.onlineStateKey);if(t){let n=this.fromWebStorageOnlineState(t);n&&this.handleOnlineStateEvent(n)}for(let n of this.earlyEvents)this.handleWebStorageEvent(n);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(e){let t=!1;return this.activeClients.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.persistMutationState(e,"pending")}updateMutationState(e,t,n){this.persistMutationState(e,t,n),this.removeMutationState(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let n=this.storage.getItem(Bb(this.persistenceKey,e));if(n){let r=nd.fromWebStorageEntry(e,n);r&&(t=r.state)}}return this.localClientState.addQueryTarget(e),this.persistClientState(),t}removeLocalQueryTarget(e){this.localClientState.removeQueryTarget(e),this.persistClientState()}isLocalQueryTarget(e){return this.localClientState.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Bb(this.persistenceKey,e))}updateQueryState(e,t,n){this.persistQueryTargetState(e,t,n)}handleUserChange(e,t,n){t.forEach(r=>{this.removeMutationState(r)}),this.currentUser=e,n.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.persistOnlineState(e)}notifyBundleLoaded(e){this.persistBundleLoadedState(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return D(Vn,"READ",e,t),t}setItem(e,t){D(Vn,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){D(Vn,"REMOVE",e),this.storage.removeItem(e)}handleWebStorageEvent(e){let t=e;if(t.storageArea===this.storage){if(D(Vn,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey){ze("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(()=>p(this,null,function*(){if(!this.started){this.earlyEvents.push(t);return}if(t.key!==null){if(this.clientStateKeyRe.test(t.key))if(t.newValue!=null){let n=this.fromWebStorageClientState(t.key,t.newValue);if(n)return this.handleClientStateEvent(n.clientId,n)}else{let n=this.fromWebStorageClientStateKey(t.key);return this.handleClientStateEvent(n,null)}else if(this.mutationBatchKeyRe.test(t.key)){if(t.newValue!==null){let n=this.fromWebStorageMutationMetadata(t.key,t.newValue);if(n)return this.handleMutationBatchEvent(n)}}else if(this.queryTargetKeyRe.test(t.key)){if(t.newValue!==null){let n=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue);if(n)return this.handleQueryTargetEvent(n)}}else if(t.key===this.onlineStateKey){if(t.newValue!==null){let n=this.fromWebStorageOnlineState(t.newValue);if(n)return this.handleOnlineStateEvent(n)}}else if(t.key===this.sequenceNumberKey){let n=T9(t.newValue);n!==wi.INVALID&&this.sequenceNumberHandler(n)}else if(t.key===this.bundleLoadedKey){let n=this.fromWebStoreBundleLoadedState(t.newValue);yield Promise.all(n.map(r=>this.syncEngine.synchronizeWithChangedDocuments(r)))}}}))}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(e,t,n){let r=new km(this.currentUser,e,t,n),s=tk(this.persistenceKey,this.currentUser,e);this.setItem(s,r.toWebStorageJSON())}removeMutationState(e){let t=tk(this.persistenceKey,this.currentUser,e);this.removeItem(t)}persistOnlineState(e){let t={clientId:this.localClientId,onlineState:e};this.storage.setItem(this.onlineStateKey,JSON.stringify(t))}persistQueryTargetState(e,t,n){let r=Bb(this.persistenceKey,e),s=new nd(e,t,n);this.setItem(r,s.toWebStorageJSON())}persistBundleLoadedState(e){let t=JSON.stringify(Array.from(e));this.setItem(this.bundleLoadedKey,t)}fromWebStorageClientStateKey(e){let t=this.clientStateKeyRe.exec(e);return t?t[1]:null}fromWebStorageClientState(e,t){let n=this.fromWebStorageClientStateKey(e);return Mm.fromWebStorageEntry(n,t)}fromWebStorageMutationMetadata(e,t){let n=this.mutationBatchKeyRe.exec(e),r=Number(n[1]),s=n[2]!==void 0?n[2]:null;return km.fromWebStorageEntry(new ht(s),r,t)}fromWebStorageQueryTargetMetadata(e,t){let n=this.queryTargetKeyRe.exec(e),r=Number(n[1]);return nd.fromWebStorageEntry(r,t)}fromWebStorageOnlineState(e){return Z0.fromWebStorageEntry(e)}fromWebStoreBundleLoadedState(e){return JSON.parse(e)}handleMutationBatchEvent(e){return p(this,null,function*(){if(e.user.uid!==this.currentUser.uid){D(Vn,`Ignoring mutation for non-active user ${e.user.uid}`);return}return this.syncEngine.applyBatchState(e.batchId,e.state,e.error)})}handleQueryTargetEvent(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)}handleClientStateEvent(e,t){let n=t?this.activeClients.insert(e,t):this.activeClients.remove(e),r=this.extractActiveQueryTargets(this.activeClients),s=this.extractActiveQueryTargets(n),o=[],a=[];return s.forEach(l=>{r.has(l)||o.push(l)}),r.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.applyActiveTargetsChange(o,a).then(()=>{this.activeClients=n})}handleOnlineStateEvent(e){this.activeClients.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}extractActiveQueryTargets(e){let t=eS();return e.forEach((n,r)=>{t=t.unionWith(r.activeTargetIds)}),t}};function T9(i){let e=wi.INVALID;if(i!=null)try{let t=JSON.parse(i);z(typeof t=="number"),e=t}catch(t){ze(Vn,"Failed to read sequence number from WebStorage",t)}return e}var Om=class{constructor(){this.localState=new Cd,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,n){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new Cd,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var J0=class{addCallback(e){}shutdown(){}};var ew=class{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}};var Jf=null;function x9(){return 268435456+Math.round(2147483648*Math.random())}function Vb(){return Jf===null?Jf=x9():Jf++,"0x"+Jf.toString(16)}function I9(i){return new Promise((e,t)=>{i((n,r)=>{n?t(n):e(r)})})}var D9="1.9.1",ei="GrpcConnection",A9=`gl-node/${process.versions.node} fire/${fl} grpc/${D9}`;function Ub(i,e,t,n){z(e===null||e.type==="OAuth");let r=new ao.Metadata;return e&&e.headers.forEach((s,o)=>r.set(o,s)),t&&t.headers.forEach((s,o)=>r.set(o,s)),n&&r.set("X-Firebase-GMPID",n),r.set("X-Goog-Api-Client",A9),r.set("Google-Cloud-Resource-Prefix",i),r.set("x-goog-request-params",i),r}var tw=class{constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}get shouldResourcePathBeIncludedInRequest(){return!0}ensureActiveStub(){if(!this.cachedStub){D(ei,"Creating Firestore stub.");let e=this.databaseInfo.ssl?ao.credentials.createSsl():ao.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,n,r,s){let o=Vb(),a=this.ensureActiveStub(),l=Ub(this.databasePath,r,s,this.databaseInfo.appId),c=Object.assign({database:this.databasePath},n);return I9(d=>(D(ei,`RPC '${e}' ${o} invoked with request:`,n),a[e](c,l,(u,h)=>{u?(D(ei,`RPC '${e}' ${o} failed with error:`,u),d(new E(rm(u.code),u.message))):(D(ei,`RPC '${e}' ${o} completed with response:`,h),d(void 0,h))})))}invokeStreamingRPC(e,t,n,r,s,o){let a=Vb(),l=[],c=new tt;D(ei,`RPC '${e}' ${a} invoked (streaming) with request:`,n);let d=this.ensureActiveStub(),u=Ub(this.databasePath,r,s,this.databaseInfo.appId),h=Object.assign(Object.assign({},n),{database:this.databasePath}),m=d[e](h,u),g=!1;return m.on("data",_=>{D(ei,`RPC ${e} ${a} received result:`,_),l.push(_),o!==void 0&&l.length===o&&(g=!0,c.resolve(l))}),m.on("end",()=>{D(ei,`RPC '${e}' ${a} completed.`),g||(g=!0,c.resolve(l))}),m.on("error",_=>{D(ei,`RPC '${e}' ${a} failed with error:`,_);let y=rm(_.code);c.reject(new E(y,_.message))}),c.promise}openStream(e,t,n){let r=Vb(),s=this.ensureActiveStub(),o=Ub(this.databasePath,t,n,this.databaseInfo.appId),a=s[e](o),l=!1,c=u=>{l||(l=!0,d.callOnClose(u),a.end())},d=new ew({sendFn:u=>{if(l)D(ei,`RPC '${e}' stream ${r} not sending because gRPC stream is closed:`,u);else{D(ei,`RPC '${e}' stream ${r} sending:`,u);try{a.write(u)}catch(h){throw ze("Failure sending:",u),ze("Error:",h),h}}},closeFn:()=>{D(ei,`RPC '${e}' stream ${r} closed locally via close().`),c()}});return a.on("data",u=>{l||(D(ei,`RPC '${e}' stream ${r} received:`,u),d.callOnMessage(u))}),a.on("end",()=>{D(ei,`RPC '${e}' stream ${r} ended.`),c()}),a.on("error",u=>{if(!l){Vi(ei,`RPC '${e}' stream ${r} error. Code:`,u.code,"Message:",u.message);let h=rm(u.code);c(new E(h,u.message))}}),D(ei,`Opening RPC '${e}' stream ${r} to ${this.databaseInfo.host}`),setTimeout(()=>{d.callOnOpen()},0),d}},YM={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}},R9={nested:YM},k9=Object.freeze({__proto__:null,nested:YM,default:R9});var M9={longs:String,enums:String,defaults:!0,oneofs:!1};function O9(){let i=gk.fromJSON(k9,M9);return ao.loadPackageDefinition(i)}function N9(i){let e=O9();return new tw(e,i)}function P9(){return new J0}function XM(){return process.env.USE_MOCK_PERSISTENCE==="YES"?window:null}function F9(){return null}function Vd(i){return new E0(i,!1)}var L9="ExponentialBackoff",B9=1e3,V9=1.5,U9=60*1e3,Td=class{constructor(e,t,n=B9,r=V9,s=U9){this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),n=Math.max(0,Date.now()-this.lastAttemptTime),r=Math.max(0,t-n);r>0&&D(L9,`Backing off for ${r} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,r,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var ik="PersistentStream",q9=60*1e3,z9=10*1e3,Nm=class{constructor(e,t,n,r,s,o,a,l){this.queue=e,this.idleTimerId=n,this.healthTimerId=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.backoff=new Td(e,t)}isStarted(){return this.state===1||this.state===5||this.isOpen()}isOpen(){return this.state===2||this.state===3}start(){if(this.state===4){this.performBackoff();return}this.auth()}stop(){return p(this,null,function*(){this.isStarted()&&(yield this.close(0))})}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&this.idleTimer===null&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,q9,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}handleIdleCloseTimer(){return p(this,null,function*(){if(this.isOpen())return this.close(0)})}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}close(e,t){return p(this,null,function*(){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,e!==4?this.backoff.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(ze(t.toString()),ze("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===b.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.onClose(t)})}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.closeCount===t&&this.startStream(n,r)},n=>{e(()=>{let r=new E(b.UNKNOWN,"Fetching auth token failed: "+n.message);return this.handleStreamClose(r)})})}startStream(e,t){let n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onOpen(()=>{n(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,z9,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(r=>{n(()=>this.handleStreamClose(r))}),this.stream.onMessage(r=>{n(()=>this.onMessage(r))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(()=>p(this,null,function*(){this.state=0,this.start()}))}handleStreamClose(e){return D(ik,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(D(ik,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},iw=class extends Nm{constructor(e,t,n,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onMessage(e){this.backoff.reset();let t=e$(this.serializer,e),n=i$(e);return this.listener.onWatchChange(t,n)}watch(e){let t={};t.database=_d(this.serializer),t.addTarget=f$(this.serializer,e);let n=u$(this.serializer,e);n&&(t.labels=n),this.sendRequest(t)}unwatch(e){let t={};t.database=_d(this.serializer),t.removeTarget=e,this.sendRequest(t)}},nw=class extends Nm{constructor(e,t,n,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s,this.handshakeComplete_=!1}get handshakeComplete(){return this.handshakeComplete_}start(){this.handshakeComplete_=!1,this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete_&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onMessage(e){if(z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();let t=o$(e.writeResults,e.commitTime),n=it(e.commitTime);return this.listener.onMutationResult(n,t)}else return z(!e.writeResults||e.writeResults.length===0),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()}writeHandshake(){let e={};e.database=_d(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(n=>bd(this.serializer,n))};this.sendRequest(t)}};var rw=class{},sw=class extends rw{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new E(b.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,n){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.invokeRPC(e,t,n,r,s)).catch(r=>{throw r.name==="FirebaseError"?(r.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new E(b.UNKNOWN,r.toString())})}invokeStreamingRPC(e,t,n,r){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.invokeStreamingRPC(e,t,n,s,o,r)).catch(s=>{throw s.name==="FirebaseError"?(s.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new E(b.UNKNOWN,s.toString())})}terminate(){this.terminated=!0}};function j9(i,e,t,n){return new sw(i,e,t,n)}function G9(i,e){return p(this,null,function*(){let t=F(i),n=_d(t.serializer)+"/documents",r={writes:e.map(s=>bd(t.serializer,s))};yield t.invokeRPC("Commit",n,r)})}function $9(i,e){return p(this,null,function*(){let t=F(i),n=_d(t.serializer)+"/documents",r={documents:e.map(l=>vd(t.serializer,l))},s=yield t.invokeStreamingRPC("BatchGetDocuments",n,r,e.length),o=new Map;s.forEach(l=>{let c=JG(t.serializer,l);o.set(c.key.toString(),c)});let a=[];return e.forEach(l=>{let c=o.get(l.toString());z(!!c),a.push(c)}),a})}function H9(i,e,t){let n=F(i);return n.verifyInitialized(),new nw(e,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,t)}function W9(i,e,t){let n=F(i);return n.verifyInitialized(),new iw(e,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,t)}var K9="OnlineStateTracker",nk=1,rk=10*1e3,ow=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){this.watchStreamFailures===0&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",rk,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${rk/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){this.state==="Online"?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=nk&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${nk} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e==="Online"&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(ze(t),this.shouldWarnClientIsOffline=!1):D(K9,t)}clearOnlineStateTimer(){this.onlineStateTimer!==null&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}};var vo="RemoteStore",Q9=10,aw=class{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=s,this.connectivityMonitor.addCallback(o=>{n.enqueueAndForget(()=>p(this,null,function*(){Ss(this)&&(D(vo,"Restarting streams for network reachability change."),yield hH(this))}))}),this.onlineStateTracker=new ow(n,r)}};function Y9(i,e,t,n,r){return new aw(i,e,t,n,r)}function X9(i){let e=F(i);return e.offlineCauses.delete(0),Ud(e)}function Ud(i){return p(this,null,function*(){if(Ss(i))for(let e of i.onNetworkStatusChange)yield e(!0)})}function Z9(i){return p(this,null,function*(){let e=F(i);e.offlineCauses.add(0),yield vl(e),e.onlineStateTracker.set("Offline")})}function vl(i){return p(this,null,function*(){for(let e of i.onNetworkStatusChange)yield e(!1)})}function J9(i){return p(this,null,function*(){let e=F(i);D(vo,"RemoteStore shutting down."),e.offlineCauses.add(5),yield vl(e),e.connectivityMonitor.shutdown(),e.onlineStateTracker.set("Unknown")})}function ap(i,e){let t=F(i);t.listenTargets.has(e.targetId)||(t.listenTargets.set(e.targetId,e),dS(t)?cS(t):bl(t).isOpen()&&lS(t,e))}function qd(i,e){let t=F(i),n=bl(t);t.listenTargets.delete(e),n.isOpen()&&ZM(t,e),t.listenTargets.size===0&&(n.isOpen()?n.markIdle():Ss(t)&&t.onlineStateTracker.set("Unknown"))}function lS(i,e){if(i.watchChangeAggregator.recordPendingTargetRequest(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($.min())>0){let t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}bl(i).watch(e)}function ZM(i,e){i.watchChangeAggregator.recordPendingTargetRequest(e),bl(i).unwatch(e)}function cS(i){i.watchChangeAggregator=new S0({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),getTargetDataForTarget:e=>i.listenTargets.get(e)||null,getDatabaseId:()=>i.datastore.serializer.databaseId}),bl(i).start(),i.onlineStateTracker.handleWatchStreamStart()}function dS(i){return Ss(i)&&!bl(i).isStarted()&&i.listenTargets.size>0}function Ss(i){return F(i).offlineCauses.size===0}function JM(i){i.watchChangeAggregator=void 0}function eH(i){return p(this,null,function*(){i.listenTargets.forEach((e,t)=>{lS(i,e)})})}function tH(i,e){return p(this,null,function*(){JM(i),dS(i)?(i.onlineStateTracker.handleWatchStreamFailure(e),cS(i)):i.onlineStateTracker.set("Unknown")})}function iH(i,e,t){return p(this,null,function*(){if(i.onlineStateTracker.set("Online"),e instanceof vm&&e.state===2&&e.cause){try{yield rH(i,e)}catch(n){D(vo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield Pm(i,n)}return}if(e instanceof Qa?i.watchChangeAggregator.handleDocumentChange(e):e instanceof ym?i.watchChangeAggregator.handleExistenceFilter(e):i.watchChangeAggregator.handleTargetChange(e),!t.isEqual($.min()))try{let n=yield zM(i.localStore);t.compareTo(n)>=0&&(yield nH(i,t))}catch(n){D(vo,"Failed to raise snapshot:",n),yield Pm(i,n)}})}function Pm(i,e,t){return p(this,null,function*(){if(ws(e))i.offlineCauses.add(1),yield vl(i),i.onlineStateTracker.set("Offline"),t||(t=()=>zM(i.localStore)),i.asyncQueue.enqueueRetryable(()=>p(this,null,function*(){D(vo,"Retrying IndexedDB access"),yield t(),i.offlineCauses.delete(1),yield Ud(i)}));else throw e})}function eO(i,e){return e().catch(t=>Pm(i,t,e))}function nH(i,e){let t=i.watchChangeAggregator.createRemoteEvent(e);return t.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){let s=i.listenTargets.get(r);s&&i.listenTargets.set(r,s.withResumeToken(n.resumeToken,e))}}),t.targetMismatches.forEach((n,r)=>{let s=i.listenTargets.get(n);if(!s)return;i.listenTargets.set(n,s.withResumeToken(Ct.EMPTY_BYTE_STRING,s.snapshotVersion)),ZM(i,n);let o=new rl(s.target,n,r,s.sequenceNumber);lS(i,o)}),i.remoteSyncer.applyRemoteEvent(t)}function rH(i,e){return p(this,null,function*(){let t=e.cause;for(let n of e.targetIds)i.listenTargets.has(n)&&(yield i.remoteSyncer.rejectListen(n,t),i.listenTargets.delete(n),i.watchChangeAggregator.removeTarget(n))})}function _l(i){return p(this,null,function*(){let e=F(i),t=Es(e),n=e.writePipeline.length>0?e.writePipeline[e.writePipeline.length-1].batchId:as;for(;sH(e);)try{let r=yield r9(e.localStore,n);if(r===null){e.writePipeline.length===0&&t.markIdle();break}else n=r.batchId,oH(e,r)}catch(r){yield Pm(e,r)}tO(e)&&iO(e)})}function sH(i){return Ss(i)&&i.writePipeline.length<Q9}function oH(i,e){i.writePipeline.push(e);let t=Es(i);t.isOpen()&&t.handshakeComplete&&t.writeMutations(e.mutations)}function tO(i){return Ss(i)&&!Es(i).isStarted()&&i.writePipeline.length>0}function iO(i){Es(i).start()}function aH(i){return p(this,null,function*(){Es(i).writeHandshake()})}function lH(i){return p(this,null,function*(){let e=Es(i);for(let t of i.writePipeline)e.writeMutations(t.mutations)})}function cH(i,e,t){return p(this,null,function*(){let n=i.writePipeline.shift(),r=v0.from(n,e,t);yield eO(i,()=>i.remoteSyncer.applySuccessfulWrite(r)),yield _l(i)})}function dH(i,e){return p(this,null,function*(){e&&Es(i).handshakeComplete&&(yield uH(i,e)),tO(i)&&iO(i)})}function uH(i,e){return p(this,null,function*(){if(FG(e.code)){let t=i.writePipeline.shift();Es(i).inhibitBackoff(),yield eO(i,()=>i.remoteSyncer.rejectFailedWrite(t.batchId,e)),yield _l(i)}})}function hH(i){return p(this,null,function*(){let e=F(i);e.offlineCauses.add(4),yield vl(e),e.onlineStateTracker.set("Unknown"),e.offlineCauses.delete(4),yield Ud(e)})}function sk(i,e){return p(this,null,function*(){let t=F(i);t.asyncQueue.verifyOperationInProgress(),D(vo,"RemoteStore received new credentials");let n=Ss(t);t.offlineCauses.add(3),yield vl(t),n&&t.onlineStateTracker.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.offlineCauses.delete(3),yield Ud(t)})}function lw(i,e){return p(this,null,function*(){let t=F(i);e?(t.offlineCauses.delete(2),yield Ud(t)):e||(t.offlineCauses.add(2),yield vl(t),t.onlineStateTracker.set("Unknown"))})}function bl(i){return i.watchStream||(i.watchStream=W9(i.datastore,i.asyncQueue,{onOpen:eH.bind(null,i),onClose:tH.bind(null,i),onWatchChange:iH.bind(null,i)}),i.onNetworkStatusChange.push(e=>p(this,null,function*(){e?(i.watchStream.inhibitBackoff(),dS(i)?cS(i):i.onlineStateTracker.set("Unknown")):(yield i.watchStream.stop(),JM(i))}))),i.watchStream}function Es(i){return i.writeStream||(i.writeStream=H9(i.datastore,i.asyncQueue,{onOpen:aH.bind(null,i),onClose:dH.bind(null,i),onHandshakeComplete:lH.bind(null,i),onMutationResult:cH.bind(null,i)}),i.onNetworkStatusChange.push(e=>p(this,null,function*(){e?(i.writeStream.inhibitBackoff(),yield _l(i)):(yield i.writeStream.stop(),i.writePipeline.length>0&&(D(vo,`Stopping write stream with ${i.writePipeline.length} pending writes`),i.writePipeline=[]))}))),i.writeStream}var fH="AsyncQueue",cw=class i{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new tt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){let o=Date.now()+n,a=new i(e,t,o,r,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new E(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function wl(i,e){if(ze(fH,`${e}: ${i}`),ws(i))return new E(b.UNAVAILABLE,`${e}: ${i}`);throw i}var Fm=class i{constructor(e){e?this.comparator=(t,n)=>e(t,n)||O.comparator(t.key,n.key):this.comparator=(t,n)=>O.comparator(t.key,n.key),this.keyedMap=Xc(),this.sortedSet=new Me(this.comparator)}static emptySet(e){return new i(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof i)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let n=new i;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}};var Lm=class{constructor(){this.changeMap=new Me(O.comparator)}track(e){let t=e.doc.key,n=this.changeMap.get(t);if(!n){this.changeMap=this.changeMap.insert(t,e);return}e.type!==0&&n.type===3?this.changeMap=this.changeMap.insert(t,e):e.type===3&&n.type!==1?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.changeMap=this.changeMap.remove(t):e.type===1&&n.type===2?this.changeMap=this.changeMap.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):B()}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,n)=>{e.push(n)}),e}},ll=class i{constructor(e,t,n,r,s,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new i(e,t,Fm.emptySet(t),o,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!Fd(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}};var dw=class{constructor(){this.viewSnap=void 0,this.listeners=[]}};function mH(){return new uw}var uw=class{constructor(){this.queries=new $n(e=>eM(e),Fd),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}};function uS(i,e){return p(this,null,function*(){let t=F(i),n=e.query,r=!1,s=t.queries.get(n);if(s||(r=!0,s=new dw),r)try{s.viewSnap=yield t.onListen(n)}catch(o){let a=wl(o,`Initialization of query '${za(e.query)}' failed`);e.onError(a);return}t.queries.set(n,s),s.listeners.push(e),e.applyOnlineStateChange(t.onlineState),s.viewSnap&&e.onViewSnapshot(s.viewSnap)&&fS(t)})}function hS(i,e){return p(this,null,function*(){let t=F(i),n=e.query,r=!1,s=t.queries.get(n);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),r=s.listeners.length===0)}if(r)return t.queries.delete(n),t.onUnlisten(n)})}function pH(i,e){let t=F(i),n=!1;for(let r of e){let s=r.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.onViewSnapshot(r)&&(n=!0);o.viewSnap=r}}n&&fS(t)}function gH(i,e,t){let n=F(i),r=n.queries.get(e);if(r)for(let s of r.listeners)s.onError(t);n.queries.delete(e)}function yH(i,e){let t=F(i);t.onlineState=e;let n=!1;t.queries.forEach((r,s)=>{for(let o of s.listeners)o.applyOnlineStateChange(e)&&(n=!0)}),n&&fS(t)}function vH(i,e){F(i).snapshotsInSyncListeners.add(e),e.next()}function _H(i,e){F(i).snapshotsInSyncListeners.delete(e)}function fS(i){i.snapshotsInSyncListeners.forEach(e=>{e.next()})}var xd=class{constructor(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=n||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let n=[];for(let r of e.docChanges)r.type!==3&&n.push(r);e=new ll(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache)return!0;let n=t!=="Offline";return this.options.waitForSyncWhenOnline&&n?!1:!e.docs.isEmpty()||e.hasCachedResults||t==="Offline"}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return e.syncStateChanged||t?this.options.includeMetadataChanges===!0:!1}raiseInitialEvent(e){e=ll.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}};var hw=class i{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.addedKeys=n,this.removedKeys=r}static fromSnapshot(e,t){let n=Z(),r=Z();for(let s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key);break}return new i(e,t.fromCache,n,r)}};var Bm=class{constructor(e){this.serializer=e}toDocumentKey(e){return zn(this.serializer,e)}toMutableDocument(e){return e.metadata.exists?EM(this.serializer,e.document,!1):ut.newNoDocument(this.toDocumentKey(e.metadata.name),this.toSnapshotVersion(e.metadata.readTime))}toSnapshotVersion(e){return it(e)}},fw=class{constructor(e,t,n){this.bundleMetadata=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=nO(e)}addSizedElement(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;let n=me.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}getQueryDocumentMapping(e){let t=new Map,n=new Bm(this.serializer);for(let r of e)if(r.metadata.queries){let s=n.toDocumentKey(r.metadata.name);for(let o of r.metadata.queries){let a=(t.get(o)||Z()).add(s);t.set(o,a)}}return t}complete(){return p(this,null,function*(){let e=yield h9(this.localStore,new Bm(this.serializer),this.documents,this.bundleMetadata.id),t=this.getQueryDocumentMapping(this.documents);for(let n of this.queries)yield g9(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:e}})}};function nO(i){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}}function bH(i){return{taskState:"Success",documentsLoaded:i.totalDocuments,bytesLoaded:i.totalBytes,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}}var Vm=class{constructor(e){this.key=e}},Um=class{constructor(e){this.key=e}},qm=class{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=Z(),this.mutatedKeys=Z(),this.docComparator=iM(e),this.documentSet=new Fm(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let n=t?t.changeSet:new Lm,r=t?t.documentSet:this.documentSet,s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,u)=>{let h=r.get(d),m=Ld(this.query,u)?u:null,g=h?this.mutatedKeys.has(h.key):!1,_=m?m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations:!1,y=!1;h&&m?h.data.isEqual(m.data)?g!==_&&(n.track({type:3,doc:m}),y=!0):this.shouldWaitForSyncedDocument(h,m)||(n.track({type:2,doc:m}),y=!0,(l&&this.docComparator(m,l)>0||c&&this.docComparator(m,c)<0)&&(a=!0)):!h&&m?(n.track({type:0,doc:m}),y=!0):h&&!m&&(n.track({type:1,doc:h}),y=!0,(l||c)&&(a=!0)),y&&(m?(o=o.add(m),_?s=s.add(d):s=s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{documentSet:o,changeSet:n,needsRefill:a,mutatedKeys:s}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){let s=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let o=e.changeSet.getChanges();o.sort((u,h)=>wH(u.type,h.type)||this.docComparator(u.doc,h.doc)),this.applyTargetChange(n),r=r??!1;let a=t&&!r?this.updateLimboDocuments():[],c=this.limboDocuments.size===0&&this.current&&!r?1:0,d=c!==this.syncState;return this.syncState=c,o.length===0&&!d?{limboChanges:a}:{snapshot:new ll(this.query,e.documentSet,s,o,e.mutatedKeys,c===0,d,!1,n?n.resumeToken.approximateByteSize()>0:!1),limboChanges:a}}applyOnlineStateChange(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Lm,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!(this._syncedDocuments.has(e)||!this.documentSet.has(e)||this.documentSet.get(e).hasLocalMutations)}applyTargetChange(e){e&&(e.addedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.delete(t)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=Z(),this.documentSet.forEach(n=>{this.shouldBeInLimbo(n.key)&&(this.limboDocuments=this.limboDocuments.add(n.key))});let t=[];return e.forEach(n=>{this.limboDocuments.has(n)||t.push(new Um(n))}),this.limboDocuments.forEach(n=>{e.has(n)||t.push(new Vm(n))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=Z();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return ll.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===0,this.hasCachedResults)}};function wH(i,e){let t=n=>{switch(n){case 0:return 1;case 2:return 2;case 3:return 2;case 1:return 0;default:return B()}};return t(i)-t(e)}var Cs="SyncEngine",mw=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},pw=class{constructor(e){this.key=e,this.receivedDocument=!1}},gw=class{constructor(e,t,n,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.syncEngineListener={},this.queryViewsByQuery=new $n(a=>eM(a),Fd),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new Me(O.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new Sd,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=sl.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return this._isPrimaryClient===!0}};function SH(i,e,t,n,r,s,o){let a=new gw(i,e,t,n,r,s);return o&&(a._isPrimaryClient=!0),a}function EH(i,e){return p(this,null,function*(){let t=_S(i),n,r,s=t.queryViewsByQuery.get(e);if(s)n=s.targetId,t.sharedClientState.addLocalQueryTarget(n),r=s.view.computeInitialSnapshot();else{let o=yield ol(t.localStore,ii(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);n=o.targetId,r=yield mS(t,e,n,a==="current",o.resumeToken),t.isPrimaryClient&&ap(t.remoteStore,o)}return r})}function mS(i,e,t,n,r){return p(this,null,function*(){i.applyDocChanges=(u,h,m)=>OH(i,u,h,m);let s=yield op(i.localStore,e,!0),o=new qm(e,s.remoteKeys),a=o.computeDocChanges(s.documents),l=yd.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",r),c=o.applyChanges(a,i.isPrimaryClient,l);yS(i,t,c.limboChanges);let d=new mw(e,t,o);return i.queryViewsByQuery.set(e,d),i.queriesByTarget.has(t)?i.queriesByTarget.get(t).push(e):i.queriesByTarget.set(t,[e]),c.snapshot})}function CH(i,e){return p(this,null,function*(){let t=F(i),n=t.queryViewsByQuery.get(e),r=t.queriesByTarget.get(n.targetId);if(r.length>1){t.queriesByTarget.set(n.targetId,r.filter(s=>!Fd(s,e))),t.queryViewsByQuery.delete(e);return}t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield al(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),qd(t.remoteStore,n.targetId),cl(t,n.targetId)}).catch(bs))):(cl(t,n.targetId),yield al(t.localStore,n.targetId,!0))})}function TH(i,e,t){return p(this,null,function*(){let n=bS(i);try{let r=yield Y5(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),kH(n,r.batchId,t),yield gr(n,r.changes),yield _l(n.remoteStore)}catch(r){let s=wl(r,"Failed to persist write");t.reject(s)}})}function rO(i,e){return p(this,null,function*(){let t=F(i);try{let n=yield t9(t.localStore,e);e.targetChanges.forEach((r,s)=>{let o=t.activeLimboResolutionsByTarget.get(s);o&&(z(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.receivedDocument=!0:r.modifiedDocuments.size>0?z(o.receivedDocument):r.removedDocuments.size>0&&(z(o.receivedDocument),o.receivedDocument=!1))}),yield gr(t,n,e)}catch(n){yield bs(n)}})}function ok(i,e,t){let n=F(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){let r=[];n.queryViewsByQuery.forEach((s,o)=>{let a=o.view.applyOnlineStateChange(e);a.snapshot&&r.push(a.snapshot)}),yH(n.eventManager,e),r.length&&n.syncEngineListener.onWatchChange(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function xH(i,e,t){return p(this,null,function*(){let n=F(i);n.sharedClientState.updateQueryState(e,"rejected",t);let r=n.activeLimboResolutionsByTarget.get(e),s=r&&r.key;if(s){let o=new Me(O.comparator);o=o.insert(s,ut.newNoDocument(s,$.min()));let a=Z().add(s),l=new gd($.min(),new Map,new Me(X),o,a);yield rO(n,l),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(s),n.activeLimboResolutionsByTarget.delete(e),vS(n)}else yield al(n.localStore,e,!1).then(()=>cl(n,e,t)).catch(bs)})}function IH(i,e){return p(this,null,function*(){let t=F(i),n=e.batch.batchId;try{let r=yield X5(t.localStore,e);gS(t,n,null),pS(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield gr(t,r)}catch(r){yield bs(r)}})}function DH(i,e,t){return p(this,null,function*(){let n=F(i);try{let r=yield J5(n.localStore,e);gS(n,e,t),pS(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield gr(n,r)}catch(r){yield bs(r)}})}function AH(i,e){return p(this,null,function*(){let t=F(i);Ss(t.remoteStore)||D(Cs,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let n=yield e9(t.localStore);if(n===as){e.resolve();return}let r=t.pendingWritesCallbacks.get(n)||[];r.push(e),t.pendingWritesCallbacks.set(n,r)}catch(n){let r=wl(n,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}})}function pS(i,e){(i.pendingWritesCallbacks.get(e)||[]).forEach(t=>{t.resolve()}),i.pendingWritesCallbacks.delete(e)}function RH(i,e){i.pendingWritesCallbacks.forEach(t=>{t.forEach(n=>{n.reject(new E(b.CANCELLED,e))})}),i.pendingWritesCallbacks.clear()}function kH(i,e,t){let n=i.mutationUserCallbacks[i.currentUser.toKey()];n||(n=new Me(X)),n=n.insert(e,t),i.mutationUserCallbacks[i.currentUser.toKey()]=n}function gS(i,e,t){let n=F(i),r=n.mutationUserCallbacks[n.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.mutationUserCallbacks[n.currentUser.toKey()]=r}}function cl(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(let n of i.queriesByTarget.get(e))i.queryViewsByQuery.delete(n),t&&i.syncEngineListener.onWatchError(n,t);i.queriesByTarget.delete(e),i.isPrimaryClient&&i.limboDocumentRefs.removeReferencesForId(e).forEach(r=>{i.limboDocumentRefs.containsKey(r)||sO(i,r)})}function sO(i,e){i.enqueuedLimboResolutions.delete(e.path.canonicalString());let t=i.activeLimboTargetsByKey.get(e);t!==null&&(qd(i.remoteStore,t),i.activeLimboTargetsByKey=i.activeLimboTargetsByKey.remove(e),i.activeLimboResolutionsByTarget.delete(t),vS(i))}function yS(i,e,t){for(let n of t)n instanceof Vm?(i.limboDocumentRefs.addReference(n.key,e),MH(i,n)):n instanceof Um?(D(Cs,"Document no longer in limbo: "+n.key),i.limboDocumentRefs.removeReference(n.key,e),i.limboDocumentRefs.containsKey(n.key)||sO(i,n.key)):B()}function MH(i,e){let t=e.key,n=t.path.canonicalString();!i.activeLimboTargetsByKey.get(t)&&!i.enqueuedLimboResolutions.has(n)&&(D(Cs,"New document in limbo: "+t),i.enqueuedLimboResolutions.add(n),vS(i))}function vS(i){for(;i.enqueuedLimboResolutions.size>0&&i.activeLimboTargetsByKey.size<i.maxConcurrentLimboResolutions;){let e=i.enqueuedLimboResolutions.values().next().value;i.enqueuedLimboResolutions.delete(e);let t=new O(me.fromString(e)),n=i.limboTargetIdGenerator.next();i.activeLimboResolutionsByTarget.set(n,new pw(t)),i.activeLimboTargetsByKey=i.activeLimboTargetsByKey.insert(t,n),ap(i.remoteStore,new rl(ii(yl(t.path)),n,"TargetPurposeLimboResolution",wi.INVALID))}}function gr(i,e,t){return p(this,null,function*(){let n=F(i),r=[],s=[],o=[];n.queryViewsByQuery.isEmpty()||(n.queryViewsByQuery.forEach((a,l)=>{o.push(n.applyDocChanges(l,e,t).then(c=>{if((c||t)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(l.targetId,c?.fromCache?"not-current":"current"),c){r.push(c);let d=hw.fromSnapshot(l.targetId,c);s.push(d)}}))}),yield Promise.all(o),n.syncEngineListener.onWatchChange(r),yield n9(n.localStore,s))})}function OH(i,e,t,n){return p(this,null,function*(){let r=e.view.computeDocChanges(t);r.needsRefill&&(r=yield op(i.localStore,e.query,!1).then(({documents:l})=>e.view.computeDocChanges(l,r)));let s=n&&n.targetChanges.get(e.targetId),o=n&&n.targetMismatches.get(e.targetId)!=null,a=e.view.applyChanges(r,i.isPrimaryClient,s,o);return yS(i,e.targetId,a.limboChanges),a.snapshot})}function NH(i,e){return p(this,null,function*(){let t=F(i);if(!t.currentUser.isEqual(e)){D(Cs,"User change. New user:",e.toKey());let r=yield qM(t.localStore,e);t.currentUser=e,RH(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield gr(t,r.affectedDocuments)}})}function PH(i,e){let t=F(i),n=t.activeLimboResolutionsByTarget.get(e);if(n&&n.receivedDocument)return Z().add(n.key);{let r=Z(),s=t.queriesByTarget.get(e);if(!s)return r;for(let o of s){let a=t.queryViewsByQuery.get(o);r=r.unionWith(a.view.syncedDocuments)}return r}}function FH(i,e){return p(this,null,function*(){let t=F(i),n=yield op(t.localStore,e.query,!0),r=e.view.synchronizeWithPersistedState(n);return t.isPrimaryClient&&yS(t,e.targetId,r.limboChanges),r})}function LH(i,e){return p(this,null,function*(){let t=F(i);return $M(t.localStore,e).then(n=>gr(t,n))})}function BH(i,e,t,n){return p(this,null,function*(){let r=F(i),s=yield l9(r.localStore,e);if(s===null){D(Cs,"Cannot apply mutation batch with id: "+e);return}t==="pending"?yield _l(r.remoteStore):t==="acknowledged"||t==="rejected"?(gS(r,e,n||null),pS(r,e),c9(r.localStore,e)):B(),yield gr(r,s)})}function VH(i,e){return p(this,null,function*(){let t=F(i);if(_S(t),bS(t),e===!0&&t._isPrimaryClient!==!0){let n=t.sharedClientState.getAllActiveQueryTargets(),r=yield ak(t,n.toArray());t._isPrimaryClient=!0,yield lw(t.remoteStore,!0);for(let s of r)ap(t.remoteStore,s)}else if(e===!1&&t._isPrimaryClient!==!1){let n=[],r=Promise.resolve();t.queriesByTarget.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?n.push(o):r=r.then(()=>(cl(t,o),al(t.localStore,o,!0))),qd(t.remoteStore,o)}),yield r,yield ak(t,n),UH(t),t._isPrimaryClient=!1,yield lw(t.remoteStore,!1)}})}function UH(i){let e=F(i);e.activeLimboResolutionsByTarget.forEach((t,n)=>{qd(e.remoteStore,n)}),e.limboDocumentRefs.removeAllReferences(),e.activeLimboResolutionsByTarget=new Map,e.activeLimboTargetsByKey=new Me(O.comparator)}function ak(i,e,t){return p(this,null,function*(){let n=F(i),r=[],s=[];for(let o of e){let a,l=n.queriesByTarget.get(o);if(l&&l.length!==0){a=yield ol(n.localStore,ii(l[0]));for(let c of l){let d=n.queryViewsByQuery.get(c),u=yield FH(n,d);u.snapshot&&s.push(u.snapshot)}}else{let c=yield GM(n.localStore,o);a=yield ol(n.localStore,c),yield mS(n,oO(c),o,!1,a.resumeToken)}r.push(a)}return n.syncEngineListener.onWatchChange(s),r})}function oO(i){return Jk(i.path,i.collectionGroup,i.orderBy,i.filters,i.limit,"F",i.startAt,i.endAt)}function qH(i){let e=F(i);return d9(e.localStore)}function zH(i,e,t,n){return p(this,null,function*(){let r=F(i);if(r._isPrimaryClient){D(Cs,"Ignoring unexpected query state notification.");return}let s=r.queriesByTarget.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield $M(r.localStore,tM(s[0])),a=gd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ct.EMPTY_BYTE_STRING);yield gr(r,o,a);break}case"rejected":{yield al(r.localStore,e,!0),cl(r,e,n);break}default:B()}})}function jH(i,e,t){return p(this,null,function*(){let n=_S(i);if(n._isPrimaryClient){for(let r of e){if(n.queriesByTarget.has(r)){D(Cs,"Adding an already active target "+r);continue}let s=yield GM(n.localStore,r),o=yield ol(n.localStore,s);yield mS(n,oO(s),o.targetId,!1,o.resumeToken),ap(n.remoteStore,o)}for(let r of t)n.queriesByTarget.has(r)&&(yield al(n.localStore,r,!1).then(()=>{qd(n.remoteStore,r),cl(n,r)}).catch(bs))}})}function _S(i){let e=F(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=rO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=PH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xH.bind(null,e),e.syncEngineListener.onWatchChange=pH.bind(null,e.eventManager),e.syncEngineListener.onWatchError=gH.bind(null,e.eventManager),e}function bS(i){let e=F(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DH.bind(null,e),e}function GH(i,e,t){let n=F(i);$H(n,e,t).then(r=>{n.sharedClientState.notifyBundleLoaded(r)})}function $H(i,e,t){return p(this,null,function*(){try{let n=yield e.getMetadata();if(yield f9(i.localStore,n))return yield e.close(),t._completeWith(bH(n)),Promise.resolve(new Set);t._updateProgress(nO(n));let s=new fw(n,i.localStore,e.serializer),o=yield e.nextElement();for(;o;){let l=yield s.addSizedElement(o);l&&t._updateProgress(l),o=yield e.nextElement()}let a=yield s.complete();return yield gr(i,a.changedDocs,void 0),yield m9(i.localStore,n),t._completeWith(a.progress),Promise.resolve(a.changedCollectionGroups)}catch(n){return Vi(Cs,`Loading bundle failed with ${n}`),t._failWith(n),Promise.resolve(new Set)}})}var Id=class{constructor(){this.synchronizeTabs=!1}initialize(e){return p(this,null,function*(){this.serializer=Vd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return UM(this.persistence,new Rm,e.initialUser,this.serializer)}createPersistence(e){return new Dm(Am.factory,this.serializer)}createSharedClientState(e){return new Om}terminate(){return p(this,null,function*(){this.gcScheduler&&this.gcScheduler.stop(),yield this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var zm=class i extends Id{constructor(e,t,n){super(),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(e){return p(this,null,function*(){yield Hp(i.prototype,this,"initialize").call(this,e),yield this.onlineComponentProvider.initialize(this,e),yield bS(this.onlineComponentProvider.syncEngine),yield _l(this.onlineComponentProvider.remoteStore),yield this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return UM(this.persistence,new Rm,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let n=this.persistence.referenceDelegate.garbageCollector;return new F0(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let n=new Zb(t,this.persistence);return new Xb(e.asyncQueue,n)}createPersistence(e){let t=oS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Bi.withCacheSize(this.cacheSizeBytes):Bi.DEFAULT;return new Y0(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,XM(),F9(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Om}},yw=class i extends zm{constructor(e,t){super(e,t,!1),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return p(this,null,function*(){yield Hp(i.prototype,this,"initialize").call(this,e);let t=this.onlineComponentProvider.syncEngine;this.sharedClientState instanceof rd&&(this.sharedClientState.syncEngine={applyBatchState:BH.bind(null,t),applyTargetState:zH.bind(null,t),applyActiveTargetsChange:jH.bind(null,t),getActiveClients:qH.bind(null,t),synchronizeWithChangedDocuments:LH.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.setPrimaryStateListener(n=>p(this,null,function*(){yield VH(this.onlineComponentProvider.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=XM();if(!rd.isAvailable(t))throw new E(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let n=oS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new rd(t,e.asyncQueue,n,e.clientId,e.initialUser)}},Dd=class{initialize(e,t){return p(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>ok(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=NH.bind(null,this.syncEngine),yield lw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return mH()}createDatastore(e){let t=Vd(e.databaseInfo.databaseId),n=N9(e.databaseInfo);return j9(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return Y9(this.localStore,this.datastore,e.asyncQueue,t=>ok(this.syncEngine,t,0),P9())}createSyncEngine(e,t){return SH(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return J9(this.remoteStore)}};var HH=10240;function WH(i,e=HH){let t=0;return{read(){return p(this,null,function*(){if(t<i.byteLength){let s={value:i.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}})},cancel(){return p(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}function wS(i,e,t){if(!t)throw new E(b.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function SS(i,e,t,n){if(e===!0&&n===!0)throw new E(b.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function lk(i){if(!O.isDocumentKey(i))throw new E(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function ck(i){if(O.isDocumentKey(i))throw new E(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function KH(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function zd(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{let e=QH(i);return e?`a custom ${e} object`:"an object"}}else return typeof i=="function"?"a function":B()}function QH(i){return i.constructor?i.constructor.name:null}function le(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new E(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=zd(i);throw new E(b.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function aO(i,e){if(e<=0)throw new E(b.INVALID_ARGUMENT,`Function ${i}() requires a positive number, but it was: ${e}.`)}function YH(i,e){if(!(i instanceof Uint8Array))throw new E(b.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${zd(i)}`);return WH(i,e)}var dl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.observer.error?this.scheduleEvent(this.observer.error,e):ze("Uncaught Error in snapshot listener:",e.toString())}mute(){this.muted=!0}scheduleEvent(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var vw=class{constructor(e,t){this.payload=e,this.byteLength=t}isBundleMetadata(){return"metadata"in this.payload}};var _w=class{constructor(e,t){this.reader=e,this.serializer=t,this.metadata=new tt,this.buffer=new Uint8Array,this.textDecoder=LG(),this.nextElementImpl().then(n=>{n&&n.isBundleMetadata()?this.metadata.resolve(n.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n?.payload)}`))},n=>this.metadata.reject(n))}close(){return this.reader.cancel()}getMetadata(){return p(this,null,function*(){return this.metadata.promise})}nextElement(){return p(this,null,function*(){return yield this.getMetadata(),this.nextElementImpl()})}nextElementImpl(){return p(this,null,function*(){let e=yield this.readLength();if(e===null)return null;let t=this.textDecoder.decode(e),n=Number(t);isNaN(n)&&this.raiseError(`length string (${t}) is not valid number`);let r=yield this.readJsonString(n);return new vw(JSON.parse(r),e.length+n)})}indexOfOpenBracket(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}readLength(){return p(this,null,function*(){for(;this.indexOfOpenBracket()<0&&!(yield this.pullMoreDataToBuffer()););if(this.buffer.length===0)return null;let e=this.indexOfOpenBracket();e<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}readJsonString(e){return p(this,null,function*(){for(;this.buffer.length<e;)(yield this.pullMoreDataToBuffer())&&this.raiseError("Reached the end of bundle when more is expected.");let t=this.textDecoder.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}raiseError(e){throw this.reader.cancel(),new Error(`Invalid bundle format: ${e}`)}pullMoreDataToBuffer(){return p(this,null,function*(){let e=yield this.reader.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};function XH(i,e){return new _w(i,e)}var bw=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){return p(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new E(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");let t=yield $9(this.datastore,e);return t.forEach(n=>this.recordVersion(n)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new ys(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return p(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,n)=>{let r=O.fromPath(n);this.mutations.push(new fd(r,this.precondition(r)))}),yield G9(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else if(e.isNoDocument())t=$.min();else throw B();let n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new E(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual($.min())?Qe.exists(!1):Qe.updateTime(t):Qe.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual($.min()))throw new E(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qe.updateTime(t)}else return Qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var ww=class{constructor(e,t,n,r,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=s,this.attemptsRemaining=n.maxAttempts,this.backoff=new Td(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(()=>p(this,null,function*(){let e=new bw(this.datastore),t=this.tryRunUpdateFunction(e);t&&t.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(r=>{this.handleTransactionError(r)}))}).catch(n=>{this.handleTransactionError(n)})}))}tryRunUpdateFunction(e){try{let t=this.updateFunction(e);return Nd(t)||!t.catch||!t.then?(this.deferred.reject(Error("Transaction callback must return a Promise")),null):t}catch(t){return this.deferred.reject(t),null}}handleTransactionError(e){this.attemptsRemaining>0&&this.isRetryableTransactionError(e)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(e)}isRetryableTransactionError(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!yM(t)}return!1}};var vs="FirestoreClient",ZH=100,JH=11,eW=20,tW=22,Sw=class{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ht.UNAUTHENTICATED,this.clientId=am.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,s=>p(this,null,function*(){D(vs,"Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(n,s=>(D(vs,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}getConfiguration(){return p(this,null,function*(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:ZH}})}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new E(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new tt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>p(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=wl(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function sm(i,e){return p(this,null,function*(){i.asyncQueue.verifyOperationInProgress(),D(vs,"Initializing OfflineComponentProvider");let t=yield i.getConfiguration();yield e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener(r=>p(this,null,function*(){n.isEqual(r)||(yield qM(e.localStore,r),n=r)})),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i._offlineComponents=e})}function Ew(i,e){return p(this,null,function*(){i.asyncQueue.verifyOperationInProgress();let t=yield ES(i);D(vs,"Initializing OnlineComponentProvider");let n=yield i.getConfiguration();yield e.initialize(t,n),i.setCredentialChangeListener(r=>sk(e.remoteStore,r)),i.setAppCheckTokenChangeListener((r,s)=>sk(e.remoteStore,s)),i._onlineComponents=e})}function lO(i){return i.name==="FirebaseError"?i.code===b.FAILED_PRECONDITION||i.code===b.UNIMPLEMENTED:typeof DOMException<"u"&&i instanceof DOMException?i.code===tW||i.code===eW||i.code===JH:!0}function ES(i){return p(this,null,function*(){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){D(vs,"Using user provided OfflineComponentProvider");try{yield sm(i,i._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!lO(t))throw t;Vi("Error using user provided cache. Falling back to memory cache: "+t),yield sm(i,new Id)}}else D(vs,"Using default OfflineComponentProvider"),yield sm(i,new Id);return i._offlineComponents})}function lp(i){return p(this,null,function*(){return i._onlineComponents||(i._uninitializedComponentsProvider?(D(vs,"Using user provided OnlineComponentProvider"),yield Ew(i,i._uninitializedComponentsProvider._online)):(D(vs,"Using default OnlineComponentProvider"),yield Ew(i,new Dd))),i._onlineComponents})}function cO(i){return ES(i).then(e=>e.persistence)}function CS(i){return ES(i).then(e=>e.localStore)}function dO(i){return lp(i).then(e=>e.remoteStore)}function TS(i){return lp(i).then(e=>e.syncEngine)}function iW(i){return lp(i).then(e=>e.datastore)}function ul(i){return p(this,null,function*(){let e=yield lp(i),t=e.eventManager;return t.onListen=EH.bind(null,e.syncEngine),t.onUnlisten=CH.bind(null,e.syncEngine),t})}function nW(i){return i.asyncQueue.enqueue(()=>p(this,null,function*(){let e=yield cO(i),t=yield dO(i);return e.setNetworkEnabled(!0),X9(t)}))}function rW(i){return i.asyncQueue.enqueue(()=>p(this,null,function*(){let e=yield cO(i),t=yield dO(i);return e.setNetworkEnabled(!1),Z9(t)}))}function sW(i){let e=new tt;return i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let t=yield TS(i);return AH(t,e)})),e.promise}function oW(i,e,t,n){let r=new dl(n),s=new xd(e,r,t);return i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let o=yield ul(i);return uS(o,s)})),()=>{r.mute(),i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let o=yield ul(i);return hS(o,s)}))}}function aW(i,e){let t=new tt;return i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let n=yield CS(i);return hW(n,e,t)})),t.promise}function uO(i,e,t={}){let n=new tt;return i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let r=yield ul(i);return fW(r,i.asyncQueue,e,t,n)})),n.promise}function lW(i,e){let t=new tt;return i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let n=yield CS(i);return mW(n,e,t)})),t.promise}function hO(i,e,t={}){let n=new tt;return i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let r=yield ul(i);return pW(r,i.asyncQueue,e,t,n)})),n.promise}function cW(i,e){let t=new tt;return i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let n=yield TS(i);return TH(n,e,t)})),t.promise}function dW(i,e){let t=new dl(e);return i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let n=yield ul(i);return vH(n,t)})),()=>{t.mute(),i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let n=yield ul(i);return _H(n,t)}))}}function uW(i,e,t){let n=new tt;return i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){let r=yield iW(i);new ww(i.asyncQueue,r,t,e,n).run()})),n.promise}function hW(i,e,t){return p(this,null,function*(){try{let n=yield s9(i,e);n.isFoundDocument()?t.resolve(n):n.isNoDocument()?t.resolve(null):t.reject(new E(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(n){let r=wl(n,`Failed to get document '${e} from cache`);t.reject(r)}})}function fW(i,e,t,n,r){let s=new dl({next:a=>{e.enqueueAndForget(()=>hS(i,o));let l=a.docs.has(t);!l&&a.fromCache?r.reject(new E(b.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&n&&n.source==="server"?r.reject(new E(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(a)},error:a=>r.reject(a)}),o=new xd(yl(t.path),s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return uS(i,o)}function mW(i,e,t){return p(this,null,function*(){try{let n=yield op(i,e,!0),r=new qm(e,n.remoteKeys),s=r.computeDocChanges(n.documents),o=r.applyChanges(s,!1);t.resolve(o.snapshot)}catch(n){let r=wl(n,`Failed to execute query '${e} against cache`);t.reject(r)}})}function pW(i,e,t,n,r){let s=new dl({next:a=>{e.enqueueAndForget(()=>hS(i,o)),a.fromCache&&n.source==="server"?r.reject(new E(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(a)},error:a=>r.reject(a)}),o=new xd(t,s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return uS(i,o)}function gW(i,e,t,n){let r=vW(t,Vd(e));i.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){GH(yield TS(i),r,n)}))}function yW(i,e){return i.asyncQueue.enqueue(()=>p(this,null,function*(){return p9(yield CS(i),e)}))}function vW(i,e){let t;return typeof i=="string"?t=vM().encode(i):t=i,XH(YH(t),e)}function _W(i,e){return i.timeoutSeconds===e.timeoutSeconds}function fO(i){let e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}var bW="ComponentProvider",dk=new Map;function wW(i){let e=dk.get(i);e&&(D(bW,"Removing Datastore"),dk.delete(i),e.terminate())}function SW(i,e,t,n){return new r0(i,e,t,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling,fO(n.experimentalLongPollingOptions),n.useFetchStreams)}var mO="firestore.googleapis.com",uk=!0,hk=5,fk=30,EW=!0,jm=class{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new E(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mO,this.ssl=uk}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:uk;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=LM;else{if(e.cacheSizeBytes!==Bd&&e.cacheSizeBytes<K1)throw new E(b.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${K1}`);this.cacheSizeBytes=e.cacheSizeBytes}SS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=EW:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fO((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),CW(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&_W(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function CW(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new E(b.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<hk)throw new E(b.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is ${hk})`);if(i.timeoutSeconds>fk)throw new E(b.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is ${fk})`)}}var _o=class{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jm({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new E(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new E(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jm(e),e.credentials!==void 0&&(this._authCredentials=E4(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return wW(this),Promise.resolve()}};function cp(i,e,t,n={}){var r;i=le(i,_o);let s=i._getSettings(),o=`${e}:${t}`;if(s.host!==mO&&s.host!==o&&Vi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),i._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let a,l;if(typeof n.mockUserToken=="string")a=n.mockUserToken,l=ht.MOCK_USER;else{a=EC(n.mockUserToken,(r=i._app)===null||r===void 0?void 0:r.options.projectId);let c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new E(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ht(c)}i._authCredentials=new zb(new om(a,l))}}var At=class i{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new i(this.firestore,e,this._query)}},De=class i{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new i(this.firestore,e,this._key)}},jn=class i extends At{constructor(e,t,n){super(e,t,yl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new De(this.firestore,null,new O(e))}withConverter(e){return new i(this.firestore,e,this._path)}};function jd(i,e,...t){if(i=qe(i),wS("collection","path",e),i instanceof _o){let n=me.fromString(e,...t);return ck(n),new jn(i,null,n)}else{if(!(i instanceof De)&&!(i instanceof jn))throw new E(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=i._path.child(me.fromString(e,...t));return ck(n),new jn(i.firestore,null,n)}}function xS(i,e){if(i=le(i,_o),wS("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new E(b.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new At(i,null,sG(e))}function Sl(i,e,...t){if(i=qe(i),arguments.length===1&&(e=am.newId()),wS("doc","path",e),i instanceof _o){let n=me.fromString(e,...t);return lk(n),new De(i,null,new O(n))}else{if(!(i instanceof De)&&!(i instanceof jn))throw new E(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=i._path.child(me.fromString(e,...t));return lk(n),new De(i.firestore,i instanceof jn?i.converter:null,new O(n))}}function Gd(i,e){return i=qe(i),e=qe(e),(i instanceof De||i instanceof jn)&&(e instanceof De||e instanceof jn)?i.firestore===e.firestore&&i.path===e.path&&i.converter===e.converter:!1}function dp(i,e){return i=qe(i),e=qe(e),i instanceof At&&e instanceof At?i.firestore===e.firestore&&Fd(i._query,e._query)&&i.converter===e.converter:!1}var TW="AsyncQueue",Cw=class{constructor(){this.tail=Promise.resolve(),this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new Td(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()}}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new tt;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}retryNextOp(){return p(this,null,function*(){if(this.retryableOps.length!==0){try{yield this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(ws(e))D(TW,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}})}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(n=>{this.failure=n,this.operationInProgress=!1;let r=IW(n);throw ze("INTERNAL UNHANDLED ERROR: ",r),n}).then(n=>(this.operationInProgress=!1,n))));return this.tail=t,t}enqueueAfterDelay(e,t,n){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let r=cw.createAndSchedule(this,e,t,n,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(r),r}verifyNotFailed(){this.failure&&B()}verifyOperationInProgress(){}drain(){return p(this,null,function*(){let e;do e=this.tail,yield e;while(e!==this.tail)})}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(let t of this.delayedOperations)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}};function xW(){return new Cw}function IW(i){let e=i.message||"";return i.stack&&(i.stack.includes(i.message)?e=i.stack:e=i.message+`
`+i.stack),e}var Tw=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new tt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var pO=Bd,Fe=class extends _o{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=xW(),this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||yO(this),this._firestoreClient.terminate()}};function gO(i,e){let t=typeof i=="object"?i:Fl(),n=typeof i=="string"?i:e||s0,r=sg(t,"firestore").getImmediate({identifier:n});if(!r._initialized){let s=SC("firestore");s&&cp(r,...s)}return r}function gt(i){return i._firestoreClient||yO(i),i._firestoreClient.verifyNotTerminated(),i._firestoreClient}function yO(i){var e,t,n;let r=i._freezeSettings(),s=SW(i._databaseId,((e=i._app)===null||e===void 0?void 0:e.options.appId)||"",i._persistenceKey,r);i._firestoreClient=new Sw(i._authCredentials,i._appCheckCredentials,i._queue,s),!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=r.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(i._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}function IS(i,e){i=le(i,Fe),_O(i);let t=gt(i);if(t._uninitializedComponentsProvider)throw new E(b.FAILED_PRECONDITION,"SDK cache is already specified.");Vi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=i._freezeSettings(),r=new Dd,s=new zm(r,n.cacheSizeBytes,e?.forceOwnership);return vO(t,r,s)}function DS(i){i=le(i,Fe),_O(i);let e=gt(i);if(e._uninitializedComponentsProvider)throw new E(b.FAILED_PRECONDITION,"SDK cache is already specified.");Vi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=i._freezeSettings(),n=new Dd,r=new yw(n,t.cacheSizeBytes);return vO(e,n,r)}function vO(i,e,t){let n=new tt;return i.asyncQueue.enqueue(()=>p(this,null,function*(){try{yield sm(i,t),yield Ew(i,e),n.resolve()}catch(r){let s=r;if(!lO(s))throw s;Vi("Error enabling indexeddb cache. Falling back to memory cache: "+s),n.reject(s)}})).then(()=>n.promise)}function AS(i){if(i._initialized&&!i._terminated)throw new E(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new tt;return i._queue.enqueueAndForgetEvenWhileRestricted(()=>p(this,null,function*(){try{yield K5(oS(i._databaseId,i._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function RS(i){i=le(i,Fe);let e=gt(i);return sW(e)}function kS(i){i=le(i,Fe);let e=gt(i);return nW(e)}function MS(i){i=le(i,Fe);let e=gt(i);return rW(e)}function OS(i,e){i=le(i,Fe);let t=gt(i),n=new Tw;return gW(t,i._databaseId,e,n),n}function NS(i,e){i=le(i,Fe);let t=gt(i);return yW(t,e).then(n=>n?new At(i,null,n.query):null)}function _O(i){if(i._initialized||i._terminated)throw new E(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}function DW(i,e=!0){w4(IC),Pl(new Rs("firestore",(t,{instanceIdentifier:n,options:r})=>{let s=t.getProvider("app").getImmediate(),o=new Fe(new jb(t.getProvider("auth-internal")),new Wb(t.getProvider("app-check-internal")),v6(s,n),s);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),Kt(o1,a1,i),Kt(o1,a1,"esm2017")}var Hn=class i{constructor(e){this._byteString=e}static fromBase64String(e){try{return new i(Ct.fromBase64String(e))}catch(t){throw new E(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new i(Ct.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var an=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new E(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var fr=class{constructor(e){this._methodName=e}};var bo=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new E(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new E(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}};var AW=/^__.*__$/,xw=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new on(e,this.data,this.fieldMask,t,this.fieldTransforms):new gs(e,this.data,t,this.fieldTransforms)}},Gm=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new on(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function bO(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}var $m=class i{constructor(e,t,n,r,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new i(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Hm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(bO(this.dataSource)&&AW.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},Iw=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Vd(e)}createContext(e,t,n,r=!1){return new $m({dataSource:e,methodName:t,targetDoc:n,path:nt.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function To(i){let e=i._freezeSettings(),t=Vd(i._databaseId);return new Iw(i._databaseId,!!e.ignoreUndefinedProperties,t)}function up(i,e,t,n,r,s={}){let o=i.createContext(s.merge||s.mergeFields?2:0,e,t,r);LS("Data must be an object, but it was:",o,n);let a=EO(n,o),l,c;if(s.merge)l=new Si(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let u of s.mergeFields){let h=Mw(e,u,t);if(!o.contains(h))throw new E(b.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);TO(d,h)||d.push(h)}l=new Si(d),c=o.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=o.fieldTransforms;return new xw(new Gt(a),l,c)}var Ad=class i extends fr{_toFieldTransform(e){if(e.dataSource===2)e.fieldMask.push(e.path);else throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(e){return e instanceof i}};function wO(i,e,t){return new $m({dataSource:3,targetDoc:e.settings.targetDoc,methodName:i._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Dw=class i extends fr{_toFieldTransform(e){return new po(e.path,new ms)}isEqual(e){return e instanceof i}},Aw=class extends fr{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=wO(this,e,!0),n=this._elements.map(s=>xo(s,t)),r=new ur(n);return new po(e.path,r)}isEqual(e){return this===e}},Rw=class extends fr{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=wO(this,e,!0),n=this._elements.map(s=>xo(s,t)),r=new hr(n);return new po(e.path,r)}isEqual(e){return this===e}},kw=class extends fr{constructor(e,t){super(e),this._operand=t}_toFieldTransform(e){let t=new ps(e.serializer,lM(e.serializer,this._operand));return new po(e.path,t)}isEqual(e){return this===e}};function PS(i,e,t,n){let r=i.createContext(1,e,t);LS("Data must be an object, but it was:",r,n);let s=[],o=Gt.empty();Co(n,(l,c)=>{let d=BS(e,l,t);c=qe(c);let u=r.childContextForFieldPath(d);if(c instanceof Ad)s.push(d);else{let h=xo(c,u);h!=null&&(s.push(d),o.set(d,h))}});let a=new Si(s);return new Gm(o,a,r.fieldTransforms)}function FS(i,e,t,n,r,s){let o=i.createContext(1,e,t),a=[Mw(e,n,t)],l=[r];if(s.length%2!==0)throw new E(b.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(Mw(e,s[h])),l.push(s[h+1]);let c=[],d=Gt.empty();for(let h=a.length-1;h>=0;--h)if(!TO(c,a[h])){let m=a[h],g=l[h];g=qe(g);let _=o.childContextForFieldPath(m);if(g instanceof Ad)c.push(m);else{let y=xo(g,_);y!=null&&(c.push(m),d.set(m,y))}}let u=new Si(c);return new Gm(d,u,o.fieldTransforms)}function SO(i,e,t,n=!1){let r=i.createContext(n?4:3,e);return xo(t,r)}function xo(i,e){if(i=qe(i),CO(i))return LS("Unsupported field value:",e,i),EO(i,e);if(i instanceof fr)return kW(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return RW(i,e)}else return MW(i,e)}function EO(i,e){let t={};return Pk(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Co(i,(n,r)=>{let s=xo(r,e.childContextForField(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function RW(i,e){let t=[],n=0;for(let r of i){let s=xo(r,e.childContextForArray(n));s==null&&(s={nullValue:"NULL_VALUE"}),t.push(s),n++}return{arrayValue:{values:t}}}function kW(i,e){if(!bO(e.dataSource))throw e.createError(`${i._methodName}() can only be used with update() and set()`);if(!e.path)throw e.createError(`${i._methodName}() is not currently supported inside arrays`);let t=i._toFieldTransform(e);t&&e.fieldTransforms.push(t)}function MW(i,e){if(i=qe(i),i===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return lM(e.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let t=je.fromDate(i);return{timestampValue:nl(e.serializer,t)}}else if(i instanceof je){let t=new je(i.seconds,Math.floor(i.nanoseconds/1e3)*1e3);return{timestampValue:nl(e.serializer,t)}}else{if(i instanceof bo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Hn)return{bytesValue:_M(e.serializer,i._byteString)};if(i instanceof De){let t=e.databaseId,n=i.firestore._databaseId;if(!n.isEqual(t))throw e.createError(`Document reference is for database ${n.projectId}/${n.database} but should be for database ${t.projectId}/${t.database}`);return{referenceValue:tS(i.firestore._databaseId||e.databaseId,i._key.path)}}else throw e.createError(`Unsupported field value: ${zd(i)}`)}}function CO(i){return typeof i=="object"&&i!==null&&!(i instanceof Array)&&!(i instanceof Date)&&!(i instanceof je)&&!(i instanceof bo)&&!(i instanceof Hn)&&!(i instanceof De)&&!(i instanceof fr)}function LS(i,e,t){if(!CO(t)||!KH(t)){let n=zd(t);throw n==="an object"?e.createError(i+" a custom object"):e.createError(i+" "+n)}}function Mw(i,e,t){if(e=qe(e),e instanceof an)return e._internalPath;if(typeof e=="string")return BS(i,e);throw Hm("Field path arguments must be of type string or ",i,!1,void 0,t)}var OW=new RegExp("[~\\*/\\[\\]]");function BS(i,e,t){if(e.search(OW)>=0)throw Hm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new an(...e.split("."))._internalPath}catch{throw Hm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function Hm(i,e,t,n,r){let s=n&&!n.isEmpty(),o=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${n}`),o&&(l+=` in document ${r}`),l+=")"),new E(b.INVALID_ARGUMENT,a+i+l)}function TO(i,e){return i.some(t=>t.isEqual(e))}var wo=class{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new De(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document)if(this._converter){let e=new Ow(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}else return this._userDataWriter.convertValue(this._document.data.value);else return}get(e){if(this._document){let t=this._document.data.field(hp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ow=class extends wo{data(){return super.data()}};function hp(i,e){return typeof e=="string"?BS(i,e):e instanceof an?e._internalPath:e._delegate._internalPath}function xO(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new E(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Rd=class{},So=class extends Rd{};function Wn(i,e,...t){let n=[];e instanceof Rd&&n.push(e),n=n.concat(t),qW(n);for(let r of n)i=r._apply(i);return i}var Wm=class i extends So{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new i(e,t,n)}_apply(e){let t=this._parse(e);return DO(e._query,t),new At(e.firestore,e.converter,Jw(e._query,t))}_parse(e){let t=To(e.firestore);return NW(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function VS(i,e,t){let n=e,r=hp("where",i);return Wm._create(r,n,t)}var Nw=class i extends Rd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new i(e,t)}_parse(e){let t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:be.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(VW(e._query,t),new At(e.firestore,e.converter,Jw(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Pw=class i extends So{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new i(e,t)}_apply(e){let t=PW(e._query,this._field,this._direction);return new At(e.firestore,e.converter,lG(e._query,t))}};function US(i,e="asc"){let t=e,n=hp("orderBy",i);return Pw._create(n,t)}var Km=class i extends So{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new i(e,t,n)}_apply(e){return new At(e.firestore,e.converter,gm(e._query,this._limit,this._limitType))}};function qS(i){return aO("limit",i),Km._create("limit",i,"F")}function zS(i){return aO("limitToLast",i),Km._create("limitToLast",i,"L")}var Qm=class i extends So{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new i(e,t,n)}_apply(e){let t=IO(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,cG(e._query,t))}};function jS(...i){return Qm._create("startAt",i,!0)}function GS(...i){return Qm._create("startAfter",i,!1)}var Ym=class i extends So{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new i(e,t,n)}_apply(e){let t=IO(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,dG(e._query,t))}};function $S(...i){return Ym._create("endBefore",i,!1)}function HS(...i){return Ym._create("endAt",i,!0)}function IO(i,e,t,n){if(t[0]=qe(t[0]),t[0]instanceof wo)return FW(i._query,i.firestore._databaseId,e,t[0]._document,n);{let r=To(i.firestore);return LW(i._query,i.firestore._databaseId,r,e,t,n)}}function NW(i,e,t,n,r,s,o){let a;if(r.isKeyField()){if(s==="array-contains"||s==="array-contains-any")throw new E(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if(s==="in"||s==="not-in"){pk(o,s);let c=[];for(let d of o)c.push(mk(n,i,d));a={arrayValue:{values:c}}}else a=mk(n,i,o)}else(s==="in"||s==="not-in"||s==="array-contains-any")&&pk(o,s),a=SO(t,e,o,s==="in"||s==="not-in");return oe.create(r,s,a)}function PW(i,e,t){if(i.startAt!==null)throw new E(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new E(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fo(e,t)}function FW(i,e,t,n,r){if(!n)throw new E(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${t}().`);let s=[];for(let o of el(i))if(o.field.isKeyField())s.push(ho(e,n.key));else{let a=n.data.field(o.field);if(ip(a))throw new E(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(a!==null)s.push(a);else{let l=o.field.canonicalString();throw new E(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${l}' (used as the orderBy) does not exist.`)}}return new Gn(s,r)}function LW(i,e,t,n,r,s){let o=i.explicitOrderBy;if(r.length>o.length)throw new E(b.INVALID_ARGUMENT,`Too many arguments provided to ${n}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let a=[];for(let l=0;l<r.length;l++){let c=r[l];if(o[l].field.isKeyField()){if(typeof c!="string")throw new E(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${n}(), but got a ${typeof c}`);if(!Zw(i)&&c.indexOf("/")!==-1)throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${n}() must be a plain document ID, but '${c}' contains a slash.`);let u=i.path.child(me.fromString(c));if(!O.isDocumentKey(u))throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${n}() must result in a valid document path, but '${u}' is not because it contains an odd number of segments.`);let h=new O(u);a.push(ho(e,h))}else{let u=SO(t,n,c);a.push(u)}}return new Gn(a,s)}function mk(i,e,t){if(t=qe(t),typeof t=="string"){if(t==="")throw new E(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Zw(e)&&t.indexOf("/")!==-1)throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let n=e.path.child(me.fromString(t));if(!O.isDocumentKey(n))throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ho(i,new O(n))}else{if(t instanceof De)return ho(i,t._key);throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zd(t)}.`)}}function pk(i,e){if(!Array.isArray(i)||i.length===0)throw new E(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function BW(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function DO(i,e){let t=UW(i.filters,BW(e.op));if(t!==null)throw t===e.op?new E(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new E(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function VW(i,e){let t=i,n=e.getFlattenedFilters();for(let r of n)DO(t,r),t=Jw(t,r)}function UW(i,e){for(let t of i)for(let n of t.getFlattenedFilters())if(e.indexOf(n.op)>=0)return n.op;return null}function qW(i){let e=i.filter(n=>n instanceof Nw).length,t=i.filter(n=>n instanceof Wm).length;if(e>1||e>0&&t>0)throw new E(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}var hl=class{convertValue(e,t="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw B()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return Co(e,(r,s)=>{n[r]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new bo(Ye(e.latitude),Ye(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=Qw(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ld(e));default:return null}}convertTimestamp(e){let t=ds(e);return new je(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=me.fromString(e);z(AM(n));let r=new hs(n.get(1),n.get(3)),s=new O(n.popFirst(5));return r.isEqual(t)||ze(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function fp(i,e,t){let n;return i?t&&(t.merge||t.mergeFields)?n=i.toFirestore(e,t):n=i.toFirestore(e):n=e,n}var Fw=class extends hl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new De(this.firestore,null,t)}};function Lw(i){return zW(i,["next","error","complete"])}function zW(i,e){if(typeof i!="object"||i===null)return!1;let t=i;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}var mr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},qi=class extends wo{constructor(e,t,n,r,s,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document)if(this._converter){let t=new _s(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}else return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);else return}get(e,t={}){if(this._document){let n=this._document.data.field(hp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}},_s=class extends qi{data(e={}){return super.data(e)}},ln=class{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new mr(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new _s(this._firestore,this._userDataWriter,n.key,n,new mr(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new E(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return(!this._cachedChanges||this._cachedChangesIncludeMetadataChanges!==t)&&(this._cachedChanges=jW(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function jW(i,e){if(i._snapshot.oldDocs.isEmpty()){let t=0;return i._snapshot.docChanges.map(n=>{let r=new _s(i._firestore,i._userDataWriter,n.doc.key,n.doc,new mr(i._snapshot.mutatedKeys.has(n.doc.key),i._snapshot.fromCache),i.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}else{let t=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(n=>e||n.type!==3).map(n=>{let r=new _s(i._firestore,i._userDataWriter,n.doc.key,n.doc,new mr(i._snapshot.mutatedKeys.has(n.doc.key),i._snapshot.fromCache),i.query.converter),s=-1,o=-1;return n.type!==0&&(s=t.indexOf(n.doc.key),t=t.delete(n.doc.key)),n.type!==1&&(t=t.add(n.doc),o=t.indexOf(n.doc.key)),{type:GW(n.type),doc:r,oldIndex:s,newIndex:o}})}}function GW(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B()}}function mp(i,e){return i instanceof qi&&e instanceof qi?i._firestore===e._firestore&&i._key.isEqual(e._key)&&(i._document===null?e._document===null:i._document.isEqual(e._document))&&i._converter===e._converter:i instanceof ln&&e instanceof ln?i._firestore===e._firestore&&dp(i.query,e.query)&&i.metadata.isEqual(e.metadata)&&i._snapshot.isEqual(e._snapshot):!1}function WS(i){i=le(i,De);let e=le(i.firestore,Fe),t=gt(e);return uO(t,i._key).then(n=>iE(e,i,n))}var pr=class extends hl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new De(this.firestore,null,t)}};function KS(i){i=le(i,De);let e=le(i.firestore,Fe),t=gt(e),n=new pr(e);return aW(t,i._key).then(r=>new qi(e,n,i._key,r,new mr(r!==null&&r.hasLocalMutations,!0),i.converter))}function QS(i){i=le(i,De);let e=le(i.firestore,Fe),t=gt(e);return uO(t,i._key,{source:"server"}).then(n=>iE(e,i,n))}function YS(i){i=le(i,At);let e=le(i.firestore,Fe),t=gt(e),n=new pr(e);return xO(i._query),hO(t,i._query).then(r=>new ln(e,n,i,r))}function XS(i){i=le(i,At);let e=le(i.firestore,Fe),t=gt(e),n=new pr(e);return lW(t,i._query).then(r=>new ln(e,n,i,r))}function ZS(i){i=le(i,At);let e=le(i.firestore,Fe),t=gt(e),n=new pr(e);return hO(t,i._query,{source:"server"}).then(r=>new ln(e,n,i,r))}function pp(i,e,t){i=le(i,De);let n=le(i.firestore,Fe),r=fp(i.converter,e,t),s=To(n),a=up(s,"setDoc",i._key,r,i.converter!==null,t).toMutation(i._key,Qe.none());return Cl(n,[a])}function gp(i,e,t,...n){i=le(i,De);let r=le(i.firestore,Fe),s=To(r);e=qe(e);let o;typeof e=="string"||e instanceof an?o=FS(s,"updateDoc",i._key,e,t,n):o=PS(s,"updateDoc",i._key,e);let a=o.toMutation(i._key,Qe.exists(!0));return Cl(r,[a])}function JS(i){let e=le(i.firestore,Fe),t=[new ys(i._key,Qe.none())];return Cl(e,t)}function eE(i,e){let t=le(i.firestore,Fe),n=Sl(i),r=fp(i.converter,e),s=To(i.firestore),a=up(s,"addDoc",n._key,r,i.converter!==null,{}).toMutation(n._key,Qe.exists(!1));return Cl(t,[a]).then(()=>n)}function El(i,...e){var t,n,r;i=qe(i);let s={includeMetadataChanges:!1},o=0;typeof e[o]=="object"&&!Lw(e[o])&&(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(Lw(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let l,c,d;if(i instanceof De)c=le(i.firestore,Fe),d=yl(i._key.path),l={next:h=>{e[o]&&e[o](iE(c,i,h))},error:e[o+1],complete:e[o+2]};else{let h=le(i,At);c=le(h.firestore,Fe),d=h._query;let m=new pr(c);l={next:g=>{e[o]&&e[o](new ln(c,m,h,g))},error:e[o+1],complete:e[o+2]},xO(i._query)}let u=gt(c);return oW(u,d,a,l)}function tE(i,e){i=le(i,Fe);let t=gt(i),n=Lw(e)?e:{next:e};return dW(t,n)}function Cl(i,e){let t=gt(i);return cW(t,e)}function iE(i,e,t){let n=t.docs.get(e._key),r=new pr(i);return new qi(i,r,e._key,n,new mr(t.hasPendingWrites,t.fromCache),e.converter)}var $W={maxAttempts:5};function HW(i){if(i.maxAttempts<1)throw new E(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}var Xm=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=To(e)}set(e,t,n){this._verifyNotCommitted();let r=os(e,this._firestore),s=fp(r.converter,t,n),o=up(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,n);return this._mutations.push(o.toMutation(r._key,Qe.none())),this}update(e,t,n,...r){this._verifyNotCommitted();let s=os(e,this._firestore);t=qe(t);let o;return typeof t=="string"||t instanceof an?o=FS(this._dataReader,"WriteBatch.update",s._key,t,n,r):o=PS(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Qe.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=os(e,this._firestore);return this._mutations=this._mutations.concat(new ys(t._key,Qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new E(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function os(i,e){if(i=qe(i),i.firestore!==e)throw new E(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return i}var Bw=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=To(e)}get(e){let t=os(e,this._firestore),n=new Fw(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||r.length!==1)return B();let s=r[0];if(s.isFoundDocument())return new wo(this._firestore,n,s.key,s,t.converter);if(s.isNoDocument())return new wo(this._firestore,n,t._key,null,t.converter);throw B()})}set(e,t,n){let r=os(e,this._firestore),s=fp(r.converter,t,n),o=up(this._dataReader,"Transaction.set",r._key,s,r.converter!==null,n);return this._transaction.set(r._key,o),this}update(e,t,n,...r){let s=os(e,this._firestore);t=qe(t);let o;return typeof t=="string"||t instanceof an?o=FS(this._dataReader,"Transaction.update",s._key,t,n,r):o=PS(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){let t=os(e,this._firestore);return this._transaction.delete(t._key),this}};var Vw=class extends Bw{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=os(e,this._firestore),n=new pr(this._firestore);return super.get(e).then(r=>new qi(this._firestore,n,t._key,r._document,new mr(!1,!1),t.converter))}};function nE(i,e,t){i=le(i,Fe);let n=Object.assign(Object.assign({},$W),t);HW(n);let r=gt(i);return uW(r,s=>e(new Vw(i,s)),n)}function rE(){return new Ad("deleteField")}function sE(){return new Dw("serverTimestamp")}function oE(...i){return new Aw("arrayUnion",i)}function aE(...i){return new Rw("arrayRemove",i)}function lE(i){return new kw("increment",i)}DW("node");var yp=function(){return yp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},yp.apply(this,arguments)};var KW={includeMetadataChanges:!1};function AO(i,e){return e===void 0&&(e=KW),new mt(function(t){var n=El(i,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:n}})}function RO(i,e){var t;e===void 0&&(e={});var n=i.data(e);return!i.exists()||typeof n!="object"||n===null||!e.idField?n:yp(yp({},n),(t={},t[e.idField]=i.id,t))}function kO(i){return AO(i,{includeMetadataChanges:!0}).pipe(pe(function(e){return e.docs}))}function MO(i,e){return e===void 0&&(e={}),kO(i).pipe(pe(function(t){return t.map(function(n){return RO(n,e)})}))}var Io=class{constructor(e){return e}},OO="firestore",cE=class{constructor(){return zl(OO)}};var dE=new W("angularfire2.firestore-instances");function QW(i,e){let t=Eg(OO,i,e);return t&&new Io(t)}function YW(i){return(e,t)=>{let n=e.runOutsideAngular(()=>i(t));return new Io(n)}}var XW={provide:cE,deps:[[new Gi,dE]]},ZW={provide:Io,useFactory:QW,deps:[[new Gi,dE],Fs]},JW=(()=>{class i{constructor(){Kt("angularfire",Ti.full,"fst")}static \u0275fac=function(n){return new(n||i)};static \u0275mod=ee({type:i});static \u0275inj=J({providers:[ZW,XW]})}return i})();function NO(i,...e){return{ngModule:JW,providers:[{provide:dE,useFactory:YW(i),multi:!0,deps:[se,Ol,Zn,jl,[new Gi,Cu],[new Gi,_n],...e]}]}}var PO=Ps(MO,!0);var FO=Ps(jd,!0);var LO=Ps(gO,!0);function eK(){return!0}var tK=new W("mat-sanity-checks",{providedIn:"root",factory:eK}),ni=(()=>{let e=class e{constructor(n,r,s){this._sanityChecks=r,this._document=s,this._hasDoneGlobalChecks=!1,n._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return kC()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[n]}};e.\u0275fac=function(r){return new(r||e)(N(zC),N(tK,8),N(lt))},e.\u0275mod=ee({type:e}),e.\u0275inj=J({imports:[dg,dg]});let i=e;return i})();function vp(i,e){return class extends i{get color(){return this._color}set color(t){let n=t||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function GO(i){return class extends i{updateErrorState(){let e=this.errorState,t=this._parentFormGroup||this._parentForm,n=this.errorStateMatcher||this._defaultErrorStateMatcher,r=this.ngControl?this.ngControl.control:null,s=n.isErrorState(r,t);s!==e&&(this.errorState=s,this.stateChanges.next())}constructor(...e){super(...e),this.errorState=!1}}}var $O=(()=>{let e=class e{isErrorState(n,r){return!!(n&&n.invalid&&(n.touched||r&&r.submitted))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var uE=class{constructor(e,t,n,r=!1){this._renderer=e,this.element=t,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}},BO=Xn({passive:!0,capture:!0}),hE=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let t=ks(e);t&&this._events.get(e.type)?.forEach((n,r)=>{(r===t||r.contains(t))&&n.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,n,r){let s=this._events.get(t);if(s){let o=s.get(n);o?o.add(r):s.set(n,new Set([r]))}else this._events.set(t,new Map([[n,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,BO)})}removeHandler(e,t,n){let r=this._events.get(e);if(!r)return;let s=r.get(t);s&&(s.delete(n),s.size===0&&r.delete(t),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,BO)))}},VO={enterDuration:225,exitDuration:150},iK=800,UO=Xn({passive:!0,capture:!0}),qO=["mousedown","touchstart"],zO=["mouseup","mouseleave","touchend","touchcancel"],$d=class $d{constructor(e,t,n,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=He(n))}fadeInRipple(e,t,n={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=yt(yt({},VO),n.animation);n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);let o=n.radius||nK(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=`${a-o}px`,d.style.top=`${l-o}px`,d.style.height=`${o*2}px`,d.style.width=`${o*2}px`,n.color!=null&&(d.style.backgroundColor=n.color),d.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(d);let u=window.getComputedStyle(d),h=u.transitionProperty,m=u.transitionDuration,g=h==="none"||m==="0s"||m==="0s, 0s"||r.width===0&&r.height===0,_=new uE(this,d,n,g);d.style.transform="scale3d(1, 1, 1)",_.state=0,n.persistent||(this._mostRecentTransientRipple=_);let y=null;return!g&&(c||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let A=()=>this._finishRippleTransition(_),w=()=>this._destroyRipple(_);d.addEventListener("transitionend",A),d.addEventListener("transitioncancel",w),y={onTransitionEnd:A,onTransitionCancel:w}}),this._activeRipples.set(_,y),(g||!c)&&this._finishRippleTransition(_),_}fadeOutRipple(e){if(e.state===2||e.state===3)return;let t=e.element,n=yt(yt({},VO),e.config.animation);t.style.transitionDuration=`${n.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let t=He(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,qO.forEach(n=>{$d._eventManager.addHandler(this._ngZone,n,t,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{zO.forEach(t=>{this._triggerElement.addEventListener(t,this,UO)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===0?this._startFadeOutTransition(e):e.state===2&&this._destroyRipple(e)}_startFadeOutTransition(e){let t=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=1,!n&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,t!==null&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){let t=mu(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+iK;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!pu(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let t=e.changedTouches;if(t)for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let t=e.state===1||e.config.terminateOnPointerUp&&e.state===0;!e.config.persistent&&t&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(qO.forEach(t=>$d._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&zO.forEach(t=>e.removeEventListener(t,this,UO)))}};$d._eventManager=new hE;var jO=$d;function nK(i,e,t){let n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+r*r)}var sK=["*",[["mat-toolbar-row"]]],oK=["*","mat-toolbar-row"],aK=vp(class{constructor(i){this._elementRef=i}}),lK=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Le({type:e,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]});let i=e;return i})(),HO=(()=>{let e=class e extends aK{constructor(n,r,s){super(n),this._platform=r,this._document=s}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}};e.\u0275fac=function(r){return new(r||e)(V(Be),V(Ft),V(lt))},e.\u0275cmp=mi({type:e,selectors:[["mat-toolbar"]],contentQueries:function(r,s,o){if(r&1&&ai(o,lK,5),r&2){let a;Ve(a=Ue())&&(s._toolbarRows=a)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(r,s){r&2&&Ze("mat-toolbar-multiple-rows",s._toolbarRows.length>0)("mat-toolbar-single-row",s._toolbarRows.length===0)},inputs:{color:"color"},exportAs:["matToolbar"],features:[mn],ngContentSelectors:oK,decls:2,vars:0,template:function(r,s){r&1&&($i(sK),at(0),at(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0});let i=e;return i})();var WO=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({imports:[ni,ni]});let i=e;return i})();var dK=["*"],_p;function uK(){if(_p===void 0&&(_p=null,typeof window<"u")){let i=window;i.trustedTypes!==void 0&&(_p=i.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return _p}function Hd(i){return uK()?.createHTML(i)||i}function KO(i){return Error(`Unable to find icon with the name "${i}"`)}function hK(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}function QO(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function YO(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}var yr=class{constructor(e,t,n){this.url=e,this.svgText=t,this.options=n}},fK=(()=>{let e=class e{constructor(n,r,s,o){this._httpClient=n,this._sanitizer=r,this._errorHandler=o,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=s}addSvgIcon(n,r,s){return this.addSvgIconInNamespace("",n,r,s)}addSvgIconLiteral(n,r,s){return this.addSvgIconLiteralInNamespace("",n,r,s)}addSvgIconInNamespace(n,r,s,o){return this._addSvgIconConfig(n,r,new yr(s,null,o))}addSvgIconResolver(n){return this._resolvers.push(n),this}addSvgIconLiteralInNamespace(n,r,s,o){let a=this._sanitizer.sanitize(Po.HTML,s);if(!a)throw YO(s);let l=Hd(a);return this._addSvgIconConfig(n,r,new yr("",l,o))}addSvgIconSet(n,r){return this.addSvgIconSetInNamespace("",n,r)}addSvgIconSetLiteral(n,r){return this.addSvgIconSetLiteralInNamespace("",n,r)}addSvgIconSetInNamespace(n,r,s){return this._addSvgIconSetConfig(n,new yr(r,null,s))}addSvgIconSetLiteralInNamespace(n,r,s){let o=this._sanitizer.sanitize(Po.HTML,r);if(!o)throw YO(r);let a=Hd(o);return this._addSvgIconSetConfig(n,new yr("",a,s))}registerFontClassAlias(n,r=n){return this._fontCssClassesByAlias.set(n,r),this}classNameForFontAlias(n){return this._fontCssClassesByAlias.get(n)||n}setDefaultFontSetClass(...n){return this._defaultFontSetClass=n,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(n){let r=this._sanitizer.sanitize(Po.RESOURCE_URL,n);if(!r)throw QO(n);let s=this._cachedIconsByUrl.get(r);return s?Ot(bp(s)):this._loadSvgIconFromConfig(new yr(n,null)).pipe(wr(o=>this._cachedIconsByUrl.set(r,o)),pe(o=>bp(o)))}getNamedSvgIcon(n,r=""){let s=XO(r,n),o=this._svgIconConfigs.get(s);if(o)return this._getSvgFromConfig(o);if(o=this._getIconConfigFromResolvers(r,n),o)return this._svgIconConfigs.set(s,o),this._getSvgFromConfig(o);let a=this._iconSetConfigs.get(r);return a?this._getSvgFromIconSetConfigs(n,a):QE(KO(s))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(n){return n.svgText?Ot(bp(this._svgElementFromConfig(n))):this._loadSvgIconFromConfig(n).pipe(pe(r=>bp(r)))}_getSvgFromIconSetConfigs(n,r){let s=this._extractIconWithNameFromAnySet(n,r);if(s)return Ot(s);let o=r.filter(a=>!a.svgText).map(a=>this._loadSvgIconSetFromConfig(a).pipe(JE(l=>{let d=`Loading icon set URL: ${this._sanitizer.sanitize(Po.RESOURCE_URL,a.url)} failed: ${l.message}`;return this._errorHandler.handleError(new Error(d)),Ot(null)})));return tu(o).pipe(pe(()=>{let a=this._extractIconWithNameFromAnySet(n,r);if(!a)throw KO(n);return a}))}_extractIconWithNameFromAnySet(n,r){for(let s=r.length-1;s>=0;s--){let o=r[s];if(o.svgText&&o.svgText.toString().indexOf(n)>-1){let a=this._svgElementFromConfig(o),l=this._extractSvgIconFromSet(a,n,o.options);if(l)return l}}return null}_loadSvgIconFromConfig(n){return this._fetchIcon(n).pipe(wr(r=>n.svgText=r),pe(()=>this._svgElementFromConfig(n)))}_loadSvgIconSetFromConfig(n){return n.svgText?Ot(null):this._fetchIcon(n).pipe(wr(r=>n.svgText=r))}_extractSvgIconFromSet(n,r,s){let o=n.querySelector(`[id="${r}"]`);if(!o)return null;let a=o.cloneNode(!0);if(a.removeAttribute("id"),a.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(a,s);if(a.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(a),s);let l=this._svgElementFromString(Hd("<svg></svg>"));return l.appendChild(a),this._setSvgAttributes(l,s)}_svgElementFromString(n){let r=this._document.createElement("DIV");r.innerHTML=n;let s=r.querySelector("svg");if(!s)throw Error("<svg> tag not found");return s}_toSvgElement(n){let r=this._svgElementFromString(Hd("<svg></svg>")),s=n.attributes;for(let o=0;o<s.length;o++){let{name:a,value:l}=s[o];a!=="id"&&r.setAttribute(a,l)}for(let o=0;o<n.childNodes.length;o++)n.childNodes[o].nodeType===this._document.ELEMENT_NODE&&r.appendChild(n.childNodes[o].cloneNode(!0));return r}_setSvgAttributes(n,r){return n.setAttribute("fit",""),n.setAttribute("height","100%"),n.setAttribute("width","100%"),n.setAttribute("preserveAspectRatio","xMidYMid meet"),n.setAttribute("focusable","false"),r&&r.viewBox&&n.setAttribute("viewBox",r.viewBox),n}_fetchIcon(n){let{url:r,options:s}=n,o=s?.withCredentials??!1;if(!this._httpClient)throw hK();if(r==null)throw Error(`Cannot fetch icon from URL "${r}".`);let a=this._sanitizer.sanitize(Po.RESOURCE_URL,r);if(!a)throw QO(r);let l=this._inProgressUrlFetches.get(a);if(l)return l;let c=this._httpClient.get(a,{responseType:"text",withCredentials:o}).pipe(pe(d=>Hd(d)),tC(()=>this._inProgressUrlFetches.delete(a)),nC());return this._inProgressUrlFetches.set(a,c),c}_addSvgIconConfig(n,r,s){return this._svgIconConfigs.set(XO(n,r),s),this}_addSvgIconSetConfig(n,r){let s=this._iconSetConfigs.get(n);return s?s.push(r):this._iconSetConfigs.set(n,[r]),this}_svgElementFromConfig(n){if(!n.svgElement){let r=this._svgElementFromString(n.svgText);this._setSvgAttributes(r,n.options),n.svgElement=r}return n.svgElement}_getIconConfigFromResolvers(n,r){for(let s=0;s<this._resolvers.length;s++){let o=this._resolvers[s](r,n);if(o)return mK(o)?new yr(o.url,null,o.options):new yr(o,null)}}};e.\u0275fac=function(r){return new(r||e)(N(uC,8),N(fC),N(lt,8),N(ou))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function bp(i){return i.cloneNode(!0)}function XO(i,e){return i+":"+e}function mK(i){return!!(i.url&&i.options)}var pK=vp(class{constructor(i){this._elementRef=i}}),gK=new W("MAT_ICON_DEFAULT_OPTIONS"),yK=new W("mat-icon-location",{providedIn:"root",factory:vK});function vK(){let i=Nt(lt),e=i?i.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}var ZO=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],_K=ZO.map(i=>`[${i}]`).join(", "),bK=/^url\(['"]?#(.*?)['"]?\)$/,JO=(()=>{let e=class e extends pK{get inline(){return this._inline}set inline(n){this._inline=Yn(n)}get svgIcon(){return this._svgIcon}set svgIcon(n){n!==this._svgIcon&&(n?this._updateSvgIcon(n):this._svgIcon&&this._clearSvgElement(),this._svgIcon=n)}get fontSet(){return this._fontSet}set fontSet(n){let r=this._cleanupFontValue(n);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(n){let r=this._cleanupFontValue(n);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}constructor(n,r,s,o,a,l){super(n),this._iconRegistry=r,this._location=o,this._errorHandler=a,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=zi.EMPTY,l&&(l.color&&(this.color=this.defaultColor=l.color),l.fontSet&&(this.fontSet=l.fontSet)),s||n.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(n){if(!n)return["",""];let r=n.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${n}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let n=this._elementsWithExternalReferences;if(n&&n.size){let r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(n){this._clearSvgElement();let r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(n),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(n)}_clearSvgElement(){let n=this._elementRef.nativeElement,r=n.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){let s=n.childNodes[r];(s.nodeType!==1||s.nodeName.toLowerCase()==="svg")&&s.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let n=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(s=>s.length>0);this._previousFontSetClass.forEach(s=>n.classList.remove(s)),r.forEach(s=>n.classList.add(s)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&n.classList.remove(this._previousFontIconClass),this.fontIcon&&n.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(n){return typeof n=="string"?n.trim().split(" ")[0]:n}_prependPathToReferences(n){let r=this._elementsWithExternalReferences;r&&r.forEach((s,o)=>{s.forEach(a=>{o.setAttribute(a.name,`url('${n}#${a.value}')`)})})}_cacheChildrenWithExternalReferences(n){let r=n.querySelectorAll(_K),s=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let o=0;o<r.length;o++)ZO.forEach(a=>{let l=r[o],c=l.getAttribute(a),d=c?c.match(bK):null;if(d){let u=s.get(l);u||(u=[],s.set(l,u)),u.push({name:a,value:d[1]})}})}_updateSvgIcon(n){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),n){let[r,s]=this._splitIconName(n);r&&(this._svgNamespace=r),s&&(this._svgName=s),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(s,r).pipe(Ds(1)).subscribe(o=>this._setSvgElement(o),o=>{let a=`Error retrieving icon ${r}:${s}! ${o.message}`;this._errorHandler.handleError(new Error(a))})}}};e.\u0275fac=function(r){return new(r||e)(V(Be),V(fK),Zp("aria-hidden"),V(yK),V(ou),V(gK,8))},e.\u0275cmp=mi({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(r,s){r&2&&(Ci("data-mat-icon-type",s._usingFontIcon()?"font":"svg")("data-mat-icon-name",s._svgName||s.fontIcon)("data-mat-icon-namespace",s._svgNamespace||s.fontSet)("fontIcon",s._usingFontIcon()?s.fontIcon:null),Ze("mat-icon-inline",s.inline)("mat-icon-no-color",s.color!=="primary"&&s.color!=="accent"&&s.color!=="warn"))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[mn],ngContentSelectors:dK,decls:1,vars:0,template:function(r,s){r&1&&($i(),at(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0});let i=e;return i})(),eN=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({imports:[ni,ni]});let i=e;return i})();var SK=["*"];var EK=new W("MAT_CARD_CONFIG"),tN=(()=>{let e=class e{constructor(n){this.appearance=n?.appearance||"raised"}};e.\u0275fac=function(r){return new(r||e)(V(EK,8))},e.\u0275cmp=mi({type:e,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(r,s){r&2&&Ze("mat-mdc-card-outlined",s.appearance==="outlined")("mdc-card--outlined",s.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:SK,decls:1,vars:0,template:function(r,s){r&1&&($i(),at(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{color:rgba(0, 0, 0, 0.6);flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mdc-card__action--icon:not(:disabled){color:rgba(0, 0, 0, 0.6)}.mat-mdc-card{border-radius:var(--mdc-elevated-card-container-shape);background-color:var(--mdc-elevated-card-container-color);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color);box-shadow:var(--mdc-elevated-card-container-elevation)}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape)}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width);border-style:solid;border-color:var(--mdc-outlined-card-outline-color);border-radius:var(--mdc-outlined-card-container-shape);background-color:var(--mdc-outlined-card-container-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.mat-mdc-card-outlined .mdc-card::after{border-radius:var(--mdc-outlined-card-container-shape)}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font);line-height:var(--mat-card-title-text-line-height);font-size:var(--mat-card-title-text-size);letter-spacing:var(--mat-card-title-text-tracking);font-weight:var(--mat-card-title-text-weight)}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color);font-family:var(--mat-card-subtitle-text-font);line-height:var(--mat-card-subtitle-text-line-height);font-size:var(--mat-card-subtitle-text-size);letter-spacing:var(--mat-card-subtitle-text-tracking);font-weight:var(--mat-card-subtitle-text-weight)}.mat-mdc-card{position:relative}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0});let i=e;return i})();var iN=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({imports:[ni,lu,ni]});let i=e;return i})();var nN=Xn({passive:!0}),rN=(()=>{let e=class e{constructor(n,r){this._platform=n,this._ngZone=r,this._monitoredElements=new Map}monitor(n){if(!this._platform.isBrowser)return KE;let r=He(n),s=this._monitoredElements.get(r);if(s)return s.subject;let o=new te,a="cdk-text-field-autofilled",l=c=>{c.animationName==="cdk-text-field-autofill-start"&&!r.classList.contains(a)?(r.classList.add(a),this._ngZone.run(()=>o.next({target:c.target,isAutofilled:!0}))):c.animationName==="cdk-text-field-autofill-end"&&r.classList.contains(a)&&(r.classList.remove(a),this._ngZone.run(()=>o.next({target:c.target,isAutofilled:!1})))};return this._ngZone.runOutsideAngular(()=>{r.addEventListener("animationstart",l,nN),r.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(r,{subject:o,unlisten:()=>{r.removeEventListener("animationstart",l,nN)}}),o}stopMonitoring(n){let r=He(n),s=this._monitoredElements.get(r);s&&(s.unlisten(),s.subject.complete(),r.classList.remove("cdk-text-field-autofill-monitored"),r.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(r))}ngOnDestroy(){this._monitoredElements.forEach((n,r)=>this.stopMonitoring(r))}};e.\u0275fac=function(r){return new(r||e)(N(Ft),N(se))},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var sN=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({});let i=e;return i})();function Ts(i){return i==null||(typeof i=="string"||Array.isArray(i))&&i.length===0}function hN(i){return i!=null&&typeof i.length=="number"}var fN=new W("NgValidators"),mN=new W("NgAsyncValidators"),xK=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Sp=class{static min(e){return IK(e)}static max(e){return DK(e)}static required(e){return AK(e)}static requiredTrue(e){return RK(e)}static email(e){return kK(e)}static minLength(e){return MK(e)}static maxLength(e){return OK(e)}static pattern(e){return NK(e)}static nullValidator(e){return pN(e)}static compose(e){return wN(e)}static composeAsync(e){return SN(e)}};function IK(i){return e=>{if(Ts(e.value)||Ts(i))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<i?{min:{min:i,actual:e.value}}:null}}function DK(i){return e=>{if(Ts(e.value)||Ts(i))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>i?{max:{max:i,actual:e.value}}:null}}function AK(i){return Ts(i.value)?{required:!0}:null}function RK(i){return i.value===!0?null:{required:!0}}function kK(i){return Ts(i.value)||xK.test(i.value)?null:{email:!0}}function MK(i){return e=>Ts(e.value)||!hN(e.value)?null:e.value.length<i?{minlength:{requiredLength:i,actualLength:e.value.length}}:null}function OK(i){return e=>hN(e.value)&&e.value.length>i?{maxlength:{requiredLength:i,actualLength:e.value.length}}:null}function NK(i){if(!i)return pN;let e,t;return typeof i=="string"?(t="",i.charAt(0)!=="^"&&(t+="^"),t+=i,i.charAt(i.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=i.toString(),e=i),n=>{if(Ts(n.value))return null;let r=n.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function pN(i){return null}function gN(i){return i!=null}function yN(i){return oC(i)?ji(i):i}function vN(i){let e={};return i.forEach(t=>{e=t!=null?yt(yt({},e),t):e}),Object.keys(e).length===0?null:e}function _N(i,e){return e.map(t=>t(i))}function PK(i){return!i.validate}function bN(i){return i.map(e=>PK(e)?e:t=>e.validate(t))}function wN(i){if(!i)return null;let e=i.filter(gN);return e.length==0?null:function(t){return vN(_N(t,e))}}function pE(i){return i!=null?wN(bN(i)):null}function SN(i){if(!i)return null;let e=i.filter(gN);return e.length==0?null:function(t){let n=_N(t,e).map(yN);return tu(n).pipe(pe(vN))}}function gE(i){return i!=null?SN(bN(i)):null}function oN(i,e){return i===null?[e]:Array.isArray(i)?[...i,e]:[i,e]}function EN(i){return i._rawValidators}function CN(i){return i._rawAsyncValidators}function fE(i){return i?Array.isArray(i)?i:[i]:[]}function Ep(i,e){return Array.isArray(i)?i.includes(e):i===e}function aN(i,e){let t=fE(e);return fE(i).forEach(r=>{Ep(t,r)||t.push(r)}),t}function lN(i,e){return fE(e).filter(t=>!Ep(i,t))}var Cp=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=pE(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=gE(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},xl=class extends Cp{get formDirective(){return null}get path(){return null}},Tp=class extends Cp{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}};var FK={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Xte=dn(yt({},FK),{"[class.ng-submitted]":"isSubmitted"});var Wd="VALID",wp="INVALID",Tl="PENDING",Kd="DISABLED";function TN(i){return(Rp(i)?i.validators:i)||null}function LK(i){return Array.isArray(i)?pE(i):i||null}function xN(i,e){return(Rp(e)?e.asyncValidators:i)||null}function BK(i){return Array.isArray(i)?gE(i):i||null}function Rp(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function VK(i,e,t){let n=i.controls;if(!(e?Object.keys(n):n).length)throw new nu(1e3,"");if(!n[t])throw new nu(1001,"")}function UK(i,e,t){i._forEachChild((n,r)=>{if(t[r]===void 0)throw new nu(1002,"")})}var xp=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Wd}get invalid(){return this.status===wp}get pending(){return this.status==Tl}get disabled(){return this.status===Kd}get enabled(){return this.status!==Kd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(aN(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(aN(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(lN(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(lN(e,this._rawAsyncValidators))}hasValidator(e){return Ep(this._rawValidators,e)}hasAsyncValidator(e){return Ep(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Tl,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Kd,this.errors=null,this._forEachChild(n=>{n.disable(dn(yt({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(dn(yt({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Wd,this._forEachChild(n=>{n.enable(dn(yt({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(dn(yt({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Wd||this.status===Tl)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Kd:Wd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Tl,this._hasOwnPendingAsyncValidator=!0;let t=yN(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ot,this.statusChanges=new ot}_calculateStatus(){return this._allControlsDisabled()?Kd:this.errors?wp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Tl)?Tl:this._anyControlsHaveStatus(wp)?wp:Wd}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Rp(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=LK(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=BK(this._rawAsyncValidators)}},Ip=class extends xp{constructor(e,t,n){super(TN(t),xN(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){UK(this,!0,e),Object.keys(e).forEach(n=>{VK(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(n=>{let r=this.controls[n];r&&r.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>n._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,n,r)=>((n.enabled||this.disabled)&&(t[r]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((r,s)=>{n=t(n,r,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var IN=new W("CallSetDisabledState",{providedIn:"root",factory:()=>DN}),DN="always";function mE(i,e,t=DN){yE(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(i.disabled),zK(i,e),GK(i,e),jK(i,e),qK(i,e)}function cN(i,e,t=!0){let n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),Ap(i,e),i&&(e._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function Dp(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function qK(i,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}function yE(i,e){let t=EN(i);e.validator!==null?i.setValidators(oN(t,e.validator)):typeof t=="function"&&i.setValidators([t]);let n=CN(i);e.asyncValidator!==null?i.setAsyncValidators(oN(n,e.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();Dp(e._rawValidators,r),Dp(e._rawAsyncValidators,r)}function Ap(i,e){let t=!1;if(i!==null){if(e.validator!==null){let r=EN(i);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.validator);s.length!==r.length&&(t=!0,i.setValidators(s))}}if(e.asyncValidator!==null){let r=CN(i);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.asyncValidator);s.length!==r.length&&(t=!0,i.setAsyncValidators(s))}}}let n=()=>{};return Dp(e._rawValidators,n),Dp(e._rawAsyncValidators,n),t}function zK(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&AN(i,e)})}function jK(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&AN(i,e),i.updateOn!=="submit"&&i.markAsTouched()})}function AN(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function GK(i,e){let t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}function RN(i,e){i==null,yE(i,e)}function $K(i,e){return Ap(i,e)}function kN(i,e){i._syncPendingControls(),e.forEach(t=>{let n=t.control;n.updateOn==="submit"&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function HK(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}var WK={provide:xl,useExisting:Xp(()=>vE)},Qd=(()=>Promise.resolve())(),vE=(()=>{let e=class e extends xl{constructor(n,r,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new ot,this.form=new Ip({},pE(n),gE(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){Qd.then(()=>{let r=this._findContainer(n.path);n.control=r.registerControl(n.name,n.control),mE(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){Qd.then(()=>{let r=this._findContainer(n.path);r&&r.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){Qd.then(()=>{let r=this._findContainer(n.path),s=new Ip({});RN(s,n),r.registerControl(n.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){Qd.then(()=>{let r=this._findContainer(n.path);r&&r.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,r){Qd.then(()=>{this.form.get(n.path).setValue(r)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,kN(this.form,this._directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}};e.\u0275fac=function(r){return new(r||e)(V(fN,10),V(mN,10),V(IN,8))},e.\u0275dir=Le({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,s){r&1&&oi("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pi([WK]),mn]});let i=e;return i})();function dN(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function uN(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var KK=class extends xp{constructor(e=null,t,n){super(TN(t),xN(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Rp(t)&&(t.nonNullable||t.initialValueIsDefault)&&(uN(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){dN(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){dN(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){uN(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var QK=i=>i instanceof KK;var YK={provide:xl,useExisting:Xp(()=>_E)},_E=(()=>{let e=class e extends xl{constructor(n,r,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ot,this._setValidators(n),this._setAsyncValidators(r)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Ap(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){let r=this.form.get(n.path);return mE(r,n,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),r}getControl(n){return this.form.get(n.path)}removeControl(n){cN(n.control||null,n,!1),HK(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,r){this.form.get(n.path).setValue(r)}onSubmit(n){return this.submitted=!0,kN(this.form,this.directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{let r=n.control,s=this.form.get(n.path);r!==s&&(cN(r||null,n),QK(s)&&(mE(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){let r=this.form.get(n.path);RN(r,n),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){let r=this.form.get(n.path);r&&$K(r,n)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){yE(this.form,this),this._oldForm&&Ap(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(r){return new(r||e)(V(fN,10),V(mN,10),V(IN,8))},e.\u0275dir=Le({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,s){r&1&&oi("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pi([YK]),mn,Sr]});let i=e;return i})();var bE=class{constructor(e){this._box=e,this._destroyed=new te,this._resizeSubject=new te,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(t=>this._resizeSubject.next(t)))}observe(e){return this._elementObservables.has(e)||this._elementObservables.set(e,new mt(t=>{let n=this._resizeSubject.subscribe(t);return this._resizeObserver?.observe(e,{box:this._box}),()=>{this._resizeObserver?.unobserve(e),n.unsubscribe(),this._elementObservables.delete(e)}}).pipe(un(t=>t.some(n=>n.target===e)),No({bufferSize:1,refCount:!0}),si(this._destroyed))),this._elementObservables.get(e)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},MN=(()=>{let e=class e{constructor(){this._observers=new Map,this._ngZone=Nt(se),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,n]of this._observers)n.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(n,r){let s=r?.box||"content-box";return this._observers.has(s)||this._observers.set(s,new bE(s)),this._observers.get(s).observe(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ue({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var JK=["notch"],e8=["matFormFieldNotchedOutline",""],t8=["*"],i8=["textField"],n8=["iconPrefixContainer"],r8=["textPrefixContainer"];function s8(i,e){i&1&&Qn(0,"span",16)}function o8(i,e){if(i&1&&(ye(0,"label",14),at(1,1),pt(2,s8,1,0,"span",15),ve()),i&2){let t=pn(2);Pt("floating",t._shouldLabelFloat())("monitorResize",t._hasOutline())("id",t._labelId),Ci("for",t._control.id),Se(2),Wt(2,!t.hideRequiredMarker&&t._control.required?2:-1)}}function a8(i,e){if(i&1&&pt(0,o8,3,5,"label",14),i&2){let t=pn();Wt(0,t._hasFloatingLabel()?0:-1)}}function l8(i,e){i&1&&Qn(0,"div",17)}function c8(i,e){}function d8(i,e){if(i&1&&pt(0,c8,0,0,"ng-template",9),i&2){pn(2);let t=As(1);Pt("ngTemplateOutlet",t)}}function u8(i,e){if(i&1&&(ye(0,"div",5),pt(1,d8,1,1,null,9),ve()),i&2){let t=pn();Pt("matFormFieldNotchedOutlineOpen",t._shouldLabelFloat()),Se(1),Wt(1,t._forceDisplayInfixLabel()?-1:1)}}function h8(i,e){i&1&&(ye(0,"div",18,19),at(2,2),ve())}function f8(i,e){i&1&&(ye(0,"div",20,21),at(2,3),ve())}function m8(i,e){}function p8(i,e){if(i&1&&pt(0,m8,0,0,"ng-template",9),i&2){pn();let t=As(1);Pt("ngTemplateOutlet",t)}}function g8(i,e){i&1&&(ye(0,"div",22),at(1,4),ve())}function y8(i,e){i&1&&(ye(0,"div",23),at(1,5),ve())}function v8(i,e){i&1&&Qn(0,"div",12)}function _8(i,e){if(i&1&&(ye(0,"div",24),at(1,6),ve()),i&2){let t=pn();Pt("@transitionMessages",t._subscriptAnimationState)}}function b8(i,e){if(i&1&&(ye(0,"mat-hint",26),gn(1),ve()),i&2){let t=pn(2);Pt("id",t._hintLabelId),Se(1),Fo(t.hintLabel)}}function w8(i,e){if(i&1&&(ye(0,"div",25),pt(1,b8,2,2,"mat-hint",26),at(2,7),Qn(3,"div",27),at(4,8),ve()),i&2){let t=pn();Pt("@transitionMessages",t._subscriptAnimationState),Se(1),Wt(1,t.hintLabel?1:-1)}}var S8=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],E8=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"],Mp=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Le({type:e,selectors:[["mat-label"]]});let i=e;return i})();var C8=new W("MatError");var T8=0,ON=(()=>{let e=class e{constructor(){this.align="start",this.id=`mat-mdc-hint-${T8++}`}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Le({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(r,s){r&2&&(Nl("id",s.id),Ci("align",null),Ze("mat-mdc-form-field-hint-end",s.align==="end"))},inputs:{align:"align",id:"id"}});let i=e;return i})(),x8=new W("MatPrefix");var I8=new W("MatSuffix");var qN=new W("FloatingLabelParent"),NN=(()=>{let e=class e{get floating(){return this._floating}set floating(n){this._floating=n,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(n){this._monitorResize=n,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(n){this._elementRef=n,this._floating=!1,this._monitorResize=!1,this._resizeObserver=Nt(MN),this._ngZone=Nt(se),this._parent=Nt(qN),this._resizeSubscription=new zi}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return D8(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}};e.\u0275fac=function(r){return new(r||e)(V(Be))},e.\u0275dir=Le({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(r,s){r&2&&Ze("mdc-floating-label--float-above",s.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}});let i=e;return i})();function D8(i){let e=i;if(e.offsetParent!==null)return e.scrollWidth;let t=e.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);let n=t.scrollWidth;return t.remove(),n}var PN="mdc-line-ripple--active",kp="mdc-line-ripple--deactivating",FN=(()=>{let e=class e{constructor(n,r){this._elementRef=n,this._handleTransitionEnd=s=>{let o=this._elementRef.nativeElement.classList,a=o.contains(kp);s.propertyName==="opacity"&&a&&o.remove(PN,kp)},r.runOutsideAngular(()=>{n.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let n=this._elementRef.nativeElement.classList;n.remove(kp),n.add(PN)}deactivate(){this._elementRef.nativeElement.classList.add(kp)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}};e.\u0275fac=function(r){return new(r||e)(V(Be),V(se))},e.\u0275dir=Le({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]});let i=e;return i})(),LN=(()=>{let e=class e{constructor(n,r){this._elementRef=n,this._ngZone=r,this.open=!1}ngAfterViewInit(){let n=this._elementRef.nativeElement.querySelector(".mdc-floating-label");n?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(n.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>n.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(n){!this.open||!n?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${n}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + ${8+1}px)`}};e.\u0275fac=function(r){return new(r||e)(V(Be),V(se))},e.\u0275cmp=mi({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(r,s){if(r&1&&yn(JK,5),r&2){let o;Ve(o=Ue())&&(s._notch=o.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(r,s){r&2&&Ze("mdc-notched-outline--notched",s.open)},inputs:{open:["matFormFieldNotchedOutlineOpen","open"]},attrs:e8,ngContentSelectors:t8,decls:5,vars:0,consts:[[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],["notch",""],[1,"mdc-notched-outline__trailing"]],template:function(r,s){r&1&&($i(),Qn(0,"div",0),ye(1,"div",1,2),at(3),ve(),Qn(4,"div",3))},encapsulation:2,changeDetection:0});let i=e;return i})(),A8={transitionMessages:pC("transitionMessages",[yC("enter",ig({opacity:1,transform:"translateY(0%)"})),vC("void => enter",[ig({opacity:0,transform:"translateY(-5px)"}),gC("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},wE=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Le({type:e});let i=e;return i})();var SE=new W("MatFormField"),R8=new W("MAT_FORM_FIELD_DEFAULT_OPTIONS"),BN=0,VN="fill",k8="auto",UN="fixed",M8="translateY(-50%)",zN=(()=>{let e=class e{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(n){this._hideRequiredMarker=Yn(n)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||k8}set floatLabel(n){n!==this._floatLabel&&(this._floatLabel=n,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(n){let r=this._appearance,s=n||this._defaults?.appearance||VN;this._appearance=s,this._appearance==="outline"&&this._appearance!==r&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||UN}set subscriptSizing(n){this._subscriptSizing=n||this._defaults?.subscriptSizing||UN}get hintLabel(){return this._hintLabel}set hintLabel(n){this._hintLabel=n,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(n){this._explicitFormFieldControl=n}constructor(n,r,s,o,a,l,c,d){this._elementRef=n,this._changeDetectorRef=r,this._ngZone=s,this._dir=o,this._platform=a,this._defaults=l,this._animationMode=c,this._hideRequiredMarker=!1,this.color="primary",this._appearance=VN,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${BN++}`,this._hintLabelId=`mat-mdc-hint-${BN++}`,this._subscriptAnimationState="",this._destroyed=new te,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,l&&(l.appearance&&(this.appearance=l.appearance),this._hideRequiredMarker=!!l?.hideRequiredMarker,l.color&&(this.color=l.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){let n=this._control;n.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${n.controlType}`),n.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),n.ngControl&&n.ngControl.valueChanges&&n.ngControl.valueChanges.pipe(si(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(n=>!n._isText),this._hasTextPrefix=!!this._prefixChildren.find(n=>n._isText),this._hasIconSuffix=!!this._suffixChildren.find(n=>!n._isText),this._hasTextSuffix=!!this._suffixChildren.find(n=>n._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),br(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(si(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(si(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(n){let r=this._control?this._control.ngControl:null;return r&&r[n]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let n=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&n.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let r=this._hintChildren?this._hintChildren.find(o=>o.align==="start"):null,s=this._hintChildren?this._hintChildren.find(o=>o.align==="end"):null;r?n.push(r.id):this._hintLabel&&n.push(this._hintLabelId),s&&n.push(s.id)}else this._errorChildren&&n.push(...this._errorChildren.map(r=>r.id));this._control.setDescribedByIds(n)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;let n=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){n.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdateOnStable=!0;return}let r=this._iconPrefixContainer?.nativeElement,s=this._textPrefixContainer?.nativeElement,o=r?.getBoundingClientRect().width??0,a=s?.getBoundingClientRect().width??0,l=this._dir.value==="rtl"?"-1":"1",c=`${o+a}px`,u=`calc(${l} * (${c} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;n.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${M8} translateX(${u})
    )`}_isAttachedToDom(){let n=this._elementRef.nativeElement;if(n.getRootNode){let r=n.getRootNode();return r&&r!==n}return document.documentElement.contains(n)}};e.\u0275fac=function(r){return new(r||e)(V(Be),V(Er),V(se),V(Vl),V(Ft),V(R8,8),V(Jp,8),V(lt))},e.\u0275cmp=mi({type:e,selectors:[["mat-form-field"]],contentQueries:function(r,s,o){if(r&1&&(ai(o,Mp,5),ai(o,Mp,7),ai(o,wE,5),ai(o,x8,5),ai(o,I8,5),ai(o,C8,5),ai(o,ON,5)),r&2){let a;Ve(a=Ue())&&(s._labelChildNonStatic=a.first),Ve(a=Ue())&&(s._labelChildStatic=a.first),Ve(a=Ue())&&(s._formFieldControl=a.first),Ve(a=Ue())&&(s._prefixChildren=a),Ve(a=Ue())&&(s._suffixChildren=a),Ve(a=Ue())&&(s._errorChildren=a),Ve(a=Ue())&&(s._hintChildren=a)}},viewQuery:function(r,s){if(r&1&&(yn(i8,5),yn(n8,5),yn(r8,5),yn(NN,5),yn(LN,5),yn(FN,5)),r&2){let o;Ve(o=Ue())&&(s._textField=o.first),Ve(o=Ue())&&(s._iconPrefixContainer=o.first),Ve(o=Ue())&&(s._textPrefixContainer=o.first),Ve(o=Ue())&&(s._floatingLabel=o.first),Ve(o=Ue())&&(s._notchedOutline=o.first),Ve(o=Ue())&&(s._lineRipple=o.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(r,s){r&2&&Ze("mat-mdc-form-field-label-always-float",s._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",s._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",s._hasIconSuffix)("mat-form-field-invalid",s._control.errorState)("mat-form-field-disabled",s._control.disabled)("mat-form-field-autofilled",s._control.autofilled)("mat-form-field-no-animations",s._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",s.appearance=="fill")("mat-form-field-appearance-outline",s.appearance=="outline")("mat-form-field-hide-placeholder",s._hasFloatingLabel()&&!s._shouldLabelFloat())("mat-focused",s._control.focused)("mat-primary",s.color!=="accent"&&s.color!=="warn")("mat-accent",s.color==="accent")("mat-warn",s.color==="warn")("ng-untouched",s._shouldForward("untouched"))("ng-touched",s._shouldForward("touched"))("ng-pristine",s._shouldForward("pristine"))("ng-dirty",s._shouldForward("dirty"))("ng-valid",s._shouldForward("valid"))("ng-invalid",s._shouldForward("invalid"))("ng-pending",s._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[pi([{provide:SE,useExisting:e},{provide:qN,useExisting:e}])],ngContentSelectors:E8,decls:18,vars:21,consts:[["labelTemplate",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],["textField",""],["class","mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],["class","mat-mdc-form-field-icon-prefix"],["class","mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],["class","mat-mdc-form-field-text-suffix"],["class","mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true","class","mat-mdc-form-field-required-marker mdc-floating-label--required"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-icon-prefix"],["iconPrefixContainer",""],[1,"mat-mdc-form-field-text-prefix"],["textPrefixContainer",""],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(r,s){if(r&1&&($i(S8),pt(0,a8,1,1,"ng-template",null,0,aC),ye(2,"div",1,2),oi("click",function(a){return s._control.onContainerClick(a)}),pt(4,l8,1,0,"div",3),ye(5,"div",4),pt(6,u8,2,2,"div",5)(7,h8,3,0,"div",6)(8,f8,3,0,"div",7),ye(9,"div",8),pt(10,p8,1,1,null,9),at(11),ve(),pt(12,g8,2,0,"div",10)(13,y8,2,0,"div",11),ve(),pt(14,v8,1,0,"div",12),ve(),ye(15,"div",13),pt(16,_8,2,1)(17,w8,5,2),ve()),r&2){let o;Se(2),Ze("mdc-text-field--filled",!s._hasOutline())("mdc-text-field--outlined",s._hasOutline())("mdc-text-field--no-label",!s._hasFloatingLabel())("mdc-text-field--disabled",s._control.disabled)("mdc-text-field--invalid",s._control.errorState),Se(2),Wt(4,!s._hasOutline()&&!s._control.disabled?4:-1),Se(2),Wt(6,s._hasOutline()?6:-1),Se(1),Wt(7,s._hasIconPrefix?7:-1),Se(1),Wt(8,s._hasTextPrefix?8:-1),Se(2),Wt(10,!s._hasOutline()||s._forceDisplayInfixLabel()?10:-1),Se(2),Wt(12,s._hasTextSuffix?12:-1),Se(1),Wt(13,s._hasIconSuffix?13:-1),Se(1),Wt(14,s._hasOutline()?-1:14),Se(1),Ze("mat-mdc-form-field-subscript-dynamic-size",s.subscriptSizing==="dynamic"),Se(1),Wt(16,(o=s._getDisplayedMessages())==="error"?16:o==="hint"?17:-1)}},dependencies:[cC,ON,NN,LN,FN],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:12px;box-sizing:content-box}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[A8.transitionMessages]},changeDetection:0});let i=e;return i})(),EE=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({imports:[ni,lu,FC,ni]});let i=e;return i})();var N8=new W("MAT_INPUT_VALUE_ACCESSOR"),P8=["button","checkbox","file","hidden","image","radio","range","reset","submit"],F8=0,L8=GO(class{constructor(i,e,t,n){this._defaultErrorStateMatcher=i,this._parentForm=e,this._parentFormGroup=t,this.ngControl=n,this.stateChanges=new te}}),jN=(()=>{let e=class e extends L8{get disabled(){return this._disabled}set disabled(n){this._disabled=Yn(n),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(n){this._id=n||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(Sp.required)??!1}set required(n){this._required=Yn(n)}get type(){return this._type}set type(n){this._type=n||"text",this._validateType(),!this._isTextarea&&lg().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(n){n!==this.value&&(this._inputValueAccessor.value=n,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(n){this._readonly=Yn(n)}constructor(n,r,s,o,a,l,c,d,u,h){super(l,o,a,s),this._elementRef=n,this._platform=r,this._autofillMonitor=d,this._formField=h,this._uid=`mat-input-${F8++}`,this.focused=!1,this.stateChanges=new te,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(_=>lg().has(_)),this._iOSKeyupListener=_=>{let y=_.target;!y.value&&y.selectionStart===0&&y.selectionEnd===0&&(y.setSelectionRange(1,1),y.setSelectionRange(0,0))};let m=this._elementRef.nativeElement,g=m.nodeName.toLowerCase();this._inputValueAccessor=c||m,this._previousNativeValue=this.value,this.id=this.id,r.IOS&&u.runOutsideAngular(()=>{n.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect=g==="select",this._isTextarea=g==="textarea",this._isInFormField=!!h,this._isNativeSelect&&(this.controlType=m.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(n=>{this.autofilled=n.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(n){this._elementRef.nativeElement.focus(n)}_focusChanged(n){n!==this.focused&&(this.focused=n,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){let n=this._elementRef.nativeElement.value;this._previousNativeValue!==n&&(this._previousNativeValue=n,this.stateChanges.next())}_dirtyCheckPlaceholder(){let n=this._getPlaceholder();if(n!==this._previousPlaceholder){let r=this._elementRef.nativeElement;this._previousPlaceholder=n,n?r.setAttribute("placeholder",n):r.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){P8.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let n=this._elementRef.nativeElement.validity;return n&&n.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let n=this._elementRef.nativeElement,r=n.options[0];return this.focused||n.multiple||!this.empty||!!(n.selectedIndex>-1&&r&&r.label)}else return this.focused||!this.empty}setDescribedByIds(n){n.length?this._elementRef.nativeElement.setAttribute("aria-describedby",n.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let n=this._elementRef.nativeElement;return this._isNativeSelect&&(n.multiple||n.size>1)}};e.\u0275fac=function(r){return new(r||e)(V(Be),V(Ft),V(Tp,10),V(vE,8),V(_E,8),V($O),V(N8,10),V(rN),V(se),V(SE,8))},e.\u0275dir=Le({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(r,s){r&1&&oi("focus",function(){return s._focusChanged(!0)})("blur",function(){return s._focusChanged(!1)})("input",function(){return s._onInput()}),r&2&&(Nl("id",s.id)("disabled",s.disabled)("required",s.required),Ci("name",s.name||null)("readonly",s.readonly&&!s._isNativeSelect||null)("aria-invalid",s.empty&&s.required?null:s.errorState)("aria-required",s.required)("id",s.id),Ze("mat-input-server",s._isServer)("mat-mdc-form-field-textarea-control",s._isInFormField&&s._isTextarea)("mat-mdc-form-field-input-control",s._isInFormField)("mdc-text-field__input",s._isInFormField)("mat-mdc-native-select-inline",s._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[pi([{provide:wE,useExisting:e}]),mn,Sr]});let i=e;return i})(),GN=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e}),e.\u0275inj=J({imports:[ni,EE,EE,sN,ni]});let i=e;return i})();function V8(i,e){if(i&1&&(ye(0,"mat-card",9),gn(1),ve()),i&2){let t=e.$implicit;Se(1),Fo(t)}}function U8(i,e){if(i&1&&(ye(0,"mat-card",9),gn(1),ve()),i&2){let t=e.$implicit;Se(1),Fo(t)}}function q8(i,e){if(i&1&&(ye(0,"mat-card",9),gn(1),ve()),i&2){let t=e.$implicit;Se(1),Fo(t)}}var CE=(i,e)=>[i,e],Op=(()=>{let e=class e{constructor(){this.firestore=Nt(Io),this.todo=["TODO 1"],this.inProgress=["IP 1"],this.done=["DONE 1"];let n=FO(this.firestore,"items");this.items$=PO(n)}drop(n){n.container.id===n.previousContainer.id?bg(n.container.data,n.previousIndex,n.currentIndex):rT(n.previousContainer.data,n.container.data,n.previousIndex,n.currentIndex)}addItem(n){let r=n.target;this.todo.push(r.value),r.value=""}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=mi({type:e,selectors:[["app-root"]],decls:20,vars:18,consts:[["color","primary"],[1,"content-wrapper"],["matInput","",3,"keydown.enter"],[1,"container-wrapper"],["cdkDropList","",1,"list",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["backlogList","cdkDropList"],["cdkDrag","","class","item",4,"ngFor","ngForOf"],["inProgressList","cdkDropList"],["doneList","cdkDropList"],["cdkDrag","",1,"item"]],template:function(r,s){if(r&1&&(ye(0,"mat-toolbar",0)(1,"mat-icon"),gn(2,"local_fire_deparment"),ve(),ye(3,"span"),gn(4,"KanbanFire"),ve()(),ye(5,"div",1)(6,"mat-form-field")(7,"mat-label"),gn(8,"Task name"),ve(),ye(9,"input",2),oi("keydown.enter",function(a){return s.addItem(a)}),ve()(),ye(10,"div",3)(11,"mat-card",4,5),oi("cdkDropListDropped",function(a){return s.drop(a)}),pt(13,V8,2,1,"mat-card",6),ve(),ye(14,"mat-card",4,7),oi("cdkDropListDropped",function(a){return s.drop(a)}),pt(16,U8,2,1,"mat-card",6),ve(),ye(17,"mat-card",4,8),oi("cdkDropListDropped",function(a){return s.drop(a)}),pt(19,q8,2,1,"mat-card",6),ve()()()),r&2){let o=As(12),a=As(15),l=As(18);Se(11),Pt("cdkDropListData",s.todo)("cdkDropListConnectedTo",au(9,CE,a,l)),Se(2),Pt("ngForOf",s.todo),Se(1),Pt("cdkDropListData",s.inProgress)("cdkDropListConnectedTo",au(12,CE,o,l)),Se(2),Pt("ngForOf",s.inProgress),Se(1),Pt("cdkDropListData",s.done)("cdkDropListConnectedTo",au(15,CE,o,a)),Se(2),Pt("ngForOf",s.done)}},dependencies:[lC,HO,JO,tN,uT,dT,jN,zN,Mp],styles:[".container-wrapper[_ngcontent-%COMP%]{display:flex;margin-top:20px}.list[_ngcontent-%COMP%]{width:400px;margin-right:25px;border:1px solid #ccc;min-height:60px}.item[_ngcontent-%COMP%]{margin-bottom:10px;cursor:pointer;box-sizing:border-box}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s}.content-wrapper[_ngcontent-%COMP%]{width:1000px;margin:auto}"]});let i=e;return i})();var z8="firebase",j8="10.7.1";li.registerVersion(z8,j8,"app-compat");var G8=["ngOnDestroy"],HN=(i,e,t,n={})=>new Proxy(i,{get:(r,s)=>t.runOutsideAngular(()=>{if(i[s])return n?.spy?.get&&n.spy.get(s,i[s]),i[s];if(G8.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let l=a?.[s];return typeof l=="function"?l.bind(a):l?.then?l.then(c=>t.run(()=>c)):t.run(()=>l)});return new Proxy(()=>{},{get:(a,l)=>o[l],apply:(a,l,c)=>o.then(d=>{let u=d?.(...c);return n?.spy?.apply&&n.spy.apply(s,c,u),u})})})});var Np=class{constructor(e){return e}},Il=new W("angularfire2.app.options"),Dl=new W("angularfire2.app.name");function Yd(i,e,t){let n=typeof t=="string"&&t||"[DEFAULT]",r=typeof t=="object"&&t||{};r.name=r.name||n;let o=li.apps.filter(a=>a&&a.name===r.name)[0]||e.runOutsideAngular(()=>li.initializeApp(i,r));try{if(JSON.stringify(i)!==JSON.stringify(o.options)){let a=!!module.hot;$8("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Np(o)}var $8=(i,...e)=>{tg()&&typeof console<"u"&&console[i](...e)},H8={provide:Np,useFactory:Yd,deps:[Il,se,[new Gi,Dl]]},WN=(()=>{class i{static initializeApp(t,n){return{ngModule:i,providers:[{provide:Il,useValue:t},{provide:Dl,useValue:n}]}}constructor(t){li.registerVersion("angularfire",Ti.full,"core"),li.registerVersion("angularfire",Ti.full,"app-compat"),li.registerVersion("angular",su.full,t.toString())}static \u0275fac=function(n){return new(n||i)(N(fn))};static \u0275mod=ee({type:i});static \u0275inj=J({providers:[H8]})}return i})();function Pp(i,e,t,n,r){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===i)||[];if(s)return W8(r,o)||($N("error",`${e} was already initialized on the ${t} Firebase App with different settings.${K8?" You may need to reload as Firebase is not HMR aware.":""}`),$N("warn",{is:r,was:o})),s;{let a=n();return globalThis.\u0275AngularfireInstanceCache.push([i,a,r]),a}}function W8(i,e){try{return i.toString()===e.toString()}catch{return i===e}}var K8=typeof module<"u"&&!!module.hot,$N=(i,...e)=>{tg()&&typeof console<"u"&&console[i](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Q8=new Map,Y8={activated:!1,tokenObservers:[]},X8={initialized:!1,enabled:!1};function cn(i){return Q8.get(i)||Object.assign({},Y8)}function ZN(){return X8}var Z8="https://content-firebaseappcheck.googleapis.com/v1";var J8="exchangeDebugToken",KN={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},dne=24*60*60*1e3;var xE=class{constructor(e,t,n,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return p(this,null,function*(){this.stop();try{this.pending=new rg,this.pending.promise.catch(t=>{}),yield e7(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new rg,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function e7(i){return new Promise(e=>{setTimeout(e,i)})}var t7={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},xs=new xC("appCheck","AppCheck",t7);function JN(i){if(!cn(i).activated)throw xs.create("use-before-activation",{appName:i.name})}function eP(n,r){return p(this,arguments,function*({url:i,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let m=yield o.getHeartbeatsHeader();m&&(s["X-Firebase-Client"]=m)}let a={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(i,a)}catch(m){throw xs.create("fetch-network-error",{originalErrorMessage:m?.message})}if(l.status!==200)throw xs.create("fetch-status-error",{httpStatus:l.status});let c;try{c=yield l.json()}catch(m){throw xs.create("fetch-parse-error",{originalErrorMessage:m?.message})}let d=c.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw xs.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let u=Number(d[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+u,issuedAtTimeMillis:h}})}function tP(i,e){let{projectId:t,appId:n,apiKey:r}=i.options;return{url:`${Z8}/projects/${t}/apps/${n}:${J8}?key=${r}`,body:{debug_token:e}}}var i7="firebase-app-check-database",n7=1,IE="firebase-app-check-store";var Fp=null;function r7(){return Fp||(Fp=new Promise((i,e)=>{try{let t=indexedDB.open(i7,n7);t.onsuccess=n=>{i(n.target.result)},t.onerror=n=>{var r;e(xs.create("storage-open",{originalErrorMessage:(r=n.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=n=>{let r=n.target.result;switch(n.oldVersion){case 0:r.createObjectStore(IE,{keyPath:"compositeKey"})}}}catch(t){e(xs.create("storage-open",{originalErrorMessage:t?.message}))}}),Fp)}function s7(i,e){return o7(a7(i),e)}function o7(i,e){return p(this,null,function*(){let n=(yield r7()).transaction(IE,"readwrite"),s=n.objectStore(IE).put({compositeKey:i,value:e});return new Promise((o,a)=>{s.onsuccess=l=>{o()},n.onerror=l=>{var c;a(xs.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})})}function a7(i){return`${i.options.appId}-${i.name}`}var DE=new hu("@firebase/app-check");function TE(i,e){return uu()?s7(i,e).catch(t=>{DE.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function iP(){return ZN().enabled}function nP(){return p(this,null,function*(){let i=ZN();if(i.enabled&&i.token)return i.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var l7={error:"UNKNOWN_ERROR"};function c7(i){return wC.encodeString(JSON.stringify(i),!1)}function AE(i,e=!1){return p(this,null,function*(){let t=i.app;JN(t);let n=cn(t),r=n.token,s;if(r&&!Xd(r)&&(n.token=void 0,r=void 0),!r){let l=yield n.cachedTokenPromise;l&&(Xd(l)?r=l:yield TE(t,void 0))}if(!e&&r&&Xd(r))return{token:r.token};let o=!1;if(iP()){n.exchangeTokenPromise||(n.exchangeTokenPromise=eP(tP(t,yield nP()),i.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),o=!0);let l=yield n.exchangeTokenPromise;return yield TE(t,l),n.token=l,{token:l.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),o=!0),r=yield cn(t).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?DE.warn(l.message):DE.error(l),s=l}let a;return r?s?Xd(r)?a={token:r.token,internalError:s}:a=YN(s):(a={token:r.token},n.token=r,yield TE(t,r)):a=YN(s),o&&f7(t,a),a})}function d7(i){return p(this,null,function*(){let e=i.app;JN(e);let{provider:t}=cn(e);if(iP()){let n=yield nP(),{token:r}=yield eP(tP(e,n),i.heartbeatServiceProvider);return{token:r}}else{let{token:n}=yield t.getToken();return{token:n}}})}function u7(i,e,t,n){let{app:r}=i,s=cn(r),o={next:t,error:n,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Xd(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),QN(i)}).catch(()=>{})}s.cachedTokenPromise.then(()=>QN(i))}function rP(i,e){let t=cn(i),n=t.tokenObservers.filter(r=>r.next!==e);n.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function QN(i){let{app:e}=i,t=cn(e),n=t.tokenRefresher;n||(n=h7(i),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function h7(i){let{app:e}=i;return new xE(()=>p(this,null,function*(){let t=cn(e),n;if(t.token?n=yield AE(i,!0):n=yield AE(i),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{let t=cn(e);if(t.token){let n=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,r=t.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,r),Math.max(0,n-Date.now())}else return 0},KN.RETRIAL_MIN_WAIT,KN.RETRIAL_MAX_WAIT)}function f7(i,e){let t=cn(i).tokenObservers;for(let n of t)try{n.type==="EXTERNAL"&&e.error!=null?n.error(e.error):n.next(e)}catch{}}function Xd(i){return i.expireTimeMillis-Date.now()>0}function YN(i){return{token:c7(l7),error:i}}var RE=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=cn(this.app);for(let t of e)rP(this.app,t.next);return Promise.resolve()}};function m7(i,e){return new RE(i,e)}function p7(i){return{getToken:e=>AE(i,e),getLimitedUseToken:()=>d7(i),addTokenListener:e=>u7(i,"INTERNAL",e),removeTokenListener:e=>rP(i.app,e)}}var g7="@firebase/app-check",y7="0.8.1";var v7="app-check",XN="app-check-internal";function _7(){Pl(new Rs(v7,i=>{let e=i.getProvider("app").getImmediate(),t=i.getProvider("heartbeat");return m7(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((i,e,t)=>{i.getProvider(XN).initialize()})),Pl(new Rs(XN,i=>{let e=i.getProvider("app-check").getImmediate();return p7(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Kt(g7,y7)}_7();var b7=["localhost","0.0.0.0","127.0.0.1"],Sne=typeof window<"u"&&b7.includes(window.location.hostname);var kE=new W("angularfire2.auth.use-emulator"),ME=new W("angularfire2.auth.settings"),OE=new W("angularfire2.auth.tenant-id"),NE=new W("angularfire2.auth.langugage-code"),PE=new W("angularfire2.auth.use-device-language"),FE=new W("angularfire.auth.persistence"),LE=(i,e,t,n,r,s,o,a)=>Pp(`${i.name}.auth`,"AngularFireAuth",i.name,()=>{let l=e.runOutsideAngular(()=>i.auth());if(t&&l.useEmulator(...t),n&&(l.tenantId=n),l.languageCode=r,s&&l.useDeviceLanguage(),o)for(let[c,d]of Object.entries(o))l.settings[c]=d;return a&&l.setPersistence(a),l},[t,n,r,s,o,a]),oP=(()=>{class i{authState;idToken;user;idTokenResult;credential;constructor(t,n,r,s,o,a,l,c,d,u,h,m){let g=new te,_=Ot(void 0).pipe(_r(o.outsideAngular),hn(()=>s.runOutsideAngular(()=>import("./chunk-AQA2QWCC.mjs"))),pe(()=>Yd(t,s,n)),pe(y=>LE(y,s,a,c,d,u,l,h)),No({bufferSize:1,refCount:!1}));if(cu(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Ot(null);else{_.pipe(iC()).subscribe();let y=_.pipe(hn(R=>R.getRedirectResult().then(k=>k,()=>null)),Qt,No({bufferSize:1,refCount:!1})),A=_.pipe(hn(R=>new mt(k=>({unsubscribe:s.runOutsideAngular(()=>R.onAuthStateChanged(q=>k.next(q),q=>k.error(q),()=>k.complete()))})))),w=_.pipe(hn(R=>new mt(k=>({unsubscribe:s.runOutsideAngular(()=>R.onIdTokenChanged(q=>k.next(q),q=>k.error(q),()=>k.complete()))}))));this.authState=y.pipe(Yp(A),Is(o.outsideAngular),_r(o.insideAngular)),this.user=y.pipe(Yp(w),Is(o.outsideAngular),_r(o.insideAngular)),this.idToken=this.user.pipe(hn(R=>R?ji(R.getIdToken()):Ot(null))),this.idTokenResult=this.user.pipe(hn(R=>R?ji(R.getIdTokenResult()):Ot(null))),this.credential=br(y,g,this.authState.pipe(un(R=>!R))).pipe(pe(R=>R?.user?R:null),Is(o.outsideAngular),_r(o.insideAngular))}return HN(this,_,s,{spy:{apply:(y,A,w)=>{(y.startsWith("signIn")||y.startsWith("createUser"))&&w.then(R=>g.next(R))}}})}static \u0275fac=function(n){return new(n||i)(N(Il),N(Dl,8),N(fn),N(se),N(Zn),N(kE,8),N(ME,8),N(OE,8),N(NE,8),N(PE,8),N(FE,8),N(_n,8))};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();var S7="@firebase/firestore-compat",E7="0.3.23";function jE(i,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new E("invalid-argument",`Invalid options passed to function ${i}(): You cannot specify both "merge" and "mergeFields".`);return e}function aP(){if(typeof Uint8Array>"u")throw new E("unimplemented","Uint8Arrays are not available in this environment.")}function lP(){if(!Fk())throw new E("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Lp=class i{constructor(e){this._delegate=e}static fromBase64String(e){return lP(),new i(Hn.fromBase64String(e))}static fromUint8Array(e){return aP(),new i(Hn.fromUint8Array(e))}toBase64(){return lP(),this._delegate.toBase64()}toUint8Array(){return aP(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function BE(i){return C7(i,["next","error","complete"])}function C7(i,e){if(typeof i!="object"||i===null)return!1;let t=i;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}var VE=class{enableIndexedDbPersistence(e,t){return IS(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return DS(e._delegate)}clearIndexedDbPersistence(e){return AS(e._delegate)}},Bp=class{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof hs||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Vi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){cp(this._delegate,e,t,n)}enableNetwork(){return kS(this._delegate)}disableNetwork(){return MS(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,SS("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return RS(this._delegate)}onSnapshotsInSync(e){return tE(this._delegate,e)}get app(){if(!this._appCompat)throw new E("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new kl(this,jd(this._delegate,e))}catch(t){throw ri(t,"collection()","Firestore.collection()")}}doc(e){try{return new Kn(this,Sl(this._delegate,e))}catch(t){throw ri(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ko(this,xS(this._delegate,e))}catch(t){throw ri(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return nE(this._delegate,t=>e(new Vp(this,t)))}batch(){return gt(this._delegate),new Up(new Xm(this._delegate,e=>Cl(this._delegate,e)))}loadBundle(e){return OS(this._delegate,e)}namedQuery(e){return NS(this._delegate,e).then(t=>t?new ko(this,t):null)}},Al=class extends hl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Lp(new Hn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Kn.forKey(t,this.firestore,null)}};function T7(i){Uw(i)}var Vp=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Al(e)}get(e){let t=Do(e);return this._delegate.get(t).then(n=>new Ao(this._firestore,new qi(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){let r=Do(e);return n?(jE("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){let s=Do(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){let t=Do(e);return this._delegate.delete(t),this}},Up=class{constructor(e){this._delegate=e}set(e,t,n){let r=Do(e);return n?(jE("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){let s=Do(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){let t=Do(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Rl=class i{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){let n=new _s(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ro(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let n=i.INSTANCES,r=n.get(e);r||(r=new WeakMap,n.set(e,r));let s=r.get(t);return s||(s=new i(e,new Al(e),t),r.set(t,s)),s}};Rl.INSTANCES=new WeakMap;var Kn=class i{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Al(e)}static forPath(e,t,n){if(e.length%2!==0)throw new E("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new i(t,new De(t._delegate,n,new O(e)))}static forKey(e,t,n){return new i(t,new De(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new kl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new kl(this.firestore,jd(this._delegate,e))}catch(t){throw ri(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=qe(e),e instanceof De?Gd(this._delegate,e):!1}set(e,t){t=jE("DocumentReference.set",t);try{return t?pp(this._delegate,e,t):pp(this._delegate,e)}catch(n){throw ri(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return arguments.length===1?gp(this._delegate,e):gp(this._delegate,e,t,...n)}catch(r){throw ri(r,"updateDoc()","DocumentReference.update()")}}delete(){return JS(this._delegate)}onSnapshot(...e){let t=cP(e),n=dP(e,r=>new Ao(this.firestore,new qi(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return El(this._delegate,t,n)}get(e){let t;return e?.source==="cache"?t=KS(this._delegate):e?.source==="server"?t=QS(this._delegate):t=WS(this._delegate),t.then(n=>new Ao(this.firestore,new qi(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new i(this.firestore,e?this._delegate.withConverter(Rl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ri(i,e,t){return i.message=i.message.replace(e,t),i}function cP(i){for(let e of i)if(typeof e=="object"&&!BE(e))return e;return{}}function dP(i,e){var t,n;let r;return BE(i[0])?r=i[0]:BE(i[1])?r=i[1]:typeof i[0]=="function"?r={next:i[0],error:i[1],complete:i[2]}:r={next:i[1],error:i[2],complete:i[3]},{next:s=>{r.next&&r.next(e(s))},error:(t=r.error)===null||t===void 0?void 0:t.bind(r),complete:(n=r.complete)===null||n===void 0?void 0:n.bind(r)}}var Ao=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Kn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return mp(this._delegate,e._delegate)}},Ro=class extends Ao{data(e){let t=this._delegate.data(e);return this._delegate._converter||yk(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},ko=class i{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Al(e)}where(e,t,n){try{return new i(this.firestore,Wn(this._delegate,VS(e,t,n)))}catch(r){throw ri(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new i(this.firestore,Wn(this._delegate,US(e,t)))}catch(n){throw ri(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new i(this.firestore,Wn(this._delegate,qS(e)))}catch(t){throw ri(t,"limit()","Query.limit()")}}limitToLast(e){try{return new i(this.firestore,Wn(this._delegate,zS(e)))}catch(t){throw ri(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new i(this.firestore,Wn(this._delegate,jS(...e)))}catch(t){throw ri(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new i(this.firestore,Wn(this._delegate,GS(...e)))}catch(t){throw ri(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new i(this.firestore,Wn(this._delegate,$S(...e)))}catch(t){throw ri(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new i(this.firestore,Wn(this._delegate,HS(...e)))}catch(t){throw ri(t,"endAt()","Query.endAt()")}}isEqual(e){return dp(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=XS(this._delegate):e?.source==="server"?t=ZS(this._delegate):t=YS(this._delegate),t.then(n=>new Zd(this.firestore,new ln(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){let t=cP(e),n=dP(e,r=>new Zd(this.firestore,new ln(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return El(this._delegate,t,n)}withConverter(e){return new i(this.firestore,e?this._delegate.withConverter(Rl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},UE=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ro(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Zd=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new ko(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ro(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new UE(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new Ro(this._firestore,n))})}isEqual(e){return mp(this._delegate,e._delegate)}},kl=class i extends ko{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Kn(this.firestore,e):null}doc(e){try{return e===void 0?new Kn(this.firestore,Sl(this._delegate)):new Kn(this.firestore,Sl(this._delegate,e))}catch(t){throw ri(t,"doc()","CollectionReference.doc()")}}add(e){return eE(this._delegate,e).then(t=>new Kn(this.firestore,t))}isEqual(e){return Gd(this._delegate,e._delegate)}withConverter(e){return new i(this.firestore,e?this._delegate.withConverter(Rl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Do(i){return le(i,De)}var qE=class i{constructor(...e){this._delegate=new an(...e)}static documentId(){return new i(nt.keyField().canonicalString())}isEqual(e){return e=qe(e),e instanceof an?this._delegate._internalPath.isEqual(e._internalPath):!1}};var zE=class i{constructor(e){this._delegate=e}static serverTimestamp(){let e=sE();return e._methodName="FieldValue.serverTimestamp",new i(e)}static delete(){let e=rE();return e._methodName="FieldValue.delete",new i(e)}static arrayUnion(...e){let t=oE(...e);return t._methodName="FieldValue.arrayUnion",new i(t)}static arrayRemove(...e){let t=aE(...e);return t._methodName="FieldValue.arrayRemove",new i(t)}static increment(e){let t=lE(e);return t._methodName="FieldValue.increment",new i(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var x7={Firestore:Bp,GeoPoint:bo,Timestamp:je,Blob:Lp,Transaction:Vp,WriteBatch:Up,DocumentReference:Kn,DocumentSnapshot:Ao,Query:ko,QueryDocumentSnapshot:Ro,QuerySnapshot:Zd,CollectionReference:kl,FieldPath:qE,FieldValue:zE,setLogLevel:T7,CACHE_SIZE_UNLIMITED:pO};function I7(i,e){i.INTERNAL.registerComponent(new Rs("firestore-compat",t=>{let n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(n,r)},"PUBLIC").setServiceProps(Object.assign({},x7)))}function D7(i){I7(i,(e,t)=>new Bp(e,t,new VE)),i.registerVersion(S7,E7,"node")}D7(li);function A7(i,e=eu){return new mt(t=>{let n;return e!=null?e.schedule(()=>{n=i.onSnapshot({includeMetadataChanges:!0},t)}):n=i.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}function uP(i,e){return A7(i,e)}function R7(i,e){return uP(i,e).pipe(Ei(void 0),Oo(),pe(t=>{let[n,r]=t;return r.exists?n?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}function HE(i,e){return uP(i,e).pipe(pe(t=>({payload:t,type:"query"})))}var qp=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let n=this.ref.collection(e),{ref:r,query:s}=gP(n,t);return new jp(r,s,this.afs)}snapshotChanges(){return R7(this.ref,this.afs.schedulers.outsideAngular).pipe(Qt)}valueChanges(e={}){return this.snapshotChanges().pipe(pe(({payload:t})=>e.idField?dn(yt({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return ji(this.ref.get(e)).pipe(Qt)}};function zp(i,e){return HE(i,e).pipe(Ei(void 0),Oo(),pe(t=>{let[n,r]=t,s=r.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((a,l)=>{let c=s.find(u=>u.doc.ref.isEqual(a.ref)),d=n?.payload.docs.find(u=>u.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:a}})}),o}))}function hP(i,e,t){return zp(i,t).pipe(Ml((n,r)=>k7(n,r.map(s=>s.payload),e),[]),iu(),pe(n=>n.map(r=>({type:r.type,payload:r}))))}function k7(i,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(i=M7(i,n))}),i}function GE(i,e,t,...n){let r=i.slice();return r.splice(e,t,...n),r}function M7(i,e){switch(e.type){case"added":if(!(i[e.newIndex]&&i[e.newIndex].doc.ref.isEqual(e.doc.ref)))return GE(i,e.newIndex,0,e);break;case"modified":if(i[e.oldIndex]==null||i[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=i.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return GE(i,e.newIndex,1,e);break;case"removed":if(i[e.oldIndex]&&i[e.oldIndex].doc.ref.isEqual(e.doc.ref))return GE(i,e.oldIndex,1);break}return i}function fP(i){return(!i||i.length===0)&&(i=["added","removed","modified"]),i}var jp=class{ref;query;afs;constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=zp(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(pe(n=>n.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(Ei(void 0),Oo(),un(([n,r])=>r.length>0||!n),pe(([,n])=>n),Qt)}auditTrail(e){return this.stateChanges(e).pipe(Ml((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=fP(e);return hP(this.query,t,this.afs.schedulers.outsideAngular).pipe(Qt)}valueChanges(e={}){return HE(this.query,this.afs.schedulers.outsideAngular).pipe(pe(t=>t.payload.docs.map(n=>e.idField?dn(yt({},n.data()),{[e.idField]:n.id}):n.data())),Qt)}get(e){return ji(this.query.get(e)).pipe(Qt)}add(e){return this.ref.add(e)}doc(e){return new qp(this.ref.doc(e),this.afs)}},$E=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?zp(this.query,this.afs.schedulers.outsideAngular).pipe(Qt):zp(this.query,this.afs.schedulers.outsideAngular).pipe(pe(t=>t.filter(n=>e.indexOf(n.type)>-1)),un(t=>t.length>0),Qt)}auditTrail(e){return this.stateChanges(e).pipe(Ml((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=fP(e);return hP(this.query,t,this.afs.schedulers.outsideAngular).pipe(Qt)}valueChanges(e={}){return HE(this.query,this.afs.schedulers.outsideAngular).pipe(pe(n=>n.payload.docs.map(r=>e.idField?yt({[e.idField]:r.id},r.data()):r.data())),Qt)}get(e){return ji(this.query.get(e)).pipe(Qt)}},mP=new W("angularfire2.enableFirestorePersistence"),pP=new W("angularfire2.firestore.persistenceSettings"),O7=new W("angularfire2.firestore.settings"),N7=new W("angularfire2.firestore.use-emulator");function gP(i,e=t=>t){return{query:e(i),ref:i}}var P7=(()=>{class i{schedulers;firestore;persistenceEnabled$;constructor(t,n,r,s,o,a,l,c,d,u,h,m,g,_,y,A,w){this.schedulers=l;let R=Yd(t,a,n),k=d;u&&LE(R,a,h,g,_,y,m,A),[this.firestore,this.persistenceEnabled$]=Pp(`${R.name}.firestore`,"AngularFirestore",R.name,()=>{let q=a.runOutsideAngular(()=>R.firestore());if(s&&q.settings(s),k&&q.useEmulator(...k),r&&!cu(o)){let K=()=>{try{return ji(q.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(ne){return typeof console<"u"&&console.warn(ne),Ot(!1)}};return[q,a.runOutsideAngular(K)]}else return[q,Ot(!1)]},[s,k,r])}collection(t,n){let r;typeof t=="string"?r=this.firestore.collection(t):r=t;let{ref:s,query:o}=gP(r,n),a=this.schedulers.ngZone.run(()=>s);return new jp(a,o,this)}collectionGroup(t,n){let r=n||(o=>o),s=this.firestore.collectionGroup(t);return new $E(r(s),this)}doc(t){let n;typeof t=="string"?n=this.firestore.doc(t):n=t;let r=this.schedulers.ngZone.run(()=>n);return new qp(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(n){return new(n||i)(N(Il),N(Dl,8),N(mP,8),N(O7,8),N(fn),N(se),N(Zn),N(pP,8),N(N7,8),N(oP,8),N(kE,8),N(ME,8),N(OE,8),N(NE,8),N(PE,8),N(FE,8),N(_n,8))};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})(),yP=(()=>{class i{constructor(){li.registerVersion("angularfire",Ti.full,"fst-compat")}static enablePersistence(t){return{ngModule:i,providers:[{provide:mP,useValue:!0},{provide:pP,useValue:t}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=ee({type:i});static \u0275inj=J({providers:[P7]})}return i})();var vP=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e,bootstrap:[Op]}),e.\u0275inj=J({providers:[mC()],imports:[hC,AC,_C,WO,eN,iN,hT,GN,mT(()=>pT({projectId:"pokerparty-a1760",appId:"1:327148006791:web:d9b3681a6adbd683b3f722",databaseURL:"https://pokerparty-a1760-default-rtdb.firebaseio.com",storageBucket:"pokerparty-a1760.appspot.com",apiKey:"AIzaSyDWeJRQAeSyg-3JfBBIjTkmxRTDHkQPP58",authDomain:"pokerparty-a1760.firebaseapp.com",messagingSenderId:"327148006791",measurementId:"G-3SLXJ6ZBLZ"})),NO(()=>LO()),WN.initializeApp({}),yP]});let i=e;return i})();var F7=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=ee({type:e,bootstrap:[Op]}),e.\u0275inj=J({imports:[vP,bC]});let i=e;return i})();export{F7 as a};
